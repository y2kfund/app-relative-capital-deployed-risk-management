var sb = Object.defineProperty;
var ab = (r, e, t) => e in r ? sb(r, e, { enumerable: !0, configurable: !0, writable: !0, value: t }) : r[e] = t;
var A = (r, e, t) => ab(r, typeof e != "symbol" ? e + "" : e, t);
import { inject as Vn, ref as Qs, watch as Vr, nextTick as Tp, defineComponent as xp, h as ob, shallowRef as mo, toRefs as lb, computed as rt, getCurrentInstance as hb, watchEffect as Sp, onMounted as ub, onBeforeUnmount as Rp, isRef as db, unref as Ot, createElementBlock as on, openBlock as ln, createElementVNode as Ce, toDisplayString as hn, createVNode as cb } from "vue";
import { useQueryClient as fb, useQuery as pb } from "@tanstack/vue-query";
const gb = Symbol.for("y2kfund.supabase");
function vb() {
  const r = Vn(gb, null);
  if (!r) throw new Error("[@y2kfund/core] Supabase client not found. Did you install createCore()?");
  return r;
}
async function mb(r, e) {
  if (!e)
    return console.log("âš ï¸ No userId provided, showing all positions"), [];
  try {
    console.log("ðŸ‘¤ Fetching accessible accounts for user:", e);
    const { data: t, error: i } = await r.schema("hf").from("user_account_access").select("internal_account_id").eq("user_id", e).eq("is_active", !0);
    if (i)
      return console.error("âŒ Error fetching user account access:", i), [];
    if (!t || t.length === 0)
      return console.log("âš ï¸ No account access found for user, showing all positions"), [];
    const n = t.map((s) => s.internal_account_id);
    return console.log("âœ… User has access to accounts:", n), n;
  } catch (t) {
    return console.error("âŒ Exception fetching account access:", t), [];
  }
}
const bb = {
  top20: (r) => ["relativeCapitalDeployed", "top20", r]
};
function yb(r, e) {
  if (!r) return "";
  if (e === "STK" || e === "FUND")
    return r;
  if (e === "OPT") {
    const t = r.match(/^([A-Z]+)/);
    return t ? t[1] : r.split(/\s+/)[0];
  }
  return r;
}
function wb(r, e) {
  return e === "STK" || e === "FUND" ? !0 : e === "OPT" ? r.includes(" P ") || r.includes(" P[") : !1;
}
function Cb(r) {
  const e = vb(), t = fb(), i = bb.top20(r), n = pb({
    queryKey: i,
    queryFn: async () => {
      console.log("ðŸ” [Top20Capital] Querying with:", {
        userId: r || "none (all accounts)"
      });
      const a = await mb(e, r);
      r && a.length === 0 ? console.log("âš ï¸ User has no account access restrictions - showing all accounts") : a.length > 0 && console.log("ðŸ”’ User has access to accounts:", a);
      const { data: o, error: l } = await e.schema("hf").from("positions").select("fetched_at").order("fetched_at", { ascending: !1 }).limit(1).single();
      if (l)
        throw console.error("âŒ Error fetching latest fetched_at:", l), l;
      if (!o || !o.fetched_at)
        return console.log("âš ï¸ No positions found in database"), [];
      const h = o.fetched_at;
      console.log("ðŸ“… Latest fetched_at:", h);
      let u = e.schema("hf").from("positions").select("*").eq("fetched_at", h).in("asset_class", ["STK", "OPT", "FUND"]);
      a.length > 0 && (u = u.in("internal_account_id", a));
      const { data: d, error: c } = await u;
      if (c)
        throw console.error("âŒ Error fetching positions:", c), c;
      if (!d || d.length === 0)
        return console.log("ðŸ“Š No positions found matching criteria"), [];
      console.log(`âœ… Fetched ${d.length} position(s) from database`);
      const f = d.filter(
        (C) => wb(C.symbol, C.asset_class)
      );
      if (console.log(`ðŸ”½ Filtered to ${f.length} position(s) (STK + FUND + PUT options)`), f.length === 0)
        return console.log("âš ï¸ No positions after filtering"), [];
      const p = /* @__PURE__ */ new Map();
      f.forEach((C) => {
        const S = yb(C.symbol, C.asset_class);
        if (!S) return;
        const R = Math.abs(C.accounting_quantity ?? C.qty ?? 0);
        p.has(S) || p.set(S, {
          totalQuantity: 0,
          positions: []
        });
        const D = p.get(S);
        D.totalQuantity += R, D.positions.push(C);
      }), console.log(`ðŸ“¦ Grouped into ${p.size} unique symbol(s)`);
      const [m, g] = await Promise.all([
        e.schema("hf").from("user_accounts_master").select("internal_account_id, legal_entity"),
        r ? e.schema("hf").from("user_account_alias").select("internal_account_id, alias").eq("user_id", r) : { data: [], error: null }
      ]);
      m.error && console.error("âš ï¸ Error fetching accounts:", m.error);
      const v = new Map(
        (g.data || []).map((C) => [C.internal_account_id, C.alias])
      ), b = new Map(
        (m.data || []).map((C) => [C.internal_account_id, C.legal_entity])
      );
      console.log(`ðŸ“‹ Fetched ${b.size} account(s), ${v.size} alias(es)`), p.forEach((C) => {
        C.positions = C.positions.map((S) => {
          let R = S.internal_account_id;
          if (v.has(S.internal_account_id))
            R = v.get(S.internal_account_id);
          else if (b.has(S.internal_account_id)) {
            const D = b.get(S.internal_account_id);
            D && (R = D);
          }
          return {
            ...S,
            account_display_name: R
          };
        });
      });
      const y = Array.from(p.keys());
      if (y.length === 0)
        return console.log("âš ï¸ No unique symbols found"), [];
      console.log("ðŸ’° Fetching market prices for symbols:", y);
      const { data: w, error: _ } = await e.schema("hf").from("market_price").select("symbol, market_price").in("symbol", y).order("id", { ascending: !1 });
      _ && console.warn("âš ï¸ Error fetching market prices:", _);
      const E = /* @__PURE__ */ new Map();
      w && w.forEach((C) => {
        E.has(C.symbol) || E.set(C.symbol, C.market_price);
      }), console.log(`ðŸ“Š Fetched prices for ${E.size} symbol(s)`);
      const x = [];
      p.forEach((C, S) => {
        const R = E.get(S) ?? null, D = R ? C.totalQuantity * R : 0;
        x.push({
          symbolRoot: S,
          totalQuantity: C.totalQuantity,
          currentMarketPrice: R,
          capitalInvested: D,
          positionCount: C.positions.length,
          positions: C.positions
        });
      }), x.sort((C, S) => S.capitalInvested - C.capitalInvested);
      const T = x.slice(0, 20);
      return console.log("âœ… Top 20 positions by capital invested:", {
        totalGroups: x.length,
        top20Count: T.length,
        top20Symbols: T.map((C) => `${C.symbolRoot}: $${C.capitalInvested.toFixed(2)}`)
      }), T;
    },
    enabled: !0,
    // Always enabled
    staleTime: 6e4,
    // 1 minute cache
    retry: 2
    // Retry failed queries up to 2 times
  }), s = e.channel("top20-capital-deployed").on(
    "postgres_changes",
    {
      schema: "hf",
      table: "positions",
      event: "*"
    },
    () => {
      console.log("ðŸ”„ Positions table changed, invalidating top 20 capital query"), t.invalidateQueries({ queryKey: i });
    }
  ).subscribe();
  return {
    ...n,
    _cleanup: () => {
      var a;
      console.log("ðŸ§¹ Cleaning up top 20 capital subscription"), (a = s == null ? void 0 : s.unsubscribe) == null || a.call(s);
    }
  };
}
class ke {
  constructor(e) {
    this.table = e;
  }
  //////////////////////////////////////////
  /////////////// DataLoad /////////////////
  //////////////////////////////////////////
  reloadData(e, t, i) {
    return this.table.dataLoader.load(e, void 0, void 0, void 0, t, i);
  }
  //////////////////////////////////////////
  ///////////// Localization ///////////////
  //////////////////////////////////////////
  langText() {
    return this.table.modules.localize.getText(...arguments);
  }
  langBind() {
    return this.table.modules.localize.bind(...arguments);
  }
  langLocale() {
    return this.table.modules.localize.getLocale(...arguments);
  }
  //////////////////////////////////////////
  ////////// Inter Table Comms /////////////
  //////////////////////////////////////////
  commsConnections() {
    return this.table.modules.comms.getConnections(...arguments);
  }
  commsSend() {
    return this.table.modules.comms.send(...arguments);
  }
  //////////////////////////////////////////
  //////////////// Layout  /////////////////
  //////////////////////////////////////////
  layoutMode() {
    return this.table.modules.layout.getMode();
  }
  layoutRefresh(e) {
    return this.table.modules.layout.layout(e);
  }
  //////////////////////////////////////////
  /////////////// Event Bus ////////////////
  //////////////////////////////////////////
  subscribe() {
    return this.table.eventBus.subscribe(...arguments);
  }
  unsubscribe() {
    return this.table.eventBus.unsubscribe(...arguments);
  }
  subscribed(e) {
    return this.table.eventBus.subscribed(e);
  }
  subscriptionChange() {
    return this.table.eventBus.subscriptionChange(...arguments);
  }
  dispatch() {
    return this.table.eventBus.dispatch(...arguments);
  }
  chain() {
    return this.table.eventBus.chain(...arguments);
  }
  confirm() {
    return this.table.eventBus.confirm(...arguments);
  }
  dispatchExternal() {
    return this.table.externalEvents.dispatch(...arguments);
  }
  subscribedExternal(e) {
    return this.table.externalEvents.subscribed(e);
  }
  subscriptionChangeExternal() {
    return this.table.externalEvents.subscriptionChange(...arguments);
  }
  //////////////////////////////////////////
  //////////////// Options /////////////////
  //////////////////////////////////////////
  options(e) {
    return this.table.options[e];
  }
  setOption(e, t) {
    return typeof t < "u" && (this.table.options[e] = t), this.table.options[e];
  }
  //////////////////////////////////////////
  /////////// Deprecation Checks ///////////
  //////////////////////////////////////////
  deprecationCheck(e, t, i) {
    return this.table.deprecationAdvisor.check(e, t, i);
  }
  deprecationCheckMsg(e, t) {
    return this.table.deprecationAdvisor.checkMsg(e, t);
  }
  deprecationMsg(e) {
    return this.table.deprecationAdvisor.msg(e);
  }
  //////////////////////////////////////////
  //////////////// Modules /////////////////
  //////////////////////////////////////////
  module(e) {
    return this.table.module(e);
  }
}
class de {
  static elVisible(e) {
    return !(e.offsetWidth <= 0 && e.offsetHeight <= 0);
  }
  static elOffset(e) {
    var t = e.getBoundingClientRect();
    return {
      top: t.top + window.pageYOffset - document.documentElement.clientTop,
      left: t.left + window.pageXOffset - document.documentElement.clientLeft
    };
  }
  static retrieveNestedData(e, t, i) {
    var n = e ? t.split(e) : [t], s = n.length, a;
    for (let o = 0; o < s && (i = i[n[o]], a = i, !!i); o++)
      ;
    return a;
  }
  static deepClone(e, t, i = []) {
    var n = {}.__proto__, s = [].__proto__;
    t || (t = Object.assign(Array.isArray(e) ? [] : {}, e));
    for (var a in e) {
      let o = e[a], l, h;
      o != null && typeof o == "object" && (o.__proto__ === n || o.__proto__ === s) && (l = i.findIndex((u) => u.subject === o), l > -1 ? t[a] = i[l].copy : (h = Object.assign(Array.isArray(o) ? [] : {}, o), i.unshift({ subject: o, copy: h }), t[a] = this.deepClone(o, h, i)));
    }
    return t;
  }
}
let _b = class Mp extends ke {
  constructor(e, t, i) {
    super(e), this.element = t, this.container = this._lookupContainer(), this.parent = i, this.reversedX = !1, this.childPopup = null, this.blurable = !1, this.blurCallback = null, this.blurEventsBound = !1, this.renderedCallback = null, this.visible = !1, this.hideable = !0, this.element.classList.add("tabulator-popup-container"), this.blurEvent = this.hide.bind(this, !1), this.escEvent = this._escapeCheck.bind(this), this.destroyBinding = this.tableDestroyed.bind(this), this.destroyed = !1;
  }
  tableDestroyed() {
    this.destroyed = !0, this.hide(!0);
  }
  _lookupContainer() {
    var e = this.table.options.popupContainer;
    return typeof e == "string" ? (e = document.querySelector(e), e || console.warn("Menu Error - no container element found matching selector:", this.table.options.popupContainer, "(defaulting to document body)")) : e === !0 && (e = this.table.element), e && !this._checkContainerIsParent(e) && (e = !1, console.warn("Menu Error - container element does not contain this table:", this.table.options.popupContainer, "(defaulting to document body)")), e || (e = document.body), e;
  }
  _checkContainerIsParent(e, t = this.table.element) {
    return e === t ? !0 : t.parentNode ? this._checkContainerIsParent(e, t.parentNode) : !1;
  }
  renderCallback(e) {
    this.renderedCallback = e;
  }
  containerEventCoords(e) {
    var t = !(e instanceof MouseEvent), i = t ? e.touches[0].pageX : e.pageX, n = t ? e.touches[0].pageY : e.pageY;
    if (this.container !== document.body) {
      let s = de.elOffset(this.container);
      i -= s.left, n -= s.top;
    }
    return { x: i, y: n };
  }
  elementPositionCoords(e, t = "right") {
    var i = de.elOffset(e), n, s, a;
    switch (this.container !== document.body && (n = de.elOffset(this.container), i.left -= n.left, i.top -= n.top), t) {
      case "right":
        s = i.left + e.offsetWidth, a = i.top - 1;
        break;
      case "bottom":
        s = i.left, a = i.top + e.offsetHeight;
        break;
      case "left":
        s = i.left, a = i.top - 1;
        break;
      case "top":
        s = i.left, a = i.top;
        break;
      case "center":
        s = i.left + e.offsetWidth / 2, a = i.top + e.offsetHeight / 2;
        break;
    }
    return { x: s, y: a, offset: i };
  }
  show(e, t) {
    var i, n, s, a, o;
    return this.destroyed || this.table.destroyed ? this : (e instanceof HTMLElement ? (s = e, o = this.elementPositionCoords(e, t), a = o.offset, i = o.x, n = o.y) : typeof e == "number" ? (a = { top: 0, left: 0 }, i = e, n = t) : (o = this.containerEventCoords(e), i = o.x, n = o.y, this.reversedX = !1), this.element.style.top = n + "px", this.element.style.left = i + "px", this.container.appendChild(this.element), typeof this.renderedCallback == "function" && this.renderedCallback(), this._fitToScreen(i, n, s, a, t), this.visible = !0, this.subscribe("table-destroy", this.destroyBinding), this.element.addEventListener("mousedown", (l) => {
      l.stopPropagation();
    }), this);
  }
  _fitToScreen(e, t, i, n, s) {
    var a = this.container === document.body ? document.documentElement.scrollTop : this.container.scrollTop;
    (e + this.element.offsetWidth >= this.container.offsetWidth || this.reversedX) && (this.element.style.left = "", i ? this.element.style.right = this.container.offsetWidth - n.left + "px" : this.element.style.right = this.container.offsetWidth - e + "px", this.reversedX = !0);
    let o = Math.max(this.container.offsetHeight, a ? this.container.scrollHeight : 0);
    if (t + this.element.offsetHeight > o)
      if (i)
        switch (s) {
          case "bottom":
            this.element.style.top = parseInt(this.element.style.top) - this.element.offsetHeight - i.offsetHeight - 1 + "px";
            break;
          default:
            this.element.style.top = parseInt(this.element.style.top) - this.element.offsetHeight + i.offsetHeight + 1 + "px";
        }
      else
        this.element.style.height = o + "px";
  }
  isVisible() {
    return this.visible;
  }
  hideOnBlur(e) {
    return this.blurable = !0, this.visible && (setTimeout(() => {
      this.visible && (this.table.rowManager.element.addEventListener("scroll", this.blurEvent), this.subscribe("cell-editing", this.blurEvent), document.body.addEventListener("click", this.blurEvent), document.body.addEventListener("contextmenu", this.blurEvent), document.body.addEventListener("mousedown", this.blurEvent), window.addEventListener("resize", this.blurEvent), document.body.addEventListener("keydown", this.escEvent), this.blurEventsBound = !0);
    }, 100), this.blurCallback = e), this;
  }
  _escapeCheck(e) {
    e.keyCode == 27 && this.hide();
  }
  blockHide() {
    this.hideable = !1;
  }
  restoreHide() {
    this.hideable = !0;
  }
  hide(e = !1) {
    return this.visible && this.hideable && (this.blurable && this.blurEventsBound && (document.body.removeEventListener("keydown", this.escEvent), document.body.removeEventListener("click", this.blurEvent), document.body.removeEventListener("contextmenu", this.blurEvent), document.body.removeEventListener("mousedown", this.blurEvent), window.removeEventListener("resize", this.blurEvent), this.table.rowManager.element.removeEventListener("scroll", this.blurEvent), this.unsubscribe("cell-editing", this.blurEvent), this.blurEventsBound = !1), this.childPopup && this.childPopup.hide(), this.parent && (this.parent.childPopup = null), this.element.parentNode && this.element.parentNode.removeChild(this.element), this.visible = !1, this.blurCallback && !e && this.blurCallback(), this.unsubscribe("table-destroy", this.destroyBinding)), this;
  }
  child(e) {
    return this.childPopup && this.childPopup.hide(), this.childPopup = new Mp(this.table, e, this), this.childPopup;
  }
};
class U extends ke {
  constructor(e, t) {
    super(e), this._handler = null;
  }
  initialize() {
  }
  ///////////////////////////////////
  ////// Options Registration ///////
  ///////////////////////////////////
  registerTableOption(e, t) {
    this.table.optionsList.register(e, t);
  }
  registerColumnOption(e, t) {
    this.table.columnManager.optionsList.register(e, t);
  }
  ///////////////////////////////////
  /// Public Function Registration ///
  ///////////////////////////////////
  registerTableFunction(e, t) {
    typeof this.table[e] > "u" ? this.table[e] = (...i) => (this.table.initGuard(e), t(...i)) : console.warn("Unable to bind table function, name already in use", e);
  }
  registerComponentFunction(e, t, i) {
    return this.table.componentFunctionBinder.bind(e, t, i);
  }
  ///////////////////////////////////
  ////////// Data Pipeline //////////
  ///////////////////////////////////
  registerDataHandler(e, t) {
    this.table.rowManager.registerDataPipelineHandler(e, t), this._handler = e;
  }
  registerDisplayHandler(e, t) {
    this.table.rowManager.registerDisplayPipelineHandler(e, t), this._handler = e;
  }
  displayRows(e) {
    var t = this.table.rowManager.displayRows.length - 1, i;
    if (this._handler && (i = this.table.rowManager.displayPipeline.findIndex((n) => n.handler === this._handler), i > -1 && (t = i)), e && (t = t + e), this._handler)
      return t > -1 ? this.table.rowManager.getDisplayRows(t) : this.activeRows();
  }
  activeRows() {
    return this.table.rowManager.activeRows;
  }
  refreshData(e, t) {
    t || (t = this._handler), t && this.table.rowManager.refreshActiveData(t, !1, e);
  }
  ///////////////////////////////////
  //////// Footer Management ////////
  ///////////////////////////////////
  footerAppend(e) {
    return this.table.footerManager.append(e);
  }
  footerPrepend(e) {
    return this.table.footerManager.prepend(e);
  }
  footerRemove(e) {
    return this.table.footerManager.remove(e);
  }
  ///////////////////////////////////
  //////// Popups Management ////////
  ///////////////////////////////////
  popup(e, t) {
    return new _b(this.table, e, t);
  }
  ///////////////////////////////////
  //////// Alert Management ////////
  ///////////////////////////////////
  alert(e, t) {
    return this.table.alertManager.alert(e, t);
  }
  clearAlert() {
    return this.table.alertManager.clear();
  }
}
var Eb = {
  rownum: function(r, e, t, i, n, s) {
    return s.getPosition();
  }
};
const Fr = class Fr extends U {
  constructor(e) {
    super(e), this.allowedTypes = ["", "data", "download", "clipboard", "print", "htmlOutput"], this.registerColumnOption("accessor"), this.registerColumnOption("accessorParams"), this.registerColumnOption("accessorData"), this.registerColumnOption("accessorDataParams"), this.registerColumnOption("accessorDownload"), this.registerColumnOption("accessorDownloadParams"), this.registerColumnOption("accessorClipboard"), this.registerColumnOption("accessorClipboardParams"), this.registerColumnOption("accessorPrint"), this.registerColumnOption("accessorPrintParams"), this.registerColumnOption("accessorHtmlOutput"), this.registerColumnOption("accessorHtmlOutputParams");
  }
  initialize() {
    this.subscribe("column-layout", this.initializeColumn.bind(this)), this.subscribe("row-data-retrieve", this.transformRow.bind(this));
  }
  //initialize column accessor
  initializeColumn(e) {
    var t = !1, i = {};
    this.allowedTypes.forEach((n) => {
      var s = "accessor" + (n.charAt(0).toUpperCase() + n.slice(1)), a;
      e.definition[s] && (a = this.lookupAccessor(e.definition[s]), a && (t = !0, i[s] = {
        accessor: a,
        params: e.definition[s + "Params"] || {}
      }));
    }), t && (e.modules.accessor = i);
  }
  lookupAccessor(e) {
    var t = !1;
    switch (typeof e) {
      case "string":
        Fr.accessors[e] ? t = Fr.accessors[e] : console.warn("Accessor Error - No such accessor found, ignoring: ", e);
        break;
      case "function":
        t = e;
        break;
    }
    return t;
  }
  //apply accessor to row
  transformRow(e, t) {
    var i = "accessor" + (t.charAt(0).toUpperCase() + t.slice(1)), n = e.getComponent(), s = de.deepClone(e.data || {});
    return this.table.columnManager.traverse(function(a) {
      var o, l, h, u;
      a.modules.accessor && (l = a.modules.accessor[i] || a.modules.accessor.accessor || !1, l && (o = a.getFieldValue(s), o != "undefined" && (u = a.getComponent(), h = typeof l.params == "function" ? l.params(o, s, t, u, n) : l.params, a.setFieldValue(s, l.accessor(o, s, t, h, u, n)))));
    }), s;
  }
};
A(Fr, "moduleName", "accessor"), //load defaults
A(Fr, "accessors", Eb);
let zl = Fr;
var Tb = {
  method: "GET"
};
function Fl(r, e) {
  var t = [];
  if (e = e || "", Array.isArray(r))
    r.forEach((n, s) => {
      t = t.concat(Fl(n, e ? e + "[" + s + "]" : s));
    });
  else if (typeof r == "object")
    for (var i in r)
      t = t.concat(Fl(r[i], e ? e + "[" + i + "]" : i));
  else
    t.push({ key: e, value: r });
  return t;
}
function xb(r) {
  var e = Fl(r), t = [];
  return e.forEach(function(i) {
    t.push(encodeURIComponent(i.key) + "=" + encodeURIComponent(i.value));
  }), t.join("&");
}
function Dp(r, e, t) {
  return r && t && Object.keys(t).length && (!e.method || e.method.toLowerCase() == "get") && (e.method = "get", r += (r.includes("?") ? "&" : "?") + xb(t)), r;
}
function Sb(r, e, t) {
  var i;
  return new Promise((n, s) => {
    if (r = this.urlGenerator.call(this.table, r, e, t), e.method.toUpperCase() != "GET")
      if (i = typeof this.table.options.ajaxContentType == "object" ? this.table.options.ajaxContentType : this.contentTypeFormatters[this.table.options.ajaxContentType], i) {
        for (var a in i.headers)
          e.headers || (e.headers = {}), typeof e.headers[a] > "u" && (e.headers[a] = i.headers[a]);
        e.body = i.body.call(this, r, e, t);
      } else
        console.warn("Ajax Error - Invalid ajaxContentType value:", this.table.options.ajaxContentType);
    r ? (typeof e.headers > "u" && (e.headers = {}), typeof e.headers.Accept > "u" && (e.headers.Accept = "application/json"), typeof e.headers["X-Requested-With"] > "u" && (e.headers["X-Requested-With"] = "XMLHttpRequest"), typeof e.mode > "u" && (e.mode = "cors"), e.mode == "cors" ? (typeof e.headers.Origin > "u" && (e.headers.Origin = window.location.origin), typeof e.credentials > "u" && (e.credentials = "same-origin")) : typeof e.credentials > "u" && (e.credentials = "include"), fetch(r, e).then((o) => {
      o.ok ? o.json().then((l) => {
        n(l);
      }).catch((l) => {
        s(l), console.warn("Ajax Load Error - Invalid JSON returned", l);
      }) : (console.error("Ajax Load Error - Connection Error: " + o.status, o.statusText), s(o));
    }).catch((o) => {
      console.error("Ajax Load Error - Connection Error: ", o), s(o);
    })) : (console.warn("Ajax Load Error - No URL Set"), n([]));
  });
}
function Hl(r, e) {
  var t = [];
  if (e = e || "", Array.isArray(r))
    r.forEach((n, s) => {
      t = t.concat(Hl(n, e ? e + "[" + s + "]" : s));
    });
  else if (typeof r == "object")
    for (var i in r)
      t = t.concat(Hl(r[i], e ? e + "[" + i + "]" : i));
  else
    t.push({ key: e, value: r });
  return t;
}
var Rb = {
  json: {
    headers: {
      "Content-Type": "application/json"
    },
    body: function(r, e, t) {
      return JSON.stringify(t);
    }
  },
  form: {
    headers: {},
    body: function(r, e, t) {
      var i = Hl(t), n = new FormData();
      return i.forEach(function(s) {
        n.append(s.key, s.value);
      }), n;
    }
  }
};
const Rt = class Rt extends U {
  constructor(e) {
    super(e), this.config = {}, this.url = "", this.urlGenerator = !1, this.params = !1, this.loaderPromise = !1, this.registerTableOption("ajaxURL", !1), this.registerTableOption("ajaxURLGenerator", !1), this.registerTableOption("ajaxParams", {}), this.registerTableOption("ajaxConfig", "get"), this.registerTableOption("ajaxContentType", "form"), this.registerTableOption("ajaxRequestFunc", !1), this.registerTableOption("ajaxRequesting", function() {
    }), this.registerTableOption("ajaxResponse", !1), this.contentTypeFormatters = Rt.contentTypeFormatters;
  }
  //initialize setup options
  initialize() {
    this.loaderPromise = this.table.options.ajaxRequestFunc || Rt.defaultLoaderPromise, this.urlGenerator = this.table.options.ajaxURLGenerator || Rt.defaultURLGenerator, this.table.options.ajaxURL && this.setUrl(this.table.options.ajaxURL), this.setDefaultConfig(this.table.options.ajaxConfig), this.registerTableFunction("getAjaxUrl", this.getUrl.bind(this)), this.subscribe("data-loading", this.requestDataCheck.bind(this)), this.subscribe("data-params", this.requestParams.bind(this)), this.subscribe("data-load", this.requestData.bind(this));
  }
  requestParams(e, t, i, n) {
    var s = this.table.options.ajaxParams;
    return s && (typeof s == "function" && (s = s.call(this.table)), n = Object.assign(Object.assign({}, s), n)), n;
  }
  requestDataCheck(e, t, i, n) {
    return !!(!e && this.url || typeof e == "string");
  }
  requestData(e, t, i, n, s) {
    var a;
    return !s && this.requestDataCheck(e) ? (e && this.setUrl(e), a = this.generateConfig(i), this.sendRequest(this.url, t, a)) : s;
  }
  setDefaultConfig(e = {}) {
    this.config = Object.assign({}, Rt.defaultConfig), typeof e == "string" ? this.config.method = e : Object.assign(this.config, e);
  }
  //load config object
  generateConfig(e = {}) {
    var t = Object.assign({}, this.config);
    return typeof e == "string" ? t.method = e : Object.assign(t, e), t;
  }
  //set request url
  setUrl(e) {
    this.url = e;
  }
  //get request url
  getUrl() {
    return this.url;
  }
  //send ajax request
  sendRequest(e, t, i) {
    return this.table.options.ajaxRequesting.call(this.table, e, t) !== !1 ? this.loaderPromise(e, i, t).then((n) => (this.table.options.ajaxResponse && (n = this.table.options.ajaxResponse.call(this.table, e, t, n)), n)) : Promise.reject();
  }
};
A(Rt, "moduleName", "ajax"), //load defaults
A(Rt, "defaultConfig", Tb), A(Rt, "defaultURLGenerator", Dp), A(Rt, "defaultLoaderPromise", Sb), A(Rt, "contentTypeFormatters", Rb);
let Nl = Rt;
var Mb = {
  replace: function(r) {
    return this.table.setData(r);
  },
  update: function(r) {
    return this.table.updateOrAddData(r);
  },
  insert: function(r) {
    return this.table.addData(r);
  }
}, Db = {
  table: function(r) {
    var e = [], t = !0, i = this.table.columnManager.columns, n = [], s = [];
    return r = r.split(`
`), r.forEach(function(a) {
      e.push(a.split("	"));
    }), e.length && !(e.length === 1 && e[0].length < 2) ? (e[0].forEach(function(a) {
      var o = i.find(function(l) {
        return a && l.definition.title && a.trim() && l.definition.title.trim() === a.trim();
      });
      o ? n.push(o) : t = !1;
    }), t || (t = !0, n = [], e[0].forEach(function(a) {
      var o = i.find(function(l) {
        return a && l.field && a.trim() && l.field.trim() === a.trim();
      });
      o ? n.push(o) : t = !1;
    }), t || (n = this.table.columnManager.columnsByIndex)), t && e.shift(), e.forEach(function(a) {
      var o = {};
      a.forEach(function(l, h) {
        n[h] && (o[n[h].field] = l);
      }), s.push(o);
    }), s) : !1;
  }
}, Lb = {
  copyToClipboard: ["ctrl + 67", "meta + 67"]
}, kb = {
  copyToClipboard: function(r) {
    this.table.modules.edit.currentCell || this.table.modExists("clipboard", !0) && this.table.modules.clipboard.copy(!1, !0);
  }
}, Ab = {
  keybindings: {
    bindings: Lb,
    actions: kb
  }
};
const fi = class fi extends U {
  constructor(e) {
    super(e), this.mode = !0, this.pasteParser = function() {
    }, this.pasteAction = function() {
    }, this.customSelection = !1, this.rowRange = !1, this.blocked = !0, this.registerTableOption("clipboard", !1), this.registerTableOption("clipboardCopyStyled", !0), this.registerTableOption("clipboardCopyConfig", !1), this.registerTableOption("clipboardCopyFormatter", !1), this.registerTableOption("clipboardCopyRowRange", "active"), this.registerTableOption("clipboardPasteParser", "table"), this.registerTableOption("clipboardPasteAction", "insert"), this.registerColumnOption("clipboard"), this.registerColumnOption("titleClipboard");
  }
  initialize() {
    this.mode = this.table.options.clipboard, this.rowRange = this.table.options.clipboardCopyRowRange, (this.mode === !0 || this.mode === "copy") && this.table.element.addEventListener("copy", (e) => {
      var t, i, n;
      this.blocked || (e.preventDefault(), this.customSelection ? (t = this.customSelection, this.table.options.clipboardCopyFormatter && (t = this.table.options.clipboardCopyFormatter("plain", t))) : (n = this.table.modules.export.generateExportList(this.table.options.clipboardCopyConfig, this.table.options.clipboardCopyStyled, this.rowRange, "clipboard"), i = this.table.modules.export.generateHTMLTable(n), t = i ? this.generatePlainContent(n) : "", this.table.options.clipboardCopyFormatter && (t = this.table.options.clipboardCopyFormatter("plain", t), i = this.table.options.clipboardCopyFormatter("html", i))), window.clipboardData && window.clipboardData.setData ? window.clipboardData.setData("Text", t) : e.clipboardData && e.clipboardData.setData ? (e.clipboardData.setData("text/plain", t), i && e.clipboardData.setData("text/html", i)) : e.originalEvent && e.originalEvent.clipboardData.setData && (e.originalEvent.clipboardData.setData("text/plain", t), i && e.originalEvent.clipboardData.setData("text/html", i)), this.dispatchExternal("clipboardCopied", t, i), this.reset());
    }), (this.mode === !0 || this.mode === "paste") && this.table.element.addEventListener("paste", (e) => {
      this.paste(e);
    }), this.setPasteParser(this.table.options.clipboardPasteParser), this.setPasteAction(this.table.options.clipboardPasteAction), this.registerTableFunction("copyToClipboard", this.copy.bind(this));
  }
  reset() {
    this.blocked = !0, this.customSelection = !1;
  }
  generatePlainContent(e) {
    var t = [];
    return e.forEach((i) => {
      var n = [];
      i.columns.forEach((s) => {
        var a = "";
        if (s)
          if (i.type === "group" && (s.value = s.component.getKey()), s.value === null)
            a = "";
          else
            switch (typeof s.value) {
              case "object":
                a = JSON.stringify(s.value);
                break;
              case "undefined":
                a = "";
                break;
              default:
                a = s.value;
            }
        n.push(a);
      }), t.push(n.join("	"));
    }), t.join(`
`);
  }
  copy(e, t) {
    var i, n;
    this.blocked = !1, this.customSelection = !1, (this.mode === !0 || this.mode === "copy") && (this.rowRange = e || this.table.options.clipboardCopyRowRange, typeof window.getSelection < "u" && typeof document.createRange < "u" ? (e = document.createRange(), e.selectNodeContents(this.table.element), i = window.getSelection(), i.toString() && t && (this.customSelection = i.toString()), i.removeAllRanges(), i.addRange(e)) : typeof document.selection < "u" && typeof document.body.createTextRange < "u" && (n = document.body.createTextRange(), n.moveToElementText(this.table.element), n.select()), document.execCommand("copy"), i && i.removeAllRanges());
  }
  //PASTE EVENT HANDLING
  setPasteAction(e) {
    switch (typeof e) {
      case "string":
        this.pasteAction = fi.pasteActions[e], this.pasteAction || console.warn("Clipboard Error - No such paste action found:", e);
        break;
      case "function":
        this.pasteAction = e;
        break;
    }
  }
  setPasteParser(e) {
    switch (typeof e) {
      case "string":
        this.pasteParser = fi.pasteParsers[e], this.pasteParser || console.warn("Clipboard Error - No such paste parser found:", e);
        break;
      case "function":
        this.pasteParser = e;
        break;
    }
  }
  paste(e) {
    var t, i, n;
    this.checkPasteOrigin(e) && (t = this.getPasteData(e), i = this.pasteParser.call(this, t), i ? (e.preventDefault(), this.table.modExists("mutator") && (i = this.mutateData(i)), n = this.pasteAction.call(this, i), this.dispatchExternal("clipboardPasted", t, i, n)) : this.dispatchExternal("clipboardPasteError", t));
  }
  mutateData(e) {
    var t = [];
    return Array.isArray(e) ? e.forEach((i) => {
      t.push(this.table.modules.mutator.transformRow(i, "clipboard"));
    }) : t = e, t;
  }
  checkPasteOrigin(e) {
    var t = !0, i = this.confirm("clipboard-paste", [e]);
    return (i || !["DIV", "SPAN"].includes(e.target.tagName)) && (t = !1), t;
  }
  getPasteData(e) {
    var t;
    return window.clipboardData && window.clipboardData.getData ? t = window.clipboardData.getData("Text") : e.clipboardData && e.clipboardData.getData ? t = e.clipboardData.getData("text/plain") : e.originalEvent && e.originalEvent.clipboardData.getData && (t = e.originalEvent.clipboardData.getData("text/plain")), t;
  }
};
A(fi, "moduleName", "clipboard"), A(fi, "moduleExtensions", Ab), //load defaults
A(fi, "pasteActions", Mb), A(fi, "pasteParsers", Db);
let Bl = fi;
class Pb {
  constructor(e) {
    return this._row = e, new Proxy(this, {
      get: function(t, i, n) {
        return typeof t[i] < "u" ? t[i] : t._row.table.componentFunctionBinder.handle("row", t._row, i);
      }
    });
  }
  getData(e) {
    return this._row.getData(e);
  }
  getElement() {
    return this._row.getElement();
  }
  getTable() {
    return this._row.table;
  }
  getCells() {
    var e = [];
    return this._row.getCells().forEach(function(t) {
      e.push(t.getComponent());
    }), e;
  }
  getCell(e) {
    var t = this._row.getCell(e);
    return t ? t.getComponent() : !1;
  }
  _getSelf() {
    return this._row;
  }
}
class Lp {
  constructor(e) {
    return this._cell = e, new Proxy(this, {
      get: function(t, i, n) {
        return typeof t[i] < "u" ? t[i] : t._cell.table.componentFunctionBinder.handle("cell", t._cell, i);
      }
    });
  }
  getValue() {
    return this._cell.getValue();
  }
  getOldValue() {
    return this._cell.getOldValue();
  }
  getInitialValue() {
    return this._cell.initialValue;
  }
  getElement() {
    return this._cell.getElement();
  }
  getRow() {
    return this._cell.row.getComponent();
  }
  getData(e) {
    return this._cell.row.getData(e);
  }
  getType() {
    return "cell";
  }
  getField() {
    return this._cell.column.getField();
  }
  getColumn() {
    return this._cell.column.getComponent();
  }
  setValue(e, t) {
    typeof t > "u" && (t = !0), this._cell.setValue(e, t);
  }
  restoreOldValue() {
    this._cell.setValueActual(this._cell.getOldValue());
  }
  restoreInitialValue() {
    this._cell.setValueActual(this._cell.initialValue);
  }
  checkHeight() {
    this._cell.checkHeight();
  }
  getTable() {
    return this._cell.table;
  }
  _getSelf() {
    return this._cell;
  }
}
class gs extends ke {
  constructor(e, t) {
    super(e.table), this.table = e.table, this.column = e, this.row = t, this.element = null, this.value = null, this.initialValue, this.oldValue = null, this.modules = {}, this.height = null, this.width = null, this.minWidth = null, this.component = null, this.loaded = !1, this.build();
  }
  //////////////// Setup Functions /////////////////
  //generate element
  build() {
    this.generateElement(), this.setWidth(), this._configureCell(), this.setValueActual(this.column.getFieldValue(this.row.data)), this.initialValue = this.value;
  }
  generateElement() {
    this.element = document.createElement("div"), this.element.className = "tabulator-cell", this.element.setAttribute("role", "gridcell"), this.column.isRowHeader && this.element.classList.add("tabulator-row-header");
  }
  _configureCell() {
    var e = this.element, t = this.column.getField(), i = {
      top: "flex-start",
      bottom: "flex-end",
      middle: "center"
    }, n = {
      left: "flex-start",
      right: "flex-end",
      center: "center"
    };
    if (e.style.textAlign = this.column.hozAlign, this.column.vertAlign && (e.style.display = "inline-flex", e.style.alignItems = i[this.column.vertAlign] || "", this.column.hozAlign && (e.style.justifyContent = n[this.column.hozAlign] || "")), t && e.setAttribute("tabulator-field", t), this.column.definition.cssClass) {
      var s = this.column.definition.cssClass.split(" ");
      s.forEach((a) => {
        e.classList.add(a);
      });
    }
    this.dispatch("cell-init", this), this.column.visible || this.hide();
  }
  //generate cell contents
  _generateContents() {
    var e;
    switch (e = this.chain("cell-format", this, null, () => this.element.innerHTML = this.value), typeof e) {
      case "object":
        if (e instanceof Node) {
          for (; this.element.firstChild; ) this.element.removeChild(this.element.firstChild);
          this.element.appendChild(e);
        } else
          this.element.innerHTML = "", e != null && console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:", e);
        break;
      case "undefined":
        this.element.innerHTML = "";
        break;
      default:
        this.element.innerHTML = e;
    }
  }
  cellRendered() {
    this.dispatch("cell-rendered", this);
  }
  //////////////////// Getters ////////////////////
  getElement(e) {
    return this.loaded || (this.loaded = !0, e || this.layoutElement()), this.element;
  }
  getValue() {
    return this.value;
  }
  getOldValue() {
    return this.oldValue;
  }
  //////////////////// Actions ////////////////////
  setValue(e, t, i) {
    var n = this.setValueProcessData(e, t, i);
    n && (this.dispatch("cell-value-updated", this), this.cellRendered(), this.column.definition.cellEdited && this.column.definition.cellEdited.call(this.table, this.getComponent()), this.dispatchExternal("cellEdited", this.getComponent()), this.subscribedExternal("dataChanged") && this.dispatchExternal("dataChanged", this.table.rowManager.getData()));
  }
  setValueProcessData(e, t, i) {
    var n = !1;
    return (this.value !== e || i) && (n = !0, t && (e = this.chain("cell-value-changing", [this, e], null, e))), this.setValueActual(e), n && this.dispatch("cell-value-changed", this), n;
  }
  setValueActual(e) {
    this.oldValue = this.value, this.value = e, this.dispatch("cell-value-save-before", this), this.column.setFieldValue(this.row.data, e), this.dispatch("cell-value-save-after", this), this.loaded && this.layoutElement();
  }
  layoutElement() {
    this._generateContents(), this.dispatch("cell-layout", this);
  }
  setWidth() {
    this.width = this.column.width, this.element.style.width = this.column.widthStyled;
  }
  clearWidth() {
    this.width = "", this.element.style.width = "";
  }
  getWidth() {
    return this.width || this.element.offsetWidth;
  }
  setMinWidth() {
    this.minWidth = this.column.minWidth, this.element.style.minWidth = this.column.minWidthStyled;
  }
  setMaxWidth() {
    this.maxWidth = this.column.maxWidth, this.element.style.maxWidth = this.column.maxWidthStyled;
  }
  checkHeight() {
    this.row.reinitializeHeight();
  }
  clearHeight() {
    this.element.style.height = "", this.height = null, this.dispatch("cell-height", this, "");
  }
  setHeight() {
    this.height = this.row.height, this.element.style.height = this.row.heightStyled, this.dispatch("cell-height", this, this.row.heightStyled);
  }
  getHeight() {
    return this.height || this.element.offsetHeight;
  }
  show() {
    this.element.style.display = this.column.vertAlign ? "inline-flex" : "";
  }
  hide() {
    this.element.style.display = "none";
  }
  delete() {
    this.dispatch("cell-delete", this), !this.table.rowManager.redrawBlock && this.element.parentNode && this.element.parentNode.removeChild(this.element), this.element = !1, this.column.deleteCell(this), this.row.deleteCell(this), this.calcs = {};
  }
  getIndex() {
    return this.row.getCellIndex(this);
  }
  //////////////// Object Generation /////////////////
  getComponent() {
    return this.component || (this.component = new Lp(this)), this.component;
  }
}
class kp {
  constructor(e) {
    return this._column = e, this.type = "ColumnComponent", new Proxy(this, {
      get: function(t, i, n) {
        return typeof t[i] < "u" ? t[i] : t._column.table.componentFunctionBinder.handle("column", t._column, i);
      }
    });
  }
  getElement() {
    return this._column.getElement();
  }
  getDefinition() {
    return this._column.getDefinition();
  }
  getField() {
    return this._column.getField();
  }
  getTitleDownload() {
    return this._column.getTitleDownload();
  }
  getCells() {
    var e = [];
    return this._column.cells.forEach(function(t) {
      e.push(t.getComponent());
    }), e;
  }
  isVisible() {
    return this._column.visible;
  }
  show() {
    this._column.isGroup ? this._column.columns.forEach(function(e) {
      e.show();
    }) : this._column.show();
  }
  hide() {
    this._column.isGroup ? this._column.columns.forEach(function(e) {
      e.hide();
    }) : this._column.hide();
  }
  toggle() {
    this._column.visible ? this.hide() : this.show();
  }
  delete() {
    return this._column.delete();
  }
  getSubColumns() {
    var e = [];
    return this._column.columns.length && this._column.columns.forEach(function(t) {
      e.push(t.getComponent());
    }), e;
  }
  getParentColumn() {
    return this._column.getParentComponent();
  }
  _getSelf() {
    return this._column;
  }
  scrollTo(e, t) {
    return this._column.table.columnManager.scrollToColumn(this._column, e, t);
  }
  getTable() {
    return this._column.table;
  }
  move(e, t) {
    var i = this._column.table.columnManager.findColumn(e);
    i ? this._column.table.columnManager.moveColumn(this._column, i, t) : console.warn("Move Error - No matching column found:", i);
  }
  getNextColumn() {
    var e = this._column.nextColumn();
    return e ? e.getComponent() : !1;
  }
  getPrevColumn() {
    var e = this._column.prevColumn();
    return e ? e.getComponent() : !1;
  }
  updateDefinition(e) {
    return this._column.updateDefinition(e);
  }
  getWidth() {
    return this._column.getWidth();
  }
  setWidth(e) {
    var t;
    return e === !0 ? t = this._column.reinitializeWidth(!0) : t = this._column.setWidth(e), this._column.table.columnManager.rerenderColumns(!0), t;
  }
}
var Ap = {
  title: void 0,
  field: void 0,
  columns: void 0,
  visible: void 0,
  hozAlign: void 0,
  vertAlign: void 0,
  width: void 0,
  minWidth: 40,
  maxWidth: void 0,
  maxInitialWidth: void 0,
  cssClass: void 0,
  variableHeight: void 0,
  headerVertical: void 0,
  headerHozAlign: void 0,
  headerWordWrap: !1,
  editableTitle: void 0
};
const Zi = class Zi extends ke {
  constructor(e, t, i) {
    super(t.table), this.definition = e, this.parent = t, this.type = "column", this.columns = [], this.cells = [], this.isGroup = !1, this.isRowHeader = i, this.element = this.createElement(), this.contentElement = !1, this.titleHolderElement = !1, this.titleElement = !1, this.groupElement = this.createGroupElement(), this.hozAlign = "", this.vertAlign = "", this.field = "", this.fieldStructure = "", this.getFieldValue = "", this.setFieldValue = "", this.titleDownload = null, this.titleFormatterRendered = !1, this.mapDefinitions(), this.setField(this.definition.field), this.modules = {}, this.width = null, this.widthStyled = "", this.maxWidth = null, this.maxWidthStyled = "", this.maxInitialWidth = null, this.minWidth = null, this.minWidthStyled = "", this.widthFixed = !1, this.visible = !0, this.component = null, this.definition.columns ? (this.isGroup = !0, this.definition.columns.forEach((n, s) => {
      var a = new Zi(n, this);
      this.attachColumn(a);
    }), this.checkColumnVisibility()) : t.registerColumnField(this), this._initialize();
  }
  createElement() {
    var e = document.createElement("div");
    switch (e.classList.add("tabulator-col"), e.setAttribute("role", "columnheader"), e.setAttribute("aria-sort", "none"), this.isRowHeader && e.classList.add("tabulator-row-header"), this.table.options.columnHeaderVertAlign) {
      case "middle":
        e.style.justifyContent = "center";
        break;
      case "bottom":
        e.style.justifyContent = "flex-end";
        break;
    }
    return e;
  }
  createGroupElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-col-group-cols"), e;
  }
  mapDefinitions() {
    var e = this.table.options.columnDefaults;
    if (e)
      for (let t in e)
        typeof this.definition[t] > "u" && (this.definition[t] = e[t]);
    this.definition = this.table.columnManager.optionsList.generate(Zi.defaultOptionList, this.definition);
  }
  checkDefinition() {
    Object.keys(this.definition).forEach((e) => {
      Zi.defaultOptionList.indexOf(e) === -1 && console.warn("Invalid column definition option in '" + (this.field || this.definition.title) + "' column:", e);
    });
  }
  setField(e) {
    this.field = e, this.fieldStructure = e ? this.table.options.nestedFieldSeparator ? e.split(this.table.options.nestedFieldSeparator) : [e] : [], this.getFieldValue = this.fieldStructure.length > 1 ? this._getNestedData : this._getFlatData, this.setFieldValue = this.fieldStructure.length > 1 ? this._setNestedData : this._setFlatData;
  }
  //register column position with column manager
  registerColumnPosition(e) {
    this.parent.registerColumnPosition(e);
  }
  //register column position with column manager
  registerColumnField(e) {
    this.parent.registerColumnField(e);
  }
  //trigger position registration
  reRegisterPosition() {
    this.isGroup ? this.columns.forEach(function(e) {
      e.reRegisterPosition();
    }) : this.registerColumnPosition(this);
  }
  //build header element
  _initialize() {
    for (var e = this.definition; this.element.firstChild; ) this.element.removeChild(this.element.firstChild);
    e.headerVertical && (this.element.classList.add("tabulator-col-vertical"), e.headerVertical === "flip" && this.element.classList.add("tabulator-col-vertical-flip")), this.contentElement = this._buildColumnHeaderContent(), this.element.appendChild(this.contentElement), this.isGroup ? this._buildGroupHeader() : this._buildColumnHeader(), this.dispatch("column-init", this);
  }
  //build header element for header
  _buildColumnHeader() {
    var e = this.definition;
    if (this.dispatch("column-layout", this), typeof e.visible < "u" && (e.visible ? this.show(!0) : this.hide(!0)), e.cssClass) {
      var t = e.cssClass.split(" ");
      t.forEach((i) => {
        this.element.classList.add(i);
      });
    }
    e.field && this.element.setAttribute("tabulator-field", e.field), this.setMinWidth(parseInt(e.minWidth)), e.maxInitialWidth && (this.maxInitialWidth = parseInt(e.maxInitialWidth)), e.maxWidth && this.setMaxWidth(parseInt(e.maxWidth)), this.reinitializeWidth(), this.hozAlign = this.definition.hozAlign, this.vertAlign = this.definition.vertAlign, this.titleElement.style.textAlign = this.definition.headerHozAlign;
  }
  _buildColumnHeaderContent() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-col-content"), this.titleHolderElement = document.createElement("div"), this.titleHolderElement.classList.add("tabulator-col-title-holder"), e.appendChild(this.titleHolderElement), this.titleElement = this._buildColumnHeaderTitle(), this.titleHolderElement.appendChild(this.titleElement), e;
  }
  //build title element of column
  _buildColumnHeaderTitle() {
    var e = this.definition, t = document.createElement("div");
    if (t.classList.add("tabulator-col-title"), e.headerWordWrap && t.classList.add("tabulator-col-title-wrap"), e.editableTitle) {
      var i = document.createElement("input");
      i.classList.add("tabulator-title-editor"), i.addEventListener("click", (n) => {
        n.stopPropagation(), i.focus();
      }), i.addEventListener("mousedown", (n) => {
        n.stopPropagation();
      }), i.addEventListener("change", () => {
        e.title = i.value, this.dispatchExternal("columnTitleChanged", this.getComponent());
      }), t.appendChild(i), e.field ? this.langBind("columns|" + e.field, (n) => {
        i.value = n || e.title || "&nbsp;";
      }) : i.value = e.title || "&nbsp;";
    } else
      e.field ? this.langBind("columns|" + e.field, (n) => {
        this._formatColumnHeaderTitle(t, n || e.title || "&nbsp;");
      }) : this._formatColumnHeaderTitle(t, e.title || "&nbsp;");
    return t;
  }
  _formatColumnHeaderTitle(e, t) {
    var i = this.chain("column-format", [this, t, e], null, () => t);
    switch (typeof i) {
      case "object":
        i instanceof Node ? e.appendChild(i) : (e.innerHTML = "", console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:", i));
        break;
      case "undefined":
        e.innerHTML = "";
        break;
      default:
        e.innerHTML = i;
    }
  }
  //build header element for column group
  _buildGroupHeader() {
    if (this.element.classList.add("tabulator-col-group"), this.element.setAttribute("role", "columngroup"), this.element.setAttribute("aria-title", this.definition.title), this.definition.cssClass) {
      var e = this.definition.cssClass.split(" ");
      e.forEach((t) => {
        this.element.classList.add(t);
      });
    }
    this.titleElement.style.textAlign = this.definition.headerHozAlign, this.element.appendChild(this.groupElement);
  }
  //flat field lookup
  _getFlatData(e) {
    return e[this.field];
  }
  //nested field lookup
  _getNestedData(e) {
    var t = e, i = this.fieldStructure, n = i.length, s;
    for (let a = 0; a < n && (t = t[i[a]], s = t, !!t); a++)
      ;
    return s;
  }
  //flat field set
  _setFlatData(e, t) {
    this.field && (e[this.field] = t);
  }
  //nested field set
  _setNestedData(e, t) {
    var i = e, n = this.fieldStructure, s = n.length;
    for (let a = 0; a < s; a++)
      if (a == s - 1)
        i[n[a]] = t;
      else {
        if (!i[n[a]])
          if (typeof t < "u")
            i[n[a]] = {};
          else
            break;
        i = i[n[a]];
      }
  }
  //attach column to this group
  attachColumn(e) {
    this.groupElement ? (this.columns.push(e), this.groupElement.appendChild(e.getElement()), e.columnRendered()) : console.warn("Column Warning - Column being attached to another column instead of column group");
  }
  //vertically align header in column
  verticalAlign(e, t) {
    var i = this.parent.isGroup ? this.parent.getGroupElement().clientHeight : t || this.parent.getHeadersElement().clientHeight;
    this.element.style.height = i + "px", this.dispatch("column-height", this, this.element.style.height), this.isGroup && (this.groupElement.style.minHeight = i - this.contentElement.offsetHeight + "px"), this.columns.forEach(function(n) {
      n.verticalAlign(e);
    });
  }
  //clear vertical alignment
  clearVerticalAlign() {
    this.element.style.paddingTop = "", this.element.style.height = "", this.element.style.minHeight = "", this.groupElement.style.minHeight = "", this.columns.forEach(function(e) {
      e.clearVerticalAlign();
    }), this.dispatch("column-height", this, "");
  }
  //// Retrieve Column Information ////
  //return column header element
  getElement() {
    return this.element;
  }
  //return column group element
  getGroupElement() {
    return this.groupElement;
  }
  //return field name
  getField() {
    return this.field;
  }
  getTitleDownload() {
    return this.titleDownload;
  }
  //return the first column in a group
  getFirstColumn() {
    return this.isGroup ? this.columns.length ? this.columns[0].getFirstColumn() : !1 : this;
  }
  //return the last column in a group
  getLastColumn() {
    return this.isGroup ? this.columns.length ? this.columns[this.columns.length - 1].getLastColumn() : !1 : this;
  }
  //return all columns in a group
  getColumns(e) {
    var t = [];
    return e ? this.columns.forEach((i) => {
      t.push(i), t = t.concat(i.getColumns(!0));
    }) : t = this.columns, t;
  }
  //return all columns in a group
  getCells() {
    return this.cells;
  }
  //retrieve the top column in a group of columns
  getTopColumn() {
    return this.parent.isGroup ? this.parent.getTopColumn() : this;
  }
  //return column definition object
  getDefinition(e) {
    var t = [];
    return this.isGroup && e && (this.columns.forEach(function(i) {
      t.push(i.getDefinition(!0));
    }), this.definition.columns = t), this.definition;
  }
  //////////////////// Actions ////////////////////
  checkColumnVisibility() {
    var e = !1;
    this.columns.forEach(function(t) {
      t.visible && (e = !0);
    }), e ? (this.show(), this.dispatchExternal("columnVisibilityChanged", this.getComponent(), !1)) : this.hide();
  }
  //show column
  show(e, t) {
    this.visible || (this.visible = !0, this.element.style.display = "", this.parent.isGroup && this.parent.checkColumnVisibility(), this.cells.forEach(function(i) {
      i.show();
    }), !this.isGroup && this.width === null && this.reinitializeWidth(), this.table.columnManager.verticalAlignHeaders(), this.dispatch("column-show", this, t), e || this.dispatchExternal("columnVisibilityChanged", this.getComponent(), !0), this.parent.isGroup && this.parent.matchChildWidths(), this.silent || this.table.columnManager.rerenderColumns());
  }
  //hide column
  hide(e, t) {
    this.visible && (this.visible = !1, this.element.style.display = "none", this.table.columnManager.verticalAlignHeaders(), this.parent.isGroup && this.parent.checkColumnVisibility(), this.cells.forEach(function(i) {
      i.hide();
    }), this.dispatch("column-hide", this, t), e || this.dispatchExternal("columnVisibilityChanged", this.getComponent(), !1), this.parent.isGroup && this.parent.matchChildWidths(), this.silent || this.table.columnManager.rerenderColumns());
  }
  matchChildWidths() {
    var e = 0;
    this.contentElement && this.columns.length && (this.columns.forEach(function(t) {
      t.visible && (e += t.getWidth());
    }), this.contentElement.style.maxWidth = e - 1 + "px", this.table.initialized && (this.element.style.width = e + "px"), this.parent.isGroup && this.parent.matchChildWidths());
  }
  removeChild(e) {
    var t = this.columns.indexOf(e);
    t > -1 && this.columns.splice(t, 1), this.columns.length || this.delete();
  }
  setWidth(e) {
    this.widthFixed = !0, this.setWidthActual(e);
  }
  setWidthActual(e) {
    isNaN(e) && (e = Math.floor(this.table.element.clientWidth / 100 * parseInt(e))), e = Math.max(this.minWidth, e), this.maxWidth && (e = Math.min(this.maxWidth, e)), this.width = e, this.widthStyled = e ? e + "px" : "", this.element.style.width = this.widthStyled, this.isGroup || this.cells.forEach(function(t) {
      t.setWidth();
    }), this.parent.isGroup && this.parent.matchChildWidths(), this.dispatch("column-width", this), this.subscribedExternal("columnWidth") && this.dispatchExternal("columnWidth", this.getComponent());
  }
  checkCellHeights() {
    var e = [];
    this.cells.forEach(function(t) {
      t.row.heightInitialized && (t.row.getElement().offsetParent !== null ? (e.push(t.row), t.row.clearCellHeight()) : t.row.heightInitialized = !1);
    }), e.forEach(function(t) {
      t.calcHeight();
    }), e.forEach(function(t) {
      t.setCellHeight();
    });
  }
  getWidth() {
    var e = 0;
    return this.isGroup ? this.columns.forEach(function(t) {
      t.visible && (e += t.getWidth());
    }) : e = this.width, e;
  }
  getLeftOffset() {
    var e = this.element.offsetLeft;
    return this.parent.isGroup && (e += this.parent.getLeftOffset()), e;
  }
  getHeight() {
    return Math.ceil(this.element.getBoundingClientRect().height);
  }
  setMinWidth(e) {
    this.maxWidth && e > this.maxWidth && (e = this.maxWidth, console.warn("the minWidth (" + e + "px) for column '" + this.field + "' cannot be bigger that its maxWidth (" + this.maxWidthStyled + ")")), this.minWidth = e, this.minWidthStyled = e ? e + "px" : "", this.element.style.minWidth = this.minWidthStyled, this.cells.forEach(function(t) {
      t.setMinWidth();
    });
  }
  setMaxWidth(e) {
    this.minWidth && e < this.minWidth && (e = this.minWidth, console.warn("the maxWidth (" + e + "px) for column '" + this.field + "' cannot be smaller that its minWidth (" + this.minWidthStyled + ")")), this.maxWidth = e, this.maxWidthStyled = e ? e + "px" : "", this.element.style.maxWidth = this.maxWidthStyled, this.cells.forEach(function(t) {
      t.setMaxWidth();
    });
  }
  delete() {
    return new Promise((e, t) => {
      this.isGroup && this.columns.forEach(function(n) {
        n.delete();
      }), this.dispatch("column-delete", this);
      var i = this.cells.length;
      for (let n = 0; n < i; n++)
        this.cells[0].delete();
      this.element.parentNode && this.element.parentNode.removeChild(this.element), this.element = !1, this.contentElement = !1, this.titleElement = !1, this.groupElement = !1, this.parent.isGroup && this.parent.removeChild(this), this.table.columnManager.deregisterColumn(this), this.table.columnManager.rerenderColumns(!0), this.dispatch("column-deleted", this), e();
    });
  }
  columnRendered() {
    this.titleFormatterRendered && this.titleFormatterRendered(), this.dispatch("column-rendered", this);
  }
  //////////////// Cell Management /////////////////
  //generate cell for this column
  generateCell(e) {
    var t = new gs(this, e);
    return this.cells.push(t), t;
  }
  nextColumn() {
    var e = this.table.columnManager.findColumnIndex(this);
    return e > -1 ? this._nextVisibleColumn(e + 1) : !1;
  }
  _nextVisibleColumn(e) {
    var t = this.table.columnManager.getColumnByIndex(e);
    return !t || t.visible ? t : this._nextVisibleColumn(e + 1);
  }
  prevColumn() {
    var e = this.table.columnManager.findColumnIndex(this);
    return e > -1 ? this._prevVisibleColumn(e - 1) : !1;
  }
  _prevVisibleColumn(e) {
    var t = this.table.columnManager.getColumnByIndex(e);
    return !t || t.visible ? t : this._prevVisibleColumn(e - 1);
  }
  reinitializeWidth(e) {
    this.widthFixed = !1, typeof this.definition.width < "u" && !e && this.setWidth(this.definition.width), this.dispatch("column-width-fit-before", this), this.fitToData(e), this.dispatch("column-width-fit-after", this);
  }
  //set column width to maximum cell width for non group columns
  fitToData(e) {
    if (!this.isGroup) {
      this.widthFixed || (this.element.style.width = "", this.cells.forEach((n) => {
        n.clearWidth();
      }));
      var t = this.element.offsetWidth;
      if ((!this.width || !this.widthFixed) && (this.cells.forEach((n) => {
        var s = n.getWidth();
        s > t && (t = s);
      }), t)) {
        var i = t + 1;
        e ? this.setWidth(i) : (this.maxInitialWidth && !e && (i = Math.min(i, this.maxInitialWidth)), this.setWidthActual(i));
      }
    }
  }
  updateDefinition(e) {
    var t;
    return this.isGroup || this.parent.isGroup ? (console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"), Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")) : (t = Object.assign({}, this.getDefinition()), t = Object.assign(t, e), this.table.columnManager.addColumn(t, !1, this).then((i) => (t.field == this.field && (this.field = !1), this.delete().then(() => i.getComponent()))));
  }
  deleteCell(e) {
    var t = this.cells.indexOf(e);
    t > -1 && this.cells.splice(t, 1);
  }
  //////////////// Object Generation /////////////////
  getComponent() {
    return this.component || (this.component = new kp(this)), this.component;
  }
  getPosition() {
    return this.table.columnManager.getVisibleColumnsByIndex().indexOf(this) + 1;
  }
  getParentComponent() {
    return this.parent instanceof Zi ? this.parent.getComponent() : !1;
  }
};
A(Zi, "defaultOptionList", Ap);
let rr = Zi;
class Ya {
  constructor(e) {
    return this._row = e, new Proxy(this, {
      get: function(t, i, n) {
        return typeof t[i] < "u" ? t[i] : t._row.table.componentFunctionBinder.handle("row", t._row, i);
      }
    });
  }
  getData(e) {
    return this._row.getData(e);
  }
  getElement() {
    return this._row.getElement();
  }
  getCells() {
    var e = [];
    return this._row.getCells().forEach(function(t) {
      e.push(t.getComponent());
    }), e;
  }
  getCell(e) {
    var t = this._row.getCell(e);
    return t ? t.getComponent() : !1;
  }
  getIndex() {
    return this._row.getData("data")[this._row.table.options.index];
  }
  getPosition() {
    return this._row.getPosition();
  }
  watchPosition(e) {
    return this._row.watchPosition(e);
  }
  delete() {
    return this._row.delete();
  }
  scrollTo(e, t) {
    return this._row.table.rowManager.scrollToRow(this._row, e, t);
  }
  move(e, t) {
    this._row.moveToRow(e, t);
  }
  update(e) {
    return this._row.updateData(e);
  }
  normalizeHeight() {
    this._row.normalizeHeight(!0);
  }
  _getSelf() {
    return this._row;
  }
  reformat() {
    return this._row.reinitialize();
  }
  getTable() {
    return this._row.table;
  }
  getNextRow() {
    var e = this._row.nextRow();
    return e && e.getComponent();
  }
  getPrevRow() {
    var e = this._row.prevRow();
    return e && e.getComponent();
  }
}
class ze extends ke {
  constructor(e, t, i = "row") {
    super(t.table), this.parent = t, this.data = {}, this.type = i, this.element = !1, this.modules = {}, this.cells = [], this.height = 0, this.heightStyled = "", this.manualHeight = !1, this.outerHeight = 0, this.initialized = !1, this.heightInitialized = !1, this.position = 0, this.positionWatchers = [], this.component = null, this.created = !1, this.setData(e);
  }
  create() {
    this.created || (this.created = !0, this.generateElement());
  }
  createElement() {
    var e = document.createElement("div");
    e.classList.add("tabulator-row"), e.setAttribute("role", "row"), this.element = e;
  }
  getElement() {
    return this.create(), this.element;
  }
  detachElement() {
    this.element && this.element.parentNode && this.element.parentNode.removeChild(this.element);
  }
  generateElement() {
    this.createElement(), this.dispatch("row-init", this);
  }
  generateCells() {
    this.cells = this.table.columnManager.generateCells(this);
  }
  //functions to setup on first render
  initialize(e, t) {
    if (this.create(), !this.initialized || e) {
      for (this.deleteCells(); this.element.firstChild; ) this.element.removeChild(this.element.firstChild);
      this.dispatch("row-layout-before", this), this.generateCells(), this.initialized = !0, this.table.columnManager.renderer.renderRowCells(this, t), e && this.normalizeHeight(), this.dispatch("row-layout", this), this.table.options.rowFormatter && this.table.options.rowFormatter(this.getComponent()), this.dispatch("row-layout-after", this);
    } else
      this.table.columnManager.renderer.rerenderRowCells(this, t);
  }
  rendered() {
    this.cells.forEach((e) => {
      e.cellRendered();
    });
  }
  reinitializeHeight() {
    this.heightInitialized = !1, this.element && this.element.offsetParent !== null && this.normalizeHeight(!0);
  }
  deinitialize() {
    this.initialized = !1;
  }
  deinitializeHeight() {
    this.heightInitialized = !1;
  }
  reinitialize(e) {
    this.initialized = !1, this.heightInitialized = !1, this.manualHeight || (this.height = 0, this.heightStyled = ""), this.element && this.element.offsetParent !== null && this.initialize(!0), this.dispatch("row-relayout", this);
  }
  //get heights when doing bulk row style calcs in virtual DOM
  calcHeight(e) {
    var t = 0, i = 0;
    this.table.options.rowHeight ? this.height = this.table.options.rowHeight : (i = this.calcMinHeight(), t = this.calcMaxHeight(), e ? this.height = Math.max(t, i) : this.height = this.manualHeight ? this.height : Math.max(t, i)), this.heightStyled = this.height ? this.height + "px" : "", this.outerHeight = this.element.offsetHeight;
  }
  calcMinHeight() {
    return this.table.options.resizableRows ? this.element.clientHeight : 0;
  }
  calcMaxHeight() {
    var e = 0;
    return this.cells.forEach(function(t) {
      var i = t.getHeight();
      i > e && (e = i);
    }), e;
  }
  //set of cells
  setCellHeight() {
    this.cells.forEach(function(e) {
      e.setHeight();
    }), this.heightInitialized = !0;
  }
  clearCellHeight() {
    this.cells.forEach(function(e) {
      e.clearHeight();
    });
  }
  //normalize the height of elements in the row
  normalizeHeight(e) {
    e && !this.table.options.rowHeight && this.clearCellHeight(), this.calcHeight(e), this.setCellHeight();
  }
  //set height of rows
  setHeight(e, t) {
    (this.height != e || t) && (this.manualHeight = !0, this.height = e, this.heightStyled = e ? e + "px" : "", this.setCellHeight(), this.outerHeight = this.element.offsetHeight, this.subscribedExternal("rowHeight") && this.dispatchExternal("rowHeight", this.getComponent()));
  }
  //return rows outer height
  getHeight() {
    return this.outerHeight;
  }
  //return rows outer Width
  getWidth() {
    return this.element.offsetWidth;
  }
  //////////////// Cell Management /////////////////
  deleteCell(e) {
    var t = this.cells.indexOf(e);
    t > -1 && this.cells.splice(t, 1);
  }
  //////////////// Data Management /////////////////
  setData(e) {
    this.data = this.chain("row-data-init-before", [this, e], void 0, e), this.dispatch("row-data-init-after", this);
  }
  //update the rows data
  updateData(e) {
    var t = this.element && de.elVisible(this.element), i = {}, n;
    return new Promise((s, a) => {
      typeof e == "string" && (e = JSON.parse(e)), this.dispatch("row-data-save-before", this), this.subscribed("row-data-changing") && (i = Object.assign(i, this.data), i = Object.assign(i, e)), n = this.chain("row-data-changing", [this, i, e], null, e);
      for (let o in n)
        this.data[o] = n[o];
      this.dispatch("row-data-save-after", this);
      for (let o in e)
        this.table.columnManager.getColumnsByFieldRoot(o).forEach((h) => {
          let u = this.getCell(h.getField());
          if (u) {
            let d = h.getFieldValue(n);
            u.getValue() !== d && (u.setValueProcessData(d), t && u.cellRendered());
          }
        });
      t ? (this.normalizeHeight(!0), this.table.options.rowFormatter && this.table.options.rowFormatter(this.getComponent())) : (this.initialized = !1, this.height = 0, this.heightStyled = ""), this.dispatch("row-data-changed", this, t, e), this.dispatchExternal("rowUpdated", this.getComponent()), this.subscribedExternal("dataChanged") && this.dispatchExternal("dataChanged", this.table.rowManager.getData()), s();
    });
  }
  getData(e) {
    return e ? this.chain("row-data-retrieve", [this, e], null, this.data) : this.data;
  }
  getCell(e) {
    var t = !1;
    return e = this.table.columnManager.findColumn(e), !this.initialized && this.cells.length === 0 && this.generateCells(), t = this.cells.find(function(i) {
      return i.column === e;
    }), t;
  }
  getCellIndex(e) {
    return this.cells.findIndex(function(t) {
      return t === e;
    });
  }
  findCell(e) {
    return this.cells.find((t) => t.element === e);
  }
  getCells() {
    return !this.initialized && this.cells.length === 0 && this.generateCells(), this.cells;
  }
  nextRow() {
    var e = this.table.rowManager.nextDisplayRow(this, !0);
    return e || !1;
  }
  prevRow() {
    var e = this.table.rowManager.prevDisplayRow(this, !0);
    return e || !1;
  }
  moveToRow(e, t) {
    var i = this.table.rowManager.findRow(e);
    i ? (this.table.rowManager.moveRowActual(this, i, !t), this.table.rowManager.refreshActiveData("display", !1, !0)) : console.warn("Move Error - No matching row found:", e);
  }
  ///////////////////// Actions  /////////////////////
  delete() {
    return this.dispatch("row-delete", this), this.deleteActual(), Promise.resolve();
  }
  deleteActual(e) {
    this.detachModules(), this.table.rowManager.deleteRow(this, e), this.deleteCells(), this.initialized = !1, this.heightInitialized = !1, this.element = !1, this.dispatch("row-deleted", this);
  }
  detachModules() {
    this.dispatch("row-deleting", this);
  }
  deleteCells() {
    var e = this.cells.length;
    for (let t = 0; t < e; t++)
      this.cells[0].delete();
  }
  wipe() {
    if (this.detachModules(), this.deleteCells(), this.element) {
      for (; this.element.firstChild; ) this.element.removeChild(this.element.firstChild);
      this.element.parentNode && this.element.parentNode.removeChild(this.element);
    }
    this.element = !1, this.modules = {};
  }
  isDisplayed() {
    return this.table.rowManager.getDisplayRows().includes(this);
  }
  getPosition() {
    return this.isDisplayed() ? this.position : !1;
  }
  setPosition(e) {
    e != this.position && (this.position = e, this.positionWatchers.forEach((t) => {
      t(this.position);
    }));
  }
  watchPosition(e) {
    this.positionWatchers.push(e), e(this.position);
  }
  getGroup() {
    return this.modules.group || !1;
  }
  //////////////// Object Generation /////////////////
  getComponent() {
    return this.component || (this.component = new Ya(this)), this.component;
  }
}
var Ob = {
  avg: function(r, e, t) {
    var i = 0, n = typeof t.precision < "u" ? t.precision : 2;
    return r.length && (i = r.reduce(function(s, a) {
      return Number(s) + Number(a);
    }), i = i / r.length, i = n !== !1 ? i.toFixed(n) : i), parseFloat(i).toString();
  },
  max: function(r, e, t) {
    var i = null, n = typeof t.precision < "u" ? t.precision : !1;
    return r.forEach(function(s) {
      s = Number(s), (s > i || i === null) && (i = s);
    }), i !== null ? n !== !1 ? i.toFixed(n) : i : "";
  },
  min: function(r, e, t) {
    var i = null, n = typeof t.precision < "u" ? t.precision : !1;
    return r.forEach(function(s) {
      s = Number(s), (s < i || i === null) && (i = s);
    }), i !== null ? n !== !1 ? i.toFixed(n) : i : "";
  },
  sum: function(r, e, t) {
    var i = 0, n = typeof t.precision < "u" ? t.precision : !1;
    return r.length && r.forEach(function(s) {
      s = Number(s), i += isNaN(s) ? 0 : Number(s);
    }), n !== !1 ? i.toFixed(n) : i;
  },
  concat: function(r, e, t) {
    var i = 0;
    return r.length && (i = r.reduce(function(n, s) {
      return String(n) + String(s);
    })), i;
  },
  count: function(r, e, t) {
    var i = 0;
    return r.length && r.forEach(function(n) {
      n && i++;
    }), i;
  },
  unique: function(r, e, t) {
    var i = r.filter((n, s) => (r || n === 0) && r.indexOf(n) === s);
    return i.length;
  }
};
const pi = class pi extends U {
  constructor(e) {
    super(e), this.topCalcs = [], this.botCalcs = [], this.genColumn = !1, this.topElement = this.createElement(), this.botElement = this.createElement(), this.topRow = !1, this.botRow = !1, this.topInitialized = !1, this.botInitialized = !1, this.blocked = !1, this.recalcAfterBlock = !1, this.registerTableOption("columnCalcs", !0), this.registerColumnOption("topCalc"), this.registerColumnOption("topCalcParams"), this.registerColumnOption("topCalcFormatter"), this.registerColumnOption("topCalcFormatterParams"), this.registerColumnOption("bottomCalc"), this.registerColumnOption("bottomCalcParams"), this.registerColumnOption("bottomCalcFormatter"), this.registerColumnOption("bottomCalcFormatterParams");
  }
  createElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-calcs-holder"), e;
  }
  initialize() {
    this.genColumn = new rr({ field: "value" }, this), this.subscribe("cell-value-changed", this.cellValueChanged.bind(this)), this.subscribe("column-init", this.initializeColumnCheck.bind(this)), this.subscribe("row-deleted", this.rowsUpdated.bind(this)), this.subscribe("scroll-horizontal", this.scrollHorizontal.bind(this)), this.subscribe("row-added", this.rowsUpdated.bind(this)), this.subscribe("column-moved", this.recalcActiveRows.bind(this)), this.subscribe("column-add", this.recalcActiveRows.bind(this)), this.subscribe("data-refreshed", this.recalcActiveRowsRefresh.bind(this)), this.subscribe("table-redraw", this.tableRedraw.bind(this)), this.subscribe("rows-visible", this.visibleRows.bind(this)), this.subscribe("scrollbar-vertical", this.adjustForScrollbar.bind(this)), this.subscribe("redraw-blocked", this.blockRedraw.bind(this)), this.subscribe("redraw-restored", this.restoreRedraw.bind(this)), this.subscribe("table-redrawing", this.resizeHolderWidth.bind(this)), this.subscribe("column-resized", this.resizeHolderWidth.bind(this)), this.subscribe("column-show", this.resizeHolderWidth.bind(this)), this.subscribe("column-hide", this.resizeHolderWidth.bind(this)), this.registerTableFunction("getCalcResults", this.getResults.bind(this)), this.registerTableFunction("recalc", this.userRecalc.bind(this)), this.resizeHolderWidth();
  }
  resizeHolderWidth() {
    this.topElement.style.minWidth = this.table.columnManager.headersElement.offsetWidth + "px";
  }
  tableRedraw(e) {
    this.recalc(this.table.rowManager.activeRows), e && this.redraw();
  }
  blockRedraw() {
    this.blocked = !0, this.recalcAfterBlock = !1;
  }
  restoreRedraw() {
    this.blocked = !1, this.recalcAfterBlock && (this.recalcAfterBlock = !1, this.recalcActiveRowsRefresh());
  }
  ///////////////////////////////////
  ///////// Table Functions /////////
  ///////////////////////////////////
  userRecalc() {
    this.recalc(this.table.rowManager.activeRows);
  }
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  blockCheck() {
    return this.blocked && (this.recalcAfterBlock = !0), this.blocked;
  }
  visibleRows(e, t) {
    return this.topRow && t.unshift(this.topRow), this.botRow && t.push(this.botRow), t;
  }
  rowsUpdated(e) {
    this.table.options.groupBy ? this.recalcRowGroup(e) : this.recalcActiveRows();
  }
  recalcActiveRowsRefresh() {
    this.table.options.groupBy && this.table.options.dataTreeStartExpanded && this.table.options.dataTree ? this.recalcAll() : this.recalcActiveRows();
  }
  recalcActiveRows() {
    this.recalc(this.table.rowManager.activeRows);
  }
  cellValueChanged(e) {
    (e.column.definition.topCalc || e.column.definition.bottomCalc) && (this.table.options.groupBy ? ((this.table.options.columnCalcs == "table" || this.table.options.columnCalcs == "both") && this.recalcActiveRows(), this.table.options.columnCalcs != "table" && this.recalcRowGroup(e.row)) : this.recalcActiveRows());
  }
  initializeColumnCheck(e) {
    (e.definition.topCalc || e.definition.bottomCalc) && this.initializeColumn(e);
  }
  //initialize column calcs
  initializeColumn(e) {
    var t = e.definition, i = {
      topCalcParams: t.topCalcParams || {},
      botCalcParams: t.bottomCalcParams || {}
    };
    if (t.topCalc) {
      switch (typeof t.topCalc) {
        case "string":
          pi.calculations[t.topCalc] ? i.topCalc = pi.calculations[t.topCalc] : console.warn("Column Calc Error - No such calculation found, ignoring: ", t.topCalc);
          break;
        case "function":
          i.topCalc = t.topCalc;
          break;
      }
      i.topCalc && (e.modules.columnCalcs = i, this.topCalcs.push(e), this.table.options.columnCalcs != "group" && this.initializeTopRow());
    }
    if (t.bottomCalc) {
      switch (typeof t.bottomCalc) {
        case "string":
          pi.calculations[t.bottomCalc] ? i.botCalc = pi.calculations[t.bottomCalc] : console.warn("Column Calc Error - No such calculation found, ignoring: ", t.bottomCalc);
          break;
        case "function":
          i.botCalc = t.bottomCalc;
          break;
      }
      i.botCalc && (e.modules.columnCalcs = i, this.botCalcs.push(e), this.table.options.columnCalcs != "group" && this.initializeBottomRow());
    }
  }
  //dummy functions to handle being mock column manager
  registerColumnField() {
  }
  removeCalcs() {
    var e = !1;
    this.topInitialized && (this.topInitialized = !1, this.topElement.parentNode.removeChild(this.topElement), e = !0), this.botInitialized && (this.botInitialized = !1, this.footerRemove(this.botElement), e = !0), e && this.table.rowManager.adjustTableSize();
  }
  reinitializeCalcs() {
    this.topCalcs.length && this.initializeTopRow(), this.botCalcs.length && this.initializeBottomRow();
  }
  initializeTopRow() {
    var e = document.createDocumentFragment();
    this.topInitialized || (e.appendChild(document.createElement("br")), e.appendChild(this.topElement), this.table.columnManager.getContentsElement().insertBefore(e, this.table.columnManager.headersElement.nextSibling), this.topInitialized = !0);
  }
  initializeBottomRow() {
    this.botInitialized || (this.footerPrepend(this.botElement), this.botInitialized = !0);
  }
  scrollHorizontal(e) {
    this.botInitialized && this.botRow && (this.botElement.scrollLeft = e);
  }
  recalc(e) {
    var t, i;
    if (!this.blockCheck() && (this.topInitialized || this.botInitialized)) {
      if (t = this.rowsToData(e), this.topInitialized) {
        for (this.topRow && this.topRow.deleteCells(), i = this.generateRow("top", t), this.topRow = i; this.topElement.firstChild; ) this.topElement.removeChild(this.topElement.firstChild);
        this.topElement.appendChild(i.getElement()), i.initialize(!0);
      }
      if (this.botInitialized) {
        for (this.botRow && this.botRow.deleteCells(), i = this.generateRow("bottom", t), this.botRow = i; this.botElement.firstChild; ) this.botElement.removeChild(this.botElement.firstChild);
        this.botElement.appendChild(i.getElement()), i.initialize(!0);
      }
      this.table.rowManager.adjustTableSize(), this.table.modExists("frozenColumns") && this.table.modules.frozenColumns.layout();
    }
  }
  recalcRowGroup(e) {
    this.recalcGroup(this.table.modules.groupRows.getRowGroup(e));
  }
  recalcAll() {
    if ((this.topCalcs.length || this.botCalcs.length) && (this.table.options.columnCalcs !== "group" && this.recalcActiveRows(), this.table.options.groupBy && this.table.options.columnCalcs !== "table")) {
      var e = this.table.modules.groupRows.getChildGroups();
      e.forEach((t) => {
        this.recalcGroup(t);
      });
    }
  }
  recalcGroup(e) {
    var t, i;
    this.blockCheck() || e && e.calcs && (e.calcs.bottom && (t = this.rowsToData(e.rows), i = this.generateRowData("bottom", t), e.calcs.bottom.updateData(i), e.calcs.bottom.reinitialize()), e.calcs.top && (t = this.rowsToData(e.rows), i = this.generateRowData("top", t), e.calcs.top.updateData(i), e.calcs.top.reinitialize()));
  }
  //generate top stats row
  generateTopRow(e) {
    return this.generateRow("top", this.rowsToData(e));
  }
  //generate bottom stats row
  generateBottomRow(e) {
    return this.generateRow("bottom", this.rowsToData(e));
  }
  rowsToData(e) {
    var t = [], i = this.table.options.dataTree && this.table.options.dataTreeChildColumnCalcs, n = this.table.modules.dataTree;
    return e.forEach((s) => {
      var a;
      t.push(s.getData()), i && ((a = s.modules.dataTree) != null && a.open) && this.rowsToData(n.getFilteredTreeChildren(s)).forEach((o) => {
        t.push(s);
      });
    }), t;
  }
  //generate stats row
  generateRow(e, t) {
    var i = this.generateRowData(e, t), n;
    return this.table.modExists("mutator") && this.table.modules.mutator.disable(), n = new ze(i, this, "calc"), this.table.modExists("mutator") && this.table.modules.mutator.enable(), n.getElement().classList.add("tabulator-calcs", "tabulator-calcs-" + e), n.component = !1, n.getComponent = () => (n.component || (n.component = new Pb(n)), n.component), n.generateCells = () => {
      var s = [];
      this.table.columnManager.columnsByIndex.forEach((a) => {
        this.genColumn.setField(a.getField()), this.genColumn.hozAlign = a.hozAlign, a.definition[e + "CalcFormatter"] && this.table.modExists("format") ? this.genColumn.modules.format = {
          formatter: this.table.modules.format.lookupFormatter(a.definition[e + "CalcFormatter"]),
          params: a.definition[e + "CalcFormatterParams"] || {}
        } : this.genColumn.modules.format = {
          formatter: this.table.modules.format.lookupFormatter("plaintext"),
          params: {}
        }, this.genColumn.definition.cssClass = a.definition.cssClass;
        var o = new gs(this.genColumn, n);
        o.getElement(), o.column = a, o.setWidth(), a.cells.push(o), s.push(o), a.visible || o.hide();
      }), n.cells = s;
    }, n;
  }
  //generate stats row
  generateRowData(e, t) {
    var i = {}, n = e == "top" ? this.topCalcs : this.botCalcs, s = e == "top" ? "topCalc" : "botCalc", a, o;
    return n.forEach(function(l) {
      var h = [];
      l.modules.columnCalcs && l.modules.columnCalcs[s] && (t.forEach(function(u) {
        h.push(l.getFieldValue(u));
      }), o = s + "Params", a = typeof l.modules.columnCalcs[o] == "function" ? l.modules.columnCalcs[o](h, t) : l.modules.columnCalcs[o], l.setFieldValue(i, l.modules.columnCalcs[s](h, t, a)));
    }), i;
  }
  hasTopCalcs() {
    return !!this.topCalcs.length;
  }
  hasBottomCalcs() {
    return !!this.botCalcs.length;
  }
  //handle table redraw
  redraw() {
    this.topRow && this.topRow.normalizeHeight(!0), this.botRow && this.botRow.normalizeHeight(!0);
  }
  //return the calculated
  getResults() {
    var e = {}, t;
    return this.table.options.groupBy && this.table.modExists("groupRows") ? (t = this.table.modules.groupRows.getGroups(!0), t.forEach((i) => {
      e[i.getKey()] = this.getGroupResults(i);
    })) : e = {
      top: this.topRow ? this.topRow.getData() : {},
      bottom: this.botRow ? this.botRow.getData() : {}
    }, e;
  }
  //get results from a group
  getGroupResults(e) {
    var t = e._getSelf(), i = e.getSubGroups(), n = {}, s = {};
    return i.forEach((a) => {
      n[a.getKey()] = this.getGroupResults(a);
    }), s = {
      top: t.calcs.top ? t.calcs.top.getData() : {},
      bottom: t.calcs.bottom ? t.calcs.bottom.getData() : {},
      groups: n
    }, s;
  }
  adjustForScrollbar(e) {
    this.botRow && (this.table.rtl ? this.botElement.style.paddingLeft = e + "px" : this.botElement.style.paddingRight = e + "px");
  }
};
A(pi, "moduleName", "columnCalcs"), //load defaults
A(pi, "calculations", Ob);
let Vl = pi;
class Pp extends U {
  constructor(e) {
    super(e), this.indent = 10, this.field = "", this.collapseEl = null, this.expandEl = null, this.branchEl = null, this.elementField = !1, this.startOpen = function() {
    }, this.registerTableOption("dataTree", !1), this.registerTableOption("dataTreeFilter", !0), this.registerTableOption("dataTreeSort", !0), this.registerTableOption("dataTreeElementColumn", !1), this.registerTableOption("dataTreeBranchElement", !0), this.registerTableOption("dataTreeChildIndent", 9), this.registerTableOption("dataTreeChildField", "_children"), this.registerTableOption("dataTreeCollapseElement", !1), this.registerTableOption("dataTreeExpandElement", !1), this.registerTableOption("dataTreeStartExpanded", !1), this.registerTableOption("dataTreeChildColumnCalcs", !1), this.registerTableOption("dataTreeSelectPropagate", !1), this.registerComponentFunction("row", "treeCollapse", this.collapseRow.bind(this)), this.registerComponentFunction("row", "treeExpand", this.expandRow.bind(this)), this.registerComponentFunction("row", "treeToggle", this.toggleRow.bind(this)), this.registerComponentFunction("row", "getTreeParent", this.getTreeParent.bind(this)), this.registerComponentFunction("row", "getTreeChildren", this.getRowChildren.bind(this)), this.registerComponentFunction("row", "addTreeChild", this.addTreeChildRow.bind(this)), this.registerComponentFunction("row", "isTreeExpanded", this.isRowExpanded.bind(this));
  }
  initialize() {
    if (this.table.options.dataTree) {
      var e = null, t = this.table.options;
      switch (this.field = t.dataTreeChildField, this.indent = t.dataTreeChildIndent, this.options("movableRows") && console.warn("The movableRows option is not available with dataTree enabled, moving of child rows could result in unpredictable behavior"), t.dataTreeBranchElement ? t.dataTreeBranchElement === !0 ? (this.branchEl = document.createElement("div"), this.branchEl.classList.add("tabulator-data-tree-branch")) : typeof t.dataTreeBranchElement == "string" ? (e = document.createElement("div"), e.innerHTML = t.dataTreeBranchElement, this.branchEl = e.firstChild) : this.branchEl = t.dataTreeBranchElement : (this.branchEl = document.createElement("div"), this.branchEl.classList.add("tabulator-data-tree-branch-empty")), t.dataTreeCollapseElement ? typeof t.dataTreeCollapseElement == "string" ? (e = document.createElement("div"), e.innerHTML = t.dataTreeCollapseElement, this.collapseEl = e.firstChild) : this.collapseEl = t.dataTreeCollapseElement : (this.collapseEl = document.createElement("div"), this.collapseEl.classList.add("tabulator-data-tree-control"), this.collapseEl.tabIndex = 0, this.collapseEl.innerHTML = "<div class='tabulator-data-tree-control-collapse'></div>"), t.dataTreeExpandElement ? typeof t.dataTreeExpandElement == "string" ? (e = document.createElement("div"), e.innerHTML = t.dataTreeExpandElement, this.expandEl = e.firstChild) : this.expandEl = t.dataTreeExpandElement : (this.expandEl = document.createElement("div"), this.expandEl.classList.add("tabulator-data-tree-control"), this.expandEl.tabIndex = 0, this.expandEl.innerHTML = "<div class='tabulator-data-tree-control-expand'></div>"), typeof t.dataTreeStartExpanded) {
        case "boolean":
          this.startOpen = function(i, n) {
            return t.dataTreeStartExpanded;
          };
          break;
        case "function":
          this.startOpen = t.dataTreeStartExpanded;
          break;
        default:
          this.startOpen = function(i, n) {
            return t.dataTreeStartExpanded[n];
          };
          break;
      }
      this.subscribe("row-init", this.initializeRow.bind(this)), this.subscribe("row-layout-after", this.layoutRow.bind(this)), this.subscribe("row-deleting", this.rowDeleting.bind(this)), this.subscribe("row-deleted", this.rowDelete.bind(this), 0), this.subscribe("row-data-changed", this.rowDataChanged.bind(this), 10), this.subscribe("cell-value-updated", this.cellValueChanged.bind(this)), this.subscribe("edit-cancelled", this.cellValueChanged.bind(this)), this.subscribe("column-moving-rows", this.columnMoving.bind(this)), this.subscribe("table-built", this.initializeElementField.bind(this)), this.subscribe("table-redrawing", this.tableRedrawing.bind(this)), this.registerDisplayHandler(this.getRows.bind(this), 30);
    }
  }
  tableRedrawing(e) {
    var t;
    e && (t = this.table.rowManager.getRows(), t.forEach((i) => {
      this.reinitializeRowChildren(i);
    }));
  }
  initializeElementField() {
    var e = this.table.columnManager.getFirstVisibleColumn();
    this.elementField = this.table.options.dataTreeElementColumn || (e ? e.field : !1);
  }
  getRowChildren(e) {
    return this.getTreeChildren(e, !0);
  }
  columnMoving() {
    var e = [];
    return this.table.rowManager.rows.forEach((t) => {
      e = e.concat(this.getTreeChildren(t, !1, !0));
    }), e;
  }
  rowDataChanged(e, t, i) {
    this.redrawNeeded(i) && (this.initializeRow(e), t && (this.layoutRow(e), this.refreshData(!0)));
  }
  cellValueChanged(e) {
    var t = e.column.getField();
    t === this.elementField && this.layoutRow(e.row);
  }
  initializeRow(e) {
    var t = e.getData()[this.field], i = Array.isArray(t), n = i || !i && typeof t == "object" && t !== null;
    !n && e.modules.dataTree && e.modules.dataTree.branchEl && e.modules.dataTree.branchEl.parentNode.removeChild(e.modules.dataTree.branchEl), !n && e.modules.dataTree && e.modules.dataTree.controlEl && e.modules.dataTree.controlEl.parentNode.removeChild(e.modules.dataTree.controlEl), e.modules.dataTree = {
      index: e.modules.dataTree ? e.modules.dataTree.index : 0,
      open: n ? e.modules.dataTree ? e.modules.dataTree.open : this.startOpen(e.getComponent(), 0) : !1,
      controlEl: e.modules.dataTree && n ? e.modules.dataTree.controlEl : !1,
      branchEl: e.modules.dataTree && n ? e.modules.dataTree.branchEl : !1,
      parent: e.modules.dataTree ? e.modules.dataTree.parent : !1,
      children: n
    };
  }
  reinitializeRowChildren(e) {
    var t = this.getTreeChildren(e, !1, !0);
    t.forEach(function(i) {
      i.reinitialize(!0);
    });
  }
  layoutRow(e) {
    var t = this.elementField ? e.getCell(this.elementField) : e.getCells()[0], i = t.getElement(), n = e.modules.dataTree;
    n.branchEl && (n.branchEl.parentNode && n.branchEl.parentNode.removeChild(n.branchEl), n.branchEl = !1), n.controlEl && (n.controlEl.parentNode && n.controlEl.parentNode.removeChild(n.controlEl), n.controlEl = !1), this.generateControlElement(e, i), e.getElement().classList.add("tabulator-tree-level-" + n.index), n.index && (this.branchEl ? (n.branchEl = this.branchEl.cloneNode(!0), i.insertBefore(n.branchEl, i.firstChild), this.table.rtl ? n.branchEl.style.marginRight = (n.branchEl.offsetWidth + n.branchEl.style.marginLeft) * (n.index - 1) + n.index * this.indent + "px" : n.branchEl.style.marginLeft = (n.branchEl.offsetWidth + n.branchEl.style.marginRight) * (n.index - 1) + n.index * this.indent + "px") : this.table.rtl ? i.style.paddingRight = parseInt(window.getComputedStyle(i, null).getPropertyValue("padding-right")) + n.index * this.indent + "px" : i.style.paddingLeft = parseInt(window.getComputedStyle(i, null).getPropertyValue("padding-left")) + n.index * this.indent + "px");
  }
  generateControlElement(e, t) {
    var i = e.modules.dataTree, n = i.controlEl;
    t = t || e.getCells()[0].getElement(), i.children !== !1 && (i.open ? (i.controlEl = this.collapseEl.cloneNode(!0), i.controlEl.addEventListener("click", (s) => {
      s.stopPropagation(), this.collapseRow(e);
    })) : (i.controlEl = this.expandEl.cloneNode(!0), i.controlEl.addEventListener("click", (s) => {
      s.stopPropagation(), this.expandRow(e);
    })), i.controlEl.addEventListener("mousedown", (s) => {
      s.stopPropagation();
    }), n && n.parentNode === t ? n.parentNode.replaceChild(i.controlEl, n) : t.insertBefore(i.controlEl, t.firstChild));
  }
  getRows(e) {
    var t = [];
    return e.forEach((i, n) => {
      var s, a;
      t.push(i), i instanceof ze && (i.create(), s = i.modules.dataTree, !s.index && s.children !== !1 && (a = this.getChildren(i, !1, !0), a.forEach((o) => {
        o.create(), t.push(o);
      })));
    }), t;
  }
  getChildren(e, t, i) {
    var n = e.modules.dataTree, s = [], a = [];
    return n.children !== !1 && (n.open || t) && (Array.isArray(n.children) || (n.children = this.generateChildren(e)), this.table.modExists("filter") && this.table.options.dataTreeFilter ? s = this.table.modules.filter.filter(n.children) : s = n.children, this.table.modExists("sort") && this.table.options.dataTreeSort && this.table.modules.sort.sort(s, i), s.forEach((o) => {
      a.push(o);
      var l = this.getChildren(o, !1, !0);
      l.forEach((h) => {
        a.push(h);
      });
    })), a;
  }
  generateChildren(e) {
    var t = [], i = e.getData()[this.field];
    return Array.isArray(i) || (i = [i]), i.forEach((n) => {
      var s = new ze(n || {}, this.table.rowManager);
      s.create(), s.modules.dataTree.index = e.modules.dataTree.index + 1, s.modules.dataTree.parent = e, s.modules.dataTree.children && (s.modules.dataTree.open = this.startOpen(s.getComponent(), s.modules.dataTree.index)), t.push(s);
    }), t;
  }
  expandRow(e, t) {
    var i = e.modules.dataTree;
    i.children !== !1 && (i.open = !0, e.reinitialize(), this.refreshData(!0), this.dispatchExternal("dataTreeRowExpanded", e.getComponent(), e.modules.dataTree.index));
  }
  collapseRow(e) {
    var t = e.modules.dataTree;
    t.children !== !1 && (t.open = !1, e.reinitialize(), this.refreshData(!0), this.dispatchExternal("dataTreeRowCollapsed", e.getComponent(), e.modules.dataTree.index));
  }
  toggleRow(e) {
    var t = e.modules.dataTree;
    t.children !== !1 && (t.open ? this.collapseRow(e) : this.expandRow(e));
  }
  isRowExpanded(e) {
    return e.modules.dataTree.open;
  }
  getTreeParent(e) {
    return e.modules.dataTree.parent ? e.modules.dataTree.parent.getComponent() : !1;
  }
  getTreeParentRoot(e) {
    return e.modules.dataTree && e.modules.dataTree.parent ? this.getTreeParentRoot(e.modules.dataTree.parent) : e;
  }
  getFilteredTreeChildren(e) {
    var t = e.modules.dataTree, i = [], n;
    return t.children && (Array.isArray(t.children) || (t.children = this.generateChildren(e)), this.table.modExists("filter") && this.table.options.dataTreeFilter ? n = this.table.modules.filter.filter(t.children) : n = t.children, n.forEach((s) => {
      s instanceof ze && i.push(s);
    })), i;
  }
  rowDeleting(e) {
    var t = e.modules.dataTree;
    t && t.children && Array.isArray(t.children) && t.children.forEach((i) => {
      i instanceof ze && i.wipe();
    });
  }
  rowDelete(e) {
    var t = e.modules.dataTree.parent, i;
    t && (i = this.findChildIndex(e, t), i !== !1 && t.data[this.field].splice(i, 1), t.data[this.field].length || delete t.data[this.field], this.initializeRow(t), this.layoutRow(t)), this.refreshData(!0);
  }
  addTreeChildRow(e, t, i, n) {
    var s = !1;
    typeof t == "string" && (t = JSON.parse(t)), Array.isArray(e.data[this.field]) || (e.data[this.field] = [], e.modules.dataTree.open = this.startOpen(e.getComponent(), e.modules.dataTree.index)), typeof n < "u" && (s = this.findChildIndex(n, e), s !== !1 && e.data[this.field].splice(i ? s : s + 1, 0, t)), s === !1 && (i ? e.data[this.field].unshift(t) : e.data[this.field].push(t)), this.initializeRow(e), this.layoutRow(e), this.refreshData(!0);
  }
  findChildIndex(e, t) {
    var i = !1;
    return typeof e == "object" ? e instanceof ze ? i = e.data : e instanceof Ya ? i = e._getSelf().data : typeof HTMLElement < "u" && e instanceof HTMLElement ? t.modules.dataTree && (i = t.modules.dataTree.children.find((n) => n instanceof ze ? n.element === e : !1), i && (i = i.data)) : e === null && (i = !1) : typeof e > "u" ? i = !1 : i = t.data[this.field].find((n) => n.data[this.table.options.index] == e), i && (Array.isArray(t.data[this.field]) && (i = t.data[this.field].indexOf(i)), i == -1 && (i = !1)), i;
  }
  getTreeChildren(e, t, i) {
    var n = e.modules.dataTree, s = [];
    return n && n.children && (Array.isArray(n.children) || (n.children = this.generateChildren(e)), n.children.forEach((a) => {
      a instanceof ze && (s.push(t ? a.getComponent() : a), i && this.getTreeChildren(a, t, i).forEach((o) => {
        s.push(o);
      }));
    })), s;
  }
  getChildField() {
    return this.field;
  }
  redrawNeeded(e) {
    return (this.field ? typeof e[this.field] < "u" : !1) || (this.elementField ? typeof e[this.elementField] < "u" : !1);
  }
}
A(Pp, "moduleName", "dataTree");
function Ib(r, e = {}, t) {
  var i = e.delimiter ? e.delimiter : ",", n = [], s = [];
  r.forEach((a) => {
    var o = [];
    switch (a.type) {
      case "group":
        console.warn("Download Warning - CSV downloader cannot process row groups");
        break;
      case "calc":
        console.warn("Download Warning - CSV downloader cannot process column calculations");
        break;
      case "header":
        a.columns.forEach((l, h) => {
          l && l.depth === 1 && (s[h] = typeof l.value > "u" || l.value === null ? "" : '"' + String(l.value).split('"').join('""') + '"');
        });
        break;
      case "row":
        a.columns.forEach((l) => {
          if (l) {
            switch (typeof l.value) {
              case "object":
                l.value = l.value !== null ? JSON.stringify(l.value) : "";
                break;
              case "undefined":
                l.value = "";
                break;
            }
            o.push('"' + String(l.value).split('"').join('""') + '"');
          }
        }), n.push(o.join(i));
        break;
    }
  }), s.length && n.unshift(s.join(i)), n = n.join(`
`), e.bom && (n = "\uFEFF" + n), t(n, "text/csv");
}
function zb(r, e, t) {
  var i = [];
  r.forEach((n) => {
    var s = {};
    switch (n.type) {
      case "header":
        break;
      case "group":
        console.warn("Download Warning - JSON downloader cannot process row groups");
        break;
      case "calc":
        console.warn("Download Warning - JSON downloader cannot process column calculations");
        break;
      case "row":
        n.columns.forEach((a) => {
          a && (s[a.component.getTitleDownload() || a.component.getField()] = a.value);
        }), i.push(s);
        break;
    }
  }), i = JSON.stringify(i, null, "	"), t(i, "application/json");
}
function Fb(r, e = {}, t) {
  var i = [], n = [], s = {}, a = e.rowGroupStyles || {
    fontStyle: "bold",
    fontSize: 12,
    cellPadding: 6,
    fillColor: 220
  }, o = e.rowCalcStyles || {
    fontStyle: "bold",
    fontSize: 10,
    cellPadding: 4,
    fillColor: 232
  }, l = e.jsPDF || {}, h = e.title ? e.title : "", u, d;
  l.orientation || (l.orientation = e.orientation || "landscape"), l.unit || (l.unit = "pt"), r.forEach((f) => {
    switch (f.type) {
      case "header":
        i.push(c(f));
        break;
      case "group":
        n.push(c(f, a));
        break;
      case "calc":
        n.push(c(f, o));
        break;
      case "row":
        n.push(c(f));
        break;
    }
  });
  function c(f, p) {
    var m = [];
    return f.columns.forEach((g) => {
      var v;
      if (g) {
        switch (typeof g.value) {
          case "object":
            g.value = g.value !== null ? JSON.stringify(g.value) : "";
            break;
          case "undefined":
            g.value = "";
            break;
        }
        v = {
          content: g.value,
          colSpan: g.width,
          rowSpan: g.height
        }, p && (v.styles = p), m.push(v);
      }
    }), m;
  }
  u = this.dependencyRegistry.lookup("jspdf", "jsPDF"), d = new u(l), e.autoTable && (typeof e.autoTable == "function" ? s = e.autoTable(d) || {} : s = e.autoTable), h && (s.didDrawPage = function(f) {
    d.text(h, 40, 30);
  }), s.head = i, s.body = n, d.autoTable(s), e.documentProcessing && e.documentProcessing(d), t(d.output("arraybuffer"), "application/pdf");
}
function Hb(r, e, t) {
  var i = this, n = e.sheetName || "Sheet1", s = this.dependencyRegistry.lookup("XLSX"), a = s.utils.book_new(), o = new ke(this), l = "compress" in e ? e.compress : !0, h = e.writeOptions || { bookType: "xlsx", bookSST: !0, compression: l }, u;
  h.type = "binary", a.SheetNames = [], a.Sheets = {};
  function d() {
    var p = [], m = [], g = {}, v = { s: { c: 0, r: 0 }, e: { c: r[0] ? r[0].columns.reduce((b, y) => b + (y && y.width ? y.width : 1), 0) : 0, r: r.length } };
    return r.forEach((b, y) => {
      var w = [];
      b.columns.forEach(function(_, E) {
        _ ? (w.push(!(_.value instanceof Date) && typeof _.value == "object" ? JSON.stringify(_.value) : _.value), (_.width > 1 || _.height > -1) && (_.height > 1 || _.width > 1) && m.push({ s: { r: y, c: E }, e: { r: y + _.height - 1, c: E + _.width - 1 } })) : w.push("");
      }), p.push(w);
    }), s.utils.sheet_add_aoa(g, p), g["!ref"] = s.utils.encode_range(v), m.length && (g["!merges"] = m), g;
  }
  if (e.sheetOnly) {
    t(d());
    return;
  }
  if (e.sheets)
    for (var c in e.sheets)
      e.sheets[c] === !0 ? (a.SheetNames.push(c), a.Sheets[c] = d()) : (a.SheetNames.push(c), o.commsSend(e.sheets[c], "download", "intercept", {
        type: "xlsx",
        options: { sheetOnly: !0 },
        active: i.active,
        intercept: function(p) {
          a.Sheets[c] = p;
        }
      }));
  else
    a.SheetNames.push(n), a.Sheets[n] = d();
  e.documentProcessing && (a = e.documentProcessing(a));
  function f(p) {
    for (var m = new ArrayBuffer(p.length), g = new Uint8Array(m), v = 0; v != p.length; ++v) g[v] = p.charCodeAt(v) & 255;
    return m;
  }
  u = s.write(a, h), t(f(u), "application/octet-stream");
}
function Nb(r, e, t) {
  this.modExists("export", !0) && t(this.modules.export.generateHTMLTable(r), "text/html");
}
function Bb(r, e, t) {
  const i = [];
  r.forEach((n) => {
    const s = {};
    switch (n.type) {
      case "header":
        break;
      case "group":
        console.warn("Download Warning - JSON downloader cannot process row groups");
        break;
      case "calc":
        console.warn("Download Warning - JSON downloader cannot process column calculations");
        break;
      case "row":
        n.columns.forEach((a) => {
          a && (s[a.component.getTitleDownload() || a.component.getField()] = a.value);
        }), i.push(JSON.stringify(s));
        break;
    }
  }), t(i.join(`
`), "application/x-ndjson");
}
var Vb = {
  csv: Ib,
  json: zb,
  jsonLines: Bb,
  pdf: Fb,
  xlsx: Hb,
  html: Nb
};
const Hr = class Hr extends U {
  constructor(e) {
    super(e), this.registerTableOption("downloadEncoder", function(t, i) {
      return new Blob([t], { type: i });
    }), this.registerTableOption("downloadConfig", {}), this.registerTableOption("downloadRowRange", "active"), this.registerColumnOption("download"), this.registerColumnOption("titleDownload");
  }
  initialize() {
    this.deprecatedOptionsCheck(), this.registerTableFunction("download", this.download.bind(this)), this.registerTableFunction("downloadToTab", this.downloadToTab.bind(this));
  }
  deprecatedOptionsCheck() {
  }
  ///////////////////////////////////
  ///////// Table Functions /////////
  ///////////////////////////////////
  downloadToTab(e, t, i, n) {
    this.download(e, t, i, n, !0);
  }
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  //trigger file download
  download(e, t, i, n, s) {
    var a = !1;
    function o(h, u) {
      s ? s === !0 ? this.triggerDownload(h, u, e, t, !0) : s(h) : this.triggerDownload(h, u, e, t);
    }
    if (typeof e == "function" ? a = e : Hr.downloaders[e] ? a = Hr.downloaders[e] : console.warn("Download Error - No such download type found: ", e), a) {
      var l = this.generateExportList(n);
      a.call(this.table, l, i || {}, o.bind(this));
    }
  }
  generateExportList(e) {
    var t = this.table.modules.export.generateExportList(this.table.options.downloadConfig, !1, e || this.table.options.downloadRowRange, "download"), i = this.table.options.groupHeaderDownload;
    return i && !Array.isArray(i) && (i = [i]), t.forEach((n) => {
      var s;
      n.type === "group" && (s = n.columns[0], i && i[n.indent] && (s.value = i[n.indent](s.value, n.component._group.getRowCount(), n.component._group.getData(), n.component)));
    }), t;
  }
  triggerDownload(e, t, i, n, s) {
    var a = document.createElement("a"), o = this.table.options.downloadEncoder(e, t);
    o && (s ? window.open(window.URL.createObjectURL(o)) : (n = n || "Tabulator." + (typeof i == "function" ? "txt" : i), navigator.msSaveOrOpenBlob ? navigator.msSaveOrOpenBlob(o, n) : (a.setAttribute("href", window.URL.createObjectURL(o)), a.setAttribute("download", n), a.style.display = "none", document.body.appendChild(a), a.click(), document.body.removeChild(a))), this.dispatchExternal("downloadComplete"));
  }
  commsReceived(e, t, i) {
    switch (t) {
      case "intercept":
        this.download(i.type, "", i.options, i.active, i.intercept);
        break;
    }
  }
};
A(Hr, "moduleName", "download"), //load defaults
A(Hr, "downloaders", Vb);
let Wl = Hr;
function Xa(r, e) {
  var t = e.mask, i = typeof e.maskLetterChar < "u" ? e.maskLetterChar : "A", n = typeof e.maskNumberChar < "u" ? e.maskNumberChar : "9", s = typeof e.maskWildcardChar < "u" ? e.maskWildcardChar : "*";
  function a(o) {
    var l = t[o];
    typeof l < "u" && l !== s && l !== i && l !== n && (r.value = r.value + "" + l, a(o + 1));
  }
  r.addEventListener("keydown", (o) => {
    var l = r.value.length, h = o.key;
    if (o.keyCode > 46 && !o.ctrlKey && !o.metaKey) {
      if (l >= t.length)
        return o.preventDefault(), o.stopPropagation(), !1;
      switch (t[l]) {
        case i:
          if (h.toUpperCase() == h.toLowerCase())
            return o.preventDefault(), o.stopPropagation(), !1;
          break;
        case n:
          if (isNaN(h))
            return o.preventDefault(), o.stopPropagation(), !1;
          break;
        case s:
          break;
        default:
          if (h !== t[l])
            return o.preventDefault(), o.stopPropagation(), !1;
      }
    }
  }), r.addEventListener("keyup", (o) => {
    o.keyCode > 46 && e.maskAutoFill && a(r.value.length);
  }), r.placeholder || (r.placeholder = t), e.maskAutoFill && a(r.value.length);
}
function Wb(r, e, t, i, n) {
  var s = r.getValue(), a = document.createElement("input");
  if (a.setAttribute("type", n.search ? "search" : "text"), a.style.padding = "4px", a.style.width = "100%", a.style.boxSizing = "border-box", n.elementAttributes && typeof n.elementAttributes == "object")
    for (let l in n.elementAttributes)
      l.charAt(0) == "+" ? (l = l.slice(1), a.setAttribute(l, a.getAttribute(l) + n.elementAttributes["+" + l])) : a.setAttribute(l, n.elementAttributes[l]);
  a.value = typeof s < "u" ? s : "", e(function() {
    r.getType() === "cell" && (a.focus({ preventScroll: !0 }), a.style.height = "100%", n.selectContents && a.select());
  });
  function o(l) {
    (s === null || typeof s > "u") && a.value !== "" || a.value !== s ? t(a.value) && (s = a.value) : i();
  }
  return a.addEventListener("change", o), a.addEventListener("blur", o), a.addEventListener("keydown", function(l) {
    switch (l.keyCode) {
      case 13:
        o();
        break;
      case 27:
        i();
        break;
      case 35:
      case 36:
        l.stopPropagation();
        break;
    }
  }), n.mask && Xa(a, n), a;
}
function Gb(r, e, t, i, n) {
  var s = r.getValue(), a = n.verticalNavigation || "hybrid", o = String(s !== null && typeof s < "u" ? s : ""), l = document.createElement("textarea"), h = 0;
  if (l.style.display = "block", l.style.padding = "2px", l.style.height = "100%", l.style.width = "100%", l.style.boxSizing = "border-box", l.style.whiteSpace = "pre-wrap", l.style.resize = "none", n.elementAttributes && typeof n.elementAttributes == "object")
    for (let d in n.elementAttributes)
      d.charAt(0) == "+" ? (d = d.slice(1), l.setAttribute(d, l.getAttribute(d) + n.elementAttributes["+" + d])) : l.setAttribute(d, n.elementAttributes[d]);
  l.value = o, e(function() {
    r.getType() === "cell" && (l.focus({ preventScroll: !0 }), l.style.height = "100%", l.scrollHeight, l.style.height = l.scrollHeight + "px", r.getRow().normalizeHeight(), n.selectContents && l.select());
  });
  function u(d) {
    (s === null || typeof s > "u") && l.value !== "" || l.value !== s ? (t(l.value) && (s = l.value), setTimeout(function() {
      r.getRow().normalizeHeight();
    }, 300)) : i();
  }
  return l.addEventListener("change", u), l.addEventListener("blur", u), l.addEventListener("keyup", function() {
    l.style.height = "";
    var d = l.scrollHeight;
    l.style.height = d + "px", d != h && (h = d, r.getRow().normalizeHeight());
  }), l.addEventListener("keydown", function(d) {
    switch (d.keyCode) {
      case 13:
        d.shiftKey && n.shiftEnterSubmit && u();
        break;
      case 27:
        i();
        break;
      case 38:
        (a == "editor" || a == "hybrid" && l.selectionStart) && (d.stopImmediatePropagation(), d.stopPropagation());
        break;
      case 40:
        (a == "editor" || a == "hybrid" && l.selectionStart !== l.value.length) && (d.stopImmediatePropagation(), d.stopPropagation());
        break;
      case 35:
      case 36:
        d.stopPropagation();
        break;
    }
  }), n.mask && Xa(l, n), l;
}
function Ub(r, e, t, i, n) {
  var s = r.getValue(), a = n.verticalNavigation || "editor", o = document.createElement("input");
  if (o.setAttribute("type", "number"), typeof n.max < "u" && o.setAttribute("max", n.max), typeof n.min < "u" && o.setAttribute("min", n.min), typeof n.step < "u" && o.setAttribute("step", n.step), o.style.padding = "4px", o.style.width = "100%", o.style.boxSizing = "border-box", n.elementAttributes && typeof n.elementAttributes == "object")
    for (let u in n.elementAttributes)
      u.charAt(0) == "+" ? (u = u.slice(1), o.setAttribute(u, o.getAttribute(u) + n.elementAttributes["+" + u])) : o.setAttribute(u, n.elementAttributes[u]);
  o.value = s;
  var l = function(u) {
    h();
  };
  e(function() {
    r.getType() === "cell" && (o.removeEventListener("blur", l), o.focus({ preventScroll: !0 }), o.style.height = "100%", o.addEventListener("blur", l), n.selectContents && o.select());
  });
  function h() {
    var u = o.value;
    !isNaN(u) && u !== "" && (u = Number(u)), u !== s ? t(u) && (s = u) : i();
  }
  return o.addEventListener("keydown", function(u) {
    switch (u.keyCode) {
      case 13:
        h();
        break;
      case 27:
        i();
        break;
      case 38:
      case 40:
        a == "editor" && (u.stopImmediatePropagation(), u.stopPropagation());
        break;
      case 35:
      case 36:
        u.stopPropagation();
        break;
    }
  }), n.mask && Xa(o, n), o;
}
function jb(r, e, t, i, n) {
  var s = r.getValue(), a = document.createElement("input");
  if (a.setAttribute("type", "range"), typeof n.max < "u" && a.setAttribute("max", n.max), typeof n.min < "u" && a.setAttribute("min", n.min), typeof n.step < "u" && a.setAttribute("step", n.step), a.style.padding = "4px", a.style.width = "100%", a.style.boxSizing = "border-box", n.elementAttributes && typeof n.elementAttributes == "object")
    for (let l in n.elementAttributes)
      l.charAt(0) == "+" ? (l = l.slice(1), a.setAttribute(l, a.getAttribute(l) + n.elementAttributes["+" + l])) : a.setAttribute(l, n.elementAttributes[l]);
  a.value = s, e(function() {
    r.getType() === "cell" && (a.focus({ preventScroll: !0 }), a.style.height = "100%");
  });
  function o() {
    var l = a.value;
    !isNaN(l) && l !== "" && (l = Number(l)), l != s ? t(l) && (s = l) : i();
  }
  return a.addEventListener("blur", function(l) {
    o();
  }), a.addEventListener("keydown", function(l) {
    switch (l.keyCode) {
      case 13:
        o();
        break;
      case 27:
        i();
        break;
    }
  }), a;
}
function Yb(r, e, t, i, n) {
  var s = n.format, a = n.verticalNavigation || "editor", o = s ? window.DateTime || luxon.DateTime : null, l = r.getValue(), h = document.createElement("input");
  function u(c) {
    var f;
    return o.isDateTime(c) ? f = c : s === "iso" ? f = o.fromISO(String(c)) : f = o.fromFormat(String(c), s), f.toFormat("yyyy-MM-dd");
  }
  if (h.type = "date", h.style.padding = "4px", h.style.width = "100%", h.style.boxSizing = "border-box", n.max && h.setAttribute("max", s ? u(n.max) : n.max), n.min && h.setAttribute("min", s ? u(n.min) : n.min), n.elementAttributes && typeof n.elementAttributes == "object")
    for (let c in n.elementAttributes)
      c.charAt(0) == "+" ? (c = c.slice(1), h.setAttribute(c, h.getAttribute(c) + n.elementAttributes["+" + c])) : h.setAttribute(c, n.elementAttributes[c]);
  l = typeof l < "u" ? l : "", s && (o ? l = u(l) : console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")), h.value = l, e(function() {
    r.getType() === "cell" && (h.focus({ preventScroll: !0 }), h.style.height = "100%", n.selectContents && h.select());
  });
  function d() {
    var c = h.value, f;
    if ((l === null || typeof l > "u") && c !== "" || c !== l) {
      if (c && s)
        switch (f = o.fromFormat(String(c), "yyyy-MM-dd"), s) {
          case !0:
            c = f;
            break;
          case "iso":
            c = f.toISO();
            break;
          default:
            c = f.toFormat(s);
        }
      t(c) && (l = h.value);
    } else
      i();
  }
  return h.addEventListener("blur", function(c) {
    (c.relatedTarget || c.rangeParent || c.explicitOriginalTarget !== h) && d();
  }), h.addEventListener("keydown", function(c) {
    switch (c.keyCode) {
      case 13:
        d();
        break;
      case 27:
        i();
        break;
      case 35:
      case 36:
        c.stopPropagation();
        break;
      case 38:
      case 40:
        a == "editor" && (c.stopImmediatePropagation(), c.stopPropagation());
        break;
    }
  }), h;
}
function Xb(r, e, t, i, n) {
  var s = n.format, a = n.verticalNavigation || "editor", o = s ? window.DateTime || luxon.DateTime : null, l, h = r.getValue(), u = document.createElement("input");
  if (u.type = "time", u.style.padding = "4px", u.style.width = "100%", u.style.boxSizing = "border-box", n.elementAttributes && typeof n.elementAttributes == "object")
    for (let c in n.elementAttributes)
      c.charAt(0) == "+" ? (c = c.slice(1), u.setAttribute(c, u.getAttribute(c) + n.elementAttributes["+" + c])) : u.setAttribute(c, n.elementAttributes[c]);
  h = typeof h < "u" ? h : "", s && (o ? (o.isDateTime(h) ? l = h : s === "iso" ? l = o.fromISO(String(h)) : l = o.fromFormat(String(h), s), h = l.toFormat("HH:mm")) : console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")), u.value = h, e(function() {
    r.getType() == "cell" && (u.focus({ preventScroll: !0 }), u.style.height = "100%", n.selectContents && u.select());
  });
  function d() {
    var c = u.value, f;
    if ((h === null || typeof h > "u") && c !== "" || c !== h) {
      if (c && s)
        switch (f = o.fromFormat(String(c), "hh:mm"), s) {
          case !0:
            c = f;
            break;
          case "iso":
            c = f.toISO();
            break;
          default:
            c = f.toFormat(s);
        }
      t(c) && (h = u.value);
    } else
      i();
  }
  return u.addEventListener("blur", function(c) {
    (c.relatedTarget || c.rangeParent || c.explicitOriginalTarget !== u) && d();
  }), u.addEventListener("keydown", function(c) {
    switch (c.keyCode) {
      case 13:
        d();
        break;
      case 27:
        i();
        break;
      case 35:
      case 36:
        c.stopPropagation();
        break;
      case 38:
      case 40:
        a == "editor" && (c.stopImmediatePropagation(), c.stopPropagation());
        break;
    }
  }), u;
}
function $b(r, e, t, i, n) {
  var s = n.format, a = n.verticalNavigation || "editor", o = s ? this.table.dependencyRegistry.lookup(["luxon", "DateTime"], "DateTime") : null, l, h = r.getValue(), u = document.createElement("input");
  if (u.type = "datetime-local", u.style.padding = "4px", u.style.width = "100%", u.style.boxSizing = "border-box", n.elementAttributes && typeof n.elementAttributes == "object")
    for (let c in n.elementAttributes)
      c.charAt(0) == "+" ? (c = c.slice(1), u.setAttribute(c, u.getAttribute(c) + n.elementAttributes["+" + c])) : u.setAttribute(c, n.elementAttributes[c]);
  h = typeof h < "u" ? h : "", s && (o ? (o.isDateTime(h) ? l = h : s === "iso" ? l = o.fromISO(String(h)) : l = o.fromFormat(String(h), s), h = l.toFormat("yyyy-MM-dd") + "T" + l.toFormat("HH:mm")) : console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")), u.value = h, e(function() {
    r.getType() === "cell" && (u.focus({ preventScroll: !0 }), u.style.height = "100%", n.selectContents && u.select());
  });
  function d() {
    var c = u.value, f;
    if ((h === null || typeof h > "u") && c !== "" || c !== h) {
      if (c && s)
        switch (f = o.fromISO(String(c)), s) {
          case !0:
            c = f;
            break;
          case "iso":
            c = f.toISO();
            break;
          default:
            c = f.toFormat(s);
        }
      t(c) && (h = u.value);
    } else
      i();
  }
  return u.addEventListener("blur", function(c) {
    (c.relatedTarget || c.rangeParent || c.explicitOriginalTarget !== u) && d();
  }), u.addEventListener("keydown", function(c) {
    switch (c.keyCode) {
      case 13:
        d();
        break;
      case 27:
        i();
        break;
      case 35:
      case 36:
        c.stopPropagation();
        break;
      case 38:
      case 40:
        a == "editor" && (c.stopImmediatePropagation(), c.stopPropagation());
        break;
    }
  }), u;
}
let qb = class {
  constructor(e, t, i, n, s, a) {
    this.edit = e, this.table = e.table, this.cell = t, this.params = this._initializeParams(a), this.data = [], this.displayItems = [], this.currentItems = [], this.focusedItem = null, this.input = this._createInputElement(), this.listEl = this._createListElement(), this.initialValues = null, this.isFilter = t.getType() === "header", this.filterTimeout = null, this.filtered = !1, this.typing = !1, this.values = [], this.popup = null, this.listIteration = 0, this.lastAction = "", this.filterTerm = "", this.blurable = !0, this.actions = {
      success: n,
      cancel: s
    }, this._deprecatedOptionsCheck(), this._initializeValue(), i(this._onRendered.bind(this));
  }
  _deprecatedOptionsCheck() {
  }
  _initializeValue() {
    var e = this.cell.getValue();
    typeof e > "u" && typeof this.params.defaultValue < "u" && (e = this.params.defaultValue), this.initialValues = this.params.multiselect ? e : [e], this.isFilter && (this.input.value = this.initialValues ? this.initialValues.join(",") : "", this.headerFilterInitialListGen());
  }
  _onRendered() {
    var e = this.cell.getElement();
    function t(i) {
      i.stopPropagation();
    }
    this.isFilter || (this.input.style.height = "100%", this.input.focus({ preventScroll: !0 })), e.addEventListener("click", t), setTimeout(() => {
      e.removeEventListener("click", t);
    }, 1e3), this.input.addEventListener("mousedown", this._preventPopupBlur.bind(this));
  }
  _createListElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-edit-list"), e.addEventListener("mousedown", this._preventBlur.bind(this)), e.addEventListener("keydown", this._inputKeyDown.bind(this)), e;
  }
  _setListWidth() {
    var e = this.isFilter ? this.input : this.cell.getElement();
    this.listEl.style.minWidth = e.offsetWidth + "px", this.params.maxWidth && (this.params.maxWidth === !0 ? this.listEl.style.maxWidth = e.offsetWidth + "px" : typeof this.params.maxWidth == "number" ? this.listEl.style.maxWidth = this.params.maxWidth + "px" : this.listEl.style.maxWidth = this.params.maxWidth);
  }
  _createInputElement() {
    var e = this.params.elementAttributes, t = document.createElement("input");
    if (t.setAttribute("type", this.params.clearable ? "search" : "text"), t.style.padding = "4px", t.style.width = "100%", t.style.boxSizing = "border-box", this.params.autocomplete || (t.style.cursor = "default", t.style.caretColor = "transparent"), e && typeof e == "object")
      for (let i in e)
        i.charAt(0) == "+" ? (i = i.slice(1), t.setAttribute(i, t.getAttribute(i) + e["+" + i])) : t.setAttribute(i, e[i]);
    return this.params.mask && Xa(t, this.params), this._bindInputEvents(t), t;
  }
  _initializeParams(e) {
    var t = ["values", "valuesURL", "valuesLookup"], i;
    return e = Object.assign({}, e), e.verticalNavigation = e.verticalNavigation || "editor", e.placeholderLoading = typeof e.placeholderLoading > "u" ? "Searching ..." : e.placeholderLoading, e.placeholderEmpty = typeof e.placeholderEmpty > "u" ? "No Results Found" : e.placeholderEmpty, e.filterDelay = typeof e.filterDelay > "u" ? 300 : e.filterDelay, e.emptyValue = Object.keys(e).includes("emptyValue") ? e.emptyValue : "", i = Object.keys(e).filter((n) => t.includes(n)).length, i ? i > 1 && console.warn("list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor") : console.warn("list editor config error - either the values, valuesURL, or valuesLookup option must be set"), e.autocomplete ? e.multiselect && (e.multiselect = !1, console.warn("list editor config error - multiselect option is not available when autocomplete is enabled")) : (e.freetext && (e.freetext = !1, console.warn("list editor config error - freetext option is only available when autocomplete is enabled")), e.filterFunc && (e.filterFunc = !1, console.warn("list editor config error - filterFunc option is only available when autocomplete is enabled")), e.filterRemote && (e.filterRemote = !1, console.warn("list editor config error - filterRemote option is only available when autocomplete is enabled")), e.mask && (e.mask = !1, console.warn("list editor config error - mask option is only available when autocomplete is enabled")), e.allowEmpty && (e.allowEmpty = !1, console.warn("list editor config error - allowEmpty option is only available when autocomplete is enabled")), e.listOnEmpty && (e.listOnEmpty = !1, console.warn("list editor config error - listOnEmpty option is only available when autocomplete is enabled"))), e.filterRemote && !(typeof e.valuesLookup == "function" || e.valuesURL) && (e.filterRemote = !1, console.warn("list editor config error - filterRemote option should only be used when values list is populated from a remote source")), e;
  }
  //////////////////////////////////////
  ////////// Event Handling ////////////
  //////////////////////////////////////
  _bindInputEvents(e) {
    e.addEventListener("focus", this._inputFocus.bind(this)), e.addEventListener("click", this._inputClick.bind(this)), e.addEventListener("blur", this._inputBlur.bind(this)), e.addEventListener("keydown", this._inputKeyDown.bind(this)), e.addEventListener("search", this._inputSearch.bind(this)), this.params.autocomplete && e.addEventListener("keyup", this._inputKeyUp.bind(this));
  }
  _inputFocus(e) {
    this.rebuildOptionsList();
  }
  _filter() {
    this.params.filterRemote ? (clearTimeout(this.filterTimeout), this.filterTimeout = setTimeout(() => {
      this.rebuildOptionsList();
    }, this.params.filterDelay)) : this._filterList();
  }
  _inputClick(e) {
    e.stopPropagation();
  }
  _inputBlur(e) {
    this.blurable && (this.popup ? this.popup.hide() : this._resolveValue(!0));
  }
  _inputSearch() {
    this._clearChoices();
  }
  _inputKeyDown(e) {
    switch (e.keyCode) {
      case 38:
        this._keyUp(e);
        break;
      case 40:
        this._keyDown(e);
        break;
      case 37:
      case 39:
        this._keySide(e);
        break;
      case 13:
        this._keyEnter();
        break;
      case 27:
        this._keyEsc();
        break;
      case 36:
      case 35:
        this._keyHomeEnd(e);
        break;
      case 9:
        this._keyTab(e);
        break;
      default:
        this._keySelectLetter(e);
    }
  }
  _inputKeyUp(e) {
    switch (e.keyCode) {
      case 38:
      case 37:
      case 39:
      case 40:
      case 13:
      case 27:
        break;
      default:
        this._keyAutoCompLetter(e);
    }
  }
  _preventPopupBlur() {
    this.popup && this.popup.blockHide(), setTimeout(() => {
      this.popup && this.popup.restoreHide();
    }, 10);
  }
  _preventBlur() {
    this.blurable = !1, setTimeout(() => {
      this.blurable = !0;
    }, 10);
  }
  //////////////////////////////////////
  //////// Keyboard Navigation /////////
  //////////////////////////////////////
  _keyTab(e) {
    this.params.autocomplete && this.lastAction === "typing" ? this._resolveValue(!0) : this.focusedItem && this._chooseItem(this.focusedItem, !0);
  }
  _keyUp(e) {
    var t = this.displayItems.indexOf(this.focusedItem);
    (this.params.verticalNavigation == "editor" || this.params.verticalNavigation == "hybrid" && t) && (e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault(), t > 0 && this._focusItem(this.displayItems[t - 1]));
  }
  _keyDown(e) {
    var t = this.displayItems.indexOf(this.focusedItem);
    (this.params.verticalNavigation == "editor" || this.params.verticalNavigation == "hybrid" && t < this.displayItems.length - 1) && (e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault(), t < this.displayItems.length - 1 && (t == -1 ? this._focusItem(this.displayItems[0]) : this._focusItem(this.displayItems[t + 1])));
  }
  _keySide(e) {
    this.params.autocomplete || (e.stopImmediatePropagation(), e.stopPropagation(), e.preventDefault());
  }
  _keyEnter(e) {
    this.params.autocomplete && this.lastAction === "typing" ? this._resolveValue(!0) : this.focusedItem && this._chooseItem(this.focusedItem);
  }
  _keyEsc(e) {
    this._cancel();
  }
  _keyHomeEnd(e) {
    this.params.autocomplete && e.stopImmediatePropagation();
  }
  _keySelectLetter(e) {
    this.params.autocomplete || (e.preventDefault(), e.keyCode >= 38 && e.keyCode <= 90 && this._scrollToValue(e.keyCode));
  }
  _keyAutoCompLetter(e) {
    this._filter(), this.lastAction = "typing", this.typing = !0;
  }
  _scrollToValue(e) {
    clearTimeout(this.filterTimeout);
    var t = String.fromCharCode(e).toLowerCase();
    this.filterTerm += t.toLowerCase();
    var i = this.displayItems.find((n) => typeof n.label < "u" && n.label.toLowerCase().startsWith(this.filterTerm));
    i && this._focusItem(i), this.filterTimeout = setTimeout(() => {
      this.filterTerm = "";
    }, 800);
  }
  _focusItem(e) {
    this.lastAction = "focus", this.focusedItem && this.focusedItem.element && this.focusedItem.element.classList.remove("focused"), this.focusedItem = e, e && e.element && (e.element.classList.add("focused"), e.element.scrollIntoView({ behavior: "smooth", block: "nearest", inline: "start" }));
  }
  //////////////////////////////////////
  /////// Data List Generation /////////
  //////////////////////////////////////
  headerFilterInitialListGen() {
    this._generateOptions(!0);
  }
  rebuildOptionsList() {
    this._generateOptions().then(this._sortOptions.bind(this)).then(this._buildList.bind(this)).then(this._showList.bind(this)).catch((e) => {
      Number.isInteger(e) || console.error("List generation error", e);
    });
  }
  _filterList() {
    this._buildList(this._filterOptions()), this._showList();
  }
  _generateOptions(e) {
    var t = [], i = ++this.listIteration;
    return this.filtered = !1, this.params.values ? t = this.params.values : this.params.valuesURL ? t = this._ajaxRequest(this.params.valuesURL, this.input.value) : typeof this.params.valuesLookup == "function" ? t = this.params.valuesLookup(this.cell, this.input.value) : this.params.valuesLookup && (t = this._uniqueColumnValues(this.params.valuesLookupField)), t instanceof Promise ? (e || this._addPlaceholder(this.params.placeholderLoading), t.then().then((n) => this.listIteration === i ? this._parseList(n) : Promise.reject(i))) : Promise.resolve(this._parseList(t));
  }
  _addPlaceholder(e) {
    var t = document.createElement("div");
    typeof e == "function" && (e = e(this.cell.getComponent(), this.listEl)), e && (this._clearList(), e instanceof HTMLElement ? t = e : (t.classList.add("tabulator-edit-list-placeholder"), t.innerHTML = e), this.listEl.appendChild(t), this._showList());
  }
  _ajaxRequest(e, t) {
    var i = this.params.filterRemote ? { term: t } : {};
    return e = Dp(e, {}, i), fetch(e).then((n) => n.ok ? n.json().catch((s) => (console.warn("List Ajax Load Error - Invalid JSON returned", s), Promise.reject(s))) : (console.error("List Ajax Load Error - Connection Error: " + n.status, n.statusText), Promise.reject(n))).catch((n) => (console.error("List Ajax Load Error - Connection Error: ", n), Promise.reject(n)));
  }
  _uniqueColumnValues(e) {
    var t = {}, i = this.table.getData(this.params.valuesLookup), n;
    return e ? n = this.table.columnManager.getColumnByField(e) : n = this.cell.getColumn()._getSelf(), n ? i.forEach((s) => {
      var a = n.getFieldValue(s);
      this._emptyValueCheck(a) || (this.params.multiselect && Array.isArray(a) ? a.forEach((o) => {
        this._emptyValueCheck(o) || (t[o] = !0);
      }) : t[a] = !0);
    }) : (console.warn("unable to find matching column to create select lookup list:", e), t = []), Object.keys(t);
  }
  _emptyValueCheck(e) {
    return e === null || typeof e > "u" || e === "";
  }
  _parseList(e) {
    var t = [];
    return Array.isArray(e) || (e = Object.entries(e).map(([i, n]) => ({
      label: n,
      value: i
    }))), e.forEach((i) => {
      typeof i != "object" && (i = {
        label: i,
        value: i
      }), this._parseListItem(i, t, 0);
    }), !this.currentItems.length && this.params.freetext && (this.input.value = this.initialValues, this.typing = !0, this.lastAction = "typing"), this.data = t, t;
  }
  _parseListItem(e, t, i) {
    var n = {};
    e.options ? n = this._parseListGroup(e, i + 1) : (n = {
      label: e.label,
      value: e.value,
      itemParams: e.itemParams,
      elementAttributes: e.elementAttributes,
      element: !1,
      selected: !1,
      visible: !0,
      level: i,
      original: e
    }, this.initialValues && this.initialValues.indexOf(e.value) > -1 && this._chooseItem(n, !0)), t.push(n);
  }
  _parseListGroup(e, t) {
    var i = {
      label: e.label,
      group: !0,
      itemParams: e.itemParams,
      elementAttributes: e.elementAttributes,
      element: !1,
      visible: !0,
      level: t,
      options: [],
      original: e
    };
    return e.options.forEach((n) => {
      this._parseListItem(n, i.options, t);
    }), i;
  }
  _sortOptions(e) {
    var t;
    return this.params.sort && (t = typeof this.params.sort == "function" ? this.params.sort : this._defaultSortFunction.bind(this), this._sortGroup(t, e)), e;
  }
  _sortGroup(e, t) {
    t.sort((i, n) => e(i.label, n.label, i.value, n.value, i.original, n.original)), t.forEach((i) => {
      i.group && this._sortGroup(e, i.options);
    });
  }
  _defaultSortFunction(e, t) {
    var i, n, s, a, o = 0, l, h = /(\d+)|(\D+)/g, u = /\d/, d = 0;
    if (this.params.sort === "desc" && ([e, t] = [t, e]), !e && e !== 0)
      d = !t && t !== 0 ? 0 : -1;
    else if (!t && t !== 0)
      d = 1;
    else {
      if (isFinite(e) && isFinite(t)) return e - t;
      if (i = String(e).toLowerCase(), n = String(t).toLowerCase(), i === n) return 0;
      if (!(u.test(i) && u.test(n))) return i > n ? 1 : -1;
      for (i = i.match(h), n = n.match(h), l = i.length > n.length ? n.length : i.length; o < l; )
        if (s = i[o], a = n[o++], s !== a)
          return isFinite(s) && isFinite(a) ? (s.charAt(0) === "0" && (s = "." + s), a.charAt(0) === "0" && (a = "." + a), s - a) : s > a ? 1 : -1;
      return i.length > n.length;
    }
    return d;
  }
  _filterOptions() {
    var e = this.params.filterFunc || this._defaultFilterFunc, t = this.input.value;
    return t ? (this.filtered = !0, this.data.forEach((i) => {
      this._filterItem(e, t, i);
    })) : this.filtered = !1, this.data;
  }
  _filterItem(e, t, i) {
    var n = !1;
    return i.group ? (i.options.forEach((s) => {
      this._filterItem(e, t, s) && (n = !0);
    }), i.visible = n) : i.visible = e(t, i.label, i.value, i.original), i.visible;
  }
  _defaultFilterFunc(e, t, i, n) {
    return e = String(e).toLowerCase(), t !== null && typeof t < "u" && (String(t).toLowerCase().indexOf(e) > -1 || String(i).toLowerCase().indexOf(e) > -1);
  }
  //////////////////////////////////////
  /////////// Display List /////////////
  //////////////////////////////////////
  _clearList() {
    for (; this.listEl.firstChild; ) this.listEl.removeChild(this.listEl.firstChild);
    this.displayItems = [];
  }
  _buildList(e) {
    this._clearList(), e.forEach((t) => {
      this._buildItem(t);
    }), this.displayItems.length || this._addPlaceholder(this.params.placeholderEmpty);
  }
  _buildItem(e) {
    var t = e.element, i;
    if (!this.filtered || e.visible) {
      if (!t) {
        if (t = document.createElement("div"), t.tabIndex = 0, i = this.params.itemFormatter ? this.params.itemFormatter(e.label, e.value, e.original, t) : e.label, i instanceof HTMLElement ? t.appendChild(i) : t.innerHTML = i, e.group ? t.classList.add("tabulator-edit-list-group") : t.classList.add("tabulator-edit-list-item"), t.classList.add("tabulator-edit-list-group-level-" + e.level), e.elementAttributes && typeof e.elementAttributes == "object")
          for (let n in e.elementAttributes)
            n.charAt(0) == "+" ? (n = n.slice(1), t.setAttribute(n, this.input.getAttribute(n) + e.elementAttributes["+" + n])) : t.setAttribute(n, e.elementAttributes[n]);
        e.group ? t.addEventListener("click", this._groupClick.bind(this, e)) : t.addEventListener("click", this._itemClick.bind(this, e)), t.addEventListener("mousedown", this._preventBlur.bind(this)), e.element = t;
      }
      this._styleItem(e), this.listEl.appendChild(t), e.group ? e.options.forEach((n) => {
        this._buildItem(n);
      }) : this.displayItems.push(e);
    }
  }
  _showList() {
    var e = this.popup && this.popup.isVisible();
    if (this.input.parentNode) {
      if (this.params.autocomplete && this.input.value === "" && !this.params.listOnEmpty) {
        this.popup && this.popup.hide(!0);
        return;
      }
      this._setListWidth(), this.popup || (this.popup = this.edit.popup(this.listEl)), this.popup.show(this.cell.getElement(), "bottom"), e || setTimeout(() => {
        this.popup.hideOnBlur(this._resolveValue.bind(this, !0));
      }, 10);
    }
  }
  _styleItem(e) {
    e && e.element && (e.selected ? e.element.classList.add("active") : e.element.classList.remove("active"));
  }
  //////////////////////////////////////
  ///////// User Interaction ///////////
  //////////////////////////////////////
  _itemClick(e, t) {
    t.stopPropagation(), this._chooseItem(e);
  }
  _groupClick(e, t) {
    t.stopPropagation();
  }
  //////////////////////////////////////
  ////// Current Item Management ///////
  //////////////////////////////////////
  _cancel() {
    this.popup.hide(!0), this.actions.cancel();
  }
  _clearChoices() {
    this.typing = !0, this.currentItems.forEach((e) => {
      e.selected = !1, this._styleItem(e);
    }), this.currentItems = [], this.focusedItem = null;
  }
  _chooseItem(e, t) {
    var i;
    this.typing = !1, this.params.multiselect ? (i = this.currentItems.indexOf(e), i > -1 ? (this.currentItems.splice(i, 1), e.selected = !1) : (this.currentItems.push(e), e.selected = !0), this.input.value = this.currentItems.map((n) => n.label).join(","), this._styleItem(e)) : (this.currentItems = [e], e.selected = !0, this.input.value = e.label, this._styleItem(e), t || this._resolveValue()), this._focusItem(e);
  }
  _resolveValue(e) {
    var t, i;
    if (this.popup && this.popup.hide(!0), this.params.multiselect)
      t = this.currentItems.map((n) => n.value);
    else if (e && this.params.autocomplete && this.typing)
      if (this.params.freetext || this.params.allowEmpty && this.input.value === "")
        t = this.input.value;
      else {
        this.actions.cancel();
        return;
      }
    else
      this.currentItems[0] ? t = this.currentItems[0].value : (i = Array.isArray(this.initialValues) ? this.initialValues[0] : this.initialValues, i === null || typeof i > "u" || i === "" ? t = i : t = this.params.emptyValue);
    t === "" && (t = this.params.emptyValue), this.actions.success(t), this.isFilter && (this.initialValues = t && !Array.isArray(t) ? [t] : t, this.currentItems = []);
  }
};
function Kb(r, e, t, i, n) {
  var s = new qb(this, r, e, t, i, n);
  return s.input;
}
function Zb(r, e, t, i, n) {
  var s = this, a = r.getElement(), o = r.getValue(), l = a.getElementsByTagName("svg").length || 5, h = a.getElementsByTagName("svg")[0] ? a.getElementsByTagName("svg")[0].getAttribute("width") : 14, u = [], d = document.createElement("div"), c = document.createElementNS("http://www.w3.org/2000/svg", "svg");
  function f(v) {
    u.forEach(function(b, y) {
      y < v ? (s.table.browser == "ie" ? b.setAttribute("class", "tabulator-star-active") : b.classList.replace("tabulator-star-inactive", "tabulator-star-active"), b.innerHTML = '<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>') : (s.table.browser == "ie" ? b.setAttribute("class", "tabulator-star-inactive") : b.classList.replace("tabulator-star-active", "tabulator-star-inactive"), b.innerHTML = '<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>');
    });
  }
  function p(v) {
    var b = document.createElement("span"), y = c.cloneNode(!0);
    u.push(y), b.addEventListener("mouseenter", function(w) {
      w.stopPropagation(), w.stopImmediatePropagation(), f(v);
    }), b.addEventListener("mousemove", function(w) {
      w.stopPropagation(), w.stopImmediatePropagation();
    }), b.addEventListener("click", function(w) {
      w.stopPropagation(), w.stopImmediatePropagation(), t(v), a.blur();
    }), b.appendChild(y), d.appendChild(b);
  }
  function m(v) {
    o = v, f(v);
  }
  if (a.style.whiteSpace = "nowrap", a.style.overflow = "hidden", a.style.textOverflow = "ellipsis", d.style.verticalAlign = "middle", d.style.display = "inline-block", d.style.padding = "4px", c.setAttribute("width", h), c.setAttribute("height", h), c.setAttribute("viewBox", "0 0 512 512"), c.setAttribute("xml:space", "preserve"), c.style.padding = "0 1px", n.elementAttributes && typeof n.elementAttributes == "object")
    for (let v in n.elementAttributes)
      v.charAt(0) == "+" ? (v = v.slice(1), d.setAttribute(v, d.getAttribute(v) + n.elementAttributes["+" + v])) : d.setAttribute(v, n.elementAttributes[v]);
  for (var g = 1; g <= l; g++)
    p(g);
  return o = Math.min(parseInt(o), l), f(o), d.addEventListener("mousemove", function(v) {
    f(0);
  }), d.addEventListener("click", function(v) {
    t(0);
  }), a.addEventListener("blur", function(v) {
    i();
  }), a.addEventListener("keydown", function(v) {
    switch (v.keyCode) {
      case 39:
        m(o + 1);
        break;
      case 37:
        m(o - 1);
        break;
      case 13:
        t(o);
        break;
      case 27:
        i();
        break;
    }
  }), d;
}
function Jb(r, e, t, i, n) {
  var s = r.getElement(), a = typeof n.max > "u" ? s.getElementsByTagName("div")[0] && s.getElementsByTagName("div")[0].getAttribute("max") || 100 : n.max, o = typeof n.min > "u" ? s.getElementsByTagName("div")[0] && s.getElementsByTagName("div")[0].getAttribute("min") || 0 : n.min, l = (a - o) / 100, h = r.getValue() || 0, u = document.createElement("div"), d = document.createElement("div"), c, f;
  function p() {
    var m = window.getComputedStyle(s, null), g = l * Math.round(d.offsetWidth / ((s.clientWidth - parseInt(m.getPropertyValue("padding-left")) - parseInt(m.getPropertyValue("padding-right"))) / 100)) + o;
    t(g), s.setAttribute("aria-valuenow", g), s.setAttribute("aria-label", h);
  }
  if (u.style.position = "absolute", u.style.right = "0", u.style.top = "0", u.style.bottom = "0", u.style.width = "5px", u.classList.add("tabulator-progress-handle"), d.style.display = "inline-block", d.style.position = "relative", d.style.height = "100%", d.style.backgroundColor = "#488CE9", d.style.maxWidth = "100%", d.style.minWidth = "0%", n.elementAttributes && typeof n.elementAttributes == "object")
    for (let m in n.elementAttributes)
      m.charAt(0) == "+" ? (m = m.slice(1), d.setAttribute(m, d.getAttribute(m) + n.elementAttributes["+" + m])) : d.setAttribute(m, n.elementAttributes[m]);
  return s.style.padding = "4px 4px", h = Math.min(parseFloat(h), a), h = Math.max(parseFloat(h), o), h = Math.round((h - o) / l), d.style.width = h + "%", s.setAttribute("aria-valuemin", o), s.setAttribute("aria-valuemax", a), d.appendChild(u), u.addEventListener("mousedown", function(m) {
    c = m.screenX, f = d.offsetWidth;
  }), u.addEventListener("mouseover", function() {
    u.style.cursor = "ew-resize";
  }), s.addEventListener("mousemove", function(m) {
    c && (d.style.width = f + m.screenX - c + "px");
  }), s.addEventListener("mouseup", function(m) {
    c && (m.stopPropagation(), m.stopImmediatePropagation(), c = !1, f = !1, p());
  }), s.addEventListener("keydown", function(m) {
    switch (m.keyCode) {
      case 39:
        m.preventDefault(), d.style.width = d.clientWidth + s.clientWidth / 100 + "px";
        break;
      case 37:
        m.preventDefault(), d.style.width = d.clientWidth - s.clientWidth / 100 + "px";
        break;
      case 9:
      case 13:
        p();
        break;
      case 27:
        i();
        break;
    }
  }), s.addEventListener("blur", function() {
    i();
  }), d;
}
function Qb(r, e, t, i, n) {
  var s = r.getValue(), a = document.createElement("input"), o = n.tristate, l = typeof n.indeterminateValue > "u" ? null : n.indeterminateValue, h = !1, u = Object.keys(n).includes("trueValue"), d = Object.keys(n).includes("falseValue");
  if (a.setAttribute("type", "checkbox"), a.style.marginTop = "5px", a.style.boxSizing = "border-box", n.elementAttributes && typeof n.elementAttributes == "object")
    for (let f in n.elementAttributes)
      f.charAt(0) == "+" ? (f = f.slice(1), a.setAttribute(f, a.getAttribute(f) + n.elementAttributes["+" + f])) : a.setAttribute(f, n.elementAttributes[f]);
  a.value = s, o && (typeof s > "u" || s === l || s === "") && (h = !0, a.indeterminate = !0), this.table.browser != "firefox" && this.table.browser != "safari" && e(function() {
    r.getType() === "cell" && a.focus({ preventScroll: !0 });
  }), a.checked = u ? s === n.trueValue : s === !0 || s === "true" || s === "True" || s === 1;
  function c(f) {
    var p = a.checked;
    return u && p ? p = n.trueValue : d && !p && (p = n.falseValue), o ? f ? h ? l : p : a.checked && !h ? (a.checked = !1, a.indeterminate = !0, h = !0, l) : (h = !1, p) : p;
  }
  return a.addEventListener("change", function(f) {
    t(c());
  }), a.addEventListener("blur", function(f) {
    t(c(!0));
  }), a.addEventListener("keydown", function(f) {
    f.keyCode == 13 && t(c()), f.keyCode == 27 && i();
  }), a;
}
function ey(r, e, t, i, n) {
  var s = r._getSelf().column, a, o, l;
  function h(u) {
    var d = u.getValue(), c = "input";
    switch (typeof d) {
      case "number":
        c = "number";
        break;
      case "boolean":
        c = "tickCross";
        break;
      case "string":
        d.includes(`
`) && (c = "textarea");
        break;
    }
    return c;
  }
  return a = n.editorLookup ? n.editorLookup(r) : h(r), n.paramsLookup && (l = typeof n.paramsLookup == "function" ? n.paramsLookup(a, r) : n.paramsLookup[a]), o = this.table.modules.edit.lookupEditor(a, s), o.call(this, r, e, t, i, l || {});
}
var ty = {
  input: Wb,
  textarea: Gb,
  number: Ub,
  range: jb,
  date: Yb,
  time: Xb,
  datetime: $b,
  list: Kb,
  star: Zb,
  progress: Jb,
  tickCross: Qb,
  adaptable: ey
};
const Qn = class Qn extends U {
  constructor(e) {
    super(e), this.currentCell = !1, this.mouseClick = !1, this.recursionBlock = !1, this.invalidEdit = !1, this.editedCells = [], this.convertEmptyValues = !1, this.editors = Qn.editors, this.registerTableOption("editTriggerEvent", "focus"), this.registerTableOption("editorEmptyValue"), this.registerTableOption("editorEmptyValueFunc", this.emptyValueCheck.bind(this)), this.registerColumnOption("editable"), this.registerColumnOption("editor"), this.registerColumnOption("editorParams"), this.registerColumnOption("editorEmptyValue"), this.registerColumnOption("editorEmptyValueFunc"), this.registerColumnOption("cellEditing"), this.registerColumnOption("cellEdited"), this.registerColumnOption("cellEditCancelled"), this.registerTableFunction("getEditedCells", this.getEditedCells.bind(this)), this.registerTableFunction("clearCellEdited", this.clearCellEdited.bind(this)), this.registerTableFunction("navigatePrev", this.navigatePrev.bind(this)), this.registerTableFunction("navigateNext", this.navigateNext.bind(this)), this.registerTableFunction("navigateLeft", this.navigateLeft.bind(this)), this.registerTableFunction("navigateRight", this.navigateRight.bind(this)), this.registerTableFunction("navigateUp", this.navigateUp.bind(this)), this.registerTableFunction("navigateDown", this.navigateDown.bind(this)), this.registerComponentFunction("cell", "isEdited", this.cellIsEdited.bind(this)), this.registerComponentFunction("cell", "clearEdited", this.clearEdited.bind(this)), this.registerComponentFunction("cell", "edit", this.editCell.bind(this)), this.registerComponentFunction("cell", "cancelEdit", this.cellCancelEdit.bind(this)), this.registerComponentFunction("cell", "navigatePrev", this.navigatePrev.bind(this)), this.registerComponentFunction("cell", "navigateNext", this.navigateNext.bind(this)), this.registerComponentFunction("cell", "navigateLeft", this.navigateLeft.bind(this)), this.registerComponentFunction("cell", "navigateRight", this.navigateRight.bind(this)), this.registerComponentFunction("cell", "navigateUp", this.navigateUp.bind(this)), this.registerComponentFunction("cell", "navigateDown", this.navigateDown.bind(this));
  }
  initialize() {
    this.subscribe("cell-init", this.bindEditor.bind(this)), this.subscribe("cell-delete", this.clearEdited.bind(this)), this.subscribe("cell-value-changed", this.updateCellClass.bind(this)), this.subscribe("column-layout", this.initializeColumnCheck.bind(this)), this.subscribe("column-delete", this.columnDeleteCheck.bind(this)), this.subscribe("row-deleting", this.rowDeleteCheck.bind(this)), this.subscribe("row-layout", this.rowEditableCheck.bind(this)), this.subscribe("data-refreshing", this.cancelEdit.bind(this)), this.subscribe("clipboard-paste", this.pasteBlocker.bind(this)), this.subscribe("keybinding-nav-prev", this.navigatePrev.bind(this, void 0)), this.subscribe("keybinding-nav-next", this.keybindingNavigateNext.bind(this)), this.subscribe("keybinding-nav-up", this.navigateUp.bind(this, void 0)), this.subscribe("keybinding-nav-down", this.navigateDown.bind(this, void 0)), Object.keys(this.table.options).includes("editorEmptyValue") && (this.convertEmptyValues = !0);
  }
  ///////////////////////////////////
  ///////// Paste Negation //////////
  ///////////////////////////////////
  pasteBlocker(e) {
    if (this.currentCell)
      return !0;
  }
  ///////////////////////////////////
  ////// Keybinding Functions ///////
  ///////////////////////////////////
  keybindingNavigateNext(e) {
    var t = this.currentCell, i = this.options("tabEndNewRow");
    t && (this.navigateNext(t, e) || i && (t.getElement().firstChild.blur(), this.invalidEdit || (i === !0 ? i = this.table.addRow({}) : typeof i == "function" ? i = this.table.addRow(i(t.row.getComponent())) : i = this.table.addRow(Object.assign({}, i)), i.then(() => {
      setTimeout(() => {
        t.getComponent().navigateNext();
      });
    }))));
  }
  ///////////////////////////////////
  ///////// Cell Functions //////////
  ///////////////////////////////////
  cellIsEdited(e) {
    return !!e.modules.edit && e.modules.edit.edited;
  }
  cellCancelEdit(e) {
    e === this.currentCell ? this.table.modules.edit.cancelEdit() : console.warn("Cancel Editor Error - This cell is not currently being edited ");
  }
  ///////////////////////////////////
  ///////// Table Functions /////////
  ///////////////////////////////////
  updateCellClass(e) {
    this.allowEdit(e) ? e.getElement().classList.add("tabulator-editable") : e.getElement().classList.remove("tabulator-editable");
  }
  clearCellEdited(e) {
    e || (e = this.table.modules.edit.getEditedCells()), Array.isArray(e) || (e = [e]), e.forEach((t) => {
      this.table.modules.edit.clearEdited(t._getSelf());
    });
  }
  navigatePrev(e = this.currentCell, t) {
    var i, n;
    if (e) {
      if (t && t.preventDefault(), i = this.navigateLeft(), i)
        return !0;
      if (n = this.table.rowManager.prevDisplayRow(e.row, !0), n && (i = this.findPrevEditableCell(n, n.cells.length), i))
        return i.getComponent().edit(), !0;
    }
    return !1;
  }
  navigateNext(e = this.currentCell, t) {
    var i, n;
    if (e) {
      if (t && t.preventDefault(), i = this.navigateRight(), i)
        return !0;
      if (n = this.table.rowManager.nextDisplayRow(e.row, !0), n && (i = this.findNextEditableCell(n, -1), i))
        return i.getComponent().edit(), !0;
    }
    return !1;
  }
  navigateLeft(e = this.currentCell, t) {
    var i, n;
    return e && (t && t.preventDefault(), i = e.getIndex(), n = this.findPrevEditableCell(e.row, i), n) ? (n.getComponent().edit(), !0) : !1;
  }
  navigateRight(e = this.currentCell, t) {
    var i, n;
    return e && (t && t.preventDefault(), i = e.getIndex(), n = this.findNextEditableCell(e.row, i), n) ? (n.getComponent().edit(), !0) : !1;
  }
  navigateUp(e = this.currentCell, t) {
    var i, n;
    return e && (t && t.preventDefault(), i = e.getIndex(), n = this.table.rowManager.prevDisplayRow(e.row, !0), n) ? (n.cells[i].getComponent().edit(), !0) : !1;
  }
  navigateDown(e = this.currentCell, t) {
    var i, n;
    return e && (t && t.preventDefault(), i = e.getIndex(), n = this.table.rowManager.nextDisplayRow(e.row, !0), n) ? (n.cells[i].getComponent().edit(), !0) : !1;
  }
  findNextEditableCell(e, t) {
    var i = !1;
    if (t < e.cells.length - 1)
      for (var n = t + 1; n < e.cells.length; n++) {
        let s = e.cells[n];
        if (s.column.modules.edit && de.elVisible(s.getElement()) && this.allowEdit(s)) {
          i = s;
          break;
        }
      }
    return i;
  }
  findPrevEditableCell(e, t) {
    var i = !1;
    if (t > 0)
      for (var n = t - 1; n >= 0; n--) {
        let s = e.cells[n];
        if (s.column.modules.edit && de.elVisible(s.getElement()) && this.allowEdit(s)) {
          i = s;
          break;
        }
      }
    return i;
  }
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  initializeColumnCheck(e) {
    typeof e.definition.editor < "u" && this.initializeColumn(e);
  }
  columnDeleteCheck(e) {
    this.currentCell && this.currentCell.column === e && this.cancelEdit();
  }
  rowDeleteCheck(e) {
    this.currentCell && this.currentCell.row === e && this.cancelEdit();
  }
  rowEditableCheck(e) {
    e.getCells().forEach((t) => {
      t.column.modules.edit && typeof t.column.modules.edit.check == "function" && this.updateCellClass(t);
    });
  }
  //initialize column editor
  initializeColumn(e) {
    var t = Object.keys(e.definition).includes("editorEmptyValue"), i = {
      editor: !1,
      blocked: !1,
      check: e.definition.editable,
      params: e.definition.editorParams || {},
      convertEmptyValues: t,
      editorEmptyValue: e.definition.editorEmptyValue,
      editorEmptyValueFunc: e.definition.editorEmptyValueFunc
    };
    i.editor = this.lookupEditor(e.definition.editor, e), i.editor && (e.modules.edit = i);
  }
  lookupEditor(e, t) {
    var i;
    switch (typeof e) {
      case "string":
        this.editors[e] ? i = this.editors[e] : console.warn("Editor Error - No such editor found: ", e);
        break;
      case "function":
        i = e;
        break;
      case "boolean":
        e === !0 && (typeof t.definition.formatter != "function" ? this.editors[t.definition.formatter] ? i = this.editors[t.definition.formatter] : i = this.editors.input : console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ", t.definition.formatter));
        break;
    }
    return i;
  }
  getCurrentCell() {
    return this.currentCell ? this.currentCell.getComponent() : !1;
  }
  clearEditor(e) {
    var t = this.currentCell, i;
    if (this.invalidEdit = !1, t) {
      for (this.currentCell = !1, i = t.getElement(), this.dispatch("edit-editor-clear", t, e), i.classList.remove("tabulator-editing"); i.firstChild; ) i.removeChild(i.firstChild);
      t.row.getElement().classList.remove("tabulator-editing"), t.table.element.classList.remove("tabulator-editing");
    }
  }
  cancelEdit() {
    if (this.currentCell) {
      var e = this.currentCell, t = this.currentCell.getComponent();
      this.clearEditor(!0), e.setValueActual(e.getValue()), e.cellRendered(), (e.column.definition.editor == "textarea" || e.column.definition.variableHeight) && e.row.normalizeHeight(!0), e.column.definition.cellEditCancelled && e.column.definition.cellEditCancelled.call(this.table, t), this.dispatch("edit-cancelled", e), this.dispatchExternal("cellEditCancelled", t);
    }
  }
  //return a formatted value for a cell
  bindEditor(e) {
    if (e.column.modules.edit) {
      var t = this, i = e.getElement(!0);
      this.updateCellClass(e), i.setAttribute("tabindex", 0), i.addEventListener("mousedown", function(n) {
        n.button === 2 ? n.preventDefault() : t.mouseClick = !0;
      }), this.options("editTriggerEvent") === "dblclick" && i.addEventListener("dblclick", function(n) {
        i.classList.contains("tabulator-editing") || (i.focus({ preventScroll: !0 }), t.edit(e, n, !1));
      }), (this.options("editTriggerEvent") === "focus" || this.options("editTriggerEvent") === "click") && i.addEventListener("click", function(n) {
        i.classList.contains("tabulator-editing") || (i.focus({ preventScroll: !0 }), t.edit(e, n, !1));
      }), this.options("editTriggerEvent") === "focus" && i.addEventListener("focus", function(n) {
        t.recursionBlock || t.edit(e, n, !1);
      });
    }
  }
  focusCellNoEvent(e, t) {
    this.recursionBlock = !0, t && this.table.browser === "ie" || e.getElement().focus({ preventScroll: !0 }), this.recursionBlock = !1;
  }
  editCell(e, t) {
    this.focusCellNoEvent(e), this.edit(e, !1, t);
  }
  focusScrollAdjust(e) {
    if (this.table.rowManager.getRenderMode() == "virtual") {
      var t = this.table.rowManager.element.scrollTop, i = this.table.rowManager.element.clientHeight + this.table.rowManager.element.scrollTop, n = e.row.getElement();
      n.offsetTop < t ? this.table.rowManager.element.scrollTop -= t - n.offsetTop : n.offsetTop + n.offsetHeight > i && (this.table.rowManager.element.scrollTop += n.offsetTop + n.offsetHeight - i);
      var s = this.table.rowManager.element.scrollLeft, a = this.table.rowManager.element.clientWidth + this.table.rowManager.element.scrollLeft, o = e.getElement();
      this.table.modExists("frozenColumns") && (s += parseInt(this.table.modules.frozenColumns.leftMargin || 0), a -= parseInt(this.table.modules.frozenColumns.rightMargin || 0)), this.table.options.renderHorizontal === "virtual" && (s -= parseInt(this.table.columnManager.renderer.vDomPadLeft), a -= parseInt(this.table.columnManager.renderer.vDomPadLeft)), o.offsetLeft < s ? this.table.rowManager.element.scrollLeft -= s - o.offsetLeft : o.offsetLeft + o.offsetWidth > a && (this.table.rowManager.element.scrollLeft += o.offsetLeft + o.offsetWidth - a);
    }
  }
  allowEdit(e) {
    var t = !!e.column.modules.edit;
    if (e.column.modules.edit)
      switch (typeof e.column.modules.edit.check) {
        case "function":
          e.row.initialized && (t = e.column.modules.edit.check(e.getComponent()));
          break;
        case "string":
          t = !!e.row.data[e.column.modules.edit.check];
          break;
        case "boolean":
          t = e.column.modules.edit.check;
          break;
      }
    return t;
  }
  edit(e, t, i) {
    var n = this, s = !0, a = function() {
    }, o = e.getElement(), l = !1, h, u, d;
    if (this.currentCell) {
      !this.invalidEdit && this.currentCell !== e && this.cancelEdit();
      return;
    }
    function c(v) {
      if (n.currentCell === e && !l) {
        var b = n.chain("edit-success", [e, v], !0, !0);
        return b === !0 || n.table.options.validationMode === "highlight" ? (l = !0, n.clearEditor(), e.modules.edit || (e.modules.edit = {}), e.modules.edit.edited = !0, n.editedCells.indexOf(e) == -1 && n.editedCells.push(e), v = n.transformEmptyValues(v, e), e.setValue(v, !0), b === !0) : (l = !0, n.invalidEdit = !0, n.focusCellNoEvent(e, !0), a(), setTimeout(() => {
          l = !1;
        }, 10), !1);
      }
    }
    function f() {
      n.currentCell === e && !l && n.cancelEdit();
    }
    function p(v) {
      a = v;
    }
    if (e.column.modules.edit.blocked)
      return this.mouseClick = !1, this.blur(o), !1;
    if (t && t.stopPropagation(), s = this.allowEdit(e), s || i) {
      if (n.cancelEdit(), n.currentCell = e, this.focusScrollAdjust(e), u = e.getComponent(), this.mouseClick && (this.mouseClick = !1, e.column.definition.cellClick && e.column.definition.cellClick.call(this.table, t, u)), e.column.definition.cellEditing && e.column.definition.cellEditing.call(this.table, u), this.dispatch("cell-editing", e), this.dispatchExternal("cellEditing", u), d = typeof e.column.modules.edit.params == "function" ? e.column.modules.edit.params(u) : e.column.modules.edit.params, h = e.column.modules.edit.editor.call(n, u, p, c, f, d), this.currentCell && h !== !1)
        if (h instanceof Node) {
          for (o.classList.add("tabulator-editing"), e.row.getElement().classList.add("tabulator-editing"), e.table.element.classList.add("tabulator-editing"); o.firstChild; ) o.removeChild(o.firstChild);
          o.appendChild(h), a();
          for (var m = o.children, g = 0; g < m.length; g++)
            m[g].addEventListener("click", function(v) {
              v.stopPropagation();
            });
        } else
          return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:", h), this.blur(o), !1;
      else
        return this.blur(o), !1;
      return !0;
    } else
      return this.mouseClick = !1, this.blur(o), !1;
  }
  emptyValueCheck(e) {
    return e === "" || e === null || typeof e > "u";
  }
  transformEmptyValues(e, t) {
    var i = t.column.modules.edit, n = i.convertEmptyValues || this.convertEmptyValues, s;
    return n && (s = i.editorEmptyValueFunc || this.options("editorEmptyValueFunc"), s && s(e) && (e = i.convertEmptyValues ? i.editorEmptyValue : this.options("editorEmptyValue"))), e;
  }
  blur(e) {
    this.confirm("edit-blur", [e]) || e.blur();
  }
  getEditedCells() {
    var e = [];
    return this.editedCells.forEach((t) => {
      e.push(t.getComponent());
    }), e;
  }
  clearEdited(e) {
    var t;
    e.modules.edit && e.modules.edit.edited && (e.modules.edit.edited = !1, this.dispatch("edit-edited-clear", e)), t = this.editedCells.indexOf(e), t > -1 && this.editedCells.splice(t, 1);
  }
};
A(Qn, "moduleName", "edit"), //load defaults
A(Qn, "editors", ty);
let Gl = Qn;
class sd {
  constructor(e, t, i, n) {
    this.type = e, this.columns = t, this.component = i || !1, this.indent = n || 0;
  }
}
class bo {
  constructor(e, t, i, n, s) {
    this.value = e, this.component = t || !1, this.width = i, this.height = n, this.depth = s;
  }
}
var iy = {}, ry = {
  visible: function() {
    return this.rowManager.getVisibleRows(!1, !0);
  },
  all: function() {
    return this.rowManager.rows;
  },
  selected: function() {
    return this.modules.selectRow.selectedRows;
  },
  active: function() {
    return this.options.pagination ? this.rowManager.getDisplayRows(this.rowManager.displayRows.length - 2) : this.rowManager.getDisplayRows();
  }
};
const gi = class gi extends U {
  constructor(e) {
    super(e), this.config = {}, this.cloneTableStyle = !0, this.colVisProp = "", this.colVisPropAttach = "", this.registerTableOption("htmlOutputConfig", !1), this.registerColumnOption("htmlOutput"), this.registerColumnOption("titleHtmlOutput");
  }
  initialize() {
    this.registerTableFunction("getHtml", this.getHtml.bind(this));
  }
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  generateExportList(e, t, i, n) {
    var s, a, o, l;
    return this.cloneTableStyle = t, this.config = e || {}, this.colVisProp = n, this.colVisPropAttach = this.colVisProp.charAt(0).toUpperCase() + this.colVisProp.slice(1), l = gi.columnLookups[i], l && (o = l.call(this.table), o = o.filter((h) => this.columnVisCheck(h))), s = this.config.columnHeaders !== !1 ? this.headersToExportRows(this.generateColumnGroupHeaders(o)) : [], o && (o = o.map((h) => h.getComponent())), a = this.bodyToExportRows(this.rowLookup(i), o), s.concat(a);
  }
  generateTable(e, t, i, n) {
    var s = this.generateExportList(e, t, i, n);
    return this.generateTableElement(s);
  }
  rowLookup(e) {
    var t = [], i;
    return typeof e == "function" ? e.call(this.table).forEach((n) => {
      n = this.table.rowManager.findRow(n), n && t.push(n);
    }) : (i = gi.rowLookups[e] || gi.rowLookups.active, t = i.call(this.table)), Object.assign([], t);
  }
  generateColumnGroupHeaders(e) {
    var t = [];
    return e || (e = this.config.columnGroups !== !1 ? this.table.columnManager.columns : this.table.columnManager.columnsByIndex), e.forEach((i) => {
      var n = this.processColumnGroup(i);
      n && t.push(n);
    }), t;
  }
  processColumnGroup(e) {
    var t = e.columns, i = 0, n = e.definition["title" + this.colVisPropAttach] || e.definition.title, s = {
      title: n,
      column: e,
      depth: 1
    };
    if (t.length) {
      if (s.subGroups = [], s.width = 0, t.forEach((a) => {
        var o = this.processColumnGroup(a);
        o && (s.width += o.width, s.subGroups.push(o), o.depth > i && (i = o.depth));
      }), s.depth += i, !s.width)
        return !1;
    } else if (this.columnVisCheck(e))
      s.width = 1;
    else
      return !1;
    return s;
  }
  columnVisCheck(e) {
    var t = e.definition[this.colVisProp];
    return this.config.rowHeaders === !1 && e.isRowHeader ? !1 : (typeof t == "function" && (t = t.call(this.table, e.getComponent())), t === !1 || t === !0 ? t : e.visible && e.field);
  }
  headersToExportRows(e) {
    var t = [], i = 0, n = [];
    function s(a, o) {
      var l = i - o;
      if (typeof t[o] > "u" && (t[o] = []), a.height = a.subGroups ? 1 : l - a.depth + 1, t[o].push(a), a.height > 1)
        for (let h = 1; h < a.height; h++)
          typeof t[o + h] > "u" && (t[o + h] = []), t[o + h].push(!1);
      if (a.width > 1)
        for (let h = 1; h < a.width; h++)
          t[o].push(!1);
      a.subGroups && a.subGroups.forEach(function(h) {
        s(h, o + 1);
      });
    }
    return e.forEach(function(a) {
      a.depth > i && (i = a.depth);
    }), e.forEach(function(a) {
      s(a, 0);
    }), t.forEach((a) => {
      var o = [];
      a.forEach((l) => {
        if (l) {
          let h = typeof l.title > "u" ? "" : l.title;
          o.push(new bo(h, l.column.getComponent(), l.width, l.height, l.depth));
        } else
          o.push(null);
      }), n.push(new sd("header", o));
    }), n;
  }
  bodyToExportRows(e, t = []) {
    var i = [];
    return t.length === 0 && this.table.columnManager.columnsByIndex.forEach((n) => {
      this.columnVisCheck(n) && t.push(n.getComponent());
    }), this.config.columnCalcs !== !1 && this.table.modExists("columnCalcs") && (this.table.modules.columnCalcs.topInitialized && e.unshift(this.table.modules.columnCalcs.topRow), this.table.modules.columnCalcs.botInitialized && e.push(this.table.modules.columnCalcs.botRow)), e = e.filter((n) => {
      switch (n.type) {
        case "group":
          return this.config.rowGroups !== !1;
        case "calc":
          return this.config.columnCalcs !== !1;
        case "row":
          return !(this.table.options.dataTree && this.config.dataTree === !1 && n.modules.dataTree.parent);
      }
      return !0;
    }), e.forEach((n, s) => {
      var a = n.getData(this.colVisProp), o = [], l = 0;
      switch (n.type) {
        case "group":
          l = n.level, o.push(new bo(n.key, n.getComponent(), t.length, 1));
          break;
        case "calc":
        case "row":
          t.forEach((h) => {
            o.push(new bo(h._column.getFieldValue(a), h, 1, 1));
          }), this.table.options.dataTree && this.config.dataTree !== !1 && (l = n.modules.dataTree.index);
          break;
      }
      i.push(new sd(n.type, o, n.getComponent(), l));
    }), i;
  }
  generateTableElement(e) {
    var t = document.createElement("table"), i = document.createElement("thead"), n = document.createElement("tbody"), s = this.lookupTableStyles(), a = this.table.options["rowFormatter" + this.colVisPropAttach], o = {};
    return o.rowFormatter = a !== null ? a : this.table.options.rowFormatter, this.table.options.dataTree && this.config.dataTree !== !1 && this.table.modExists("columnCalcs") && (o.treeElementField = this.table.modules.dataTree.elementField), o.groupHeader = this.table.options["groupHeader" + this.colVisPropAttach], o.groupHeader && !Array.isArray(o.groupHeader) && (o.groupHeader = [o.groupHeader]), t.classList.add("tabulator-print-table"), this.mapElementStyles(this.table.columnManager.getHeadersElement(), i, ["border-top", "border-left", "border-right", "border-bottom", "background-color", "color", "font-weight", "font-family", "font-size"]), e.length > 1e3 && console.warn("It may take a long time to render an HTML table with more than 1000 rows"), e.forEach((l, h) => {
      let u;
      switch (l.type) {
        case "header":
          i.appendChild(this.generateHeaderElement(l, o, s));
          break;
        case "group":
          n.appendChild(this.generateGroupElement(l, o, s));
          break;
        case "calc":
          n.appendChild(this.generateCalcElement(l, o, s));
          break;
        case "row":
          u = this.generateRowElement(l, o, s), this.mapElementStyles(h % 2 && s.evenRow ? s.evenRow : s.oddRow, u, ["border-top", "border-left", "border-right", "border-bottom", "color", "font-weight", "font-family", "font-size", "background-color"]), n.appendChild(u);
          break;
      }
    }), i.innerHTML && t.appendChild(i), t.appendChild(n), this.mapElementStyles(this.table.element, t, ["border-top", "border-left", "border-right", "border-bottom"]), t;
  }
  lookupTableStyles() {
    var e = {};
    return this.cloneTableStyle && window.getComputedStyle && (e.oddRow = this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"), e.evenRow = this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"), e.calcRow = this.table.element.querySelector(".tabulator-row.tabulator-calcs"), e.firstRow = this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"), e.firstGroup = this.table.element.getElementsByClassName("tabulator-group")[0], e.firstRow && (e.styleCells = e.firstRow.getElementsByClassName("tabulator-cell"), e.styleRowHeader = e.firstRow.getElementsByClassName("tabulator-row-header")[0], e.firstCell = e.styleCells[0], e.lastCell = e.styleCells[e.styleCells.length - 1])), e;
  }
  generateHeaderElement(e, t, i) {
    var n = document.createElement("tr");
    return e.columns.forEach((s) => {
      if (s) {
        var a = document.createElement("th"), o = s.component._column.definition.cssClass ? s.component._column.definition.cssClass.split(" ") : [];
        a.colSpan = s.width, a.rowSpan = s.height, a.innerHTML = s.value, this.cloneTableStyle && (a.style.boxSizing = "border-box"), o.forEach(function(l) {
          a.classList.add(l);
        }), this.mapElementStyles(s.component.getElement(), a, ["text-align", "border-left", "border-right", "background-color", "color", "font-weight", "font-family", "font-size"]), this.mapElementStyles(s.component._column.contentElement, a, ["padding-top", "padding-left", "padding-right", "padding-bottom"]), s.component._column.visible ? this.mapElementStyles(s.component.getElement(), a, ["width"]) : s.component._column.definition.width && (a.style.width = s.component._column.definition.width + "px"), s.component._column.parent && s.component._column.parent.isGroup ? this.mapElementStyles(s.component._column.parent.groupElement, a, ["border-top"]) : this.mapElementStyles(s.component.getElement(), a, ["border-top"]), s.component._column.isGroup ? this.mapElementStyles(s.component.getElement(), a, ["border-bottom"]) : this.mapElementStyles(this.table.columnManager.getElement(), a, ["border-bottom"]), n.appendChild(a);
      }
    }), n;
  }
  generateGroupElement(e, t, i) {
    var n = document.createElement("tr"), s = document.createElement("td"), a = e.columns[0];
    return n.classList.add("tabulator-print-table-row"), t.groupHeader && t.groupHeader[e.indent] ? a.value = t.groupHeader[e.indent](a.value, e.component._group.getRowCount(), e.component._group.getData(), e.component) : t.groupHeader !== !1 && (a.value = e.component._group.generator(a.value, e.component._group.getRowCount(), e.component._group.getData(), e.component)), s.colSpan = a.width, s.innerHTML = a.value, n.classList.add("tabulator-print-table-group"), n.classList.add("tabulator-group-level-" + e.indent), a.component.isVisible() && n.classList.add("tabulator-group-visible"), this.mapElementStyles(i.firstGroup, n, ["border-top", "border-left", "border-right", "border-bottom", "color", "font-weight", "font-family", "font-size", "background-color"]), this.mapElementStyles(i.firstGroup, s, ["padding-top", "padding-left", "padding-right", "padding-bottom"]), n.appendChild(s), n;
  }
  generateCalcElement(e, t, i) {
    var n = this.generateRowElement(e, t, i);
    return n.classList.add("tabulator-print-table-calcs"), this.mapElementStyles(i.calcRow, n, ["border-top", "border-left", "border-right", "border-bottom", "color", "font-weight", "font-family", "font-size", "background-color"]), n;
  }
  generateRowElement(e, t, i) {
    var n = document.createElement("tr");
    if (n.classList.add("tabulator-print-table-row"), e.columns.forEach((s, a) => {
      if (s) {
        var o = document.createElement("td"), l = s.component._column, h = this.table, u = h.columnManager.findColumnIndex(l), d = s.value, c, f, p = {
          modules: {},
          getValue: function() {
            return d;
          },
          getField: function() {
            return l.definition.field;
          },
          getElement: function() {
            return o;
          },
          getType: function() {
            return "cell";
          },
          getColumn: function() {
            return l.getComponent();
          },
          getData: function() {
            return e.component.getData();
          },
          getRow: function() {
            return e.component;
          },
          getTable: function() {
            return h;
          },
          getComponent: function() {
            return p;
          },
          column: l
        }, m = l.definition.cssClass ? l.definition.cssClass.split(" ") : [];
        if (m.forEach(function(g) {
          o.classList.add(g);
        }), this.table.modExists("format") && this.config.formatCells !== !1)
          d = this.table.modules.format.formatExportValue(p, this.colVisProp);
        else
          switch (typeof d) {
            case "object":
              d = d !== null ? JSON.stringify(d) : "";
              break;
            case "undefined":
              d = "";
              break;
          }
        d instanceof Node ? o.appendChild(d) : o.innerHTML = d, f = ["padding-top", "padding-left", "padding-right", "padding-bottom", "border-top", "border-left", "border-right", "border-bottom", "color", "font-weight", "font-family", "font-size", "text-align"], l.isRowHeader ? (c = i.styleRowHeader, f.push("background-color")) : c = i.styleCells && i.styleCells[u] ? i.styleCells[u] : i.firstCell, c && (this.mapElementStyles(c, o, f), l.definition.align && (o.style.textAlign = l.definition.align)), this.table.options.dataTree && this.config.dataTree !== !1 && (t.treeElementField && t.treeElementField == l.field || !t.treeElementField && a == 0) && (e.component._row.modules.dataTree.controlEl && o.insertBefore(e.component._row.modules.dataTree.controlEl.cloneNode(!0), o.firstChild), e.component._row.modules.dataTree.branchEl && o.insertBefore(e.component._row.modules.dataTree.branchEl.cloneNode(!0), o.firstChild)), n.appendChild(o), p.modules.format && p.modules.format.renderedCallback && p.modules.format.renderedCallback();
      }
    }), t.rowFormatter && e.type === "row" && this.config.formatCells !== !1) {
      let s = Object.assign(e.component);
      s.getElement = function() {
        return n;
      }, t.rowFormatter(e.component);
    }
    return n;
  }
  generateHTMLTable(e) {
    var t = document.createElement("div");
    return t.appendChild(this.generateTableElement(e)), t.innerHTML;
  }
  getHtml(e, t, i, n) {
    var s = this.generateExportList(i || this.table.options.htmlOutputConfig, t, e, n || "htmlOutput");
    return this.generateHTMLTable(s);
  }
  mapElementStyles(e, t, i) {
    if (this.cloneTableStyle && e && t) {
      var n = {
        "background-color": "backgroundColor",
        color: "fontColor",
        width: "width",
        "font-weight": "fontWeight",
        "font-family": "fontFamily",
        "font-size": "fontSize",
        "text-align": "textAlign",
        "border-top": "borderTop",
        "border-left": "borderLeft",
        "border-right": "borderRight",
        "border-bottom": "borderBottom",
        "padding-top": "paddingTop",
        "padding-left": "paddingLeft",
        "padding-right": "paddingRight",
        "padding-bottom": "paddingBottom"
      };
      if (window.getComputedStyle) {
        var s = window.getComputedStyle(e);
        i.forEach(function(a) {
          t.style[n[a]] || (t.style[n[a]] = s.getPropertyValue(a));
        });
      }
    }
  }
};
A(gi, "moduleName", "export"), A(gi, "columnLookups", iy), A(gi, "rowLookups", ry);
let Ul = gi;
var ny = {
  //equal to
  "=": function(r, e, t, i) {
    return e == r;
  },
  //less than
  "<": function(r, e, t, i) {
    return e < r;
  },
  //less than or equal to
  "<=": function(r, e, t, i) {
    return e <= r;
  },
  //greater than
  ">": function(r, e, t, i) {
    return e > r;
  },
  //greater than or equal to
  ">=": function(r, e, t, i) {
    return e >= r;
  },
  //not equal to
  "!=": function(r, e, t, i) {
    return e != r;
  },
  regex: function(r, e, t, i) {
    return typeof r == "string" && (r = new RegExp(r)), r.test(e);
  },
  //contains the string
  like: function(r, e, t, i) {
    return r === null || typeof r > "u" ? e === r : typeof e < "u" && e !== null ? String(e).toLowerCase().indexOf(r.toLowerCase()) > -1 : !1;
  },
  //contains the keywords
  keywords: function(r, e, t, i) {
    var n = r.toLowerCase().split(typeof i.separator > "u" ? " " : i.separator), s = String(e === null || typeof e > "u" ? "" : e).toLowerCase(), a = [];
    return n.forEach((o) => {
      s.includes(o) && a.push(!0);
    }), i.matchAll ? a.length === n.length : !!a.length;
  },
  //starts with the string
  starts: function(r, e, t, i) {
    return r === null || typeof r > "u" ? e === r : typeof e < "u" && e !== null ? String(e).toLowerCase().startsWith(r.toLowerCase()) : !1;
  },
  //ends with the string
  ends: function(r, e, t, i) {
    return r === null || typeof r > "u" ? e === r : typeof e < "u" && e !== null ? String(e).toLowerCase().endsWith(r.toLowerCase()) : !1;
  },
  //in array
  in: function(r, e, t, i) {
    return Array.isArray(r) ? r.length ? r.indexOf(e) > -1 : !0 : (console.warn("Filter Error - filter value is not an array:", r), !1);
  }
};
const $t = class $t extends U {
  constructor(e) {
    super(e), this.filterList = [], this.headerFilters = {}, this.headerFilterColumns = [], this.prevHeaderFilterChangeCheck = "", this.prevHeaderFilterChangeCheck = "{}", this.changed = !1, this.tableInitialized = !1, this.registerTableOption("filterMode", "local"), this.registerTableOption("initialFilter", !1), this.registerTableOption("initialHeaderFilter", !1), this.registerTableOption("headerFilterLiveFilterDelay", 300), this.registerTableOption("placeholderHeaderFilter", !1), this.registerColumnOption("headerFilter"), this.registerColumnOption("headerFilterPlaceholder"), this.registerColumnOption("headerFilterParams"), this.registerColumnOption("headerFilterEmptyCheck"), this.registerColumnOption("headerFilterFunc"), this.registerColumnOption("headerFilterFuncParams"), this.registerColumnOption("headerFilterLiveFilter"), this.registerTableFunction("searchRows", this.searchRows.bind(this)), this.registerTableFunction("searchData", this.searchData.bind(this)), this.registerTableFunction("setFilter", this.userSetFilter.bind(this)), this.registerTableFunction("refreshFilter", this.userRefreshFilter.bind(this)), this.registerTableFunction("addFilter", this.userAddFilter.bind(this)), this.registerTableFunction("getFilters", this.getFilters.bind(this)), this.registerTableFunction("setHeaderFilterFocus", this.userSetHeaderFilterFocus.bind(this)), this.registerTableFunction("getHeaderFilterValue", this.userGetHeaderFilterValue.bind(this)), this.registerTableFunction("setHeaderFilterValue", this.userSetHeaderFilterValue.bind(this)), this.registerTableFunction("getHeaderFilters", this.getHeaderFilters.bind(this)), this.registerTableFunction("removeFilter", this.userRemoveFilter.bind(this)), this.registerTableFunction("clearFilter", this.userClearFilter.bind(this)), this.registerTableFunction("clearHeaderFilter", this.userClearHeaderFilter.bind(this)), this.registerComponentFunction("column", "headerFilterFocus", this.setHeaderFilterFocus.bind(this)), this.registerComponentFunction("column", "reloadHeaderFilter", this.reloadHeaderFilter.bind(this)), this.registerComponentFunction("column", "getHeaderFilterValue", this.getHeaderFilterValue.bind(this)), this.registerComponentFunction("column", "setHeaderFilterValue", this.setHeaderFilterValue.bind(this));
  }
  initialize() {
    this.subscribe("column-init", this.initializeColumnHeaderFilter.bind(this)), this.subscribe("column-width-fit-before", this.hideHeaderFilterElements.bind(this)), this.subscribe("column-width-fit-after", this.showHeaderFilterElements.bind(this)), this.subscribe("table-built", this.tableBuilt.bind(this)), this.subscribe("placeholder", this.generatePlaceholder.bind(this)), this.table.options.filterMode === "remote" && this.subscribe("data-params", this.remoteFilterParams.bind(this)), this.registerDataHandler(this.filter.bind(this), 10);
  }
  tableBuilt() {
    this.table.options.initialFilter && this.setFilter(this.table.options.initialFilter), this.table.options.initialHeaderFilter && this.table.options.initialHeaderFilter.forEach((e) => {
      var t = this.table.columnManager.findColumn(e.field);
      if (t)
        this.setHeaderFilterValue(t, e.value);
      else
        return console.warn("Column Filter Error - No matching column found:", e.field), !1;
    }), this.tableInitialized = !0;
  }
  remoteFilterParams(e, t, i, n) {
    return n.filter = this.getFilters(!0, !0), n;
  }
  generatePlaceholder(e) {
    if (this.table.options.placeholderHeaderFilter && Object.keys(this.headerFilters).length)
      return this.table.options.placeholderHeaderFilter;
  }
  ///////////////////////////////////
  ///////// Table Functions /////////
  ///////////////////////////////////
  //set standard filters
  userSetFilter(e, t, i, n) {
    this.setFilter(e, t, i, n), this.refreshFilter();
  }
  //set standard filters
  userRefreshFilter() {
    this.refreshFilter();
  }
  //add filter to array
  userAddFilter(e, t, i, n) {
    this.addFilter(e, t, i, n), this.refreshFilter();
  }
  userSetHeaderFilterFocus(e) {
    var t = this.table.columnManager.findColumn(e);
    if (t)
      this.setHeaderFilterFocus(t);
    else
      return console.warn("Column Filter Focus Error - No matching column found:", e), !1;
  }
  userGetHeaderFilterValue(e) {
    var t = this.table.columnManager.findColumn(e);
    if (t)
      return this.getHeaderFilterValue(t);
    console.warn("Column Filter Error - No matching column found:", e);
  }
  userSetHeaderFilterValue(e, t) {
    var i = this.table.columnManager.findColumn(e);
    if (i)
      this.setHeaderFilterValue(i, t);
    else
      return console.warn("Column Filter Error - No matching column found:", e), !1;
  }
  //remove filter from array
  userRemoveFilter(e, t, i) {
    this.removeFilter(e, t, i), this.refreshFilter();
  }
  //clear filters
  userClearFilter(e) {
    this.clearFilter(e), this.refreshFilter();
  }
  //clear header filters
  userClearHeaderFilter() {
    this.clearHeaderFilter(), this.refreshFilter();
  }
  //search for specific row components
  searchRows(e, t, i) {
    return this.search("rows", e, t, i);
  }
  //search for specific data
  searchData(e, t, i) {
    return this.search("data", e, t, i);
  }
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  initializeColumnHeaderFilter(e) {
    var t = e.definition;
    t.headerFilter && this.initializeColumn(e);
  }
  //initialize column header filter
  initializeColumn(e, t) {
    var i = this, n = e.getField();
    function s(a) {
      var o = e.modules.filter.tagType == "input" && e.modules.filter.attrType == "text" || e.modules.filter.tagType == "textarea" ? "partial" : "match", l = "", h = "", u;
      if (typeof e.modules.filter.prevSuccess > "u" || e.modules.filter.prevSuccess !== a) {
        if (e.modules.filter.prevSuccess = a, e.modules.filter.emptyFunc(a))
          delete i.headerFilters[n];
        else {
          switch (e.modules.filter.value = a, typeof e.definition.headerFilterFunc) {
            case "string":
              $t.filters[e.definition.headerFilterFunc] ? (l = e.definition.headerFilterFunc, u = function(d) {
                var c = e.definition.headerFilterFuncParams || {}, f = e.getFieldValue(d);
                return c = typeof c == "function" ? c(a, f, d) : c, $t.filters[e.definition.headerFilterFunc](a, f, d, c);
              }) : console.warn("Header Filter Error - Matching filter function not found: ", e.definition.headerFilterFunc);
              break;
            case "function":
              u = function(d) {
                var c = e.definition.headerFilterFuncParams || {}, f = e.getFieldValue(d);
                return c = typeof c == "function" ? c(a, f, d) : c, e.definition.headerFilterFunc(a, f, d, c);
              }, l = u;
              break;
          }
          if (!u)
            switch (o) {
              case "partial":
                u = function(d) {
                  var c = e.getFieldValue(d);
                  return typeof c < "u" && c !== null ? String(c).toLowerCase().indexOf(String(a).toLowerCase()) > -1 : !1;
                }, l = "like";
                break;
              default:
                u = function(d) {
                  return e.getFieldValue(d) == a;
                }, l = "=";
            }
          i.headerFilters[n] = { value: a, func: u, type: l };
        }
        e.modules.filter.value = a, h = JSON.stringify(i.headerFilters), i.prevHeaderFilterChangeCheck !== h && (i.prevHeaderFilterChangeCheck = h, i.trackChanges(), i.refreshFilter());
      }
      return !0;
    }
    e.modules.filter = {
      success: s,
      attrType: !1,
      tagType: !1,
      emptyFunc: !1
    }, this.generateHeaderFilterElement(e);
  }
  generateHeaderFilterElement(e, t, i) {
    var n = this, s = e.modules.filter.success, a = e.getField(), o, l, h, u, d, c, f, p;
    e.modules.filter.value = t;
    function m() {
    }
    function g(v) {
      p = v;
    }
    if (e.modules.filter.headerElement && e.modules.filter.headerElement.parentNode && e.contentElement.removeChild(e.modules.filter.headerElement.parentNode), a) {
      switch (e.modules.filter.emptyFunc = e.definition.headerFilterEmptyCheck || function(v) {
        return !v && v !== 0;
      }, o = document.createElement("div"), o.classList.add("tabulator-header-filter"), typeof e.definition.headerFilter) {
        case "string":
          n.table.modules.edit.editors[e.definition.headerFilter] ? (l = n.table.modules.edit.editors[e.definition.headerFilter], (e.definition.headerFilter === "tick" || e.definition.headerFilter === "tickCross") && !e.definition.headerFilterEmptyCheck && (e.modules.filter.emptyFunc = function(v) {
            return v !== !0 && v !== !1;
          })) : console.warn("Filter Error - Cannot build header filter, No such editor found: ", e.definition.editor);
          break;
        case "function":
          l = e.definition.headerFilter;
          break;
        case "boolean":
          e.modules.edit && e.modules.edit.editor ? l = e.modules.edit.editor : e.definition.formatter && n.table.modules.edit.editors[e.definition.formatter] ? (l = n.table.modules.edit.editors[e.definition.formatter], (e.definition.formatter === "tick" || e.definition.formatter === "tickCross") && !e.definition.headerFilterEmptyCheck && (e.modules.filter.emptyFunc = function(v) {
            return v !== !0 && v !== !1;
          })) : l = n.table.modules.edit.editors.input;
          break;
      }
      if (l) {
        if (u = {
          getValue: function() {
            return typeof t < "u" ? t : "";
          },
          getField: function() {
            return e.definition.field;
          },
          getElement: function() {
            return o;
          },
          getColumn: function() {
            return e.getComponent();
          },
          getTable: () => this.table,
          getType: () => "header",
          getRow: function() {
            return {
              normalizeHeight: function() {
              }
            };
          }
        }, f = e.definition.headerFilterParams || {}, f = typeof f == "function" ? f.call(n.table, u) : f, h = l.call(this.table.modules.edit, u, g, s, m, f), !h) {
          console.warn("Filter Error - Cannot add filter to " + a + " column, editor returned a value of false");
          return;
        }
        if (!(h instanceof Node)) {
          console.warn("Filter Error - Cannot add filter to " + a + " column, editor should return an instance of Node, the editor returned:", h);
          return;
        }
        n.langBind("headerFilters|columns|" + e.definition.field, function(v) {
          h.setAttribute("placeholder", typeof v < "u" && v ? v : e.definition.headerFilterPlaceholder || n.langText("headerFilters|default"));
        }), h.addEventListener("click", function(v) {
          v.stopPropagation(), h.focus();
        }), h.addEventListener("focus", (v) => {
          var b = this.table.columnManager.contentsElement.scrollLeft, y = this.table.rowManager.element.scrollLeft;
          b !== y && (this.table.rowManager.scrollHorizontal(b), this.table.columnManager.scrollHorizontal(b));
        }), d = !1, c = function(v) {
          d && clearTimeout(d), d = setTimeout(function() {
            s(h.value);
          }, n.table.options.headerFilterLiveFilterDelay);
        }, e.modules.filter.headerElement = h, e.modules.filter.attrType = h.hasAttribute("type") ? h.getAttribute("type").toLowerCase() : "", e.modules.filter.tagType = h.tagName.toLowerCase(), e.definition.headerFilterLiveFilter !== !1 && (e.definition.headerFilter === "autocomplete" || e.definition.headerFilter === "tickCross" || (e.definition.editor === "autocomplete" || e.definition.editor === "tickCross") && e.definition.headerFilter === !0 || (h.addEventListener("keyup", c), h.addEventListener("search", c), e.modules.filter.attrType == "number" && h.addEventListener("change", function(v) {
          s(h.value);
        }), e.modules.filter.attrType == "text" && this.table.browser !== "ie" && h.setAttribute("type", "search")), (e.modules.filter.tagType == "input" || e.modules.filter.tagType == "select" || e.modules.filter.tagType == "textarea") && h.addEventListener("mousedown", function(v) {
          v.stopPropagation();
        })), o.appendChild(h), e.contentElement.appendChild(o), i || n.headerFilterColumns.push(e), p && p();
      }
    } else
      console.warn("Filter Error - Cannot add header filter, column has no field set:", e.definition.title);
  }
  //hide all header filter elements (used to ensure correct column widths in "fitData" layout mode)
  hideHeaderFilterElements() {
    this.headerFilterColumns.forEach(function(e) {
      e.modules.filter && e.modules.filter.headerElement && (e.modules.filter.headerElement.style.display = "none");
    });
  }
  //show all header filter elements (used to ensure correct column widths in "fitData" layout mode)
  showHeaderFilterElements() {
    this.headerFilterColumns.forEach(function(e) {
      e.modules.filter && e.modules.filter.headerElement && (e.modules.filter.headerElement.style.display = "");
    });
  }
  //programmatically set focus of header filter
  setHeaderFilterFocus(e) {
    e.modules.filter && e.modules.filter.headerElement ? e.modules.filter.headerElement.focus() : console.warn("Column Filter Focus Error - No header filter set on column:", e.getField());
  }
  //programmatically get value of header filter
  getHeaderFilterValue(e) {
    if (e.modules.filter && e.modules.filter.headerElement)
      return e.modules.filter.value;
    console.warn("Column Filter Error - No header filter set on column:", e.getField());
  }
  //programmatically set value of header filter
  setHeaderFilterValue(e, t) {
    e && (e.modules.filter && e.modules.filter.headerElement ? (this.generateHeaderFilterElement(e, t, !0), e.modules.filter.success(t)) : console.warn("Column Filter Error - No header filter set on column:", e.getField()));
  }
  reloadHeaderFilter(e) {
    e && (e.modules.filter && e.modules.filter.headerElement ? this.generateHeaderFilterElement(e, e.modules.filter.value, !0) : console.warn("Column Filter Error - No header filter set on column:", e.getField()));
  }
  refreshFilter() {
    this.tableInitialized && (this.table.options.filterMode === "remote" ? this.reloadData(null, !1, !1) : this.refreshData(!0));
  }
  //check if the filters has changed since last use
  trackChanges() {
    this.changed = !0, this.dispatch("filter-changed");
  }
  //check if the filters has changed since last use
  hasChanged() {
    var e = this.changed;
    return this.changed = !1, e;
  }
  //set standard filters
  setFilter(e, t, i, n) {
    this.filterList = [], Array.isArray(e) || (e = [{ field: e, type: t, value: i, params: n }]), this.addFilter(e);
  }
  //add filter to array
  addFilter(e, t, i, n) {
    var s = !1;
    Array.isArray(e) || (e = [{ field: e, type: t, value: i, params: n }]), e.forEach((a) => {
      a = this.findFilter(a), a && (this.filterList.push(a), s = !0);
    }), s && this.trackChanges();
  }
  findFilter(e) {
    var t;
    if (Array.isArray(e))
      return this.findSubFilters(e);
    var i = !1;
    return typeof e.field == "function" ? i = function(n) {
      return e.field(n, e.type || {});
    } : $t.filters[e.type] ? (t = this.table.columnManager.getColumnByField(e.field), t ? i = function(n) {
      return $t.filters[e.type](e.value, t.getFieldValue(n), n, e.params || {});
    } : i = function(n) {
      return $t.filters[e.type](e.value, n[e.field], n, e.params || {});
    }) : console.warn("Filter Error - No such filter type found, ignoring: ", e.type), e.func = i, e.func ? e : !1;
  }
  findSubFilters(e) {
    var t = [];
    return e.forEach((i) => {
      i = this.findFilter(i), i && t.push(i);
    }), t.length ? t : !1;
  }
  //get all filters
  getFilters(e, t) {
    var i = [];
    return e && (i = this.getHeaderFilters()), t && i.forEach(function(n) {
      typeof n.type == "function" && (n.type = "function");
    }), i = i.concat(this.filtersToArray(this.filterList, t)), i;
  }
  //filter to Object
  filtersToArray(e, t) {
    var i = [];
    return e.forEach((n) => {
      var s;
      Array.isArray(n) ? i.push(this.filtersToArray(n, t)) : (s = { field: n.field, type: n.type, value: n.value }, t && typeof s.type == "function" && (s.type = "function"), i.push(s));
    }), i;
  }
  //get all filters
  getHeaderFilters() {
    var e = [];
    for (var t in this.headerFilters)
      e.push({ field: t, type: this.headerFilters[t].type, value: this.headerFilters[t].value });
    return e;
  }
  //remove filter from array
  removeFilter(e, t, i) {
    Array.isArray(e) || (e = [{ field: e, type: t, value: i }]), e.forEach((n) => {
      var s = -1;
      typeof n.field == "object" ? s = this.filterList.findIndex((a) => n === a) : s = this.filterList.findIndex((a) => n.field === a.field && n.type === a.type && n.value === a.value), s > -1 ? this.filterList.splice(s, 1) : console.warn("Filter Error - No matching filter type found, ignoring: ", n.type);
    }), this.trackChanges();
  }
  //clear filters
  clearFilter(e) {
    this.filterList = [], e && this.clearHeaderFilter(), this.trackChanges();
  }
  //clear header filters
  clearHeaderFilter() {
    this.headerFilters = {}, this.prevHeaderFilterChangeCheck = "{}", this.headerFilterColumns.forEach((e) => {
      typeof e.modules.filter.value < "u" && delete e.modules.filter.value, e.modules.filter.prevSuccess = void 0, this.reloadHeaderFilter(e);
    }), this.trackChanges();
  }
  //search data and return matching rows
  search(e, t, i, n) {
    var s = [], a = [];
    return Array.isArray(t) || (t = [{ field: t, type: i, value: n }]), t.forEach((o) => {
      o = this.findFilter(o), o && a.push(o);
    }), this.table.rowManager.rows.forEach((o) => {
      var l = !0;
      a.forEach((h) => {
        this.filterRecurse(h, o.getData()) || (l = !1);
      }), l && s.push(e === "data" ? o.getData("data") : o.getComponent());
    }), s;
  }
  //filter row array
  filter(e, t) {
    var i = [], n = [];
    return this.subscribedExternal("dataFiltering") && this.dispatchExternal("dataFiltering", this.getFilters(!0)), this.table.options.filterMode !== "remote" && (this.filterList.length || Object.keys(this.headerFilters).length) ? e.forEach((s) => {
      this.filterRow(s) && i.push(s);
    }) : i = e.slice(0), this.subscribedExternal("dataFiltered") && (i.forEach((s) => {
      n.push(s.getComponent());
    }), this.dispatchExternal("dataFiltered", this.getFilters(!0), n)), i;
  }
  //filter individual row
  filterRow(e, t) {
    var i = !0, n = e.getData();
    this.filterList.forEach((a) => {
      this.filterRecurse(a, n) || (i = !1);
    });
    for (var s in this.headerFilters)
      this.headerFilters[s].func(n) || (i = !1);
    return i;
  }
  filterRecurse(e, t) {
    var i = !1;
    return Array.isArray(e) ? e.forEach((n) => {
      this.filterRecurse(n, t) && (i = !0);
    }) : i = e.func(t), i;
  }
};
A($t, "moduleName", "filter"), //load defaults
A($t, "filters", ny);
let jl = $t;
function sy(r, e, t) {
  return this.emptyToSpace(this.sanitizeHTML(r.getValue()));
}
function ay(r, e, t) {
  return r.getValue();
}
function oy(r, e, t) {
  return r.getElement().style.whiteSpace = "pre-wrap", this.emptyToSpace(this.sanitizeHTML(r.getValue()));
}
function ly(r, e, t) {
  var i = parseFloat(r.getValue()), n = "", s, a, o, l, h, u = e.decimal || ".", d = e.thousand || ",", c = e.negativeSign || "-", f = e.symbol || "", p = !!e.symbolAfter, m = typeof e.precision < "u" ? e.precision : 2;
  if (isNaN(i))
    return this.emptyToSpace(this.sanitizeHTML(r.getValue()));
  if (i < 0 && (i = Math.abs(i), n = c), s = m !== !1 ? i.toFixed(m) : i, s = String(s).split("."), a = s[0], o = s.length > 1 ? u + s[1] : "", e.thousand !== !1)
    for (l = /(\d+)(\d{3})/; l.test(a); )
      a = a.replace(l, "$1" + d + "$2");
  return h = a + o, n === !0 ? (h = "(" + h + ")", p ? h + f : f + h) : p ? n + h + f : n + f + h;
}
function hy(r, e, t) {
  var i = r.getValue(), n = e.urlPrefix || "", s = e.download, a = i, o = document.createElement("a"), l;
  function h(u, d) {
    var c = u.shift(), f = d[c];
    return u.length && typeof f == "object" ? h(u, f) : f;
  }
  if (e.labelField && (l = r.getData(), a = h(e.labelField.split(this.table.options.nestedFieldSeparator), l)), e.label)
    switch (typeof e.label) {
      case "string":
        a = e.label;
        break;
      case "function":
        a = e.label(r);
        break;
    }
  if (a) {
    if (e.urlField && (l = r.getData(), i = de.retrieveNestedData(this.table.options.nestedFieldSeparator, e.urlField, l)), e.url)
      switch (typeof e.url) {
        case "string":
          i = e.url;
          break;
        case "function":
          i = e.url(r);
          break;
      }
    return o.setAttribute("href", n + i), e.target && o.setAttribute("target", e.target), e.download && (typeof s == "function" ? s = s(r) : s = s === !0 ? "" : s, o.setAttribute("download", s)), o.innerHTML = this.emptyToSpace(this.sanitizeHTML(a)), o;
  } else
    return "&nbsp;";
}
function uy(r, e, t) {
  var i = document.createElement("img"), n = r.getValue();
  switch (e.urlPrefix && (n = e.urlPrefix + r.getValue()), e.urlSuffix && (n = n + e.urlSuffix), i.setAttribute("src", n), typeof e.height) {
    case "number":
      i.style.height = e.height + "px";
      break;
    case "string":
      i.style.height = e.height;
      break;
  }
  switch (typeof e.width) {
    case "number":
      i.style.width = e.width + "px";
      break;
    case "string":
      i.style.width = e.width;
      break;
  }
  return i.addEventListener("load", function() {
    r.getRow().normalizeHeight();
  }), i;
}
function dy(r, e, t) {
  var i = r.getValue(), n = r.getElement(), s = e.allowEmpty, a = e.allowTruthy, o = Object.keys(e).includes("trueValue"), l = typeof e.tickElement < "u" ? e.tickElement : '<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>', h = typeof e.crossElement < "u" ? e.crossElement : '<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';
  return o && i === e.trueValue || !o && (a && i || i === !0 || i === "true" || i === "True" || i === 1 || i === "1") ? (n.setAttribute("aria-checked", !0), l || "") : s && (i === "null" || i === "" || i === null || typeof i > "u") ? (n.setAttribute("aria-checked", "mixed"), "") : (n.setAttribute("aria-checked", !1), h || "");
}
function cy(r, e, t) {
  var i = this.table.dependencyRegistry.lookup(["luxon", "DateTime"], "DateTime"), n = e.inputFormat || "yyyy-MM-dd HH:mm:ss", s = e.outputFormat || "dd/MM/yyyy HH:mm:ss", a = typeof e.invalidPlaceholder < "u" ? e.invalidPlaceholder : "", o = r.getValue();
  if (typeof i < "u") {
    var l;
    return i.isDateTime(o) ? l = o : n === "iso" ? l = i.fromISO(String(o)) : l = i.fromFormat(String(o), n), l.isValid ? (e.timezone && (l = l.setZone(e.timezone)), l.toFormat(s)) : a === !0 || !o ? o : typeof a == "function" ? a(o) : a;
  } else
    console.error("Format Error - 'datetime' formatter is dependant on luxon.js");
}
function fy(r, e, t) {
  var i = this.table.dependencyRegistry.lookup(["luxon", "DateTime"], "DateTime"), n = e.inputFormat || "yyyy-MM-dd HH:mm:ss", s = typeof e.invalidPlaceholder < "u" ? e.invalidPlaceholder : "", a = typeof e.suffix < "u" ? e.suffix : !1, o = typeof e.unit < "u" ? e.unit : "days", l = typeof e.humanize < "u" ? e.humanize : !1, h = typeof e.date < "u" ? e.date : i.now(), u = r.getValue();
  if (typeof i < "u") {
    var d;
    return i.isDateTime(u) ? d = u : n === "iso" ? d = i.fromISO(String(u)) : d = i.fromFormat(String(u), n), d.isValid ? l ? d.diff(h, o).toHuman() + (a ? " " + a : "") : parseInt(d.diff(h, o)[o]) + (a ? " " + a : "") : s === !0 ? u : typeof s == "function" ? s(u) : s;
  } else
    console.error("Format Error - 'datetimediff' formatter is dependant on luxon.js");
}
function py(r, e, t) {
  var i = r.getValue();
  return typeof e[i] > "u" ? (console.warn("Missing display value for " + i), i) : e[i];
}
function gy(r, e, t) {
  var i = r.getValue(), n = r.getElement(), s = e && e.stars ? e.stars : 5, a = document.createElement("span"), o = document.createElementNS("http://www.w3.org/2000/svg", "svg"), l = '<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>', h = '<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>';
  a.style.verticalAlign = "middle", o.setAttribute("width", "14"), o.setAttribute("height", "14"), o.setAttribute("viewBox", "0 0 512 512"), o.setAttribute("xml:space", "preserve"), o.style.padding = "0 1px", i = i && !isNaN(i) ? parseInt(i) : 0, i = Math.max(0, Math.min(i, s));
  for (var u = 1; u <= s; u++) {
    var d = o.cloneNode(!0);
    d.innerHTML = u <= i ? l : h, a.appendChild(d);
  }
  return n.style.whiteSpace = "nowrap", n.style.overflow = "hidden", n.style.textOverflow = "ellipsis", n.setAttribute("aria-label", i), a;
}
function vy(r, e, t) {
  var i = this.sanitizeHTML(r.getValue()) || 0, n = document.createElement("span"), s = e && e.max ? e.max : 100, a = e && e.min ? e.min : 0, o = e && typeof e.color < "u" ? e.color : ["red", "orange", "green"], l = "#666666", h, u;
  if (!(isNaN(i) || typeof r.getValue() > "u")) {
    switch (n.classList.add("tabulator-traffic-light"), u = parseFloat(i) <= s ? parseFloat(i) : s, u = parseFloat(u) >= a ? parseFloat(u) : a, h = (s - a) / 100, u = Math.round((u - a) / h), typeof o) {
      case "string":
        l = o;
        break;
      case "function":
        l = o(i);
        break;
      case "object":
        if (Array.isArray(o)) {
          var d = 100 / o.length, c = Math.floor(u / d);
          c = Math.min(c, o.length - 1), c = Math.max(c, 0), l = o[c];
          break;
        }
    }
    return n.style.backgroundColor = l, n;
  }
}
function my(r, e = {}, t) {
  var i = this.sanitizeHTML(r.getValue()) || 0, n = r.getElement(), s = e.max ? e.max : 100, a = e.min ? e.min : 0, o = e.legendAlign ? e.legendAlign : "center", l, h, u, d, c;
  switch (h = parseFloat(i) <= s ? parseFloat(i) : s, h = parseFloat(h) >= a ? parseFloat(h) : a, l = (s - a) / 100, h = Math.round((h - a) / l), typeof e.color) {
    case "string":
      u = e.color;
      break;
    case "function":
      u = e.color(i);
      break;
    case "object":
      if (Array.isArray(e.color)) {
        let g = 100 / e.color.length, v = Math.floor(h / g);
        v = Math.min(v, e.color.length - 1), v = Math.max(v, 0), u = e.color[v];
        break;
      }
    default:
      u = "#2DC214";
  }
  switch (typeof e.legend) {
    case "string":
      d = e.legend;
      break;
    case "function":
      d = e.legend(i);
      break;
    case "boolean":
      d = i;
      break;
    default:
      d = !1;
  }
  switch (typeof e.legendColor) {
    case "string":
      c = e.legendColor;
      break;
    case "function":
      c = e.legendColor(i);
      break;
    case "object":
      if (Array.isArray(e.legendColor)) {
        let g = 100 / e.legendColor.length, v = Math.floor(h / g);
        v = Math.min(v, e.legendColor.length - 1), v = Math.max(v, 0), c = e.legendColor[v];
      }
      break;
    default:
      c = "#000";
  }
  n.style.minWidth = "30px", n.style.position = "relative", n.setAttribute("aria-label", h);
  var f = document.createElement("div");
  f.style.display = "inline-block", f.style.width = h + "%", f.style.backgroundColor = u, f.style.height = "100%", f.setAttribute("data-max", s), f.setAttribute("data-min", a);
  var p = document.createElement("div");
  if (p.style.position = "relative", p.style.width = "100%", p.style.height = "100%", d) {
    var m = document.createElement("div");
    m.style.position = "absolute", m.style.top = 0, m.style.left = 0, m.style.textAlign = o, m.style.width = "100%", m.style.color = c, m.innerHTML = d;
  }
  return t(function() {
    if (!(r instanceof Lp)) {
      var g = document.createElement("div");
      g.style.position = "absolute", g.style.top = "4px", g.style.bottom = "4px", g.style.left = "4px", g.style.right = "4px", n.appendChild(g), n = g;
    }
    n.appendChild(p), p.appendChild(f), d && p.appendChild(m);
  }), "";
}
function by(r, e, t) {
  return r.getElement().style.backgroundColor = this.sanitizeHTML(r.getValue()), "";
}
function yy(r, e, t) {
  return '<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>';
}
function wy(r, e, t) {
  return '<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';
}
function Cy(r, e, t) {
  var i = r.getValue(), n = e.size || 15, s = n + "px", a, o, l = e.hasOwnProperty("onValue") ? e.onValue : !0, h = e.hasOwnProperty("offValue") ? e.offValue : !1, u = e.onTruthy ? i : i === l;
  return a = document.createElement("div"), a.classList.add("tabulator-toggle"), u ? (a.classList.add("tabulator-toggle-on"), a.style.flexDirection = "row-reverse", e.onColor && (a.style.background = e.onColor)) : e.offColor && (a.style.background = e.offColor), a.style.width = 2.5 * n + "px", a.style.borderRadius = s, e.clickable && a.addEventListener("click", (d) => {
    r.setValue(u ? h : l);
  }), o = document.createElement("div"), o.classList.add("tabulator-toggle-switch"), o.style.height = s, o.style.width = s, o.style.borderRadius = s, a.appendChild(o), a;
}
function _y(r, e, t) {
  var i = document.createElement("span"), n = r.getRow(), s = r.getTable();
  return n.watchPosition((a) => {
    e.relativeToPage && (a += s.modules.page.getPageSize() * (s.modules.page.getPage() - 1)), i.innerText = a;
  }), i;
}
function Ey(r, e, t) {
  return r.getElement().classList.add("tabulator-row-handle"), "<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>";
}
function Ty(r, e, t) {
  var i, n, s;
  function a(o) {
    var l = o.getValue(), h = "plaintext";
    switch (typeof l) {
      case "boolean":
        h = "tickCross";
        break;
      case "string":
        l.includes(`
`) && (h = "textarea");
        break;
    }
    return h;
  }
  return i = e.formatterLookup ? e.formatterLookup(r) : a(r), e.paramsLookup && (s = typeof e.paramsLookup == "function" ? e.paramsLookup(i, r) : e.paramsLookup[i]), n = this.table.modules.format.lookupFormatter(i), n.call(this, r, s || {}, t);
}
function xy(r, e, t) {
  var i = e.delimiter || ",", n = r.getValue(), s = this.table, a;
  return e.valueMap && (typeof e.valueMap == "string" ? a = function(o) {
    return o.map((l) => de.retrieveNestedData(s.options.nestedFieldSeparator, e.valueMap, l));
  } : a = e.valueMap), Array.isArray(n) ? (a && (n = a(n)), n.join(i)) : n;
}
function Sy(r, e, t) {
  var i = e.indent || "	", n = typeof e.multiline > "u" ? !0 : e.multiline, s = e.replacer || null, a = r.getValue();
  return n && (r.getElement().style.whiteSpace = "pre-wrap"), JSON.stringify(a, s, i);
}
var Ry = {
  plaintext: sy,
  html: ay,
  textarea: oy,
  money: ly,
  link: hy,
  image: uy,
  tickCross: dy,
  datetime: cy,
  datetimediff: fy,
  lookup: py,
  star: gy,
  traffic: vy,
  progress: my,
  color: by,
  buttonTick: yy,
  buttonCross: wy,
  toggle: Cy,
  rownum: _y,
  handle: Ey,
  adaptable: Ty,
  array: xy,
  json: Sy
};
const vi = class vi extends U {
  constructor(e) {
    super(e), this.registerColumnOption("formatter"), this.registerColumnOption("formatterParams"), this.registerColumnOption("formatterPrint"), this.registerColumnOption("formatterPrintParams"), this.registerColumnOption("formatterClipboard"), this.registerColumnOption("formatterClipboardParams"), this.registerColumnOption("formatterHtmlOutput"), this.registerColumnOption("formatterHtmlOutputParams"), this.registerColumnOption("titleFormatter"), this.registerColumnOption("titleFormatterParams");
  }
  initialize() {
    this.subscribe("cell-format", this.formatValue.bind(this)), this.subscribe("cell-rendered", this.cellRendered.bind(this)), this.subscribe("column-layout", this.initializeColumn.bind(this)), this.subscribe("column-format", this.formatHeader.bind(this));
  }
  //initialize column formatter
  initializeColumn(e) {
    e.modules.format = this.lookupTypeFormatter(e, ""), typeof e.definition.formatterPrint < "u" && (e.modules.format.print = this.lookupTypeFormatter(e, "Print")), typeof e.definition.formatterClipboard < "u" && (e.modules.format.clipboard = this.lookupTypeFormatter(e, "Clipboard")), typeof e.definition.formatterHtmlOutput < "u" && (e.modules.format.htmlOutput = this.lookupTypeFormatter(e, "HtmlOutput"));
  }
  lookupTypeFormatter(e, t) {
    var i = { params: e.definition["formatter" + t + "Params"] || {} }, n = e.definition["formatter" + t];
    return i.formatter = this.lookupFormatter(n), i;
  }
  lookupFormatter(e) {
    var t;
    switch (typeof e) {
      case "string":
        vi.formatters[e] ? t = vi.formatters[e] : (console.warn("Formatter Error - No such formatter found: ", e), t = vi.formatters.plaintext);
        break;
      case "function":
        t = e;
        break;
      default:
        t = vi.formatters.plaintext;
        break;
    }
    return t;
  }
  cellRendered(e) {
    e.modules.format && e.modules.format.renderedCallback && !e.modules.format.rendered && (e.modules.format.renderedCallback(), e.modules.format.rendered = !0);
  }
  //return a formatted value for a column header
  formatHeader(e, t, i) {
    var n, s, a, o;
    return e.definition.titleFormatter ? (n = this.lookupFormatter(e.definition.titleFormatter), a = (l) => {
      e.titleFormatterRendered = l;
    }, o = {
      getValue: function() {
        return t;
      },
      getElement: function() {
        return i;
      },
      getType: function() {
        return "header";
      },
      getColumn: function() {
        return e.getComponent();
      },
      getTable: () => this.table
    }, s = e.definition.titleFormatterParams || {}, s = typeof s == "function" ? s() : s, n.call(this, o, s, a)) : t;
  }
  //return a formatted value for a cell
  formatValue(e) {
    var t = e.getComponent(), i = typeof e.column.modules.format.params == "function" ? e.column.modules.format.params(t) : e.column.modules.format.params;
    function n(s) {
      e.modules.format || (e.modules.format = {}), e.modules.format.renderedCallback = s, e.modules.format.rendered = !1;
    }
    return e.column.modules.format.formatter.call(this, t, i, n);
  }
  formatExportValue(e, t) {
    var i = e.column.modules.format[t], n;
    if (i) {
      let s = function(a) {
        e.modules.format || (e.modules.format = {}), e.modules.format.renderedCallback = a, e.modules.format.rendered = !1;
      };
      return n = typeof i.params == "function" ? i.params(e.getComponent()) : i.params, i.formatter.call(this, e.getComponent(), n, s);
    } else
      return this.formatValue(e);
  }
  sanitizeHTML(e) {
    if (e) {
      var t = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;",
        "/": "&#x2F;",
        "`": "&#x60;",
        "=": "&#x3D;"
      };
      return String(e).replace(/[&<>"'`=/]/g, function(i) {
        return t[i];
      });
    } else
      return e;
  }
  emptyToSpace(e) {
    return e === null || typeof e > "u" || e === "" ? "&nbsp;" : e;
  }
};
A(vi, "moduleName", "format"), //load defaults
A(vi, "formatters", Ry);
let Yl = vi;
class Op extends U {
  constructor(e) {
    super(e), this.leftColumns = [], this.rightColumns = [], this.initializationMode = "left", this.active = !1, this.blocked = !0, this.registerColumnOption("frozen");
  }
  //reset initial state
  reset() {
    this.initializationMode = "left", this.leftColumns = [], this.rightColumns = [], this.active = !1;
  }
  initialize() {
    this.subscribe("cell-layout", this.layoutCell.bind(this)), this.subscribe("column-init", this.initializeColumn.bind(this)), this.subscribe("column-width", this.layout.bind(this)), this.subscribe("row-layout-after", this.layoutRow.bind(this)), this.subscribe("table-layout", this.layout.bind(this)), this.subscribe("columns-loading", this.reset.bind(this)), this.subscribe("column-add", this.reinitializeColumns.bind(this)), this.subscribe("column-deleted", this.reinitializeColumns.bind(this)), this.subscribe("column-hide", this.reinitializeColumns.bind(this)), this.subscribe("column-show", this.reinitializeColumns.bind(this)), this.subscribe("columns-loaded", this.reinitializeColumns.bind(this)), this.subscribe("table-redraw", this.layout.bind(this)), this.subscribe("layout-refreshing", this.blockLayout.bind(this)), this.subscribe("layout-refreshed", this.unblockLayout.bind(this)), this.subscribe("scrollbar-vertical", this.adjustForScrollbar.bind(this));
  }
  blockLayout() {
    this.blocked = !0;
  }
  unblockLayout() {
    this.blocked = !1;
  }
  layoutCell(e) {
    this.layoutElement(e.element, e.column);
  }
  reinitializeColumns() {
    this.reset(), this.table.columnManager.columnsByIndex.forEach((e) => {
      this.initializeColumn(e);
    }), this.layout();
  }
  //initialize specific column
  initializeColumn(e) {
    var t = { margin: 0, edge: !1 };
    e.isGroup || (this.frozenCheck(e) ? (t.position = this.initializationMode, this.initializationMode == "left" ? this.leftColumns.push(e) : this.rightColumns.unshift(e), this.active = !0, e.modules.frozen = t) : this.initializationMode = "right");
  }
  frozenCheck(e) {
    return e.parent.isGroup && e.definition.frozen && console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"), e.parent.isGroup ? this.frozenCheck(e.parent) : e.definition.frozen;
  }
  //layout calculation rows
  layoutCalcRows() {
    this.table.modExists("columnCalcs") && (this.table.modules.columnCalcs.topInitialized && this.table.modules.columnCalcs.topRow && this.layoutRow(this.table.modules.columnCalcs.topRow), this.table.modules.columnCalcs.botInitialized && this.table.modules.columnCalcs.botRow && this.layoutRow(this.table.modules.columnCalcs.botRow), this.table.modExists("groupRows") && this.layoutGroupCalcs(this.table.modules.groupRows.getGroups()));
  }
  layoutGroupCalcs(e) {
    e.forEach((t) => {
      t.calcs.top && this.layoutRow(t.calcs.top), t.calcs.bottom && this.layoutRow(t.calcs.bottom), t.groupList && t.groupList.length && this.layoutGroupCalcs(t.groupList);
    });
  }
  //calculate column positions and layout headers
  layoutColumnPosition(e) {
    var t = [], i = 0, n = 0;
    this.leftColumns.forEach((s, a) => {
      if (s.modules.frozen.marginValue = i, s.modules.frozen.margin = s.modules.frozen.marginValue + "px", s.visible && (i += s.getWidth()), a == this.leftColumns.length - 1 ? s.modules.frozen.edge = !0 : s.modules.frozen.edge = !1, s.parent.isGroup) {
        var o = this.getColGroupParentElement(s);
        t.includes(o) || (this.layoutElement(o, s), t.push(o)), o.classList.toggle("tabulator-frozen-left", s.modules.frozen.edge && s.modules.frozen.position === "left"), o.classList.toggle("tabulator-frozen-right", s.modules.frozen.edge && s.modules.frozen.position === "right");
      } else
        this.layoutElement(s.getElement(), s);
      e && s.cells.forEach((l) => {
        this.layoutElement(l.getElement(!0), s);
      });
    }), this.rightColumns.forEach((s, a) => {
      s.modules.frozen.marginValue = n, s.modules.frozen.margin = s.modules.frozen.marginValue + "px", s.visible && (n += s.getWidth()), a == this.rightColumns.length - 1 ? s.modules.frozen.edge = !0 : s.modules.frozen.edge = !1, s.parent.isGroup ? this.layoutElement(this.getColGroupParentElement(s), s) : this.layoutElement(s.getElement(), s), e && s.cells.forEach((o) => {
        this.layoutElement(o.getElement(!0), s);
      });
    });
  }
  getColGroupParentElement(e) {
    return e.parent.isGroup ? this.getColGroupParentElement(e.parent) : e.getElement();
  }
  //layout columns appropriately
  layout() {
    this.active && !this.blocked && (this.layoutColumnPosition(), this.reinitializeRows(), this.layoutCalcRows());
  }
  reinitializeRows() {
    var e = this.table.rowManager.getVisibleRows(!0), t = this.table.rowManager.getRows().filter((i) => !e.includes(i));
    t.forEach((i) => {
      i.deinitialize();
    }), e.forEach((i) => {
      i.type === "row" && this.layoutRow(i);
    });
  }
  layoutRow(e) {
    this.table.options.layout === "fitDataFill" && this.rightColumns.length && (this.table.rowManager.getTableElement().style.minWidth = "calc(100% - " + this.rightMargin + ")"), this.leftColumns.forEach((t) => {
      var i = e.getCell(t);
      i && this.layoutElement(i.getElement(!0), t);
    }), this.rightColumns.forEach((t) => {
      var i = e.getCell(t);
      i && this.layoutElement(i.getElement(!0), t);
    });
  }
  layoutElement(e, t) {
    var i;
    t.modules.frozen && e && (e.style.position = "sticky", this.table.rtl ? i = t.modules.frozen.position === "left" ? "right" : "left" : i = t.modules.frozen.position, e.style[i] = t.modules.frozen.margin, e.classList.add("tabulator-frozen"), e.classList.toggle("tabulator-frozen-left", t.modules.frozen.edge && t.modules.frozen.position === "left"), e.classList.toggle("tabulator-frozen-right", t.modules.frozen.edge && t.modules.frozen.position === "right"));
  }
  adjustForScrollbar(e) {
    this.rightColumns.length && (this.table.columnManager.getContentsElement().style.width = "calc(100% - " + e + "px)");
  }
  getFrozenColumns() {
    return this.leftColumns.concat(this.rightColumns);
  }
  _calcSpace(e, t) {
    var i = 0;
    for (let n = 0; n < t; n++)
      e[n].visible && (i += e[n].getWidth());
    return i;
  }
}
A(Op, "moduleName", "frozenColumns");
class Ip extends U {
  constructor(e) {
    super(e), this.topElement = document.createElement("div"), this.rows = [], this.registerComponentFunction("row", "freeze", this.freezeRow.bind(this)), this.registerComponentFunction("row", "unfreeze", this.unfreezeRow.bind(this)), this.registerComponentFunction("row", "isFrozen", this.isRowFrozen.bind(this)), this.registerTableOption("frozenRowsField", "id"), this.registerTableOption("frozenRows", !1);
  }
  initialize() {
    var e = document.createDocumentFragment();
    this.rows = [], this.topElement.classList.add("tabulator-frozen-rows-holder"), e.appendChild(document.createElement("br")), e.appendChild(this.topElement), this.table.columnManager.getContentsElement().insertBefore(e, this.table.columnManager.headersElement.nextSibling), this.subscribe("row-deleting", this.detachRow.bind(this)), this.subscribe("rows-visible", this.visibleRows.bind(this)), this.registerDisplayHandler(this.getRows.bind(this), 10), this.table.options.frozenRows && (this.subscribe("data-processed", this.initializeRows.bind(this)), this.subscribe("row-added", this.initializeRow.bind(this)), this.subscribe("table-redrawing", this.resizeHolderWidth.bind(this)), this.subscribe("column-resized", this.resizeHolderWidth.bind(this)), this.subscribe("column-show", this.resizeHolderWidth.bind(this)), this.subscribe("column-hide", this.resizeHolderWidth.bind(this))), this.resizeHolderWidth();
  }
  resizeHolderWidth() {
    this.topElement.style.minWidth = this.table.columnManager.headersElement.offsetWidth + "px";
  }
  initializeRows() {
    this.table.rowManager.getRows().forEach((e) => {
      this.initializeRow(e);
    });
  }
  initializeRow(e) {
    var t = this.table.options.frozenRows, i = typeof t;
    i === "number" ? e.getPosition() && e.getPosition() + this.rows.length <= t && this.freezeRow(e) : i === "function" ? t.call(this.table, e.getComponent()) && this.freezeRow(e) : Array.isArray(t) && t.includes(e.data[this.options("frozenRowsField")]) && this.freezeRow(e);
  }
  isRowFrozen(e) {
    var t = this.rows.indexOf(e);
    return t > -1;
  }
  isFrozen() {
    return !!this.rows.length;
  }
  visibleRows(e, t) {
    return this.rows.forEach((i) => {
      t.push(i);
    }), t;
  }
  //filter frozen rows out of display data
  getRows(e) {
    var t = e.slice(0);
    return this.rows.forEach(function(i) {
      var n = t.indexOf(i);
      n > -1 && t.splice(n, 1);
    }), t;
  }
  freezeRow(e) {
    e.modules.frozen ? console.warn("Freeze Error - Row is already frozen") : (e.modules.frozen = !0, this.topElement.appendChild(e.getElement()), e.initialize(), e.normalizeHeight(), this.rows.push(e), this.refreshData(!1, "display"), this.table.rowManager.adjustTableSize(), this.styleRows());
  }
  unfreezeRow(e) {
    e.modules.frozen ? (e.modules.frozen = !1, this.detachRow(e), this.table.rowManager.adjustTableSize(), this.refreshData(!1, "display"), this.rows.length && this.styleRows()) : console.warn("Freeze Error - Row is already unfrozen");
  }
  detachRow(e) {
    var t = this.rows.indexOf(e);
    if (t > -1) {
      var i = e.getElement();
      i.parentNode && i.parentNode.removeChild(i), this.rows.splice(t, 1);
    }
  }
  styleRows(e) {
    this.rows.forEach((t, i) => {
      this.table.rowManager.styleRow(t, i);
    });
  }
}
A(Ip, "moduleName", "frozenRows");
class My {
  constructor(e) {
    return this._group = e, this.type = "GroupComponent", new Proxy(this, {
      get: function(t, i, n) {
        return typeof t[i] < "u" ? t[i] : t._group.groupManager.table.componentFunctionBinder.handle("group", t._group, i);
      }
    });
  }
  getKey() {
    return this._group.key;
  }
  getField() {
    return this._group.field;
  }
  getElement() {
    return this._group.element;
  }
  getRows() {
    return this._group.getRows(!0);
  }
  getSubGroups() {
    return this._group.getSubGroups(!0);
  }
  getParentGroup() {
    return this._group.parent ? this._group.parent.getComponent() : !1;
  }
  isVisible() {
    return this._group.visible;
  }
  show() {
    this._group.show();
  }
  hide() {
    this._group.hide();
  }
  toggle() {
    this._group.toggleVisibility();
  }
  scrollTo(e, t) {
    return this._group.groupManager.table.rowManager.scrollToRow(this._group, e, t);
  }
  _getSelf() {
    return this._group;
  }
  getTable() {
    return this._group.groupManager.table;
  }
}
let ws = class zp {
  constructor(e, t, i, n, s, a, o) {
    this.groupManager = e, this.parent = t, this.key = n, this.level = i, this.field = s, this.hasSubGroups = i < e.groupIDLookups.length - 1, this.addRow = this.hasSubGroups ? this._addRowToGroup : this._addRow, this.type = "group", this.old = o, this.rows = [], this.groups = [], this.groupList = [], this.generator = a, this.element = !1, this.elementContents = !1, this.height = 0, this.outerHeight = 0, this.initialized = !1, this.calcs = {}, this.initialized = !1, this.modules = {}, this.arrowElement = !1, this.visible = o ? o.visible : typeof e.startOpen[i] < "u" ? e.startOpen[i] : e.startOpen[0], this.component = null, this.createElements(), this.addBindings(), this.createValueGroups();
  }
  wipe(e) {
    e || (this.groupList.length ? this.groupList.forEach(function(t) {
      t.wipe();
    }) : this.rows.forEach((t) => {
      t.modules && delete t.modules.group;
    })), this.element = !1, this.arrowElement = !1, this.elementContents = !1;
  }
  createElements() {
    var e = document.createElement("div");
    e.classList.add("tabulator-arrow"), this.element = document.createElement("div"), this.element.classList.add("tabulator-row"), this.element.classList.add("tabulator-group"), this.element.classList.add("tabulator-group-level-" + this.level), this.element.setAttribute("role", "rowgroup"), this.arrowElement = document.createElement("div"), this.arrowElement.classList.add("tabulator-group-toggle"), this.arrowElement.appendChild(e), this.groupManager.table.options.movableRows !== !1 && this.groupManager.table.modExists("moveRow") && this.groupManager.table.modules.moveRow.initializeGroupHeader(this);
  }
  createValueGroups() {
    var e = this.level + 1;
    this.groupManager.allowedValues && this.groupManager.allowedValues[e] && this.groupManager.allowedValues[e].forEach((t) => {
      this._createGroup(t, e);
    });
  }
  addBindings() {
    var e;
    this.groupManager.table.options.groupToggleElement && (e = this.groupManager.table.options.groupToggleElement == "arrow" ? this.arrowElement : this.element, e.addEventListener("click", (t) => {
      this.groupManager.table.options.groupToggleElement === "arrow" && (t.stopPropagation(), t.stopImmediatePropagation()), setTimeout(() => {
        this.toggleVisibility();
      });
    }));
  }
  _createGroup(e, t) {
    var i = t + "_" + e, n = new zp(this.groupManager, this, t, e, this.groupManager.groupIDLookups[t].field, this.groupManager.headerGenerator[t] || this.groupManager.headerGenerator[0], this.old ? this.old.groups[i] : !1);
    this.groups[i] = n, this.groupList.push(n);
  }
  _addRowToGroup(e) {
    var t = this.level + 1;
    if (this.hasSubGroups) {
      var i = this.groupManager.groupIDLookups[t].func(e.getData()), n = t + "_" + i;
      this.groupManager.allowedValues && this.groupManager.allowedValues[t] ? this.groups[n] && this.groups[n].addRow(e) : (this.groups[n] || this._createGroup(i, t), this.groups[n].addRow(e));
    }
  }
  _addRow(e) {
    this.rows.push(e), e.modules.group = this;
  }
  insertRow(e, t, i) {
    var n = this.conformRowData({});
    e.updateData(n);
    var s = this.rows.indexOf(t);
    s > -1 ? i ? this.rows.splice(s + 1, 0, e) : this.rows.splice(s, 0, e) : i ? this.rows.push(e) : this.rows.unshift(e), e.modules.group = this, this.groupManager.table.modExists("columnCalcs") && this.groupManager.table.options.columnCalcs != "table" && this.groupManager.table.modules.columnCalcs.recalcGroup(this), this.groupManager.updateGroupRows(!0);
  }
  scrollHeader(e) {
    this.arrowElement && (this.arrowElement.style.marginLeft = e, this.groupList.forEach(function(t) {
      t.scrollHeader(e);
    }));
  }
  getRowIndex(e) {
  }
  //update row data to match grouping constraints
  conformRowData(e) {
    return this.field ? e[this.field] = this.key : console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"), this.parent && (e = this.parent.conformRowData(e)), e;
  }
  removeRow(e) {
    var t = this.rows.indexOf(e), i = e.getElement();
    t > -1 && this.rows.splice(t, 1), !this.groupManager.table.options.groupValues && !this.rows.length ? (this.parent ? this.parent.removeGroup(this) : this.groupManager.removeGroup(this), this.groupManager.updateGroupRows(!0)) : (i.parentNode && i.parentNode.removeChild(i), this.groupManager.blockRedraw || (this.generateGroupHeaderContents(), this.groupManager.table.modExists("columnCalcs") && this.groupManager.table.options.columnCalcs != "table" && this.groupManager.table.modules.columnCalcs.recalcGroup(this)));
  }
  removeGroup(e) {
    var t = e.level + "_" + e.key, i;
    this.groups[t] && (delete this.groups[t], i = this.groupList.indexOf(e), i > -1 && this.groupList.splice(i, 1), this.groupList.length || (this.parent ? this.parent.removeGroup(this) : this.groupManager.removeGroup(this)));
  }
  getHeadersAndRows() {
    var e = [];
    return e.push(this), this._visSet(), this.calcs.top && (this.calcs.top.detachElement(), this.calcs.top.deleteCells()), this.calcs.bottom && (this.calcs.bottom.detachElement(), this.calcs.bottom.deleteCells()), this.visible ? this.groupList.length ? this.groupList.forEach(function(t) {
      e = e.concat(t.getHeadersAndRows());
    }) : (this.groupManager.table.options.columnCalcs != "table" && this.groupManager.table.modExists("columnCalcs") && this.groupManager.table.modules.columnCalcs.hasTopCalcs() && (this.calcs.top = this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows), e.push(this.calcs.top)), e = e.concat(this.rows), this.groupManager.table.options.columnCalcs != "table" && this.groupManager.table.modExists("columnCalcs") && this.groupManager.table.modules.columnCalcs.hasBottomCalcs() && (this.calcs.bottom = this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows), e.push(this.calcs.bottom))) : !this.groupList.length && this.groupManager.table.options.columnCalcs != "table" && this.groupManager.table.modExists("columnCalcs") && (this.groupManager.table.modules.columnCalcs.hasTopCalcs() && this.groupManager.table.options.groupClosedShowCalcs && (this.calcs.top = this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows), e.push(this.calcs.top)), this.groupManager.table.modules.columnCalcs.hasBottomCalcs() && this.groupManager.table.options.groupClosedShowCalcs && (this.calcs.bottom = this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows), e.push(this.calcs.bottom))), e;
  }
  getData(e, t) {
    var i = [];
    return this._visSet(), (!e || e && this.visible) && this.rows.forEach((n) => {
      i.push(n.getData(t || "data"));
    }), i;
  }
  getRowCount() {
    var e = 0;
    return this.groupList.length ? this.groupList.forEach((t) => {
      e += t.getRowCount();
    }) : e = this.rows.length, e;
  }
  toggleVisibility() {
    this.visible ? this.hide() : this.show();
  }
  hide() {
    this.visible = !1, this.groupManager.table.rowManager.getRenderMode() == "basic" && !this.groupManager.table.options.pagination ? (this.element.classList.remove("tabulator-group-visible"), this.groupList.length ? this.groupList.forEach((e) => {
      var t = e.getHeadersAndRows();
      t.forEach((i) => {
        i.detachElement();
      });
    }) : this.rows.forEach((e) => {
      var t = e.getElement();
      t.parentNode.removeChild(t);
    }), this.groupManager.updateGroupRows(!0)) : this.groupManager.updateGroupRows(!0), this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged", this.getComponent(), !1);
  }
  show() {
    if (this.visible = !0, this.groupManager.table.rowManager.getRenderMode() == "basic" && !this.groupManager.table.options.pagination) {
      this.element.classList.add("tabulator-group-visible");
      var e = this.generateElement();
      this.groupList.length ? this.groupList.forEach((t) => {
        var i = t.getHeadersAndRows();
        i.forEach((n) => {
          var s = n.getElement();
          e.parentNode.insertBefore(s, e.nextSibling), n.initialize(), e = s;
        });
      }) : this.rows.forEach((t) => {
        var i = t.getElement();
        e.parentNode.insertBefore(i, e.nextSibling), t.initialize(), e = i;
      }), this.groupManager.updateGroupRows(!0);
    } else
      this.groupManager.updateGroupRows(!0);
    this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged", this.getComponent(), !0);
  }
  _visSet() {
    var e = [];
    typeof this.visible == "function" && (this.rows.forEach(function(t) {
      e.push(t.getData());
    }), this.visible = this.visible(this.key, this.getRowCount(), e, this.getComponent()));
  }
  getRowGroup(e) {
    var t = !1;
    return this.groupList.length ? this.groupList.forEach(function(i) {
      var n = i.getRowGroup(e);
      n && (t = n);
    }) : this.rows.find(function(i) {
      return i === e;
    }) && (t = this), t;
  }
  getSubGroups(e) {
    var t = [];
    return this.groupList.forEach(function(i) {
      t.push(e ? i.getComponent() : i);
    }), t;
  }
  getRows(e, t) {
    var i = [];
    return t && this.groupList.length ? this.groupList.forEach((n) => {
      i = i.concat(n.getRows(e, t));
    }) : this.rows.forEach(function(n) {
      i.push(e ? n.getComponent() : n);
    }), i;
  }
  generateGroupHeaderContents() {
    var e = [], t = this.getRows(!1, !0);
    for (t.forEach(function(i) {
      e.push(i.getData());
    }), this.elementContents = this.generator(this.key, this.getRowCount(), e, this.getComponent()); this.element.firstChild; ) this.element.removeChild(this.element.firstChild);
    typeof this.elementContents == "string" ? this.element.innerHTML = this.elementContents : this.element.appendChild(this.elementContents), this.element.insertBefore(this.arrowElement, this.element.firstChild);
  }
  getPath(e = []) {
    return e.unshift(this.key), this.parent && this.parent.getPath(e), e;
  }
  ////////////// Standard Row Functions //////////////
  getElement() {
    return this.elementContents ? this.element : this.generateElement();
  }
  generateElement() {
    this.addBindings = !1, this._visSet(), this.visible ? this.element.classList.add("tabulator-group-visible") : this.element.classList.remove("tabulator-group-visible");
    for (var e = 0; e < this.element.childNodes.length; ++e)
      this.element.childNodes[e].parentNode.removeChild(this.element.childNodes[e]);
    return this.generateGroupHeaderContents(), this.element;
  }
  detachElement() {
    this.element && this.element.parentNode && this.element.parentNode.removeChild(this.element);
  }
  //normalize the height of elements in the row
  normalizeHeight() {
    this.setHeight(this.element.clientHeight);
  }
  initialize(e) {
    (!this.initialized || e) && (this.normalizeHeight(), this.initialized = !0);
  }
  reinitialize() {
    this.initialized = !1, this.height = 0, de.elVisible(this.element) && this.initialize(!0);
  }
  setHeight(e) {
    this.height != e && (this.height = e, this.outerHeight = this.element.offsetHeight);
  }
  //return rows outer height
  getHeight() {
    return this.outerHeight;
  }
  getGroup() {
    return this;
  }
  reinitializeHeight() {
  }
  calcHeight() {
  }
  setCellHeight() {
  }
  clearCellHeight() {
  }
  deinitializeHeight() {
  }
  rendered() {
  }
  //////////////// Object Generation /////////////////
  getComponent() {
    return this.component || (this.component = new My(this)), this.component;
  }
};
class Fp extends U {
  constructor(e) {
    super(e), this.groupIDLookups = !1, this.startOpen = [function() {
      return !1;
    }], this.headerGenerator = [function() {
      return "";
    }], this.groupList = [], this.allowedValues = !1, this.groups = {}, this.displayHandler = this.getRows.bind(this), this.blockRedraw = !1, this.registerTableOption("groupBy", !1), this.registerTableOption("groupStartOpen", !0), this.registerTableOption("groupValues", !1), this.registerTableOption("groupUpdateOnCellEdit", !1), this.registerTableOption("groupHeader", !1), this.registerTableOption("groupHeaderPrint", null), this.registerTableOption("groupHeaderClipboard", null), this.registerTableOption("groupHeaderHtmlOutput", null), this.registerTableOption("groupHeaderDownload", null), this.registerTableOption("groupToggleElement", "arrow"), this.registerTableOption("groupClosedShowCalcs", !1), this.registerTableFunction("setGroupBy", this.setGroupBy.bind(this)), this.registerTableFunction("setGroupValues", this.setGroupValues.bind(this)), this.registerTableFunction("setGroupStartOpen", this.setGroupStartOpen.bind(this)), this.registerTableFunction("setGroupHeader", this.setGroupHeader.bind(this)), this.registerTableFunction("getGroups", this.userGetGroups.bind(this)), this.registerTableFunction("getGroupedData", this.userGetGroupedData.bind(this)), this.registerComponentFunction("row", "getGroup", this.rowGetGroup.bind(this));
  }
  //initialize group configuration
  initialize() {
    this.subscribe("table-destroy", this._blockRedrawing.bind(this)), this.subscribe("rows-wipe", this._blockRedrawing.bind(this)), this.subscribe("rows-wiped", this._restore_redrawing.bind(this)), this.table.options.groupBy && (this.table.options.groupUpdateOnCellEdit && (this.subscribe("cell-value-updated", this.cellUpdated.bind(this)), this.subscribe("row-data-changed", this.reassignRowToGroup.bind(this), 0)), this.subscribe("table-built", this.configureGroupSetup.bind(this)), this.subscribe("row-deleting", this.rowDeleting.bind(this)), this.subscribe("row-deleted", this.rowsUpdated.bind(this)), this.subscribe("scroll-horizontal", this.scrollHeaders.bind(this)), this.subscribe("rows-wipe", this.wipe.bind(this)), this.subscribe("rows-added", this.rowsUpdated.bind(this)), this.subscribe("row-moving", this.rowMoving.bind(this)), this.subscribe("row-adding-index", this.rowAddingIndex.bind(this)), this.subscribe("rows-sample", this.rowSample.bind(this)), this.subscribe("render-virtual-fill", this.virtualRenderFill.bind(this)), this.registerDisplayHandler(this.displayHandler, 20), this.initialized = !0);
  }
  _blockRedrawing() {
    this.blockRedraw = !0;
  }
  _restore_redrawing() {
    this.blockRedraw = !1;
  }
  configureGroupSetup() {
    if (this.table.options.groupBy) {
      var e = this.table.options.groupBy, t = this.table.options.groupStartOpen, i = this.table.options.groupHeader;
      if (this.allowedValues = this.table.options.groupValues, Array.isArray(e) && Array.isArray(i) && e.length > i.length && console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"), this.headerGenerator = [function() {
        return "";
      }], this.startOpen = [function() {
        return !1;
      }], this.langBind("groups|item", (s, a) => {
        this.headerGenerator[0] = (o, l, h) => (typeof o > "u" ? "" : o) + "<span>(" + l + " " + (l === 1 ? s : a.groups.items) + ")</span>";
      }), this.groupIDLookups = [], e)
        this.table.modExists("columnCalcs") && this.table.options.columnCalcs != "table" && this.table.options.columnCalcs != "both" && this.table.modules.columnCalcs.removeCalcs();
      else if (this.table.modExists("columnCalcs") && this.table.options.columnCalcs != "group") {
        var n = this.table.columnManager.getRealColumns();
        n.forEach((s) => {
          s.definition.topCalc && this.table.modules.columnCalcs.initializeTopRow(), s.definition.bottomCalc && this.table.modules.columnCalcs.initializeBottomRow();
        });
      }
      Array.isArray(e) || (e = [e]), e.forEach((s, a) => {
        var o, l;
        typeof s == "function" ? o = s : (l = this.table.columnManager.getColumnByField(s), l ? o = function(h) {
          return l.getFieldValue(h);
        } : o = function(h) {
          return h[s];
        }), this.groupIDLookups.push({
          field: typeof s == "function" ? !1 : s,
          func: o,
          values: this.allowedValues ? this.allowedValues[a] : !1
        });
      }), t && (Array.isArray(t) || (t = [t]), t.forEach((s) => {
      }), this.startOpen = t), i && (this.headerGenerator = Array.isArray(i) ? i : [i]);
    } else
      this.groupList = [], this.groups = {};
  }
  rowSample(e, t) {
    if (this.table.options.groupBy) {
      var i = this.getGroups(!1)[0];
      t.push(i.getRows(!1)[0]);
    }
    return t;
  }
  virtualRenderFill() {
    var e = this.table.rowManager.tableElement, t = this.table.rowManager.getVisibleRows();
    if (this.table.options.groupBy)
      t = t.filter((i) => i.type !== "group"), e.style.minWidth = t.length ? "" : this.table.columnManager.getWidth() + "px";
    else
      return t;
  }
  rowAddingIndex(e, t, i) {
    if (this.table.options.groupBy) {
      this.assignRowToGroup(e);
      var n = e.modules.group.rows;
      return n.length > 1 && (!t || t && n.indexOf(t) == -1 ? i ? n[0] !== e && (t = n[0], this.table.rowManager.moveRowInArray(e.modules.group.rows, e, t, !i)) : n[n.length - 1] !== e && (t = n[n.length - 1], this.table.rowManager.moveRowInArray(e.modules.group.rows, e, t, !i)) : this.table.rowManager.moveRowInArray(e.modules.group.rows, e, t, !i)), t;
    }
  }
  trackChanges() {
    this.dispatch("group-changed");
  }
  ///////////////////////////////////
  ///////// Table Functions /////////
  ///////////////////////////////////
  setGroupBy(e) {
    this.table.options.groupBy = e, this.initialized || this.initialize(), this.configureGroupSetup(), !e && this.table.modExists("columnCalcs") && this.table.options.columnCalcs === !0 && this.table.modules.columnCalcs.reinitializeCalcs(), this.refreshData(), this.trackChanges();
  }
  setGroupValues(e) {
    this.table.options.groupValues = e, this.configureGroupSetup(), this.refreshData(), this.trackChanges();
  }
  setGroupStartOpen(e) {
    this.table.options.groupStartOpen = e, this.configureGroupSetup(), this.table.options.groupBy ? (this.refreshData(), this.trackChanges()) : console.warn("Grouping Update - cant refresh view, no groups have been set");
  }
  setGroupHeader(e) {
    this.table.options.groupHeader = e, this.configureGroupSetup(), this.table.options.groupBy ? (this.refreshData(), this.trackChanges()) : console.warn("Grouping Update - cant refresh view, no groups have been set");
  }
  userGetGroups(e) {
    return this.getGroups(!0);
  }
  // get grouped table data in the same format as getData()
  userGetGroupedData() {
    return this.table.options.groupBy ? this.getGroupedData() : this.getData();
  }
  ///////////////////////////////////////
  ///////// Component Functions /////////
  ///////////////////////////////////////
  rowGetGroup(e) {
    return e.modules.group ? e.modules.group.getComponent() : !1;
  }
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  rowMoving(e, t, i) {
    if (this.table.options.groupBy) {
      !i && t instanceof ws && (t = this.table.rowManager.prevDisplayRow(e) || t);
      var n = t instanceof ws ? t : t.modules.group, s = e instanceof ws ? e : e.modules.group;
      n === s ? this.table.rowManager.moveRowInArray(n.rows, e, t, i) : (s && s.removeRow(e), n.insertRow(e, t, i));
    }
  }
  rowDeleting(e) {
    this.table.options.groupBy && e.modules.group && e.modules.group.removeRow(e);
  }
  rowsUpdated(e) {
    this.table.options.groupBy && this.updateGroupRows(!0);
  }
  cellUpdated(e) {
    this.table.options.groupBy && this.reassignRowToGroup(e.row);
  }
  //return appropriate rows with group headers
  getRows(e) {
    return this.table.options.groupBy && this.groupIDLookups.length ? (this.dispatchExternal("dataGrouping"), this.generateGroups(e), this.subscribedExternal("dataGrouped") && this.dispatchExternal("dataGrouped", this.getGroups(!0)), this.updateGroupRows()) : e.slice(0);
  }
  getGroups(e) {
    var t = [];
    return this.groupList.forEach(function(i) {
      t.push(e ? i.getComponent() : i);
    }), t;
  }
  getChildGroups(e) {
    var t = [];
    return e || (e = this), e.groupList.forEach((i) => {
      i.groupList.length ? t = t.concat(this.getChildGroups(i)) : t.push(i);
    }), t;
  }
  wipe() {
    this.table.options.groupBy && (this.groupList.forEach(function(e) {
      e.wipe();
    }), this.groupList = [], this.groups = {});
  }
  pullGroupListData(e) {
    var t = [];
    return e.forEach((i) => {
      var n = {};
      n.level = 0, n.rowCount = 0, n.headerContent = "";
      var s = [];
      i.hasSubGroups ? (s = this.pullGroupListData(i.groupList), n.level = i.level, n.rowCount = s.length - i.groupList.length, n.headerContent = i.generator(i.key, n.rowCount, i.rows, i), t.push(n), t = t.concat(s)) : (n.level = i.level, n.headerContent = i.generator(i.key, i.rows.length, i.rows, i), n.rowCount = i.getRows().length, t.push(n), i.getRows().forEach((a) => {
        t.push(a.getData("data"));
      }));
    }), t;
  }
  getGroupedData() {
    return this.pullGroupListData(this.groupList);
  }
  getRowGroup(e) {
    var t = !1;
    return this.options("dataTree") && (e = this.table.modules.dataTree.getTreeParentRoot(e)), this.groupList.forEach((i) => {
      var n = i.getRowGroup(e);
      n && (t = n);
    }), t;
  }
  countGroups() {
    return this.groupList.length;
  }
  generateGroups(e) {
    var t = this.groups;
    this.groups = {}, this.groupList = [], this.allowedValues && this.allowedValues[0] ? (this.allowedValues[0].forEach((i) => {
      this.createGroup(i, 0, t);
    }), e.forEach((i) => {
      this.assignRowToExistingGroup(i, t);
    })) : e.forEach((i) => {
      this.assignRowToGroup(i, t);
    }), Object.values(t).forEach((i) => {
      i.wipe(!0);
    });
  }
  createGroup(e, t, i) {
    var n = t + "_" + e, s;
    i = i || [], s = new ws(this, !1, t, e, this.groupIDLookups[0].field, this.headerGenerator[0], i[n]), this.groups[n] = s, this.groupList.push(s);
  }
  assignRowToExistingGroup(e, t) {
    var i = this.groupIDLookups[0].func(e.getData()), n = "0_" + i;
    this.groups[n] && this.groups[n].addRow(e);
  }
  assignRowToGroup(e, t) {
    var i = this.groupIDLookups[0].func(e.getData()), n = !this.groups["0_" + i];
    return n && this.createGroup(i, 0, t), this.groups["0_" + i].addRow(e), !n;
  }
  reassignRowToGroup(e) {
    if (e.type === "row") {
      var t = e.modules.group, i = t.getPath(), n = this.getExpectedPath(e), s;
      s = i.length == n.length && i.every((a, o) => a === n[o]), s || (t.removeRow(e), this.assignRowToGroup(e, this.groups), this.refreshData(!0));
    }
  }
  getExpectedPath(e) {
    var t = [], i = e.getData();
    return this.groupIDLookups.forEach((n) => {
      t.push(n.func(i));
    }), t;
  }
  updateGroupRows(e) {
    var t = [];
    return this.blockRedraw || (this.groupList.forEach((i) => {
      t = t.concat(i.getHeadersAndRows());
    }), e && this.refreshData(!0)), t;
  }
  scrollHeaders(e) {
    this.table.options.groupBy && (this.table.options.renderHorizontal === "virtual" && (e -= this.table.columnManager.renderer.vDomPadLeft), e = e + "px", this.groupList.forEach((t) => {
      t.scrollHeader(e);
    }));
  }
  removeGroup(e) {
    var t = e.level + "_" + e.key, i;
    this.groups[t] && (delete this.groups[t], i = this.groupList.indexOf(e), i > -1 && this.groupList.splice(i, 1));
  }
  checkBasicModeGroupHeaderWidth() {
    var e = this.table.rowManager.tableElement, t = !0;
    this.table.rowManager.getDisplayRows().forEach((i, n) => {
      this.table.rowManager.styleRow(i, n), e.appendChild(i.getElement()), i.initialize(!0), i.type !== "group" && (t = !1);
    }), t ? e.style.minWidth = this.table.columnManager.getWidth() + "px" : e.style.minWidth = "";
  }
}
A(Fp, "moduleName", "groupRows");
var Dy = {
  cellEdit: function(r) {
    r.component.setValueProcessData(r.data.oldValue), r.component.cellRendered();
  },
  rowAdd: function(r) {
    r.component.deleteActual(), this.table.rowManager.checkPlaceholder();
  },
  rowDelete: function(r) {
    var e = this.table.rowManager.addRowActual(r.data.data, r.data.pos, r.data.index);
    this.table.options.groupBy && this.table.modExists("groupRows") && this.table.modules.groupRows.updateGroupRows(!0), this._rebindRow(r.component, e), this.table.rowManager.checkPlaceholder();
  },
  rowMove: function(r) {
    var e = r.data.posFrom - r.data.posTo > 0;
    this.table.rowManager.moveRowActual(r.component, this.table.rowManager.getRowFromPosition(r.data.posFrom), e), this.table.rowManager.regenerateRowPositions(), this.table.rowManager.reRenderInPosition();
  }
}, Ly = {
  cellEdit: function(r) {
    r.component.setValueProcessData(r.data.newValue), r.component.cellRendered();
  },
  rowAdd: function(r) {
    var e = this.table.rowManager.addRowActual(r.data.data, r.data.pos, r.data.index);
    this.table.options.groupBy && this.table.modExists("groupRows") && this.table.modules.groupRows.updateGroupRows(!0), this._rebindRow(r.component, e), this.table.rowManager.checkPlaceholder();
  },
  rowDelete: function(r) {
    r.component.deleteActual(), this.table.rowManager.checkPlaceholder();
  },
  rowMove: function(r) {
    this.table.rowManager.moveRowActual(r.component, this.table.rowManager.getRowFromPosition(r.data.posTo), r.data.after), this.table.rowManager.regenerateRowPositions(), this.table.rowManager.reRenderInPosition();
  }
}, ky = {
  undo: ["ctrl + 90", "meta + 90"],
  redo: ["ctrl + 89", "meta + 89"]
}, Ay = {
  undo: function(r) {
    var e = !1;
    this.table.options.history && this.table.modExists("history") && this.table.modExists("edit") && (e = this.table.modules.edit.currentCell, e || (r.preventDefault(), this.table.modules.history.undo()));
  },
  redo: function(r) {
    var e = !1;
    this.table.options.history && this.table.modExists("history") && this.table.modExists("edit") && (e = this.table.modules.edit.currentCell, e || (r.preventDefault(), this.table.modules.history.redo()));
  }
}, Py = {
  keybindings: {
    bindings: ky,
    actions: Ay
  }
};
const mi = class mi extends U {
  constructor(e) {
    super(e), this.history = [], this.index = -1, this.registerTableOption("history", !1);
  }
  initialize() {
    this.table.options.history && (this.subscribe("cell-value-updated", this.cellUpdated.bind(this)), this.subscribe("cell-delete", this.clearComponentHistory.bind(this)), this.subscribe("row-delete", this.rowDeleted.bind(this)), this.subscribe("rows-wipe", this.clear.bind(this)), this.subscribe("row-added", this.rowAdded.bind(this)), this.subscribe("row-move", this.rowMoved.bind(this))), this.registerTableFunction("undo", this.undo.bind(this)), this.registerTableFunction("redo", this.redo.bind(this)), this.registerTableFunction("getHistoryUndoSize", this.getHistoryUndoSize.bind(this)), this.registerTableFunction("getHistoryRedoSize", this.getHistoryRedoSize.bind(this)), this.registerTableFunction("clearHistory", this.clear.bind(this));
  }
  rowMoved(e, t, i) {
    this.action("rowMove", e, { posFrom: e.getPosition(), posTo: t.getPosition(), to: t, after: i });
  }
  rowAdded(e, t, i, n) {
    this.action("rowAdd", e, { data: t, pos: i, index: n });
  }
  rowDeleted(e) {
    var t, i;
    this.table.options.groupBy ? (i = e.getComponent().getGroup()._getSelf().rows, t = i.indexOf(e), t && (t = i[t - 1])) : (t = e.table.rowManager.getRowIndex(e), t && (t = e.table.rowManager.rows[t - 1])), this.action("rowDelete", e, { data: e.getData(), pos: !t, index: t });
  }
  cellUpdated(e) {
    this.action("cellEdit", e, { oldValue: e.oldValue, newValue: e.value });
  }
  clear() {
    this.history = [], this.index = -1;
  }
  action(e, t, i) {
    this.history = this.history.slice(0, this.index + 1), this.history.push({
      type: e,
      component: t,
      data: i
    }), this.index++;
  }
  getHistoryUndoSize() {
    return this.index + 1;
  }
  getHistoryRedoSize() {
    return this.history.length - (this.index + 1);
  }
  clearComponentHistory(e) {
    var t = this.history.findIndex(function(i) {
      return i.component === e;
    });
    t > -1 && (this.history.splice(t, 1), t <= this.index && this.index--, this.clearComponentHistory(e));
  }
  undo() {
    if (this.index > -1) {
      let e = this.history[this.index];
      return mi.undoers[e.type].call(this, e), this.index--, this.dispatchExternal("historyUndo", e.type, e.component.getComponent(), e.data), !0;
    } else
      return console.warn(this.options("history") ? "History Undo Error - No more history to undo" : "History module not enabled"), !1;
  }
  redo() {
    if (this.history.length - 1 > this.index) {
      this.index++;
      let e = this.history[this.index];
      return mi.redoers[e.type].call(this, e), this.dispatchExternal("historyRedo", e.type, e.component.getComponent(), e.data), !0;
    } else
      return console.warn(this.options("history") ? "History Redo Error - No more history to redo" : "History module not enabled"), !1;
  }
  //rebind rows to new element after deletion
  _rebindRow(e, t) {
    this.history.forEach(function(i) {
      if (i.component instanceof ze)
        i.component === e && (i.component = t);
      else if (i.component instanceof gs && i.component.row === e) {
        var n = i.component.column.getField();
        n && (i.component = t.getCell(n));
      }
    });
  }
};
A(mi, "moduleName", "history"), A(mi, "moduleExtensions", Py), //load defaults
A(mi, "undoers", Dy), A(mi, "redoers", Ly);
let Xl = mi;
class Hp extends U {
  constructor(e) {
    super(e), this.fieldIndex = [], this.hasIndex = !1;
  }
  initialize() {
    this.tableElementCheck();
  }
  tableElementCheck() {
    this.table.originalElement && this.table.originalElement.tagName === "TABLE" && (this.table.originalElement.childNodes.length ? this.parseTable() : console.warn("Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element."));
  }
  parseTable() {
    var e = this.table.originalElement, t = this.table.options, i = e.getElementsByTagName("th"), n = e.getElementsByTagName("tbody")[0], s = [];
    this.hasIndex = !1, this.dispatchExternal("htmlImporting"), n = n ? n.getElementsByTagName("tr") : [], this._extractOptions(e, t), i.length ? this._extractHeaders(i, n) : this._generateBlankHeaders(i, n);
    for (var a = 0; a < n.length; a++) {
      var o = n[a], l = o.getElementsByTagName("td"), h = {};
      this.hasIndex || (h[t.index] = a);
      for (var u = 0; u < l.length; u++) {
        var d = l[u];
        typeof this.fieldIndex[u] < "u" && (h[this.fieldIndex[u]] = d.innerHTML);
      }
      s.push(h);
    }
    t.data = s, this.dispatchExternal("htmlImported");
  }
  //extract tabulator attribute options
  _extractOptions(e, t, i) {
    var n = e.attributes, s = Object.keys(i || t), a = {};
    s.forEach((u) => {
      a[u.toLowerCase()] = u;
    });
    for (var o in n) {
      var l = n[o], h;
      l && typeof l == "object" && l.name && l.name.indexOf("tabulator-") === 0 && (h = l.name.replace("tabulator-", ""), typeof a[h] < "u" && (t[a[h]] = this._attribValue(l.value)));
    }
  }
  //get value of attribute
  _attribValue(e) {
    return e === "true" ? !0 : e === "false" ? !1 : e;
  }
  //find column if it has already been defined
  _findCol(e) {
    var t = this.table.options.columns.find((i) => i.title === e);
    return t || !1;
  }
  //extract column from headers
  _extractHeaders(e, t) {
    for (var i = 0; i < e.length; i++) {
      var n = e[i], s = !1, a = this._findCol(n.textContent), o;
      a ? s = !0 : a = { title: n.textContent.trim() }, a.field || (a.field = n.textContent.trim().toLowerCase().replaceAll(" ", "_")), o = n.getAttribute("width"), o && !a.width && (a.width = o), this._extractOptions(n, a, this.table.columnManager.optionsList.registeredDefaults), this.fieldIndex[i] = a.field, a.field == this.table.options.index && (this.hasIndex = !0), s || this.table.options.columns.push(a);
    }
  }
  //generate blank headers
  _generateBlankHeaders(e, t) {
    for (var i = 0; i < e.length; i++) {
      var n = e[i], s = { title: "", field: "col" + i };
      this.fieldIndex[i] = s.field;
      var a = n.getAttribute("width");
      a && (s.width = a), this.table.options.columns.push(s);
    }
  }
}
A(Hp, "moduleName", "htmlTableImport");
function Oy(r) {
  var e = [], t = 0, i = 0, n = !1;
  for (let s = 0; s < r.length; s++) {
    let a = r[s], o = r[s + 1];
    if (e[t] || (e[t] = []), e[t][i] || (e[t][i] = ""), a == '"' && n && o == '"') {
      e[t][i] += a, s++;
      continue;
    }
    if (a == '"') {
      n = !n;
      continue;
    }
    if (a == "," && !n) {
      i++;
      continue;
    }
    if (a == "\r" && o == `
` && !n) {
      i = 0, t++, s++;
      continue;
    }
    if ((a == "\r" || a == `
`) && !n) {
      i = 0, t++;
      continue;
    }
    e[t][i] += a;
  }
  return e;
}
function Iy(r) {
  try {
    return JSON.parse(r);
  } catch (e) {
    return console.warn("JSON Import Error - File contents is invalid JSON", e), Promise.reject();
  }
}
function zy(r) {
  return r;
}
function Fy(r) {
  var e = this.dependencyRegistry.lookup("XLSX"), t = e.read(r), i = t.Sheets[t.SheetNames[0]];
  return e.utils.sheet_to_json(i, { header: 1 });
}
var Hy = {
  csv: Oy,
  json: Iy,
  array: zy,
  xlsx: Fy
};
const es = class es extends U {
  constructor(e) {
    super(e), this.registerTableOption("importFormat"), this.registerTableOption("importReader", "text"), this.registerTableOption("importHeaderTransform"), this.registerTableOption("importValueTransform"), this.registerTableOption("importDataValidator"), this.registerTableOption("importFileValidator");
  }
  initialize() {
    this.registerTableFunction("import", this.importFromFile.bind(this)), this.table.options.importFormat && (this.subscribe("data-loading", this.loadDataCheck.bind(this), 10), this.subscribe("data-load", this.loadData.bind(this), 10));
  }
  loadDataCheck(e) {
    return this.table.options.importFormat && (typeof e == "string" || Array.isArray(e) && e.length && Array.isArray(e));
  }
  loadData(e, t, i, n, s) {
    return this.importData(this.lookupImporter(), e).then(this.structureData.bind(this)).catch((a) => (console.error("Import Error:", a || "Unable to import data"), Promise.reject(a)));
  }
  lookupImporter(e) {
    var t;
    return e || (e = this.table.options.importFormat), typeof e == "string" ? t = es.importers[e] : t = e, t || console.error("Import Error - Importer not found:", e), t;
  }
  importFromFile(e, t, i) {
    var n = this.lookupImporter(e);
    if (n)
      return this.pickFile(t, i).then(this.importData.bind(this, n)).then(this.structureData.bind(this)).then(this.mutateData.bind(this)).then(this.validateData.bind(this)).then(this.setData.bind(this)).catch((s) => (this.dispatch("import-error", s), this.dispatchExternal("importError", s), console.error("Import Error:", s || "Unable to import file"), this.table.dataLoader.alertError(), setTimeout(() => {
        this.table.dataLoader.clearAlert();
      }, 3e3), Promise.reject(s)));
  }
  pickFile(e, t) {
    return new Promise((i, n) => {
      var s = document.createElement("input");
      s.type = "file", s.accept = e, s.addEventListener("change", (a) => {
        var o = s.files[0], l = new FileReader(), h = this.validateFile(o);
        if (h === !0) {
          switch (this.dispatch("import-importing", s.files), this.dispatchExternal("importImporting", s.files), t || this.table.options.importReader) {
            case "buffer":
              l.readAsArrayBuffer(o);
              break;
            case "binary":
              l.readAsBinaryString(o);
              break;
            case "url":
              l.readAsDataURL(o);
              break;
            case "text":
            default:
              l.readAsText(o);
          }
          l.onload = (u) => {
            i(l.result);
          }, l.onerror = (u) => {
            console.warn("File Load Error - Unable to read file"), n(u);
          };
        } else
          n(h);
      }), this.dispatch("import-choose"), this.dispatchExternal("importChoose"), s.click();
    });
  }
  importData(e, t) {
    var i;
    return this.table.dataLoader.alertLoader(), new Promise((n, s) => {
      setTimeout(() => {
        i = e.call(this.table, t), i instanceof Promise || i ? n(i) : s();
      }, 10);
    });
  }
  structureData(e) {
    var t = [];
    return Array.isArray(e) && e.length && Array.isArray(e[0]) ? (this.table.options.autoColumns ? t = this.structureArrayToObject(e) : t = this.structureArrayToColumns(e), t) : e;
  }
  mutateData(e) {
    var t = [];
    return Array.isArray(e) ? e.forEach((i) => {
      t.push(this.table.modules.mutator.transformRow(i, "import"));
    }) : t = e, t;
  }
  transformHeader(e) {
    var t = [];
    if (this.table.options.importHeaderTransform)
      e.forEach((i) => {
        t.push(this.table.options.importHeaderTransform.call(this.table, i, e));
      });
    else
      return e;
    return t;
  }
  transformData(e) {
    var t = [];
    if (this.table.options.importValueTransform)
      e.forEach((i) => {
        t.push(this.table.options.importValueTransform.call(this.table, i, e));
      });
    else
      return e;
    return t;
  }
  structureArrayToObject(e) {
    var t = this.transformHeader(e.shift()), i = e.map((n) => {
      var s = {};
      return n = this.transformData(n), t.forEach((a, o) => {
        s[a] = n[o];
      }), s;
    });
    return i;
  }
  structureArrayToColumns(e) {
    var t = [], i = this.transformHeader(e[0]), n = this.table.getColumns();
    return n[0] && i[0] && n[0].getDefinition().title === i[0] && e.shift(), e.forEach((s) => {
      var a = {};
      s = this.transformData(s), s.forEach((o, l) => {
        var h = n[l];
        h && (a[h.getField()] = o);
      }), t.push(a);
    }), t;
  }
  validateFile(e) {
    return this.table.options.importFileValidator ? this.table.options.importFileValidator.call(this.table, e) : !0;
  }
  validateData(e) {
    var t;
    return this.table.options.importDataValidator ? (t = this.table.options.importDataValidator.call(this.table, e), t === !0 ? e : Promise.reject(t)) : e;
  }
  setData(e) {
    return this.dispatch("import-imported", e), this.dispatchExternal("importImported", e), this.table.dataLoader.clearAlert(), this.table.setData(e);
  }
};
A(es, "moduleName", "import"), //load defaults
A(es, "importers", Hy);
let $l = es;
class Np extends U {
  constructor(e) {
    super(e), this.eventMap = {
      //row events
      rowClick: "row-click",
      rowDblClick: "row-dblclick",
      rowContext: "row-contextmenu",
      rowMouseEnter: "row-mouseenter",
      rowMouseLeave: "row-mouseleave",
      rowMouseOver: "row-mouseover",
      rowMouseOut: "row-mouseout",
      rowMouseMove: "row-mousemove",
      rowMouseDown: "row-mousedown",
      rowMouseUp: "row-mouseup",
      rowTap: "row",
      rowDblTap: "row",
      rowTapHold: "row",
      //cell events
      cellClick: "cell-click",
      cellDblClick: "cell-dblclick",
      cellContext: "cell-contextmenu",
      cellMouseEnter: "cell-mouseenter",
      cellMouseLeave: "cell-mouseleave",
      cellMouseOver: "cell-mouseover",
      cellMouseOut: "cell-mouseout",
      cellMouseMove: "cell-mousemove",
      cellMouseDown: "cell-mousedown",
      cellMouseUp: "cell-mouseup",
      cellTap: "cell",
      cellDblTap: "cell",
      cellTapHold: "cell",
      //column header events
      headerClick: "column-click",
      headerDblClick: "column-dblclick",
      headerContext: "column-contextmenu",
      headerMouseEnter: "column-mouseenter",
      headerMouseLeave: "column-mouseleave",
      headerMouseOver: "column-mouseover",
      headerMouseOut: "column-mouseout",
      headerMouseMove: "column-mousemove",
      headerMouseDown: "column-mousedown",
      headerMouseUp: "column-mouseup",
      headerTap: "column",
      headerDblTap: "column",
      headerTapHold: "column",
      //group header
      groupClick: "group-click",
      groupDblClick: "group-dblclick",
      groupContext: "group-contextmenu",
      groupMouseEnter: "group-mouseenter",
      groupMouseLeave: "group-mouseleave",
      groupMouseOver: "group-mouseover",
      groupMouseOut: "group-mouseout",
      groupMouseMove: "group-mousemove",
      groupMouseDown: "group-mousedown",
      groupMouseUp: "group-mouseup",
      groupTap: "group",
      groupDblTap: "group",
      groupTapHold: "group"
    }, this.subscribers = {}, this.touchSubscribers = {}, this.columnSubscribers = {}, this.touchWatchers = {
      row: {
        tap: null,
        tapDbl: null,
        tapHold: null
      },
      cell: {
        tap: null,
        tapDbl: null,
        tapHold: null
      },
      column: {
        tap: null,
        tapDbl: null,
        tapHold: null
      },
      group: {
        tap: null,
        tapDbl: null,
        tapHold: null
      }
    }, this.registerColumnOption("headerClick"), this.registerColumnOption("headerDblClick"), this.registerColumnOption("headerContext"), this.registerColumnOption("headerMouseEnter"), this.registerColumnOption("headerMouseLeave"), this.registerColumnOption("headerMouseOver"), this.registerColumnOption("headerMouseOut"), this.registerColumnOption("headerMouseMove"), this.registerColumnOption("headerMouseDown"), this.registerColumnOption("headerMouseUp"), this.registerColumnOption("headerTap"), this.registerColumnOption("headerDblTap"), this.registerColumnOption("headerTapHold"), this.registerColumnOption("cellClick"), this.registerColumnOption("cellDblClick"), this.registerColumnOption("cellContext"), this.registerColumnOption("cellMouseEnter"), this.registerColumnOption("cellMouseLeave"), this.registerColumnOption("cellMouseOver"), this.registerColumnOption("cellMouseOut"), this.registerColumnOption("cellMouseMove"), this.registerColumnOption("cellMouseDown"), this.registerColumnOption("cellMouseUp"), this.registerColumnOption("cellTap"), this.registerColumnOption("cellDblTap"), this.registerColumnOption("cellTapHold");
  }
  initialize() {
    this.initializeExternalEvents(), this.subscribe("column-init", this.initializeColumn.bind(this)), this.subscribe("cell-dblclick", this.cellContentsSelectionFixer.bind(this)), this.subscribe("scroll-horizontal", this.clearTouchWatchers.bind(this)), this.subscribe("scroll-vertical", this.clearTouchWatchers.bind(this));
  }
  clearTouchWatchers() {
    var e = Object.values(this.touchWatchers);
    e.forEach((t) => {
      for (let i in t)
        t[i] = null;
    });
  }
  cellContentsSelectionFixer(e, t) {
    var i;
    if (!(this.table.modExists("edit") && this.table.modules.edit.currentCell === t)) {
      e.preventDefault();
      try {
        document.selection ? (i = document.body.createTextRange(), i.moveToElementText(t.getElement()), i.select()) : window.getSelection && (i = document.createRange(), i.selectNode(t.getElement()), window.getSelection().removeAllRanges(), window.getSelection().addRange(i));
      } catch {
      }
    }
  }
  initializeExternalEvents() {
    for (let e in this.eventMap)
      this.subscriptionChangeExternal(e, this.subscriptionChanged.bind(this, e));
  }
  subscriptionChanged(e, t) {
    t ? this.subscribers[e] || (this.eventMap[e].includes("-") ? (this.subscribers[e] = this.handle.bind(this, e), this.subscribe(this.eventMap[e], this.subscribers[e])) : this.subscribeTouchEvents(e)) : this.eventMap[e].includes("-") ? this.subscribers[e] && !this.columnSubscribers[e] && !this.subscribedExternal(e) && (this.unsubscribe(this.eventMap[e], this.subscribers[e]), delete this.subscribers[e]) : this.unsubscribeTouchEvents(e);
  }
  subscribeTouchEvents(e) {
    var t = this.eventMap[e];
    this.touchSubscribers[t + "-touchstart"] || (this.touchSubscribers[t + "-touchstart"] = this.handleTouch.bind(this, t, "start"), this.touchSubscribers[t + "-touchend"] = this.handleTouch.bind(this, t, "end"), this.subscribe(t + "-touchstart", this.touchSubscribers[t + "-touchstart"]), this.subscribe(t + "-touchend", this.touchSubscribers[t + "-touchend"])), this.subscribers[e] = !0;
  }
  unsubscribeTouchEvents(e) {
    var t = !0, i = this.eventMap[e];
    if (this.subscribers[e] && !this.subscribedExternal(e)) {
      delete this.subscribers[e];
      for (let n in this.eventMap)
        this.eventMap[n] === i && this.subscribers[n] && (t = !1);
      t && (this.unsubscribe(i + "-touchstart", this.touchSubscribers[i + "-touchstart"]), this.unsubscribe(i + "-touchend", this.touchSubscribers[i + "-touchend"]), delete this.touchSubscribers[i + "-touchstart"], delete this.touchSubscribers[i + "-touchend"]);
    }
  }
  initializeColumn(e) {
    var t = e.definition;
    for (let i in this.eventMap)
      t[i] && (this.subscriptionChanged(i, !0), this.columnSubscribers[i] || (this.columnSubscribers[i] = []), this.columnSubscribers[i].push(e));
  }
  handle(e, t, i) {
    this.dispatchEvent(e, t, i);
  }
  handleTouch(e, t, i, n) {
    var s = this.touchWatchers[e];
    switch (e === "column" && (e = "header"), t) {
      case "start":
        s.tap = !0, clearTimeout(s.tapHold), s.tapHold = setTimeout(() => {
          clearTimeout(s.tapHold), s.tapHold = null, s.tap = null, clearTimeout(s.tapDbl), s.tapDbl = null, this.dispatchEvent(e + "TapHold", i, n);
        }, 1e3);
        break;
      case "end":
        s.tap && (s.tap = null, this.dispatchEvent(e + "Tap", i, n)), s.tapDbl ? (clearTimeout(s.tapDbl), s.tapDbl = null, this.dispatchEvent(e + "DblTap", i, n)) : s.tapDbl = setTimeout(() => {
          clearTimeout(s.tapDbl), s.tapDbl = null;
        }, 300), clearTimeout(s.tapHold), s.tapHold = null;
        break;
    }
  }
  dispatchEvent(e, t, i) {
    var n = i.getComponent(), s;
    this.columnSubscribers[e] && (i instanceof gs ? s = i.column.definition[e] : i instanceof rr && (s = i.definition[e]), s && s(t, n)), this.dispatchExternal(e, t, n);
  }
}
A(Np, "moduleName", "interaction");
var Ny = {
  navPrev: "shift + 9",
  navNext: 9,
  navUp: 38,
  navDown: 40,
  navLeft: 37,
  navRight: 39,
  scrollPageUp: 33,
  scrollPageDown: 34,
  scrollToStart: 36,
  scrollToEnd: 35
}, By = {
  keyBlock: function(r) {
    r.stopPropagation(), r.preventDefault();
  },
  scrollPageUp: function(r) {
    var e = this.table.rowManager, t = e.scrollTop - e.element.clientHeight;
    r.preventDefault(), e.displayRowsCount && (t >= 0 ? e.element.scrollTop = t : e.scrollToRow(e.getDisplayRows()[0])), this.table.element.focus();
  },
  scrollPageDown: function(r) {
    var e = this.table.rowManager, t = e.scrollTop + e.element.clientHeight, i = e.element.scrollHeight;
    r.preventDefault(), e.displayRowsCount && (t <= i ? e.element.scrollTop = t : e.scrollToRow(e.getDisplayRows()[e.displayRowsCount - 1])), this.table.element.focus();
  },
  scrollToStart: function(r) {
    var e = this.table.rowManager;
    r.preventDefault(), e.displayRowsCount && e.scrollToRow(e.getDisplayRows()[0]), this.table.element.focus();
  },
  scrollToEnd: function(r) {
    var e = this.table.rowManager;
    r.preventDefault(), e.displayRowsCount && e.scrollToRow(e.getDisplayRows()[e.displayRowsCount - 1]), this.table.element.focus();
  },
  navPrev: function(r) {
    this.dispatch("keybinding-nav-prev", r);
  },
  navNext: function(r) {
    this.dispatch("keybinding-nav-next", r);
  },
  navLeft: function(r) {
    this.dispatch("keybinding-nav-left", r);
  },
  navRight: function(r) {
    this.dispatch("keybinding-nav-right", r);
  },
  navUp: function(r) {
    this.dispatch("keybinding-nav-up", r);
  },
  navDown: function(r) {
    this.dispatch("keybinding-nav-down", r);
  }
};
const bi = class bi extends U {
  constructor(e) {
    super(e), this.watchKeys = null, this.pressedKeys = null, this.keyupBinding = !1, this.keydownBinding = !1, this.registerTableOption("keybindings", {}), this.registerTableOption("tabEndNewRow", !1);
  }
  initialize() {
    var e = this.table.options.keybindings, t = {};
    this.watchKeys = {}, this.pressedKeys = [], e !== !1 && (Object.assign(t, bi.bindings), Object.assign(t, e), this.mapBindings(t), this.bindEvents()), this.subscribe("table-destroy", this.clearBindings.bind(this));
  }
  mapBindings(e) {
    for (let t in e)
      bi.actions[t] ? e[t] && (typeof e[t] != "object" && (e[t] = [e[t]]), e[t].forEach((i) => {
        var n = Array.isArray(i) ? i : [i];
        n.forEach((s) => {
          this.mapBinding(t, s);
        });
      })) : console.warn("Key Binding Error - no such action:", t);
  }
  mapBinding(e, t) {
    var i = {
      action: bi.actions[e],
      keys: [],
      ctrl: !1,
      shift: !1,
      meta: !1
    }, n = t.toString().toLowerCase().split(" ").join("").split("+");
    n.forEach((s) => {
      switch (s) {
        case "ctrl":
          i.ctrl = !0;
          break;
        case "shift":
          i.shift = !0;
          break;
        case "meta":
          i.meta = !0;
          break;
        default:
          s = isNaN(s) ? s.toUpperCase().charCodeAt(0) : parseInt(s), i.keys.push(s), this.watchKeys[s] || (this.watchKeys[s] = []), this.watchKeys[s].push(i);
      }
    });
  }
  bindEvents() {
    var e = this;
    this.keyupBinding = function(t) {
      var i = t.keyCode, n = e.watchKeys[i];
      n && (e.pressedKeys.push(i), n.forEach(function(s) {
        e.checkBinding(t, s);
      }));
    }, this.keydownBinding = function(t) {
      var i = t.keyCode, n = e.watchKeys[i];
      if (n) {
        var s = e.pressedKeys.indexOf(i);
        s > -1 && e.pressedKeys.splice(s, 1);
      }
    }, this.table.element.addEventListener("keydown", this.keyupBinding), this.table.element.addEventListener("keyup", this.keydownBinding);
  }
  clearBindings() {
    this.keyupBinding && this.table.element.removeEventListener("keydown", this.keyupBinding), this.keydownBinding && this.table.element.removeEventListener("keyup", this.keydownBinding);
  }
  checkBinding(e, t) {
    var i = !0;
    return e.ctrlKey == t.ctrl && e.shiftKey == t.shift && e.metaKey == t.meta ? (t.keys.forEach((n) => {
      var s = this.pressedKeys.indexOf(n);
      s == -1 && (i = !1);
    }), i && t.action.call(this, e), !0) : !1;
  }
};
A(bi, "moduleName", "keybindings"), //load defaults
A(bi, "bindings", Ny), A(bi, "actions", By);
let ql = bi;
class Bp extends U {
  constructor(e) {
    super(e), this.menuContainer = null, this.nestedMenuBlock = !1, this.currentComponent = null, this.rootPopup = null, this.columnSubscribers = {}, this.registerTableOption("rowContextMenu", !1), this.registerTableOption("rowClickMenu", !1), this.registerTableOption("rowDblClickMenu", !1), this.registerTableOption("groupContextMenu", !1), this.registerTableOption("groupClickMenu", !1), this.registerTableOption("groupDblClickMenu", !1), this.registerColumnOption("headerContextMenu"), this.registerColumnOption("headerClickMenu"), this.registerColumnOption("headerDblClickMenu"), this.registerColumnOption("headerMenu"), this.registerColumnOption("headerMenuIcon"), this.registerColumnOption("contextMenu"), this.registerColumnOption("clickMenu"), this.registerColumnOption("dblClickMenu");
  }
  initialize() {
    this.deprecatedOptionsCheck(), this.initializeRowWatchers(), this.initializeGroupWatchers(), this.subscribe("column-init", this.initializeColumn.bind(this));
  }
  deprecatedOptionsCheck() {
  }
  initializeRowWatchers() {
    this.table.options.rowContextMenu && (this.subscribe("row-contextmenu", this.loadMenuEvent.bind(this, this.table.options.rowContextMenu)), this.table.on("rowTapHold", this.loadMenuEvent.bind(this, this.table.options.rowContextMenu))), this.table.options.rowClickMenu && this.subscribe("row-click", this.loadMenuEvent.bind(this, this.table.options.rowClickMenu)), this.table.options.rowDblClickMenu && this.subscribe("row-dblclick", this.loadMenuEvent.bind(this, this.table.options.rowDblClickMenu));
  }
  initializeGroupWatchers() {
    this.table.options.groupContextMenu && (this.subscribe("group-contextmenu", this.loadMenuEvent.bind(this, this.table.options.groupContextMenu)), this.table.on("groupTapHold", this.loadMenuEvent.bind(this, this.table.options.groupContextMenu))), this.table.options.groupClickMenu && this.subscribe("group-click", this.loadMenuEvent.bind(this, this.table.options.groupClickMenu)), this.table.options.groupDblClickMenu && this.subscribe("group-dblclick", this.loadMenuEvent.bind(this, this.table.options.groupDblClickMenu));
  }
  initializeColumn(e) {
    var t = e.definition;
    t.headerContextMenu && !this.columnSubscribers.headerContextMenu && (this.columnSubscribers.headerContextMenu = this.loadMenuTableColumnEvent.bind(this, "headerContextMenu"), this.subscribe("column-contextmenu", this.columnSubscribers.headerContextMenu), this.table.on("headerTapHold", this.loadMenuTableColumnEvent.bind(this, "headerContextMenu"))), t.headerClickMenu && !this.columnSubscribers.headerClickMenu && (this.columnSubscribers.headerClickMenu = this.loadMenuTableColumnEvent.bind(this, "headerClickMenu"), this.subscribe("column-click", this.columnSubscribers.headerClickMenu)), t.headerDblClickMenu && !this.columnSubscribers.headerDblClickMenu && (this.columnSubscribers.headerDblClickMenu = this.loadMenuTableColumnEvent.bind(this, "headerDblClickMenu"), this.subscribe("column-dblclick", this.columnSubscribers.headerDblClickMenu)), t.headerMenu && this.initializeColumnHeaderMenu(e), t.contextMenu && !this.columnSubscribers.contextMenu && (this.columnSubscribers.contextMenu = this.loadMenuTableCellEvent.bind(this, "contextMenu"), this.subscribe("cell-contextmenu", this.columnSubscribers.contextMenu), this.table.on("cellTapHold", this.loadMenuTableCellEvent.bind(this, "contextMenu"))), t.clickMenu && !this.columnSubscribers.clickMenu && (this.columnSubscribers.clickMenu = this.loadMenuTableCellEvent.bind(this, "clickMenu"), this.subscribe("cell-click", this.columnSubscribers.clickMenu)), t.dblClickMenu && !this.columnSubscribers.dblClickMenu && (this.columnSubscribers.dblClickMenu = this.loadMenuTableCellEvent.bind(this, "dblClickMenu"), this.subscribe("cell-dblclick", this.columnSubscribers.dblClickMenu));
  }
  initializeColumnHeaderMenu(e) {
    var t = e.definition.headerMenuIcon, i;
    i = document.createElement("span"), i.classList.add("tabulator-header-popup-button"), t ? (typeof t == "function" && (t = t(e.getComponent())), t instanceof HTMLElement ? i.appendChild(t) : i.innerHTML = t) : i.innerHTML = "&vellip;", i.addEventListener("click", (n) => {
      n.stopPropagation(), n.preventDefault(), this.loadMenuEvent(e.definition.headerMenu, n, e);
    }), e.titleElement.insertBefore(i, e.titleElement.firstChild);
  }
  loadMenuTableCellEvent(e, t, i) {
    i._cell && (i = i._cell), i.column.definition[e] && this.loadMenuEvent(i.column.definition[e], t, i);
  }
  loadMenuTableColumnEvent(e, t, i) {
    i._column && (i = i._column), i.definition[e] && this.loadMenuEvent(i.definition[e], t, i);
  }
  loadMenuEvent(e, t, i) {
    i._group ? i = i._group : i._row && (i = i._row), e = typeof e == "function" ? e.call(this.table, t, i.getComponent()) : e, this.loadMenu(t, i, e);
  }
  loadMenu(e, t, i, n, s) {
    var a = !(e instanceof MouseEvent), o = document.createElement("div"), l;
    if (o.classList.add("tabulator-menu"), a || e.preventDefault(), !(!i || !i.length)) {
      if (n)
        l = s.child(o);
      else {
        if (this.nestedMenuBlock) {
          if (this.rootPopup)
            return;
        } else
          this.nestedMenuBlock = setTimeout(() => {
            this.nestedMenuBlock = !1;
          }, 100);
        this.rootPopup && this.rootPopup.hide(), this.rootPopup = l = this.popup(o);
      }
      i.forEach((h) => {
        var u = document.createElement("div"), d = h.label, c = h.disabled;
        h.separator ? u.classList.add("tabulator-menu-separator") : (u.classList.add("tabulator-menu-item"), typeof d == "function" && (d = d.call(this.table, t.getComponent())), d instanceof Node ? u.appendChild(d) : u.innerHTML = d, typeof c == "function" && (c = c.call(this.table, t.getComponent())), c ? (u.classList.add("tabulator-menu-item-disabled"), u.addEventListener("click", (f) => {
          f.stopPropagation();
        })) : h.menu && h.menu.length ? u.addEventListener("click", (f) => {
          f.stopPropagation(), this.loadMenu(f, t, h.menu, u, l);
        }) : h.action && u.addEventListener("click", (f) => {
          h.action(f, t.getComponent());
        }), h.menu && h.menu.length && u.classList.add("tabulator-menu-item-submenu")), o.appendChild(u);
      }), o.addEventListener("click", (h) => {
        this.rootPopup && this.rootPopup.hide();
      }), l.show(n || e), l === this.rootPopup && (this.rootPopup.hideOnBlur(() => {
        this.rootPopup = null, this.currentComponent && (this.dispatch("menu-closed", i, l), this.dispatchExternal("menuClosed", this.currentComponent.getComponent()), this.currentComponent = null);
      }), this.currentComponent = t, this.dispatch("menu-opened", i, l), this.dispatchExternal("menuOpened", t.getComponent()));
    }
  }
}
A(Bp, "moduleName", "menu");
class Vp extends U {
  constructor(e) {
    super(e), this.placeholderElement = this.createPlaceholderElement(), this.hoverElement = !1, this.checkTimeout = !1, this.checkPeriod = 250, this.moving = !1, this.toCol = !1, this.toColAfter = !1, this.startX = 0, this.autoScrollMargin = 40, this.autoScrollStep = 5, this.autoScrollTimeout = !1, this.touchMove = !1, this.moveHover = this.moveHover.bind(this), this.endMove = this.endMove.bind(this), this.registerTableOption("movableColumns", !1);
  }
  createPlaceholderElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-col"), e.classList.add("tabulator-col-placeholder"), e;
  }
  initialize() {
    this.table.options.movableColumns && (this.subscribe("column-init", this.initializeColumn.bind(this)), this.subscribe("alert-show", this.abortMove.bind(this)));
  }
  abortMove() {
    clearTimeout(this.checkTimeout);
  }
  initializeColumn(e) {
    var t = this, i = {}, n;
    !e.modules.frozen && !e.isGroup && !e.isRowHeader && (n = e.getElement(), i.mousemove = (function(s) {
      e.parent === t.moving.parent && ((t.touchMove ? s.touches[0].pageX : s.pageX) - de.elOffset(n).left + t.table.columnManager.contentsElement.scrollLeft > e.getWidth() / 2 ? (t.toCol !== e || !t.toColAfter) && (n.parentNode.insertBefore(t.placeholderElement, n.nextSibling), t.moveColumn(e, !0)) : (t.toCol !== e || t.toColAfter) && (n.parentNode.insertBefore(t.placeholderElement, n), t.moveColumn(e, !1)));
    }).bind(t), n.addEventListener("mousedown", function(s) {
      t.touchMove = !1, s.which === 1 && (t.checkTimeout = setTimeout(function() {
        t.startMove(s, e);
      }, t.checkPeriod));
    }), n.addEventListener("mouseup", function(s) {
      s.which === 1 && t.checkTimeout && clearTimeout(t.checkTimeout);
    }), t.bindTouchEvents(e)), e.modules.moveColumn = i;
  }
  bindTouchEvents(e) {
    var t = e.getElement(), i = !1, n, s, a, o, l, h;
    t.addEventListener("touchstart", (u) => {
      this.checkTimeout = setTimeout(() => {
        this.touchMove = !0, n = e.nextColumn(), a = n ? n.getWidth() / 2 : 0, s = e.prevColumn(), o = s ? s.getWidth() / 2 : 0, l = 0, h = 0, i = !1, this.startMove(u, e);
      }, this.checkPeriod);
    }, { passive: !0 }), t.addEventListener("touchmove", (u) => {
      var d, c;
      this.moving && (this.moveHover(u), i || (i = u.touches[0].pageX), d = u.touches[0].pageX - i, d > 0 ? n && d - l > a && (c = n, c !== e && (i = u.touches[0].pageX, c.getElement().parentNode.insertBefore(this.placeholderElement, c.getElement().nextSibling), this.moveColumn(c, !0))) : s && -d - h > o && (c = s, c !== e && (i = u.touches[0].pageX, c.getElement().parentNode.insertBefore(this.placeholderElement, c.getElement()), this.moveColumn(c, !1))), c && (n = c.nextColumn(), l = a, a = n ? n.getWidth() / 2 : 0, s = c.prevColumn(), h = o, o = s ? s.getWidth() / 2 : 0));
    }, { passive: !0 }), t.addEventListener("touchend", (u) => {
      this.checkTimeout && clearTimeout(this.checkTimeout), this.moving && this.endMove(u);
    });
  }
  startMove(e, t) {
    var i = t.getElement(), n = this.table.columnManager.getContentsElement(), s = this.table.columnManager.getHeadersElement();
    this.table.modules.selectRange && this.table.modules.selectRange.columnSelection && this.table.modules.selectRange.mousedown && this.table.modules.selectRange.selecting === "column" || (this.moving = t, this.startX = (this.touchMove ? e.touches[0].pageX : e.pageX) - de.elOffset(i).left, this.table.element.classList.add("tabulator-block-select"), this.placeholderElement.style.width = t.getWidth() + "px", this.placeholderElement.style.height = t.getHeight() + "px", i.parentNode.insertBefore(this.placeholderElement, i), i.parentNode.removeChild(i), this.hoverElement = i.cloneNode(!0), this.hoverElement.classList.add("tabulator-moving"), n.appendChild(this.hoverElement), this.hoverElement.style.left = "0", this.hoverElement.style.bottom = n.clientHeight - s.offsetHeight + "px", this.touchMove || (this._bindMouseMove(), document.body.addEventListener("mousemove", this.moveHover), document.body.addEventListener("mouseup", this.endMove)), this.moveHover(e), this.dispatch("column-moving", e, this.moving));
  }
  _bindMouseMove() {
    this.table.columnManager.columnsByIndex.forEach(function(e) {
      e.modules.moveColumn.mousemove && e.getElement().addEventListener("mousemove", e.modules.moveColumn.mousemove);
    });
  }
  _unbindMouseMove() {
    this.table.columnManager.columnsByIndex.forEach(function(e) {
      e.modules.moveColumn.mousemove && e.getElement().removeEventListener("mousemove", e.modules.moveColumn.mousemove);
    });
  }
  moveColumn(e, t) {
    var i = this.moving.getCells();
    this.toCol = e, this.toColAfter = t, t ? e.getCells().forEach(function(n, s) {
      var a = n.getElement(!0);
      a.parentNode && i[s] && a.parentNode.insertBefore(i[s].getElement(), a.nextSibling);
    }) : e.getCells().forEach(function(n, s) {
      var a = n.getElement(!0);
      a.parentNode && i[s] && a.parentNode.insertBefore(i[s].getElement(), a);
    });
  }
  endMove(e) {
    (e.which === 1 || this.touchMove) && (this._unbindMouseMove(), this.placeholderElement.parentNode.insertBefore(this.moving.getElement(), this.placeholderElement.nextSibling), this.placeholderElement.parentNode.removeChild(this.placeholderElement), this.hoverElement.parentNode.removeChild(this.hoverElement), this.table.element.classList.remove("tabulator-block-select"), this.toCol && this.table.columnManager.moveColumnActual(this.moving, this.toCol, this.toColAfter), this.moving = !1, this.toCol = !1, this.toColAfter = !1, this.touchMove || (document.body.removeEventListener("mousemove", this.moveHover), document.body.removeEventListener("mouseup", this.endMove)));
  }
  moveHover(e) {
    var t = this.table.columnManager.getContentsElement(), i = t.scrollLeft, n = (this.touchMove ? e.touches[0].pageX : e.pageX) - de.elOffset(t).left + i, s;
    this.hoverElement.style.left = n - this.startX + "px", n - i < this.autoScrollMargin && (this.autoScrollTimeout || (this.autoScrollTimeout = setTimeout(() => {
      s = Math.max(0, i - 5), this.table.rowManager.getElement().scrollLeft = s, this.autoScrollTimeout = !1;
    }, 1))), i + t.clientWidth - n < this.autoScrollMargin && (this.autoScrollTimeout || (this.autoScrollTimeout = setTimeout(() => {
      s = Math.min(t.clientWidth, i + 5), this.table.rowManager.getElement().scrollLeft = s, this.autoScrollTimeout = !1;
    }, 1)));
  }
}
A(Vp, "moduleName", "moveColumn");
var Vy = {
  delete: function(r, e, t) {
    r.delete();
  }
}, Wy = {
  insert: function(r, e, t) {
    return this.table.addRow(r.getData(), void 0, e), !0;
  },
  add: function(r, e, t) {
    return this.table.addRow(r.getData()), !0;
  },
  update: function(r, e, t) {
    return e ? (e.update(r.getData()), !0) : !1;
  },
  replace: function(r, e, t) {
    return e ? (this.table.addRow(r.getData(), void 0, e), e.delete(), !0) : !1;
  }
};
const Ji = class Ji extends U {
  constructor(e) {
    super(e), this.placeholderElement = this.createPlaceholderElement(), this.hoverElement = !1, this.checkTimeout = !1, this.checkPeriod = 150, this.moving = !1, this.toRow = !1, this.toRowAfter = !1, this.hasHandle = !1, this.startY = 0, this.startX = 0, this.moveHover = this.moveHover.bind(this), this.endMove = this.endMove.bind(this), this.tableRowDropEvent = !1, this.touchMove = !1, this.connection = !1, this.connectionSelectorsTables = !1, this.connectionSelectorsElements = !1, this.connectionElements = [], this.connections = [], this.connectedTable = !1, this.connectedRow = !1, this.registerTableOption("movableRows", !1), this.registerTableOption("movableRowsConnectedTables", !1), this.registerTableOption("movableRowsConnectedElements", !1), this.registerTableOption("movableRowsSender", !1), this.registerTableOption("movableRowsReceiver", "insert"), this.registerColumnOption("rowHandle");
  }
  createPlaceholderElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-row"), e.classList.add("tabulator-row-placeholder"), e;
  }
  initialize() {
    this.table.options.movableRows && (this.connectionSelectorsTables = this.table.options.movableRowsConnectedTables, this.connectionSelectorsElements = this.table.options.movableRowsConnectedElements, this.connection = this.connectionSelectorsTables || this.connectionSelectorsElements, this.subscribe("cell-init", this.initializeCell.bind(this)), this.subscribe("column-init", this.initializeColumn.bind(this)), this.subscribe("row-init", this.initializeRow.bind(this)));
  }
  initializeGroupHeader(e) {
    var t = this, i = {};
    i.mouseup = (function(n) {
      t.tableRowDrop(n, e);
    }).bind(t), i.mousemove = (function(n) {
      var s;
      n.pageY - de.elOffset(e.element).top + t.table.rowManager.element.scrollTop > e.getHeight() / 2 ? (t.toRow !== e || !t.toRowAfter) && (s = e.getElement(), s.parentNode.insertBefore(t.placeholderElement, s.nextSibling), t.moveRow(e, !0)) : (t.toRow !== e || t.toRowAfter) && (s = e.getElement(), s.previousSibling && (s.parentNode.insertBefore(t.placeholderElement, s), t.moveRow(e, !1)));
    }).bind(t), e.modules.moveRow = i;
  }
  initializeRow(e) {
    var t = this, i = {}, n;
    i.mouseup = (function(s) {
      t.tableRowDrop(s, e);
    }).bind(t), i.mousemove = (function(s) {
      var a = e.getElement();
      s.pageY - de.elOffset(a).top + t.table.rowManager.element.scrollTop > e.getHeight() / 2 ? (t.toRow !== e || !t.toRowAfter) && (a.parentNode.insertBefore(t.placeholderElement, a.nextSibling), t.moveRow(e, !0)) : (t.toRow !== e || t.toRowAfter) && (a.parentNode.insertBefore(t.placeholderElement, a), t.moveRow(e, !1));
    }).bind(t), this.hasHandle || (n = e.getElement(), n.addEventListener("mousedown", function(s) {
      s.which === 1 && (t.checkTimeout = setTimeout(function() {
        t.startMove(s, e);
      }, t.checkPeriod));
    }), n.addEventListener("mouseup", function(s) {
      s.which === 1 && t.checkTimeout && clearTimeout(t.checkTimeout);
    }), this.bindTouchEvents(e, e.getElement())), e.modules.moveRow = i;
  }
  initializeColumn(e) {
    e.definition.rowHandle && this.table.options.movableRows !== !1 && (this.hasHandle = !0);
  }
  initializeCell(e) {
    if (e.column.definition.rowHandle && this.table.options.movableRows !== !1) {
      var t = this, i = e.getElement(!0);
      i.addEventListener("mousedown", function(n) {
        n.which === 1 && (t.checkTimeout = setTimeout(function() {
          t.startMove(n, e.row);
        }, t.checkPeriod));
      }), i.addEventListener("mouseup", function(n) {
        n.which === 1 && t.checkTimeout && clearTimeout(t.checkTimeout);
      }), this.bindTouchEvents(e.row, i);
    }
  }
  bindTouchEvents(e, t) {
    var i = !1, n, s, a, o, l, h;
    t.addEventListener("touchstart", (u) => {
      this.checkTimeout = setTimeout(() => {
        this.touchMove = !0, n = e.nextRow(), a = n ? n.getHeight() / 2 : 0, s = e.prevRow(), o = s ? s.getHeight() / 2 : 0, l = 0, h = 0, i = !1, this.startMove(u, e);
      }, this.checkPeriod);
    }, { passive: !0 }), this.moving, this.toRow, this.toRowAfter, t.addEventListener("touchmove", (u) => {
      var d, c;
      this.moving && (u.preventDefault(), this.moveHover(u), i || (i = u.touches[0].pageY), d = u.touches[0].pageY - i, d > 0 ? n && d - l > a && (c = n, c !== e && (i = u.touches[0].pageY, c.getElement().parentNode.insertBefore(this.placeholderElement, c.getElement().nextSibling), this.moveRow(c, !0))) : s && -d - h > o && (c = s, c !== e && (i = u.touches[0].pageY, c.getElement().parentNode.insertBefore(this.placeholderElement, c.getElement()), this.moveRow(c, !1))), c && (n = c.nextRow(), l = a, a = n ? n.getHeight() / 2 : 0, s = c.prevRow(), h = o, o = s ? s.getHeight() / 2 : 0));
    }), t.addEventListener("touchend", (u) => {
      this.checkTimeout && clearTimeout(this.checkTimeout), this.moving && (this.endMove(u), this.touchMove = !1);
    });
  }
  _bindMouseMove() {
    this.table.rowManager.getDisplayRows().forEach((e) => {
      (e.type === "row" || e.type === "group") && e.modules.moveRow && e.modules.moveRow.mousemove && e.getElement().addEventListener("mousemove", e.modules.moveRow.mousemove);
    });
  }
  _unbindMouseMove() {
    this.table.rowManager.getDisplayRows().forEach((e) => {
      (e.type === "row" || e.type === "group") && e.modules.moveRow && e.modules.moveRow.mousemove && e.getElement().removeEventListener("mousemove", e.modules.moveRow.mousemove);
    });
  }
  startMove(e, t) {
    var i = t.getElement();
    this.setStartPosition(e, t), this.moving = t, this.table.element.classList.add("tabulator-block-select"), this.placeholderElement.style.width = t.getWidth() + "px", this.placeholderElement.style.height = t.getHeight() + "px", this.connection ? (this.table.element.classList.add("tabulator-movingrow-sending"), this.connectToTables(t)) : (i.parentNode.insertBefore(this.placeholderElement, i), i.parentNode.removeChild(i)), this.hoverElement = i.cloneNode(!0), this.hoverElement.classList.add("tabulator-moving"), this.connection ? (document.body.appendChild(this.hoverElement), this.hoverElement.style.left = "0", this.hoverElement.style.top = "0", this.hoverElement.style.width = this.table.element.clientWidth + "px", this.hoverElement.style.whiteSpace = "nowrap", this.hoverElement.style.overflow = "hidden", this.hoverElement.style.pointerEvents = "none") : (this.table.rowManager.getTableElement().appendChild(this.hoverElement), this.hoverElement.style.left = "0", this.hoverElement.style.top = "0", this._bindMouseMove()), document.body.addEventListener("mousemove", this.moveHover), document.body.addEventListener("mouseup", this.endMove), this.dispatchExternal("rowMoving", t.getComponent()), this.moveHover(e);
  }
  setStartPosition(e, t) {
    var i = this.touchMove ? e.touches[0].pageX : e.pageX, n = this.touchMove ? e.touches[0].pageY : e.pageY, s, a;
    s = t.getElement(), this.connection ? (a = s.getBoundingClientRect(), this.startX = a.left - i + window.pageXOffset, this.startY = a.top - n + window.pageYOffset) : this.startY = n - s.getBoundingClientRect().top;
  }
  endMove(e) {
    (!e || e.which === 1 || this.touchMove) && (this._unbindMouseMove(), this.connection || (this.placeholderElement.parentNode.insertBefore(this.moving.getElement(), this.placeholderElement.nextSibling), this.placeholderElement.parentNode.removeChild(this.placeholderElement)), this.hoverElement.parentNode.removeChild(this.hoverElement), this.table.element.classList.remove("tabulator-block-select"), this.toRow ? this.table.rowManager.moveRow(this.moving, this.toRow, this.toRowAfter) : this.dispatchExternal("rowMoveCancelled", this.moving.getComponent()), this.moving = !1, this.toRow = !1, this.toRowAfter = !1, document.body.removeEventListener("mousemove", this.moveHover), document.body.removeEventListener("mouseup", this.endMove), this.connection && (this.table.element.classList.remove("tabulator-movingrow-sending"), this.disconnectFromTables()));
  }
  moveRow(e, t) {
    this.toRow = e, this.toRowAfter = t;
  }
  moveHover(e) {
    this.connection ? this.moveHoverConnections.call(this, e) : this.moveHoverTable.call(this, e);
  }
  moveHoverTable(e) {
    var t = this.table.rowManager.getElement(), i = t.scrollTop, n = (this.touchMove ? e.touches[0].pageY : e.pageY) - t.getBoundingClientRect().top + i;
    this.hoverElement.style.top = Math.min(n - this.startY, this.table.rowManager.element.scrollHeight - this.hoverElement.offsetHeight) + "px";
  }
  moveHoverConnections(e) {
    this.hoverElement.style.left = this.startX + (this.touchMove ? e.touches[0].pageX : e.pageX) + "px", this.hoverElement.style.top = this.startY + (this.touchMove ? e.touches[0].pageY : e.pageY) + "px";
  }
  elementRowDrop(e, t, i) {
    this.dispatchExternal("movableRowsElementDrop", e, t, i ? i.getComponent() : !1);
  }
  //establish connection with other tables
  connectToTables(e) {
    var t;
    this.connectionSelectorsTables && (t = this.commsConnections(this.connectionSelectorsTables), this.dispatchExternal("movableRowsSendingStart", t), this.commsSend(this.connectionSelectorsTables, "moveRow", "connect", {
      row: e
    })), this.connectionSelectorsElements && (this.connectionElements = [], Array.isArray(this.connectionSelectorsElements) || (this.connectionSelectorsElements = [this.connectionSelectorsElements]), this.connectionSelectorsElements.forEach((i) => {
      typeof i == "string" ? this.connectionElements = this.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(i))) : this.connectionElements.push(i);
    }), this.connectionElements.forEach((i) => {
      var n = (s) => {
        this.elementRowDrop(s, i, this.moving);
      };
      i.addEventListener("mouseup", n), i.tabulatorElementDropEvent = n, i.classList.add("tabulator-movingrow-receiving");
    }));
  }
  //disconnect from other tables
  disconnectFromTables() {
    var e;
    this.connectionSelectorsTables && (e = this.commsConnections(this.connectionSelectorsTables), this.dispatchExternal("movableRowsSendingStop", e), this.commsSend(this.connectionSelectorsTables, "moveRow", "disconnect")), this.connectionElements.forEach((t) => {
      t.classList.remove("tabulator-movingrow-receiving"), t.removeEventListener("mouseup", t.tabulatorElementDropEvent), delete t.tabulatorElementDropEvent;
    });
  }
  //accept incomming connection
  connect(e, t) {
    return this.connectedTable ? (console.warn("Move Row Error - Table cannot accept connection, already connected to table:", this.connectedTable), !1) : (this.connectedTable = e, this.connectedRow = t, this.table.element.classList.add("tabulator-movingrow-receiving"), this.table.rowManager.getDisplayRows().forEach((i) => {
      i.type === "row" && i.modules.moveRow && i.modules.moveRow.mouseup && i.getElement().addEventListener("mouseup", i.modules.moveRow.mouseup);
    }), this.tableRowDropEvent = this.tableRowDrop.bind(this), this.table.element.addEventListener("mouseup", this.tableRowDropEvent), this.dispatchExternal("movableRowsReceivingStart", t, e), !0);
  }
  //close incoming connection
  disconnect(e) {
    e === this.connectedTable ? (this.connectedTable = !1, this.connectedRow = !1, this.table.element.classList.remove("tabulator-movingrow-receiving"), this.table.rowManager.getDisplayRows().forEach((t) => {
      t.type === "row" && t.modules.moveRow && t.modules.moveRow.mouseup && t.getElement().removeEventListener("mouseup", t.modules.moveRow.mouseup);
    }), this.table.element.removeEventListener("mouseup", this.tableRowDropEvent), this.dispatchExternal("movableRowsReceivingStop", e)) : console.warn("Move Row Error - trying to disconnect from non connected table");
  }
  dropComplete(e, t, i) {
    var n = !1;
    if (i) {
      switch (typeof this.table.options.movableRowsSender) {
        case "string":
          n = Ji.senders[this.table.options.movableRowsSender];
          break;
        case "function":
          n = this.table.options.movableRowsSender;
          break;
      }
      n ? n.call(this, this.moving ? this.moving.getComponent() : void 0, t ? t.getComponent() : void 0, e) : this.table.options.movableRowsSender && console.warn("Mover Row Error - no matching sender found:", this.table.options.movableRowsSender), this.dispatchExternal("movableRowsSent", this.moving.getComponent(), t ? t.getComponent() : void 0, e);
    } else
      this.dispatchExternal("movableRowsSentFailed", this.moving.getComponent(), t ? t.getComponent() : void 0, e);
    this.endMove();
  }
  tableRowDrop(e, t) {
    var i = !1, n = !1;
    switch (e.stopImmediatePropagation(), typeof this.table.options.movableRowsReceiver) {
      case "string":
        i = Ji.receivers[this.table.options.movableRowsReceiver];
        break;
      case "function":
        i = this.table.options.movableRowsReceiver;
        break;
    }
    i ? n = i.call(this, this.connectedRow.getComponent(), t ? t.getComponent() : void 0, this.connectedTable) : console.warn("Mover Row Error - no matching receiver found:", this.table.options.movableRowsReceiver), n ? this.dispatchExternal("movableRowsReceived", this.connectedRow.getComponent(), t ? t.getComponent() : void 0, this.connectedTable) : this.dispatchExternal("movableRowsReceivedFailed", this.connectedRow.getComponent(), t ? t.getComponent() : void 0, this.connectedTable), this.commsSend(this.connectedTable, "moveRow", "dropcomplete", {
      row: t,
      success: n
    });
  }
  commsReceived(e, t, i) {
    switch (t) {
      case "connect":
        return this.connect(e, i.row);
      case "disconnect":
        return this.disconnect(e);
      case "dropcomplete":
        return this.dropComplete(e, i.row, i.success);
    }
  }
};
A(Ji, "moduleName", "moveRow"), //load defaults
A(Ji, "senders", Vy), A(Ji, "receivers", Wy);
let Kl = Ji;
var Gy = {};
const Nr = class Nr extends U {
  constructor(e) {
    super(e), this.allowedTypes = ["", "data", "edit", "clipboard", "import"], this.enabled = !0, this.registerColumnOption("mutator"), this.registerColumnOption("mutatorParams"), this.registerColumnOption("mutatorData"), this.registerColumnOption("mutatorDataParams"), this.registerColumnOption("mutatorEdit"), this.registerColumnOption("mutatorEditParams"), this.registerColumnOption("mutatorClipboard"), this.registerColumnOption("mutatorClipboardParams"), this.registerColumnOption("mutatorImport"), this.registerColumnOption("mutatorImportParams"), this.registerColumnOption("mutateLink");
  }
  initialize() {
    this.subscribe("cell-value-changing", this.transformCell.bind(this)), this.subscribe("cell-value-changed", this.mutateLink.bind(this)), this.subscribe("column-layout", this.initializeColumn.bind(this)), this.subscribe("row-data-init-before", this.rowDataChanged.bind(this)), this.subscribe("row-data-changing", this.rowDataChanged.bind(this));
  }
  rowDataChanged(e, t, i) {
    return this.transformRow(t, "data", i);
  }
  //initialize column mutator
  initializeColumn(e) {
    var t = !1, i = {};
    this.allowedTypes.forEach((n) => {
      var s = "mutator" + (n.charAt(0).toUpperCase() + n.slice(1)), a;
      e.definition[s] && (a = this.lookupMutator(e.definition[s]), a && (t = !0, i[s] = {
        mutator: a,
        params: e.definition[s + "Params"] || {}
      }));
    }), t && (e.modules.mutate = i);
  }
  lookupMutator(e) {
    var t = !1;
    switch (typeof e) {
      case "string":
        Nr.mutators[e] ? t = Nr.mutators[e] : console.warn("Mutator Error - No such mutator found, ignoring: ", e);
        break;
      case "function":
        t = e;
        break;
    }
    return t;
  }
  //apply mutator to row
  transformRow(e, t, i) {
    var n = "mutator" + (t.charAt(0).toUpperCase() + t.slice(1)), s;
    return this.enabled && this.table.columnManager.traverse((a) => {
      var o, l, h;
      a.modules.mutate && (o = a.modules.mutate[n] || a.modules.mutate.mutator || !1, o && (s = a.getFieldValue(typeof i < "u" ? i : e), (t == "data" && !i || typeof s < "u") && (h = a.getComponent(), l = typeof o.params == "function" ? o.params(s, e, t, h) : o.params, a.setFieldValue(e, o.mutator(s, e, t, l, h)))));
    }), e;
  }
  //apply mutator to new cell value
  transformCell(e, t) {
    if (e.column.modules.mutate) {
      var i = e.column.modules.mutate.mutatorEdit || e.column.modules.mutate.mutator || !1, n = {};
      if (i)
        return n = Object.assign(n, e.row.getData()), e.column.setFieldValue(n, t), i.mutator(t, n, "edit", i.params, e.getComponent());
    }
    return t;
  }
  mutateLink(e) {
    var t = e.column.definition.mutateLink;
    t && (Array.isArray(t) || (t = [t]), t.forEach((i) => {
      var n = e.row.getCell(i);
      n && n.setValue(n.getValue(), !0, !0);
    }));
  }
  enable() {
    this.enabled = !0;
  }
  disable() {
    this.enabled = !1;
  }
};
A(Nr, "moduleName", "mutator"), //load defaults
A(Nr, "mutators", Gy);
let Zl = Nr;
function Uy(r, e, t, i, n) {
  var s = document.createElement("span"), a = document.createElement("span"), o = document.createElement("span"), l = document.createElement("span"), h = document.createElement("span"), u = document.createElement("span");
  return this.table.modules.localize.langBind("pagination|counter|showing", (d) => {
    a.innerHTML = d;
  }), this.table.modules.localize.langBind("pagination|counter|of", (d) => {
    l.innerHTML = d;
  }), this.table.modules.localize.langBind("pagination|counter|rows", (d) => {
    u.innerHTML = d;
  }), i ? (o.innerHTML = " " + e + "-" + Math.min(e + r - 1, i) + " ", h.innerHTML = " " + i + " ", s.appendChild(a), s.appendChild(o), s.appendChild(l), s.appendChild(h), s.appendChild(u)) : (o.innerHTML = " 0 ", s.appendChild(a), s.appendChild(o), s.appendChild(u)), s;
}
function jy(r, e, t, i, n) {
  var s = document.createElement("span"), a = document.createElement("span"), o = document.createElement("span"), l = document.createElement("span"), h = document.createElement("span"), u = document.createElement("span");
  return this.table.modules.localize.langBind("pagination|counter|showing", (d) => {
    a.innerHTML = d;
  }), o.innerHTML = " " + t + " ", this.table.modules.localize.langBind("pagination|counter|of", (d) => {
    l.innerHTML = d;
  }), h.innerHTML = " " + n + " ", this.table.modules.localize.langBind("pagination|counter|pages", (d) => {
    u.innerHTML = d;
  }), s.appendChild(a), s.appendChild(o), s.appendChild(l), s.appendChild(h), s.appendChild(u), s;
}
var Yy = {
  rows: Uy,
  pages: jy
};
const ts = class ts extends U {
  constructor(e) {
    super(e), this.mode = "local", this.progressiveLoad = !1, this.element = null, this.pageCounterElement = null, this.pageCounter = null, this.size = 0, this.page = 1, this.count = 5, this.max = 1, this.remoteRowCountEstimate = null, this.initialLoad = !0, this.dataChanging = !1, this.pageSizes = [], this.registerTableOption("pagination", !1), this.registerTableOption("paginationMode", "local"), this.registerTableOption("paginationSize", !1), this.registerTableOption("paginationInitialPage", 1), this.registerTableOption("paginationCounter", !1), this.registerTableOption("paginationCounterElement", !1), this.registerTableOption("paginationButtonCount", 5), this.registerTableOption("paginationSizeSelector", !1), this.registerTableOption("paginationElement", !1), this.registerTableOption("paginationAddRow", "page"), this.registerTableOption("paginationOutOfRange", !1), this.registerTableOption("progressiveLoad", !1), this.registerTableOption("progressiveLoadDelay", 0), this.registerTableOption("progressiveLoadScrollMargin", 0), this.registerTableFunction("setMaxPage", this.setMaxPage.bind(this)), this.registerTableFunction("setPage", this.setPage.bind(this)), this.registerTableFunction("setPageToRow", this.userSetPageToRow.bind(this)), this.registerTableFunction("setPageSize", this.userSetPageSize.bind(this)), this.registerTableFunction("getPageSize", this.getPageSize.bind(this)), this.registerTableFunction("previousPage", this.previousPage.bind(this)), this.registerTableFunction("nextPage", this.nextPage.bind(this)), this.registerTableFunction("getPage", this.getPage.bind(this)), this.registerTableFunction("getPageMax", this.getPageMax.bind(this)), this.registerComponentFunction("row", "pageTo", this.setPageToRow.bind(this));
  }
  initialize() {
    this.table.options.pagination ? (this.subscribe("row-deleted", this.rowsUpdated.bind(this)), this.subscribe("row-added", this.rowsUpdated.bind(this)), this.subscribe("data-processed", this.initialLoadComplete.bind(this)), this.subscribe("table-built", this.calculatePageSizes.bind(this)), this.subscribe("footer-redraw", this.footerRedraw.bind(this)), this.table.options.paginationAddRow == "page" && this.subscribe("row-adding-position", this.rowAddingPosition.bind(this)), this.table.options.paginationMode === "remote" && (this.subscribe("data-params", this.remotePageParams.bind(this)), this.subscribe("data-loaded", this._parseRemoteData.bind(this))), this.table.options.progressiveLoad && console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time"), this.registerDisplayHandler(this.restOnRenderBefore.bind(this), 40), this.registerDisplayHandler(this.getRows.bind(this), 50), this.createElements(), this.initializePageCounter(), this.initializePaginator()) : this.table.options.progressiveLoad && (this.subscribe("data-params", this.remotePageParams.bind(this)), this.subscribe("data-loaded", this._parseRemoteData.bind(this)), this.subscribe("table-built", this.calculatePageSizes.bind(this)), this.subscribe("data-processed", this.initialLoadComplete.bind(this)), this.initializeProgressive(this.table.options.progressiveLoad), this.table.options.progressiveLoad === "scroll" && this.subscribe("scroll-vertical", this.scrollVertical.bind(this)));
  }
  rowAddingPosition(e, t) {
    var i = this.table.rowManager, n = i.getDisplayRows(), s;
    return t ? n.length ? s = n[0] : i.activeRows.length && (s = i.activeRows[i.activeRows.length - 1], t = !1) : n.length && (s = n[n.length - 1], t = !(n.length < this.size)), { index: s, top: t };
  }
  calculatePageSizes() {
    var e, t;
    this.table.options.paginationSize ? this.size = this.table.options.paginationSize : (e = document.createElement("div"), e.classList.add("tabulator-row"), e.style.visibility = "hidden", t = document.createElement("div"), t.classList.add("tabulator-cell"), t.innerHTML = "Page Row Test", e.appendChild(t), this.table.rowManager.getTableElement().appendChild(e), this.size = Math.floor(this.table.rowManager.getElement().clientHeight / e.offsetHeight), this.table.rowManager.getTableElement().removeChild(e)), this.dispatchExternal("pageSizeChanged", this.size), this.generatePageSizeSelectList();
  }
  initialLoadComplete() {
    this.initialLoad = !1;
  }
  remotePageParams(e, t, i, n) {
    return this.initialLoad || (this.progressiveLoad && !i || !this.progressiveLoad && !this.dataChanging) && this.reset(!0), n.page = this.page, this.size && (n.size = this.size), n;
  }
  ///////////////////////////////////
  ///////// Table Functions /////////
  ///////////////////////////////////
  userSetPageToRow(e) {
    return this.table.options.pagination && (e = this.table.rowManager.findRow(e), e) ? this.setPageToRow(e) : Promise.reject();
  }
  userSetPageSize(e) {
    return this.table.options.pagination ? (this.setPageSize(e), this.setPage(1)) : !1;
  }
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  scrollVertical(e, t) {
    var i, n, s;
    !t && !this.table.dataLoader.loading && (i = this.table.rowManager.getElement(), n = i.scrollHeight - i.clientHeight - e, s = this.table.options.progressiveLoadScrollMargin || i.clientHeight * 2, n < s && this.nextPage().catch(() => {
    }));
  }
  restOnRenderBefore(e, t) {
    return t || this.mode === "local" && this.reset(), e;
  }
  rowsUpdated() {
    this.refreshData(!0, "all");
  }
  createElements() {
    var e;
    this.element = document.createElement("span"), this.element.classList.add("tabulator-paginator"), this.pagesElement = document.createElement("span"), this.pagesElement.classList.add("tabulator-pages"), e = document.createElement("button"), e.classList.add("tabulator-page"), e.setAttribute("type", "button"), e.setAttribute("role", "button"), e.setAttribute("aria-label", ""), e.setAttribute("title", ""), this.firstBut = e.cloneNode(!0), this.firstBut.setAttribute("data-page", "first"), this.prevBut = e.cloneNode(!0), this.prevBut.setAttribute("data-page", "prev"), this.nextBut = e.cloneNode(!0), this.nextBut.setAttribute("data-page", "next"), this.lastBut = e.cloneNode(!0), this.lastBut.setAttribute("data-page", "last"), this.table.options.paginationSizeSelector && (this.pageSizeSelect = document.createElement("select"), this.pageSizeSelect.classList.add("tabulator-page-size"));
  }
  generatePageSizeSelectList() {
    var e = [];
    if (this.pageSizeSelect) {
      if (Array.isArray(this.table.options.paginationSizeSelector))
        e = this.table.options.paginationSizeSelector, this.pageSizes = e, this.pageSizes.indexOf(this.size) == -1 && e.unshift(this.size);
      else if (this.pageSizes.indexOf(this.size) == -1) {
        e = [];
        for (let t = 1; t < 5; t++)
          e.push(this.size * t);
        this.pageSizes = e;
      } else
        e = this.pageSizes;
      for (; this.pageSizeSelect.firstChild; ) this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);
      e.forEach((t) => {
        var i = document.createElement("option");
        i.value = t, t === !0 ? this.langBind("pagination|all", function(n) {
          i.innerHTML = n;
        }) : i.innerHTML = t, this.pageSizeSelect.appendChild(i);
      }), this.pageSizeSelect.value = this.size;
    }
  }
  initializePageCounter() {
    var e = this.table.options.paginationCounter, t = null;
    e && (typeof e == "function" ? t = e : t = ts.pageCounters[e], t ? (this.pageCounter = t, this.pageCounterElement = document.createElement("span"), this.pageCounterElement.classList.add("tabulator-page-counter")) : console.warn("Pagination Error - No such page counter found: ", e));
  }
  //setup pagination
  initializePaginator(e) {
    var t, i;
    e || (this.langBind("pagination|first", (n) => {
      this.firstBut.innerHTML = n;
    }), this.langBind("pagination|first_title", (n) => {
      this.firstBut.setAttribute("aria-label", n), this.firstBut.setAttribute("title", n);
    }), this.langBind("pagination|prev", (n) => {
      this.prevBut.innerHTML = n;
    }), this.langBind("pagination|prev_title", (n) => {
      this.prevBut.setAttribute("aria-label", n), this.prevBut.setAttribute("title", n);
    }), this.langBind("pagination|next", (n) => {
      this.nextBut.innerHTML = n;
    }), this.langBind("pagination|next_title", (n) => {
      this.nextBut.setAttribute("aria-label", n), this.nextBut.setAttribute("title", n);
    }), this.langBind("pagination|last", (n) => {
      this.lastBut.innerHTML = n;
    }), this.langBind("pagination|last_title", (n) => {
      this.lastBut.setAttribute("aria-label", n), this.lastBut.setAttribute("title", n);
    }), this.firstBut.addEventListener("click", () => {
      this.setPage(1);
    }), this.prevBut.addEventListener("click", () => {
      this.previousPage();
    }), this.nextBut.addEventListener("click", () => {
      this.nextPage();
    }), this.lastBut.addEventListener("click", () => {
      this.setPage(this.max);
    }), this.table.options.paginationElement && (this.element = this.table.options.paginationElement), this.pageSizeSelect && (t = document.createElement("label"), this.langBind("pagination|page_size", (n) => {
      this.pageSizeSelect.setAttribute("aria-label", n), this.pageSizeSelect.setAttribute("title", n), t.innerHTML = n;
    }), this.element.appendChild(t), this.element.appendChild(this.pageSizeSelect), this.pageSizeSelect.addEventListener("change", (n) => {
      this.setPageSize(this.pageSizeSelect.value == "true" ? !0 : this.pageSizeSelect.value), this.setPage(1);
    })), this.element.appendChild(this.firstBut), this.element.appendChild(this.prevBut), this.element.appendChild(this.pagesElement), this.element.appendChild(this.nextBut), this.element.appendChild(this.lastBut), this.table.options.paginationElement || (this.table.options.paginationCounter && (this.table.options.paginationCounterElement ? this.table.options.paginationCounterElement instanceof HTMLElement ? this.table.options.paginationCounterElement.appendChild(this.pageCounterElement) : typeof this.table.options.paginationCounterElement == "string" && (i = document.querySelector(this.table.options.paginationCounterElement), i ? i.appendChild(this.pageCounterElement) : console.warn("Pagination Error - Unable to find element matching paginationCounterElement selector:", this.table.options.paginationCounterElement)) : this.footerAppend(this.pageCounterElement)), this.footerAppend(this.element)), this.page = this.table.options.paginationInitialPage, this.count = this.table.options.paginationButtonCount), this.mode = this.table.options.paginationMode;
  }
  initializeProgressive(e) {
    this.initializePaginator(!0), this.mode = "progressive_" + e, this.progressiveLoad = !0;
  }
  trackChanges() {
    this.dispatch("page-changed");
  }
  //calculate maximum page from number of rows
  setMaxRows(e) {
    e ? this.max = this.size === !0 ? 1 : Math.ceil(e / this.size) : this.max = 1, this.page > this.max && (this.page = this.max);
  }
  //reset to first page without triggering action
  reset(e) {
    this.initialLoad || (this.mode == "local" || e) && (this.page = 1, this.trackChanges());
  }
  //set the maximum page
  setMaxPage(e) {
    e = parseInt(e), this.max = e || 1, this.page > this.max && (this.page = this.max, this.trigger());
  }
  //set current page number
  setPage(e) {
    switch (e) {
      case "first":
        return this.setPage(1);
      case "prev":
        return this.previousPage();
      case "next":
        return this.nextPage();
      case "last":
        return this.setPage(this.max);
    }
    return e = parseInt(e), e > 0 && e <= this.max || this.mode !== "local" ? (this.page = e, this.trackChanges(), this.trigger()) : (console.warn("Pagination Error - Requested page is out of range of 1 - " + this.max + ":", e), Promise.reject());
  }
  setPageToRow(e) {
    var t = this.displayRows(-1), i = t.indexOf(e);
    if (i > -1) {
      var n = this.size === !0 ? 1 : Math.ceil((i + 1) / this.size);
      return this.setPage(n);
    } else
      return console.warn("Pagination Error - Requested row is not visible"), Promise.reject();
  }
  setPageSize(e) {
    e !== !0 && (e = parseInt(e)), e > 0 && (this.size = e, this.dispatchExternal("pageSizeChanged", e)), this.pageSizeSelect && this.generatePageSizeSelectList(), this.trackChanges();
  }
  _setPageCounter(e, t, i) {
    var n;
    if (this.pageCounter)
      switch (this.mode === "remote" && (t = this.size, i = (this.page - 1) * this.size + 1, e = this.remoteRowCountEstimate), n = this.pageCounter.call(this, t, i, this.page, e, this.max), typeof n) {
        case "object":
          if (n instanceof Node) {
            for (; this.pageCounterElement.firstChild; ) this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);
            this.pageCounterElement.appendChild(n);
          } else
            this.pageCounterElement.innerHTML = "", n != null && console.warn("Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:", n);
          break;
        case "undefined":
          this.pageCounterElement.innerHTML = "";
          break;
        default:
          this.pageCounterElement.innerHTML = n;
      }
  }
  //setup the pagination buttons
  _setPageButtons() {
    let e = Math.floor((this.count - 1) / 2), t = Math.ceil((this.count - 1) / 2), i = this.max - this.page + e + 1 < this.count ? this.max - this.count + 1 : Math.max(this.page - e, 1), n = this.page <= t ? Math.min(this.count, this.max) : Math.min(this.page + t, this.max);
    for (; this.pagesElement.firstChild; ) this.pagesElement.removeChild(this.pagesElement.firstChild);
    this.page == 1 ? (this.firstBut.disabled = !0, this.prevBut.disabled = !0) : (this.firstBut.disabled = !1, this.prevBut.disabled = !1), this.page == this.max ? (this.lastBut.disabled = !0, this.nextBut.disabled = !0) : (this.lastBut.disabled = !1, this.nextBut.disabled = !1);
    for (let s = i; s <= n; s++)
      s > 0 && s <= this.max && this.pagesElement.appendChild(this._generatePageButton(s));
    this.footerRedraw();
  }
  _generatePageButton(e) {
    var t = document.createElement("button");
    return t.classList.add("tabulator-page"), e == this.page && t.classList.add("active"), t.setAttribute("type", "button"), t.setAttribute("role", "button"), this.langBind("pagination|page_title", (i) => {
      t.setAttribute("aria-label", i + " " + e), t.setAttribute("title", i + " " + e);
    }), t.setAttribute("data-page", e), t.textContent = e, t.addEventListener("click", (i) => {
      this.setPage(e);
    }), t;
  }
  //previous page
  previousPage() {
    return this.page > 1 ? (this.page--, this.trackChanges(), this.trigger()) : (console.warn("Pagination Error - Previous page would be less than page 1:", 0), Promise.reject());
  }
  //next page
  nextPage() {
    return this.page < this.max ? (this.page++, this.trackChanges(), this.trigger()) : (this.progressiveLoad || console.warn("Pagination Error - Next page would be greater than maximum page of " + this.max + ":", this.max + 1), Promise.reject());
  }
  //return current page number
  getPage() {
    return this.page;
  }
  //return max page number
  getPageMax() {
    return this.max;
  }
  getPageSize(e) {
    return this.size;
  }
  getMode() {
    return this.mode;
  }
  //return appropriate rows for current page
  getRows(e) {
    var t = 0, i, n, s, a, o = e.filter((l) => l.type === "row");
    if (this.mode == "local") {
      i = [], this.setMaxRows(e.length), this.size === !0 ? (n = 0, s = e.length) : (n = this.size * (this.page - 1), s = n + parseInt(this.size)), this._setPageButtons();
      for (let l = n; l < s; l++) {
        let h = e[l];
        h && (i.push(h), h.type === "row" && (a || (a = h), t++));
      }
      return this._setPageCounter(o.length, t, a ? o.indexOf(a) + 1 : 0), i;
    } else
      return this._setPageButtons(), this._setPageCounter(o.length), e.slice(0);
  }
  trigger() {
    var e;
    switch (this.mode) {
      case "local":
        return e = this.table.rowManager.scrollLeft, this.refreshData(), this.table.rowManager.scrollHorizontal(e), this.dispatchExternal("pageLoaded", this.getPage()), Promise.resolve();
      case "remote":
        return this.dataChanging = !0, this.reloadData(null).finally(() => {
          this.dataChanging = !1;
        });
      case "progressive_load":
      case "progressive_scroll":
        return this.reloadData(null, !0);
      default:
        return console.warn("Pagination Error - no such pagination mode:", this.mode), Promise.reject();
    }
  }
  _parseRemoteData(e) {
    var t, i;
    if (typeof e.last_page > "u" && console.warn("Remote Pagination Error - Server response missing '" + (this.options("dataReceiveParams").last_page || "last_page") + "' property"), e.data)
      if (this.max = parseInt(e.last_page) || 1, this.remoteRowCountEstimate = typeof e.last_row < "u" ? e.last_row : e.last_page * this.size - (this.page == e.last_page ? this.size - e.data.length : 0), this.progressiveLoad) {
        switch (this.mode) {
          case "progressive_load":
            this.page == 1 ? this.table.rowManager.setData(e.data, !1, this.page == 1) : this.table.rowManager.addRows(e.data), this.page < this.max && setTimeout(() => {
              this.nextPage();
            }, this.table.options.progressiveLoadDelay);
            break;
          case "progressive_scroll":
            e = this.page === 1 ? e.data : this.table.rowManager.getData().concat(e.data), this.table.rowManager.setData(e, this.page !== 1, this.page == 1), t = this.table.options.progressiveLoadScrollMargin || this.table.rowManager.element.clientHeight * 2, this.table.rowManager.element.scrollHeight <= this.table.rowManager.element.clientHeight + t && this.page < this.max && setTimeout(() => {
              this.nextPage();
            });
            break;
        }
        return !1;
      } else {
        if (this.page > this.max && (console.warn("Remote Pagination Error - Server returned last page value lower than the current page"), i = this.options("paginationOutOfRange"), i))
          return this.setPage(typeof i == "function" ? i.call(this, this.page, this.max) : i);
        this.dispatchExternal("pageLoaded", this.getPage());
      }
    else
      console.warn("Remote Pagination Error - Server response missing '" + (this.options("dataReceiveParams").data || "data") + "' property");
    return e.data;
  }
  //handle the footer element being redrawn
  footerRedraw() {
    var e = this.table.footerManager.containerElement;
    Math.ceil(e.clientWidth) - e.scrollWidth < 0 ? this.pagesElement.style.display = "none" : (this.pagesElement.style.display = "", Math.ceil(e.clientWidth) - e.scrollWidth < 0 && (this.pagesElement.style.display = "none"));
  }
};
A(ts, "moduleName", "page"), //load defaults
A(ts, "pageCounters", Yy);
let Jl = ts;
var Xy = {
  local: function(r, e) {
    var t = localStorage.getItem(r + "-" + e);
    return t ? JSON.parse(t) : !1;
  },
  cookie: function(r, e) {
    var t = document.cookie, i = r + "-" + e, n = t.indexOf(i + "="), s, a;
    return n > -1 && (t = t.slice(n), s = t.indexOf(";"), s > -1 && (t = t.slice(0, s)), a = t.replace(i + "=", "")), a ? JSON.parse(a) : !1;
  }
}, $y = {
  local: function(r, e, t) {
    localStorage.setItem(r + "-" + e, JSON.stringify(t));
  },
  cookie: function(r, e, t) {
    var i = /* @__PURE__ */ new Date();
    i.setDate(i.getDate() + 1e4), document.cookie = r + "-" + e + "=" + JSON.stringify(t) + "; expires=" + i.toUTCString();
  }
};
const Xe = class Xe extends U {
  constructor(e) {
    super(e), this.mode = "", this.id = "", this.defWatcherBlock = !1, this.config = {}, this.readFunc = !1, this.writeFunc = !1, this.registerTableOption("persistence", !1), this.registerTableOption("persistenceID", ""), this.registerTableOption("persistenceMode", !0), this.registerTableOption("persistenceReaderFunc", !1), this.registerTableOption("persistenceWriterFunc", !1);
  }
  // Test for whether localStorage is available for use.
  localStorageTest() {
    var e = "_tabulator_test";
    try {
      return window.localStorage.setItem(e, e), window.localStorage.removeItem(e), !0;
    } catch {
      return !1;
    }
  }
  //setup parameters
  initialize() {
    if (this.table.options.persistence) {
      var e = this.table.options.persistenceMode, t = this.table.options.persistenceID, i;
      this.mode = e !== !0 ? e : this.localStorageTest() ? "local" : "cookie", this.table.options.persistenceReaderFunc ? typeof this.table.options.persistenceReaderFunc == "function" ? this.readFunc = this.table.options.persistenceReaderFunc : Xe.readers[this.table.options.persistenceReaderFunc] ? this.readFunc = Xe.readers[this.table.options.persistenceReaderFunc] : console.warn("Persistence Read Error - invalid reader set", this.table.options.persistenceReaderFunc) : Xe.readers[this.mode] ? this.readFunc = Xe.readers[this.mode] : console.warn("Persistence Read Error - invalid reader set", this.mode), this.table.options.persistenceWriterFunc ? typeof this.table.options.persistenceWriterFunc == "function" ? this.writeFunc = this.table.options.persistenceWriterFunc : Xe.writers[this.table.options.persistenceWriterFunc] ? this.writeFunc = Xe.writers[this.table.options.persistenceWriterFunc] : console.warn("Persistence Write Error - invalid reader set", this.table.options.persistenceWriterFunc) : Xe.writers[this.mode] ? this.writeFunc = Xe.writers[this.mode] : console.warn("Persistence Write Error - invalid writer set", this.mode), this.id = "tabulator-" + (t || this.table.element.getAttribute("id") || ""), this.config = {
        sort: this.table.options.persistence === !0 || this.table.options.persistence.sort,
        filter: this.table.options.persistence === !0 || this.table.options.persistence.filter,
        headerFilter: this.table.options.persistence === !0 || this.table.options.persistence.headerFilter,
        group: this.table.options.persistence === !0 || this.table.options.persistence.group,
        page: this.table.options.persistence === !0 || this.table.options.persistence.page,
        columns: this.table.options.persistence === !0 ? ["title", "width", "visible"] : this.table.options.persistence.columns
      }, this.config.page && (i = this.retrieveData("page"), i && (typeof i.paginationSize < "u" && (this.config.page === !0 || this.config.page.size) && (this.table.options.paginationSize = i.paginationSize), typeof i.paginationInitialPage < "u" && (this.config.page === !0 || this.config.page.page) && (this.table.options.paginationInitialPage = i.paginationInitialPage))), this.config.group && (i = this.retrieveData("group"), i && (typeof i.groupBy < "u" && (this.config.group === !0 || this.config.group.groupBy) && (this.table.options.groupBy = i.groupBy), typeof i.groupStartOpen < "u" && (this.config.group === !0 || this.config.group.groupStartOpen) && (this.table.options.groupStartOpen = i.groupStartOpen), typeof i.groupHeader < "u" && (this.config.group === !0 || this.config.group.groupHeader) && (this.table.options.groupHeader = i.groupHeader))), this.config.columns && (this.table.options.columns = this.load("columns", this.table.options.columns), this.subscribe("column-init", this.initializeColumn.bind(this)), this.subscribe("column-show", this.save.bind(this, "columns")), this.subscribe("column-hide", this.save.bind(this, "columns")), this.subscribe("column-moved", this.save.bind(this, "columns"))), this.subscribe("table-built", this.tableBuilt.bind(this), 0), this.subscribe("table-redraw", this.tableRedraw.bind(this)), this.subscribe("filter-changed", this.eventSave.bind(this, "filter")), this.subscribe("filter-changed", this.eventSave.bind(this, "headerFilter")), this.subscribe("sort-changed", this.eventSave.bind(this, "sort")), this.subscribe("group-changed", this.eventSave.bind(this, "group")), this.subscribe("page-changed", this.eventSave.bind(this, "page")), this.subscribe("column-resized", this.eventSave.bind(this, "columns")), this.subscribe("column-width", this.eventSave.bind(this, "columns")), this.subscribe("layout-refreshed", this.eventSave.bind(this, "columns"));
    }
    this.registerTableFunction("getColumnLayout", this.getColumnLayout.bind(this)), this.registerTableFunction("setColumnLayout", this.setColumnLayout.bind(this));
  }
  eventSave(e) {
    this.config[e] && this.save(e);
  }
  tableBuilt() {
    var e, t, i;
    this.config.sort && (e = this.load("sort"), e && (this.table.options.initialSort = e)), this.config.filter && (t = this.load("filter"), t && (this.table.options.initialFilter = t)), this.config.headerFilter && (i = this.load("headerFilter"), i && (this.table.options.initialHeaderFilter = i));
  }
  tableRedraw(e) {
    e && this.config.columns && this.save("columns");
  }
  ///////////////////////////////////
  ///////// Table Functions /////////
  ///////////////////////////////////
  getColumnLayout() {
    return this.parseColumns(this.table.columnManager.getColumns());
  }
  setColumnLayout(e) {
    return this.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns, e, !0)), !0;
  }
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  initializeColumn(e) {
    var t, i;
    this.config.columns && (this.defWatcherBlock = !0, t = e.getDefinition(), i = this.config.columns === !0 ? Object.keys(t) : this.config.columns, i.forEach((n) => {
      var s = Object.getOwnPropertyDescriptor(t, n), a = t[n];
      s && Object.defineProperty(t, n, {
        set: (o) => {
          a = o, this.defWatcherBlock || this.save("columns"), s.set && s.set(o);
        },
        get: () => (s.get && s.get(), a)
      });
    }), this.defWatcherBlock = !1);
  }
  //load saved definitions
  load(e, t) {
    var i = this.retrieveData(e);
    return t && (i = i ? this.mergeDefinition(t, i) : t), i;
  }
  //retrieve data from memory
  retrieveData(e) {
    return this.readFunc ? this.readFunc(this.id, e) : !1;
  }
  //merge old and new column definitions
  mergeDefinition(e, t, i) {
    var n = [];
    return t = t || [], t.forEach((s, a) => {
      var o = this._findColumn(e, s), l;
      o && (i ? l = Object.keys(s) : this.config.columns === !0 || this.config.columns == null ? (l = Object.keys(o), l.push("width")) : l = this.config.columns, l.forEach((h) => {
        h !== "columns" && typeof s[h] < "u" && (o[h] = s[h]);
      }), o.columns && (o.columns = this.mergeDefinition(o.columns, s.columns)), n.push(o));
    }), e.forEach((s, a) => {
      var o = this._findColumn(t, s);
      o || (n.length > a ? n.splice(a, 0, s) : n.push(s));
    }), n;
  }
  //find matching columns
  _findColumn(e, t) {
    var i = t.columns ? "group" : t.field ? "field" : "object";
    return e.find(function(n) {
      switch (i) {
        case "group":
          return n.title === t.title && n.columns.length === t.columns.length;
        case "field":
          return n.field === t.field;
        case "object":
          return n === t;
      }
    });
  }
  //save data
  save(e) {
    var t = {};
    switch (e) {
      case "columns":
        t = this.parseColumns(this.table.columnManager.getColumns());
        break;
      case "filter":
        t = this.table.modules.filter.getFilters();
        break;
      case "headerFilter":
        t = this.table.modules.filter.getHeaderFilters();
        break;
      case "sort":
        t = this.validateSorters(this.table.modules.sort.getSort());
        break;
      case "group":
        t = this.getGroupConfig();
        break;
      case "page":
        t = this.getPageConfig();
        break;
    }
    this.writeFunc && this.writeFunc(this.id, e, t);
  }
  //ensure sorters contain no function data
  validateSorters(e) {
    return e.forEach(function(t) {
      t.column = t.field, delete t.field;
    }), e;
  }
  getGroupConfig() {
    var e = {};
    return this.config.group && ((this.config.group === !0 || this.config.group.groupBy) && (e.groupBy = this.table.options.groupBy), (this.config.group === !0 || this.config.group.groupStartOpen) && (e.groupStartOpen = this.table.options.groupStartOpen), (this.config.group === !0 || this.config.group.groupHeader) && (e.groupHeader = this.table.options.groupHeader)), e;
  }
  getPageConfig() {
    var e = {};
    return this.config.page && ((this.config.page === !0 || this.config.page.size) && (e.paginationSize = this.table.modules.page.getPageSize()), (this.config.page === !0 || this.config.page.page) && (e.paginationInitialPage = this.table.modules.page.getPage())), e;
  }
  //parse columns for data to store
  parseColumns(e) {
    var t = [], i = ["headerContextMenu", "headerMenu", "contextMenu", "clickMenu"];
    return e.forEach((n) => {
      var s = {}, a = n.getDefinition(), o;
      n.isGroup ? (s.title = a.title, s.columns = this.parseColumns(n.getColumns())) : (s.field = n.getField(), this.config.columns === !0 || this.config.columns == null ? (o = Object.keys(a), o.push("width"), o.push("visible")) : o = this.config.columns, o.forEach((l) => {
        switch (l) {
          case "width":
            s.width = n.getWidth();
            break;
          case "visible":
            s.visible = n.visible;
            break;
          default:
            typeof a[l] != "function" && i.indexOf(l) === -1 && (s[l] = a[l]);
        }
      })), t.push(s);
    }), t;
  }
};
A(Xe, "moduleName", "persistence"), A(Xe, "moduleInitOrder", -10), //load defaults
A(Xe, "readers", Xy), A(Xe, "writers", $y);
let Ql = Xe;
class Wp extends U {
  constructor(e) {
    super(e), this.columnSubscribers = {}, this.registerTableOption("rowContextPopup", !1), this.registerTableOption("rowClickPopup", !1), this.registerTableOption("rowDblClickPopup", !1), this.registerTableOption("groupContextPopup", !1), this.registerTableOption("groupClickPopup", !1), this.registerTableOption("groupDblClickPopup", !1), this.registerColumnOption("headerContextPopup"), this.registerColumnOption("headerClickPopup"), this.registerColumnOption("headerDblClickPopup"), this.registerColumnOption("headerPopup"), this.registerColumnOption("headerPopupIcon"), this.registerColumnOption("contextPopup"), this.registerColumnOption("clickPopup"), this.registerColumnOption("dblClickPopup"), this.registerComponentFunction("cell", "popup", this._componentPopupCall.bind(this)), this.registerComponentFunction("column", "popup", this._componentPopupCall.bind(this)), this.registerComponentFunction("row", "popup", this._componentPopupCall.bind(this)), this.registerComponentFunction("group", "popup", this._componentPopupCall.bind(this));
  }
  initialize() {
    this.initializeRowWatchers(), this.initializeGroupWatchers(), this.subscribe("column-init", this.initializeColumn.bind(this));
  }
  _componentPopupCall(e, t, i) {
    this.loadPopupEvent(t, null, e, i);
  }
  initializeRowWatchers() {
    this.table.options.rowContextPopup && (this.subscribe("row-contextmenu", this.loadPopupEvent.bind(this, this.table.options.rowContextPopup)), this.table.on("rowTapHold", this.loadPopupEvent.bind(this, this.table.options.rowContextPopup))), this.table.options.rowClickPopup && this.subscribe("row-click", this.loadPopupEvent.bind(this, this.table.options.rowClickPopup)), this.table.options.rowDblClickPopup && this.subscribe("row-dblclick", this.loadPopupEvent.bind(this, this.table.options.rowDblClickPopup));
  }
  initializeGroupWatchers() {
    this.table.options.groupContextPopup && (this.subscribe("group-contextmenu", this.loadPopupEvent.bind(this, this.table.options.groupContextPopup)), this.table.on("groupTapHold", this.loadPopupEvent.bind(this, this.table.options.groupContextPopup))), this.table.options.groupClickPopup && this.subscribe("group-click", this.loadPopupEvent.bind(this, this.table.options.groupClickPopup)), this.table.options.groupDblClickPopup && this.subscribe("group-dblclick", this.loadPopupEvent.bind(this, this.table.options.groupDblClickPopup));
  }
  initializeColumn(e) {
    var t = e.definition;
    t.headerContextPopup && !this.columnSubscribers.headerContextPopup && (this.columnSubscribers.headerContextPopup = this.loadPopupTableColumnEvent.bind(this, "headerContextPopup"), this.subscribe("column-contextmenu", this.columnSubscribers.headerContextPopup), this.table.on("headerTapHold", this.loadPopupTableColumnEvent.bind(this, "headerContextPopup"))), t.headerClickPopup && !this.columnSubscribers.headerClickPopup && (this.columnSubscribers.headerClickPopup = this.loadPopupTableColumnEvent.bind(this, "headerClickPopup"), this.subscribe("column-click", this.columnSubscribers.headerClickPopup)), t.headerDblClickPopup && !this.columnSubscribers.headerDblClickPopup && (this.columnSubscribers.headerDblClickPopup = this.loadPopupTableColumnEvent.bind(this, "headerDblClickPopup"), this.subscribe("column-dblclick", this.columnSubscribers.headerDblClickPopup)), t.headerPopup && this.initializeColumnHeaderPopup(e), t.contextPopup && !this.columnSubscribers.contextPopup && (this.columnSubscribers.contextPopup = this.loadPopupTableCellEvent.bind(this, "contextPopup"), this.subscribe("cell-contextmenu", this.columnSubscribers.contextPopup), this.table.on("cellTapHold", this.loadPopupTableCellEvent.bind(this, "contextPopup"))), t.clickPopup && !this.columnSubscribers.clickPopup && (this.columnSubscribers.clickPopup = this.loadPopupTableCellEvent.bind(this, "clickPopup"), this.subscribe("cell-click", this.columnSubscribers.clickPopup)), t.dblClickPopup && !this.columnSubscribers.dblClickPopup && (this.columnSubscribers.dblClickPopup = this.loadPopupTableCellEvent.bind(this, "dblClickPopup"), this.subscribe("cell-click", this.columnSubscribers.dblClickPopup));
  }
  initializeColumnHeaderPopup(e) {
    var t = e.definition.headerPopupIcon, i;
    i = document.createElement("span"), i.classList.add("tabulator-header-popup-button"), t ? (typeof t == "function" && (t = t(e.getComponent())), t instanceof HTMLElement ? i.appendChild(t) : i.innerHTML = t) : i.innerHTML = "&vellip;", i.addEventListener("click", (n) => {
      n.stopPropagation(), n.preventDefault(), this.loadPopupEvent(e.definition.headerPopup, n, e);
    }), e.titleElement.insertBefore(i, e.titleElement.firstChild);
  }
  loadPopupTableCellEvent(e, t, i) {
    i._cell && (i = i._cell), i.column.definition[e] && this.loadPopupEvent(i.column.definition[e], t, i);
  }
  loadPopupTableColumnEvent(e, t, i) {
    i._column && (i = i._column), i.definition[e] && this.loadPopupEvent(i.definition[e], t, i);
  }
  loadPopupEvent(e, t, i, n) {
    var s;
    function a(o) {
      s = o;
    }
    i._group ? i = i._group : i._row && (i = i._row), e = typeof e == "function" ? e.call(this.table, t, i.getComponent(), a) : e, this.loadPopup(t, i, e, s, n);
  }
  loadPopup(e, t, i, n, s) {
    var a = !(e instanceof MouseEvent), o, l;
    i instanceof HTMLElement ? o = i : (o = document.createElement("div"), o.innerHTML = i), o.classList.add("tabulator-popup"), o.addEventListener("click", (h) => {
      h.stopPropagation();
    }), a || e.preventDefault(), l = this.popup(o), typeof n == "function" && l.renderCallback(n), e ? l.show(e) : l.show(t.getElement(), s || "center"), l.hideOnBlur(() => {
      this.dispatchExternal("popupClosed", t.getComponent());
    }), this.dispatchExternal("popupOpened", t.getComponent());
  }
}
A(Wp, "moduleName", "popup");
class Gp extends U {
  constructor(e) {
    super(e), this.element = !1, this.manualBlock = !1, this.beforeprintEventHandler = null, this.afterprintEventHandler = null, this.registerTableOption("printAsHtml", !1), this.registerTableOption("printFormatter", !1), this.registerTableOption("printHeader", !1), this.registerTableOption("printFooter", !1), this.registerTableOption("printStyled", !0), this.registerTableOption("printRowRange", "visible"), this.registerTableOption("printConfig", {}), this.registerColumnOption("print"), this.registerColumnOption("titlePrint");
  }
  initialize() {
    this.table.options.printAsHtml && (this.beforeprintEventHandler = this.replaceTable.bind(this), this.afterprintEventHandler = this.cleanup.bind(this), window.addEventListener("beforeprint", this.beforeprintEventHandler), window.addEventListener("afterprint", this.afterprintEventHandler), this.subscribe("table-destroy", this.destroy.bind(this))), this.registerTableFunction("print", this.printFullscreen.bind(this));
  }
  destroy() {
    this.table.options.printAsHtml && (window.removeEventListener("beforeprint", this.beforeprintEventHandler), window.removeEventListener("afterprint", this.afterprintEventHandler));
  }
  ///////////////////////////////////
  ///////// Table Functions /////////
  ///////////////////////////////////
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  replaceTable() {
    this.manualBlock || (this.element = document.createElement("div"), this.element.classList.add("tabulator-print-table"), this.element.appendChild(this.table.modules.export.generateTable(this.table.options.printConfig, this.table.options.printStyled, this.table.options.printRowRange, "print")), this.table.element.style.display = "none", this.table.element.parentNode.insertBefore(this.element, this.table.element));
  }
  cleanup() {
    document.body.classList.remove("tabulator-print-fullscreen-hide"), this.element && this.element.parentNode && (this.element.parentNode.removeChild(this.element), this.table.element.style.display = "");
  }
  printFullscreen(e, t, i) {
    var n = window.scrollX, s = window.scrollY, a = document.createElement("div"), o = document.createElement("div"), l = this.table.modules.export.generateTable(typeof i < "u" ? i : this.table.options.printConfig, typeof t < "u" ? t : this.table.options.printStyled, e || this.table.options.printRowRange, "print"), h, u;
    this.manualBlock = !0, this.element = document.createElement("div"), this.element.classList.add("tabulator-print-fullscreen"), this.table.options.printHeader && (a.classList.add("tabulator-print-header"), h = typeof this.table.options.printHeader == "function" ? this.table.options.printHeader.call(this.table) : this.table.options.printHeader, typeof h == "string" ? a.innerHTML = h : a.appendChild(h), this.element.appendChild(a)), this.element.appendChild(l), this.table.options.printFooter && (o.classList.add("tabulator-print-footer"), u = typeof this.table.options.printFooter == "function" ? this.table.options.printFooter.call(this.table) : this.table.options.printFooter, typeof u == "string" ? o.innerHTML = u : o.appendChild(u), this.element.appendChild(o)), document.body.classList.add("tabulator-print-fullscreen-hide"), document.body.appendChild(this.element), this.table.options.printFormatter && this.table.options.printFormatter(this.element, l), window.print(), this.cleanup(), window.scrollTo(n, s), this.manualBlock = !1;
  }
}
A(Gp, "moduleName", "print");
class Up extends U {
  constructor(e) {
    super(e), this.data = !1, this.blocked = !1, this.origFuncs = {}, this.currentVersion = 0, this.registerTableOption("reactiveData", !1);
  }
  initialize() {
    this.table.options.reactiveData && (this.subscribe("cell-value-save-before", this.block.bind(this, "cellsave")), this.subscribe("cell-value-save-after", this.unblock.bind(this, "cellsave")), this.subscribe("row-data-save-before", this.block.bind(this, "rowsave")), this.subscribe("row-data-save-after", this.unblock.bind(this, "rowsave")), this.subscribe("row-data-init-after", this.watchRow.bind(this)), this.subscribe("data-processing", this.watchData.bind(this)), this.subscribe("table-destroy", this.unwatchData.bind(this)));
  }
  watchData(e) {
    var t = this, i;
    this.currentVersion++, i = this.currentVersion, this.unwatchData(), this.data = e, this.origFuncs.push = e.push, Object.defineProperty(this.data, "push", {
      enumerable: !1,
      configurable: !0,
      value: function() {
        var n = Array.from(arguments), s;
        return !t.blocked && i === t.currentVersion && (t.block("data-push"), n.forEach((a) => {
          t.table.rowManager.addRowActual(a, !1);
        }), s = t.origFuncs.push.apply(e, arguments), t.unblock("data-push")), s;
      }
    }), this.origFuncs.unshift = e.unshift, Object.defineProperty(this.data, "unshift", {
      enumerable: !1,
      configurable: !0,
      value: function() {
        var n = Array.from(arguments), s;
        return !t.blocked && i === t.currentVersion && (t.block("data-unshift"), n.forEach((a) => {
          t.table.rowManager.addRowActual(a, !0);
        }), s = t.origFuncs.unshift.apply(e, arguments), t.unblock("data-unshift")), s;
      }
    }), this.origFuncs.shift = e.shift, Object.defineProperty(this.data, "shift", {
      enumerable: !1,
      configurable: !0,
      value: function() {
        var n, s;
        return !t.blocked && i === t.currentVersion && (t.block("data-shift"), t.data.length && (n = t.table.rowManager.getRowFromDataObject(t.data[0]), n && n.deleteActual()), s = t.origFuncs.shift.call(e), t.unblock("data-shift")), s;
      }
    }), this.origFuncs.pop = e.pop, Object.defineProperty(this.data, "pop", {
      enumerable: !1,
      configurable: !0,
      value: function() {
        var n, s;
        return !t.blocked && i === t.currentVersion && (t.block("data-pop"), t.data.length && (n = t.table.rowManager.getRowFromDataObject(t.data[t.data.length - 1]), n && n.deleteActual()), s = t.origFuncs.pop.call(e), t.unblock("data-pop")), s;
      }
    }), this.origFuncs.splice = e.splice, Object.defineProperty(this.data, "splice", {
      enumerable: !1,
      configurable: !0,
      value: function() {
        var n = Array.from(arguments), s = n[0] < 0 ? e.length + n[0] : n[0], a = n[1], o = n[2] ? n.slice(2) : !1, l, h;
        if (!t.blocked && i === t.currentVersion) {
          if (t.block("data-splice"), o && (l = e[s] ? t.table.rowManager.getRowFromDataObject(e[s]) : !1, l ? o.forEach((d) => {
            t.table.rowManager.addRowActual(d, !0, l, !0);
          }) : (o = o.slice().reverse(), o.forEach((d) => {
            t.table.rowManager.addRowActual(d, !0, !1, !0);
          }))), a !== 0) {
            var u = e.slice(s, typeof n[1] > "u" ? n[1] : s + a);
            u.forEach((d, c) => {
              var f = t.table.rowManager.getRowFromDataObject(d);
              f && f.deleteActual(c !== u.length - 1);
            });
          }
          (o || a !== 0) && t.table.rowManager.reRenderInPosition(), h = t.origFuncs.splice.apply(e, arguments), t.unblock("data-splice");
        }
        return h;
      }
    });
  }
  unwatchData() {
    if (this.data !== !1)
      for (var e in this.origFuncs)
        Object.defineProperty(this.data, e, {
          enumerable: !0,
          configurable: !0,
          writable: !0,
          value: this.origFuncs.key
        });
  }
  watchRow(e) {
    var t = e.getData();
    for (var i in t)
      this.watchKey(e, t, i);
    this.table.options.dataTree && this.watchTreeChildren(e);
  }
  watchTreeChildren(e) {
    var t = this, i = e.getData()[this.table.options.dataTreeChildField], n = {};
    i && (n.push = i.push, Object.defineProperty(i, "push", {
      enumerable: !1,
      configurable: !0,
      value: () => {
        if (!t.blocked) {
          t.block("tree-push");
          var s = n.push.apply(i, arguments);
          this.rebuildTree(e), t.unblock("tree-push");
        }
        return s;
      }
    }), n.unshift = i.unshift, Object.defineProperty(i, "unshift", {
      enumerable: !1,
      configurable: !0,
      value: () => {
        if (!t.blocked) {
          t.block("tree-unshift");
          var s = n.unshift.apply(i, arguments);
          this.rebuildTree(e), t.unblock("tree-unshift");
        }
        return s;
      }
    }), n.shift = i.shift, Object.defineProperty(i, "shift", {
      enumerable: !1,
      configurable: !0,
      value: () => {
        if (!t.blocked) {
          t.block("tree-shift");
          var s = n.shift.call(i);
          this.rebuildTree(e), t.unblock("tree-shift");
        }
        return s;
      }
    }), n.pop = i.pop, Object.defineProperty(i, "pop", {
      enumerable: !1,
      configurable: !0,
      value: () => {
        if (!t.blocked) {
          t.block("tree-pop");
          var s = n.pop.call(i);
          this.rebuildTree(e), t.unblock("tree-pop");
        }
        return s;
      }
    }), n.splice = i.splice, Object.defineProperty(i, "splice", {
      enumerable: !1,
      configurable: !0,
      value: () => {
        if (!t.blocked) {
          t.block("tree-splice");
          var s = n.splice.apply(i, arguments);
          this.rebuildTree(e), t.unblock("tree-splice");
        }
        return s;
      }
    }));
  }
  rebuildTree(e) {
    this.table.modules.dataTree.initializeRow(e), this.table.modules.dataTree.layoutRow(e), this.table.rowManager.refreshActiveData("tree", !1, !0);
  }
  watchKey(e, t, i) {
    var n = this, s = Object.getOwnPropertyDescriptor(t, i), a = t[i], o = this.currentVersion;
    Object.defineProperty(t, i, {
      set: (l) => {
        if (a = l, !n.blocked && o === n.currentVersion) {
          n.block("key");
          var h = {};
          h[i] = l, e.updateData(h), n.unblock("key");
        }
        s.set && s.set(l);
      },
      get: () => (s.get && s.get(), a)
    });
  }
  unwatchRow(e) {
    var t = e.getData();
    for (var i in t)
      Object.defineProperty(t, i, {
        value: t[i]
      });
  }
  block(e) {
    this.blocked || (this.blocked = e);
  }
  unblock(e) {
    this.blocked === e && (this.blocked = !1);
  }
}
A(Up, "moduleName", "reactiveData");
class jp extends U {
  constructor(e) {
    super(e), this.startColumn = !1, this.startX = !1, this.startWidth = !1, this.latestX = !1, this.handle = null, this.initialNextColumn = null, this.nextColumn = null, this.initialized = !1, this.registerColumnOption("resizable", !0), this.registerTableOption("resizableColumnFit", !1), this.registerTableOption("resizableColumnGuide", !1);
  }
  initialize() {
    this.subscribe("column-rendered", this.layoutColumnHeader.bind(this));
  }
  initializeEventWatchers() {
    this.initialized || (this.subscribe("cell-rendered", this.layoutCellHandles.bind(this)), this.subscribe("cell-delete", this.deInitializeComponent.bind(this)), this.subscribe("cell-height", this.resizeHandle.bind(this)), this.subscribe("column-moved", this.columnLayoutUpdated.bind(this)), this.subscribe("column-hide", this.deInitializeColumn.bind(this)), this.subscribe("column-show", this.columnLayoutUpdated.bind(this)), this.subscribe("column-width", this.columnWidthUpdated.bind(this)), this.subscribe("column-delete", this.deInitializeComponent.bind(this)), this.subscribe("column-height", this.resizeHandle.bind(this)), this.initialized = !0);
  }
  layoutCellHandles(e) {
    e.row.type === "row" && (this.deInitializeComponent(e), this.initializeColumn("cell", e, e.column, e.element));
  }
  layoutColumnHeader(e) {
    e.definition.resizable && (this.initializeEventWatchers(), this.deInitializeComponent(e), this.initializeColumn("header", e, e, e.element));
  }
  columnLayoutUpdated(e) {
    var t = e.prevColumn();
    this.reinitializeColumn(e), t && this.reinitializeColumn(t);
  }
  columnWidthUpdated(e) {
    e.modules.frozen && (this.table.modules.frozenColumns.leftColumns.includes(e) ? this.table.modules.frozenColumns.leftColumns.forEach((t) => {
      this.reinitializeColumn(t);
    }) : this.table.modules.frozenColumns.rightColumns.includes(e) && this.table.modules.frozenColumns.rightColumns.forEach((t) => {
      this.reinitializeColumn(t);
    }));
  }
  frozenColumnOffset(e) {
    var t = !1;
    return e.modules.frozen && (t = e.modules.frozen.marginValue, e.modules.frozen.position === "left" ? t += e.getWidth() - 3 : t && (t -= 3)), t !== !1 ? t + "px" : !1;
  }
  reinitializeColumn(e) {
    var t = this.frozenColumnOffset(e);
    e.cells.forEach((i) => {
      i.modules.resize && i.modules.resize.handleEl && (t && (i.modules.resize.handleEl.style[e.modules.frozen.position] = t, i.modules.resize.handleEl.style["z-index"] = 11), i.element.after(i.modules.resize.handleEl));
    }), e.modules.resize && e.modules.resize.handleEl && (t && (e.modules.resize.handleEl.style[e.modules.frozen.position] = t), e.element.after(e.modules.resize.handleEl));
  }
  initializeColumn(e, t, i, n) {
    var s = this, a = !1, o = i.definition.resizable, l = {}, h = i.getLastColumn();
    if (e === "header" && (a = i.definition.formatter == "textarea" || i.definition.variableHeight, l = { variableHeight: a }), (o === !0 || o == e) && this._checkResizability(h)) {
      var u = document.createElement("span");
      u.className = "tabulator-col-resize-handle", u.addEventListener("click", function(c) {
        c.stopPropagation();
      });
      var d = function(c) {
        s.startColumn = i, s.initialNextColumn = s.nextColumn = h.nextColumn(), s._mouseDown(c, h, u);
      };
      u.addEventListener("mousedown", d), u.addEventListener("touchstart", d, { passive: !0 }), u.addEventListener("dblclick", (c) => {
        var f = h.getWidth();
        c.stopPropagation(), h.reinitializeWidth(!0), f !== h.getWidth() && (s.dispatch("column-resized", h), s.dispatchExternal("columnResized", h.getComponent()));
      }), i.modules.frozen && (u.style.position = "sticky", u.style[i.modules.frozen.position] = this.frozenColumnOffset(i)), l.handleEl = u, n.parentNode && i.visible && n.after(u);
    }
    t.modules.resize = l;
  }
  deInitializeColumn(e) {
    this.deInitializeComponent(e), e.cells.forEach((t) => {
      this.deInitializeComponent(t);
    });
  }
  deInitializeComponent(e) {
    var t;
    e.modules.resize && (t = e.modules.resize.handleEl, t && t.parentElement && t.parentElement.removeChild(t));
  }
  resizeHandle(e, t) {
    e.modules.resize && e.modules.resize.handleEl && (e.modules.resize.handleEl.style.height = t);
  }
  resize(e, t) {
    var i = typeof e.clientX > "u" ? e.touches[0].clientX : e.clientX, n = i - this.startX, s = i - this.latestX, a, o;
    if (this.latestX = i, this.table.rtl && (n = -n, s = -s), a = t.width == t.minWidth || t.width == t.maxWidth, t.setWidth(this.startWidth + n), o = t.width == t.minWidth || t.width == t.maxWidth, s < 0 && (this.nextColumn = this.initialNextColumn), this.table.options.resizableColumnFit && this.nextColumn && !(a && o)) {
      let l = this.nextColumn.getWidth();
      s > 0 && l <= this.nextColumn.minWidth && (this.nextColumn = this.nextColumn.nextColumn()), this.nextColumn && this.nextColumn.setWidth(this.nextColumn.getWidth() - s);
    }
    this.table.columnManager.rerenderColumns(!0), !this.table.browserSlow && t.modules.resize && t.modules.resize.variableHeight && t.checkCellHeights();
  }
  calcGuidePosition(e, t, i) {
    var n = typeof e.clientX > "u" ? e.touches[0].clientX : e.clientX, s = i.getBoundingClientRect().x - this.table.element.getBoundingClientRect().x, a = this.table.element.getBoundingClientRect().x, o = t.element.getBoundingClientRect().left - a, l = n - this.startX, h = Math.max(s + l, o + t.minWidth);
    return t.maxWidth && (h = Math.min(h, o + t.maxWidth)), h;
  }
  _checkResizability(e) {
    return e.definition.resizable;
  }
  _mouseDown(e, t, i) {
    var n = this, s;
    this.dispatchExternal("columnResizing", t.getComponent()), n.table.options.resizableColumnGuide && (s = document.createElement("span"), s.classList.add("tabulator-col-resize-guide"), n.table.element.appendChild(s), setTimeout(() => {
      s.style.left = n.calcGuidePosition(e, t, i) + "px";
    })), n.table.element.classList.add("tabulator-block-select");
    function a(l) {
      n.table.options.resizableColumnGuide ? s.style.left = n.calcGuidePosition(l, t, i) + "px" : n.resize(l, t);
    }
    function o(l) {
      n.table.options.resizableColumnGuide && (n.resize(l, t), s.remove()), n.startColumn.modules.edit && (n.startColumn.modules.edit.blocked = !1), n.table.browserSlow && t.modules.resize && t.modules.resize.variableHeight && t.checkCellHeights(), document.body.removeEventListener("mouseup", o), document.body.removeEventListener("mousemove", a), i.removeEventListener("touchmove", a), i.removeEventListener("touchend", o), n.table.element.classList.remove("tabulator-block-select"), n.startWidth !== t.getWidth() && (n.table.columnManager.verticalAlignHeaders(), n.dispatch("column-resized", t), n.dispatchExternal("columnResized", t.getComponent()));
    }
    e.stopPropagation(), n.startColumn.modules.edit && (n.startColumn.modules.edit.blocked = !0), n.startX = typeof e.clientX > "u" ? e.touches[0].clientX : e.clientX, n.latestX = n.startX, n.startWidth = t.getWidth(), document.body.addEventListener("mousemove", a), document.body.addEventListener("mouseup", o), i.addEventListener("touchmove", a, { passive: !0 }), i.addEventListener("touchend", o);
  }
}
A(jp, "moduleName", "resizeColumns");
class Yp extends U {
  constructor(e) {
    super(e), this.startColumn = !1, this.startY = !1, this.startHeight = !1, this.handle = null, this.prevHandle = null, this.registerTableOption("resizableRows", !1), this.registerTableOption("resizableRowGuide", !1);
  }
  initialize() {
    this.table.options.resizableRows && this.subscribe("row-layout-after", this.initializeRow.bind(this));
  }
  initializeRow(e) {
    var t = this, i = e.getElement(), n = document.createElement("div");
    n.className = "tabulator-row-resize-handle";
    var s = document.createElement("div");
    s.className = "tabulator-row-resize-handle prev", n.addEventListener("click", function(l) {
      l.stopPropagation();
    });
    var a = function(l) {
      t.startRow = e, t._mouseDown(l, e, n);
    };
    n.addEventListener("mousedown", a), n.addEventListener("touchstart", a, { passive: !0 }), s.addEventListener("click", function(l) {
      l.stopPropagation();
    });
    var o = function(l) {
      var h = t.table.rowManager.prevDisplayRow(e);
      h && (t.startRow = h, t._mouseDown(l, h, s));
    };
    s.addEventListener("mousedown", o), s.addEventListener("touchstart", o, { passive: !0 }), i.appendChild(n), i.appendChild(s);
  }
  resize(e, t) {
    t.setHeight(this.startHeight + ((typeof e.screenY > "u" ? e.touches[0].screenY : e.screenY) - this.startY));
  }
  calcGuidePosition(e, t, i) {
    var n = typeof e.screenY > "u" ? e.touches[0].screenY : e.screenY, s = i.getBoundingClientRect().y - this.table.element.getBoundingClientRect().y, a = this.table.element.getBoundingClientRect().y, o = t.element.getBoundingClientRect().top - a, l = n - this.startY;
    return Math.max(s + l, o);
  }
  _mouseDown(e, t, i) {
    var n = this, s;
    n.dispatchExternal("rowResizing", t.getComponent()), n.table.options.resizableRowGuide && (s = document.createElement("span"), s.classList.add("tabulator-row-resize-guide"), n.table.element.appendChild(s), setTimeout(() => {
      s.style.top = n.calcGuidePosition(e, t, i) + "px";
    })), n.table.element.classList.add("tabulator-block-select");
    function a(l) {
      n.table.options.resizableRowGuide ? s.style.top = n.calcGuidePosition(l, t, i) + "px" : n.resize(l, t);
    }
    function o(l) {
      n.table.options.resizableRowGuide && (n.resize(l, t), s.remove()), document.body.removeEventListener("mouseup", a), document.body.removeEventListener("mousemove", a), i.removeEventListener("touchmove", a), i.removeEventListener("touchend", o), n.table.element.classList.remove("tabulator-block-select"), n.dispatchExternal("rowResized", t.getComponent());
    }
    e.stopPropagation(), n.startY = typeof e.screenY > "u" ? e.touches[0].screenY : e.screenY, n.startHeight = t.getHeight(), document.body.addEventListener("mousemove", a), document.body.addEventListener("mouseup", o), i.addEventListener("touchmove", a, { passive: !0 }), i.addEventListener("touchend", o);
  }
}
A(Yp, "moduleName", "resizeRows");
class Xp extends U {
  constructor(e) {
    super(e), this.binding = !1, this.visibilityObserver = !1, this.resizeObserver = !1, this.containerObserver = !1, this.tableHeight = 0, this.tableWidth = 0, this.containerHeight = 0, this.containerWidth = 0, this.autoResize = !1, this.visible = !1, this.initialized = !1, this.initialRedraw = !1, this.registerTableOption("autoResize", !0);
  }
  initialize() {
    if (this.table.options.autoResize) {
      var e = this.table, t;
      this.tableHeight = e.element.clientHeight, this.tableWidth = e.element.clientWidth, e.element.parentNode && (this.containerHeight = e.element.parentNode.clientHeight, this.containerWidth = e.element.parentNode.clientWidth), typeof IntersectionObserver < "u" && typeof ResizeObserver < "u" && e.rowManager.getRenderMode() === "virtual" ? (this.initializeVisibilityObserver(), this.autoResize = !0, this.resizeObserver = new ResizeObserver((i) => {
        if (!e.browserMobile || e.browserMobile && (!e.modules.edit || e.modules.edit && !e.modules.edit.currentCell)) {
          var n = Math.floor(i[0].contentRect.height), s = Math.floor(i[0].contentRect.width);
          (this.tableHeight != n || this.tableWidth != s) && (this.tableHeight = n, this.tableWidth = s, e.element.parentNode && (this.containerHeight = e.element.parentNode.clientHeight, this.containerWidth = e.element.parentNode.clientWidth), this.redrawTable());
        }
      }), this.resizeObserver.observe(e.element), t = window.getComputedStyle(e.element), this.table.element.parentNode && !this.table.rowManager.fixedHeight && (t.getPropertyValue("max-height") || t.getPropertyValue("min-height")) && (this.containerObserver = new ResizeObserver((i) => {
        if (!e.browserMobile || e.browserMobile && (!e.modules.edit || e.modules.edit && !e.modules.edit.currentCell)) {
          var n = Math.floor(i[0].contentRect.height), s = Math.floor(i[0].contentRect.width);
          (this.containerHeight != n || this.containerWidth != s) && (this.containerHeight = n, this.containerWidth = s, this.tableHeight = e.element.clientHeight, this.tableWidth = e.element.clientWidth), this.redrawTable();
        }
      }), this.containerObserver.observe(this.table.element.parentNode)), this.subscribe("table-resize", this.tableResized.bind(this))) : (this.binding = function() {
        (!e.browserMobile || e.browserMobile && (!e.modules.edit || e.modules.edit && !e.modules.edit.currentCell)) && (e.columnManager.rerenderColumns(!0), e.redraw());
      }, window.addEventListener("resize", this.binding)), this.subscribe("table-destroy", this.clearBindings.bind(this));
    }
  }
  initializeVisibilityObserver() {
    this.visibilityObserver = new IntersectionObserver((e) => {
      this.visible = e[0].isIntersecting, this.initialized ? this.visible && (this.redrawTable(this.initialRedraw), this.initialRedraw = !1) : (this.initialized = !0, this.initialRedraw = !this.visible);
    }), this.visibilityObserver.observe(this.table.element);
  }
  redrawTable(e) {
    this.initialized && this.visible && (this.table.columnManager.rerenderColumns(!0), this.table.redraw(e));
  }
  tableResized() {
    this.table.rowManager.redraw();
  }
  clearBindings() {
    this.binding && window.removeEventListener("resize", this.binding), this.resizeObserver && this.resizeObserver.unobserve(this.table.element), this.visibilityObserver && this.visibilityObserver.unobserve(this.table.element), this.containerObserver && this.containerObserver.unobserve(this.table.element.parentNode);
  }
}
A(Xp, "moduleName", "resizeTable");
function qy(r, e, t) {
  var i = document.createElement("div"), n = r.getRow()._row.modules.responsiveLayout;
  i.classList.add("tabulator-responsive-collapse-toggle"), i.innerHTML = `<svg class='tabulator-responsive-collapse-toggle-open' viewbox="0 0 24 24">
  <line x1="7" y1="12" x2="17" y2="12" fill="none" stroke-width="3" stroke-linecap="round" />
  <line y1="7" x1="12" y2="17" x2="12" fill="none" stroke-width="3" stroke-linecap="round" />
</svg>

<svg class='tabulator-responsive-collapse-toggle-close' viewbox="0 0 24 24">
  <line x1="7" y1="12" x2="17" y2="12"  fill="none" stroke-width="3" stroke-linecap="round" />
</svg>`, r.getElement().classList.add("tabulator-row-handle");
  function s(a) {
    var o = n.element;
    n.open = a, o && (n.open ? (i.classList.add("open"), o.style.display = "") : (i.classList.remove("open"), o.style.display = "none"));
  }
  return i.addEventListener("click", function(a) {
    a.stopImmediatePropagation(), s(!n.open), r.getTable().rowManager.adjustTableSize();
  }), s(n.open), i;
}
var Ky = {
  format: {
    formatters: {
      responsiveCollapse: qy
    }
  }
};
class eh extends U {
  constructor(e) {
    super(e), this.columns = [], this.hiddenColumns = [], this.mode = "", this.index = 0, this.collapseFormatter = [], this.collapseStartOpen = !0, this.collapseHandleColumn = !1, this.registerTableOption("responsiveLayout", !1), this.registerTableOption("responsiveLayoutCollapseStartOpen", !0), this.registerTableOption("responsiveLayoutCollapseUseFormatters", !0), this.registerTableOption("responsiveLayoutCollapseFormatter", !1), this.registerColumnOption("responsive");
  }
  //generate responsive columns list
  initialize() {
    this.table.options.responsiveLayout && (this.subscribe("column-layout", this.initializeColumn.bind(this)), this.subscribe("column-show", this.updateColumnVisibility.bind(this)), this.subscribe("column-hide", this.updateColumnVisibility.bind(this)), this.subscribe("columns-loaded", this.initializeResponsivity.bind(this)), this.subscribe("column-moved", this.initializeResponsivity.bind(this)), this.subscribe("column-add", this.initializeResponsivity.bind(this)), this.subscribe("column-delete", this.initializeResponsivity.bind(this)), this.subscribe("table-redrawing", this.tableRedraw.bind(this)), this.table.options.responsiveLayout === "collapse" && (this.subscribe("row-data-changed", this.generateCollapsedRowContent.bind(this)), this.subscribe("row-init", this.initializeRow.bind(this)), this.subscribe("row-layout", this.layoutRow.bind(this))));
  }
  tableRedraw(e) {
    ["fitColumns", "fitDataStretch"].indexOf(this.layoutMode()) === -1 && (e || this.update());
  }
  initializeResponsivity() {
    var e = [];
    this.mode = this.table.options.responsiveLayout, this.collapseFormatter = this.table.options.responsiveLayoutCollapseFormatter || this.formatCollapsedData, this.collapseStartOpen = this.table.options.responsiveLayoutCollapseStartOpen, this.hiddenColumns = [], this.collapseFormatter && (this.collapseFormatter = this.collapseFormatter.bind(this.table)), this.table.columnManager.columnsByIndex.forEach((t, i) => {
      t.modules.responsive && t.modules.responsive.order && t.modules.responsive.visible && (t.modules.responsive.index = i, e.push(t), !t.visible && this.mode === "collapse" && this.hiddenColumns.push(t));
    }), e = e.reverse(), e = e.sort((t, i) => {
      var n = i.modules.responsive.order - t.modules.responsive.order;
      return n || i.modules.responsive.index - t.modules.responsive.index;
    }), this.columns = e, this.mode === "collapse" && this.generateCollapsedContent();
    for (let t of this.table.columnManager.columnsByIndex)
      if (t.definition.formatter == "responsiveCollapse") {
        this.collapseHandleColumn = t;
        break;
      }
    this.collapseHandleColumn && (this.hiddenColumns.length ? this.collapseHandleColumn.show() : this.collapseHandleColumn.hide());
  }
  //define layout information
  initializeColumn(e) {
    var t = e.getDefinition();
    e.modules.responsive = { order: typeof t.responsive > "u" ? 1 : t.responsive, visible: t.visible !== !1 };
  }
  initializeRow(e) {
    var t;
    e.type !== "calc" && (t = document.createElement("div"), t.classList.add("tabulator-responsive-collapse"), e.modules.responsiveLayout = {
      element: t,
      open: this.collapseStartOpen
    }, this.collapseStartOpen || (t.style.display = "none"));
  }
  layoutRow(e) {
    var t = e.getElement();
    e.modules.responsiveLayout && (t.appendChild(e.modules.responsiveLayout.element), this.generateCollapsedRowContent(e));
  }
  //update column visibility
  updateColumnVisibility(e, t) {
    !t && e.modules.responsive && (e.modules.responsive.visible = e.visible, this.initializeResponsivity());
  }
  hideColumn(e) {
    var t = this.hiddenColumns.length;
    e.hide(!1, !0), this.mode === "collapse" && (this.hiddenColumns.unshift(e), this.generateCollapsedContent(), this.collapseHandleColumn && !t && this.collapseHandleColumn.show());
  }
  showColumn(e) {
    var t;
    e.show(!1, !0), e.setWidth(e.getWidth()), this.mode === "collapse" && (t = this.hiddenColumns.indexOf(e), t > -1 && this.hiddenColumns.splice(t, 1), this.generateCollapsedContent(), this.collapseHandleColumn && !this.hiddenColumns.length && this.collapseHandleColumn.hide());
  }
  //redraw columns to fit space
  update() {
    for (var e = !0; e; ) {
      let t = this.table.modules.layout.getMode() == "fitColumns" ? this.table.columnManager.getFlexBaseWidth() : this.table.columnManager.getWidth(), i = (this.table.options.headerVisible ? this.table.columnManager.element.clientWidth : this.table.element.clientWidth) - t;
      if (i < 0) {
        let n = this.columns[this.index];
        n ? (this.hideColumn(n), this.index++) : e = !1;
      } else {
        let n = this.columns[this.index - 1];
        n && i > 0 && i >= n.getWidth() ? (this.showColumn(n), this.index--) : e = !1;
      }
      this.table.rowManager.activeRowsCount || this.table.rowManager.renderEmptyScroll();
    }
  }
  generateCollapsedContent() {
    var e = this.table.rowManager.getDisplayRows();
    e.forEach((t) => {
      this.generateCollapsedRowContent(t);
    });
  }
  generateCollapsedRowContent(e) {
    var t, i;
    if (e.modules.responsiveLayout) {
      for (t = e.modules.responsiveLayout.element; t.firstChild; ) t.removeChild(t.firstChild);
      i = this.collapseFormatter(this.generateCollapsedRowData(e)), i && t.appendChild(i), e.calcHeight(!0);
    }
  }
  generateCollapsedRowData(e) {
    var t = e.getData(), i = [], n;
    return this.hiddenColumns.forEach((s) => {
      var a = s.getFieldValue(t);
      if (s.definition.title && s.field)
        if (s.modules.format && this.table.options.responsiveLayoutCollapseUseFormatters) {
          let o = function(l) {
            l();
          };
          n = {
            value: !1,
            data: {},
            getValue: function() {
              return a;
            },
            getData: function() {
              return t;
            },
            getType: function() {
              return "cell";
            },
            getElement: function() {
              return document.createElement("div");
            },
            getRow: function() {
              return e.getComponent();
            },
            getColumn: function() {
              return s.getComponent();
            },
            getTable: () => this.table
          }, i.push({
            field: s.field,
            title: s.definition.title,
            value: s.modules.format.formatter.call(this.table.modules.format, n, s.modules.format.params, o)
          });
        } else
          i.push({
            field: s.field,
            title: s.definition.title,
            value: a
          });
    }), i;
  }
  formatCollapsedData(e) {
    var t = document.createElement("table");
    return e.forEach((i) => {
      var n = document.createElement("tr"), s = document.createElement("td"), a = document.createElement("td"), o, l = document.createElement("strong");
      s.appendChild(l), this.modules.localize.bind("columns|" + i.field, function(h) {
        l.innerHTML = h || i.title;
      }), i.value instanceof Node ? (o = document.createElement("div"), o.appendChild(i.value), a.appendChild(o)) : a.innerHTML = i.value, n.appendChild(s), n.appendChild(a), t.appendChild(n);
    }), Object.keys(e).length ? t : "";
  }
}
A(eh, "moduleName", "responsiveLayout"), A(eh, "moduleExtensions", Ky);
function Zy(r, e, t) {
  var i = document.createElement("input"), n = !1;
  if (i.type = "checkbox", i.setAttribute("aria-label", "Select Row"), this.table.modExists("selectRow", !0))
    if (i.addEventListener("click", (a) => {
      a.stopPropagation();
    }), typeof r.getRow == "function") {
      var s = r.getRow();
      s instanceof Ya ? (i.addEventListener("change", (a) => {
        this.table.options.selectableRowsRangeMode === "click" && n ? n = !1 : s.toggleSelect();
      }), this.table.options.selectableRowsRangeMode === "click" && i.addEventListener("click", (a) => {
        n = !0, this.table.modules.selectRow.handleComplexRowClick(s._row, a);
      }), i.checked = s.isSelected && s.isSelected(), this.table.modules.selectRow.registerRowSelectCheckbox(s, i)) : i = "";
    } else
      i.addEventListener("change", (a) => {
        this.table.modules.selectRow.selectedRows.length ? this.table.deselectRow() : this.table.selectRow(e.rowRange);
      }), this.table.modules.selectRow.registerHeaderSelectCheckbox(i);
  return i;
}
var Jy = {
  format: {
    formatters: {
      rowSelection: Zy
    }
  }
};
class th extends U {
  constructor(e) {
    super(e), this.selecting = !1, this.lastClickedRow = !1, this.selectPrev = [], this.selectedRows = [], this.headerCheckboxElement = null, this.registerTableOption("selectableRows", "highlight"), this.registerTableOption("selectableRowsRangeMode", "drag"), this.registerTableOption("selectableRowsRollingSelection", !0), this.registerTableOption("selectableRowsPersistence", !0), this.registerTableOption("selectableRowsCheck", function(t, i) {
      return !0;
    }), this.registerTableFunction("selectRow", this.selectRows.bind(this)), this.registerTableFunction("deselectRow", this.deselectRows.bind(this)), this.registerTableFunction("toggleSelectRow", this.toggleRow.bind(this)), this.registerTableFunction("getSelectedRows", this.getSelectedRows.bind(this)), this.registerTableFunction("getSelectedData", this.getSelectedData.bind(this)), this.registerComponentFunction("row", "select", this.selectRows.bind(this)), this.registerComponentFunction("row", "deselect", this.deselectRows.bind(this)), this.registerComponentFunction("row", "toggleSelect", this.toggleRow.bind(this)), this.registerComponentFunction("row", "isSelected", this.isRowSelected.bind(this));
  }
  initialize() {
    this.deprecatedOptionsCheck(), this.table.options.selectableRows === "highlight" && this.table.options.selectableRange && (this.table.options.selectableRows = !1), this.table.options.selectableRows !== !1 && (this.subscribe("row-init", this.initializeRow.bind(this)), this.subscribe("row-deleting", this.rowDeleted.bind(this)), this.subscribe("rows-wipe", this.clearSelectionData.bind(this)), this.subscribe("rows-retrieve", this.rowRetrieve.bind(this)), this.table.options.selectableRows && !this.table.options.selectableRowsPersistence && this.subscribe("data-refreshing", this.deselectRows.bind(this)));
  }
  deprecatedOptionsCheck() {
  }
  rowRetrieve(e, t) {
    return e === "selected" ? this.selectedRows : t;
  }
  rowDeleted(e) {
    this._deselectRow(e, !0);
  }
  clearSelectionData(e) {
    var t = this.selectedRows.length;
    this.selecting = !1, this.lastClickedRow = !1, this.selectPrev = [], this.selectedRows = [], t && e !== !0 && this._rowSelectionChanged();
  }
  initializeRow(e) {
    var t = this, i = t.checkRowSelectability(e), n = e.getElement(), s = function() {
      setTimeout(function() {
        t.selecting = !1;
      }, 50), document.body.removeEventListener("mouseup", s);
    };
    e.modules.select = { selected: !1 }, n.classList.toggle("tabulator-selectable", i), n.classList.toggle("tabulator-unselectable", !i), t.checkRowSelectability(e) && t.table.options.selectableRows && t.table.options.selectableRows != "highlight" && (t.table.options.selectableRowsRangeMode === "click" ? n.addEventListener("click", this.handleComplexRowClick.bind(this, e)) : (n.addEventListener("click", function(a) {
      (!t.table.modExists("edit") || !t.table.modules.edit.getCurrentCell()) && t.table._clearSelection(), t.selecting || t.toggleRow(e);
    }), n.addEventListener("mousedown", function(a) {
      if (a.shiftKey)
        return t.table._clearSelection(), t.selecting = !0, t.selectPrev = [], document.body.addEventListener("mouseup", s), document.body.addEventListener("keyup", s), t.toggleRow(e), !1;
    }), n.addEventListener("mouseenter", function(a) {
      t.selecting && (t.table._clearSelection(), t.toggleRow(e), t.selectPrev[1] == e && t.toggleRow(t.selectPrev[0]));
    }), n.addEventListener("mouseout", function(a) {
      t.selecting && (t.table._clearSelection(), t.selectPrev.unshift(e));
    })));
  }
  handleComplexRowClick(e, t) {
    if (t.shiftKey) {
      this.table._clearSelection(), this.lastClickedRow = this.lastClickedRow || e;
      var i = this.table.rowManager.getDisplayRowIndex(this.lastClickedRow), n = this.table.rowManager.getDisplayRowIndex(e), s = i <= n ? i : n, a = i >= n ? i : n, o = this.table.rowManager.getDisplayRows().slice(0), l = o.splice(s, a - s + 1);
      t.ctrlKey || t.metaKey ? (l.forEach((h) => {
        h !== this.lastClickedRow && (this.table.options.selectableRows !== !0 && !this.isRowSelected(e) ? this.selectedRows.length < this.table.options.selectableRows && this.toggleRow(h) : this.toggleRow(h));
      }), this.lastClickedRow = e) : (this.deselectRows(void 0, !0), this.table.options.selectableRows !== !0 && l.length > this.table.options.selectableRows && (l = l.slice(0, this.table.options.selectableRows)), this.selectRows(l)), this.table._clearSelection();
    } else t.ctrlKey || t.metaKey ? (this.toggleRow(e), this.lastClickedRow = e) : (this.deselectRows(void 0, !0), this.selectRows(e), this.lastClickedRow = e);
  }
  checkRowSelectability(e) {
    return e && e.type === "row" ? this.table.options.selectableRowsCheck.call(this.table, e.getComponent()) : !1;
  }
  //toggle row selection
  toggleRow(e) {
    this.checkRowSelectability(e) && (e.modules.select && e.modules.select.selected ? this._deselectRow(e) : this._selectRow(e));
  }
  //select a number of rows
  selectRows(e) {
    var t = [], i, n;
    switch (typeof e) {
      case "undefined":
        i = this.table.rowManager.rows;
        break;
      case "number":
        i = this.table.rowManager.findRow(e);
        break;
      case "string":
        i = this.table.rowManager.findRow(e), i || (i = this.table.rowManager.getRows(e));
        break;
      default:
        i = e;
        break;
    }
    Array.isArray(i) ? i.length && (i.forEach((s) => {
      n = this._selectRow(s, !0, !0), n && t.push(n);
    }), this._rowSelectionChanged(!1, t)) : i && this._selectRow(i, !1, !0);
  }
  //select an individual row
  _selectRow(e, t, i) {
    if (!isNaN(this.table.options.selectableRows) && this.table.options.selectableRows !== !0 && !i && this.selectedRows.length >= this.table.options.selectableRows)
      if (this.table.options.selectableRowsRollingSelection)
        this._deselectRow(this.selectedRows[0]);
      else
        return !1;
    var n = this.table.rowManager.findRow(e);
    if (n) {
      if (this.selectedRows.indexOf(n) == -1)
        return n.getElement().classList.add("tabulator-selected"), n.modules.select || (n.modules.select = {}), n.modules.select.selected = !0, n.modules.select.checkboxEl && (n.modules.select.checkboxEl.checked = !0), this.selectedRows.push(n), this.table.options.dataTreeSelectPropagate && this.childRowSelection(n, !0), this.dispatchExternal("rowSelected", n.getComponent()), this._rowSelectionChanged(t, n), n;
    } else
      t || console.warn("Selection Error - No such row found, ignoring selection:" + e);
  }
  isRowSelected(e) {
    return this.selectedRows.indexOf(e) !== -1;
  }
  //deselect a number of rows
  deselectRows(e, t) {
    var i = [], n, s;
    switch (typeof e) {
      case "undefined":
        n = Object.assign([], this.selectedRows);
        break;
      case "number":
        n = this.table.rowManager.findRow(e);
        break;
      case "string":
        n = this.table.rowManager.findRow(e), n || (n = this.table.rowManager.getRows(e));
        break;
      default:
        n = e;
        break;
    }
    Array.isArray(n) ? n.length && (n.forEach((a) => {
      s = this._deselectRow(a, !0, !0), s && i.push(s);
    }), this._rowSelectionChanged(t, [], i)) : n && this._deselectRow(n, t, !0);
  }
  //deselect an individual row
  _deselectRow(e, t) {
    var i = this, n = i.table.rowManager.findRow(e), s, a;
    if (n) {
      if (s = i.selectedRows.findIndex(function(o) {
        return o == n;
      }), s > -1)
        return a = n.getElement(), a && a.classList.remove("tabulator-selected"), n.modules.select || (n.modules.select = {}), n.modules.select.selected = !1, n.modules.select.checkboxEl && (n.modules.select.checkboxEl.checked = !1), i.selectedRows.splice(s, 1), this.table.options.dataTreeSelectPropagate && this.childRowSelection(n, !1), this.dispatchExternal("rowDeselected", n.getComponent()), i._rowSelectionChanged(t, void 0, n), n;
    } else
      t || console.warn("Deselection Error - No such row found, ignoring selection:" + e);
  }
  getSelectedData() {
    var e = [];
    return this.selectedRows.forEach(function(t) {
      e.push(t.getData());
    }), e;
  }
  getSelectedRows() {
    var e = [];
    return this.selectedRows.forEach(function(t) {
      e.push(t.getComponent());
    }), e;
  }
  _rowSelectionChanged(e, t = [], i = []) {
    this.headerCheckboxElement && (this.selectedRows.length === 0 ? (this.headerCheckboxElement.checked = !1, this.headerCheckboxElement.indeterminate = !1) : this.table.rowManager.rows.length === this.selectedRows.length ? (this.headerCheckboxElement.checked = !0, this.headerCheckboxElement.indeterminate = !1) : (this.headerCheckboxElement.indeterminate = !0, this.headerCheckboxElement.checked = !1)), e || (Array.isArray(t) || (t = [t]), t = t.map((n) => n.getComponent()), Array.isArray(i) || (i = [i]), i = i.map((n) => n.getComponent()), this.dispatchExternal("rowSelectionChanged", this.getSelectedData(), this.getSelectedRows(), t, i));
  }
  registerRowSelectCheckbox(e, t) {
    e._row.modules.select || (e._row.modules.select = {}), e._row.modules.select.checkboxEl = t;
  }
  registerHeaderSelectCheckbox(e) {
    this.headerCheckboxElement = e;
  }
  childRowSelection(e, t) {
    var i = this.table.modules.dataTree.getChildren(e, !0, !0);
    if (t)
      for (let n of i)
        this._selectRow(n, !0);
    else
      for (let n of i)
        this._deselectRow(n, !0);
  }
}
A(th, "moduleName", "selectRow"), A(th, "moduleExtensions", Jy);
class Qy {
  constructor(e) {
    return this._range = e, new Proxy(this, {
      get: function(t, i, n) {
        return typeof t[i] < "u" ? t[i] : t._range.table.componentFunctionBinder.handle("range", t._range, i);
      }
    });
  }
  getElement() {
    return this._range.element;
  }
  getData() {
    return this._range.getData();
  }
  getCells() {
    return this._range.getCells(!0, !0);
  }
  getStructuredCells() {
    return this._range.getStructuredCells();
  }
  getRows() {
    return this._range.getRows().map((e) => e.getComponent());
  }
  getColumns() {
    return this._range.getColumns().map((e) => e.getComponent());
  }
  getBounds() {
    return this._range.getBounds();
  }
  getTopEdge() {
    return this._range.top;
  }
  getBottomEdge() {
    return this._range.bottom;
  }
  getLeftEdge() {
    return this._range.left;
  }
  getRightEdge() {
    return this._range.right;
  }
  setBounds(e, t) {
    this._range.destroyedGuard("setBounds") && this._range.setBounds(e && e._cell, t && t._cell);
  }
  setStartBound(e) {
    this._range.destroyedGuard("setStartBound") && (this._range.setEndBound(e && e._cell), this._range.rangeManager.layoutElement());
  }
  setEndBound(e) {
    this._range.destroyedGuard("setEndBound") && (this._range.setEndBound(e && e._cell), this._range.rangeManager.layoutElement());
  }
  clearValues() {
    this._range.destroyedGuard("clearValues") && this._range.clearValues();
  }
  remove() {
    this._range.destroyedGuard("remove") && this._range.destroy(!0);
  }
}
class ew extends ke {
  constructor(e, t, i, n) {
    super(e), this.rangeManager = t, this.element = null, this.initialized = !1, this.initializing = {
      start: !1,
      end: !1
    }, this.destroyed = !1, this.top = 0, this.bottom = 0, this.left = 0, this.right = 0, this.table = e, this.start = { row: 0, col: 0 }, this.end = { row: 0, col: 0 }, this.rangeManager.rowHeader && (this.left = 1, this.right = 1, this.start.col = 1, this.end.col = 1), this.initElement(), setTimeout(() => {
      this.initBounds(i, n);
    });
  }
  initElement() {
    this.element = document.createElement("div"), this.element.classList.add("tabulator-range");
  }
  initBounds(e, t) {
    this._updateMinMax(), e && this.setBounds(e, t || e);
  }
  ///////////////////////////////////
  ///////   Boundary Setup    ///////
  ///////////////////////////////////
  setStart(e, t) {
    (this.start.row !== e || this.start.col !== t) && (this.start.row = e, this.start.col = t, this.initializing.start = !0, this._updateMinMax());
  }
  setEnd(e, t) {
    (this.end.row !== e || this.end.col !== t) && (this.end.row = e, this.end.col = t, this.initializing.end = !0, this._updateMinMax());
  }
  setBounds(e, t, i) {
    e && this.setStartBound(e), this.setEndBound(t || e), this.rangeManager.layoutElement(i);
  }
  setStartBound(e) {
    var t, i;
    e.type === "column" ? this.rangeManager.columnSelection && this.setStart(0, e.getPosition() - 1) : (t = e.row.position - 1, i = e.column.getPosition() - 1, e.column === this.rangeManager.rowHeader ? this.setStart(t, 1) : this.setStart(t, i));
  }
  setEndBound(e) {
    var t = this._getTableRows().length, i, n, s;
    e.type === "column" ? this.rangeManager.columnSelection && (this.rangeManager.selecting === "column" ? this.setEnd(t - 1, e.getPosition() - 1) : this.rangeManager.selecting === "cell" && this.setEnd(0, e.getPosition() - 1)) : (i = e.row.position - 1, n = e.column.getPosition() - 1, s = e.column === this.rangeManager.rowHeader, this.rangeManager.selecting === "row" ? this.setEnd(i, this._getTableColumns().length - 1) : this.rangeManager.selecting !== "row" && s ? this.setEnd(i, 0) : this.rangeManager.selecting === "column" ? this.setEnd(t - 1, n) : this.setEnd(i, n));
  }
  _updateMinMax() {
    this.top = Math.min(this.start.row, this.end.row), this.bottom = Math.max(this.start.row, this.end.row), this.left = Math.min(this.start.col, this.end.col), this.right = Math.max(this.start.col, this.end.col), this.initialized ? this.dispatchExternal("rangeChanged", this.getComponent()) : this.initializing.start && this.initializing.end && (this.initialized = !0, this.dispatchExternal("rangeAdded", this.getComponent()));
  }
  _getTableColumns() {
    return this.table.columnManager.getVisibleColumnsByIndex();
  }
  _getTableRows() {
    return this.table.rowManager.getDisplayRows().filter((e) => e.type === "row");
  }
  ///////////////////////////////////
  ///////      Rendering      ///////
  ///////////////////////////////////
  layout() {
    var e = this.table.rowManager.renderer.vDomTop, t = this.table.rowManager.renderer.vDomBottom, i = this.table.columnManager.renderer.leftCol, n = this.table.columnManager.renderer.rightCol, s, a, o, l, h, u, d, c, f, p;
    this.table.options.renderHorizontal === "virtual" && this.rangeManager.rowHeader && (n += 1), e == null && (e = 0), t == null && (t = 1 / 0), i == null && (i = 0), n == null && (n = 1 / 0), this.overlaps(i, e, n, t) && (s = Math.max(this.top, e), a = Math.min(this.bottom, t), o = Math.max(this.left, i), l = Math.min(this.right, n), h = this.rangeManager.getCell(s, o), u = this.rangeManager.getCell(a, l), d = h.getElement(), c = u.getElement(), f = h.row.getElement(), p = u.row.getElement(), this.element.classList.add("tabulator-range-active"), this.table.rtl ? (this.element.style.right = f.offsetWidth - d.offsetLeft - d.offsetWidth + "px", this.element.style.width = d.offsetLeft + d.offsetWidth - c.offsetLeft + "px") : (this.element.style.left = f.offsetLeft + d.offsetLeft + "px", this.element.style.width = c.offsetLeft + c.offsetWidth - d.offsetLeft + "px"), this.element.style.top = f.offsetTop + "px", this.element.style.height = p.offsetTop + p.offsetHeight - f.offsetTop + "px");
  }
  atTopLeft(e) {
    return e.row.position - 1 === this.top && e.column.getPosition() - 1 === this.left;
  }
  atBottomRight(e) {
    return e.row.position - 1 === this.bottom && e.column.getPosition() - 1 === this.right;
  }
  occupies(e) {
    return this.occupiesRow(e.row) && this.occupiesColumn(e.column);
  }
  occupiesRow(e) {
    return this.top <= e.position - 1 && e.position - 1 <= this.bottom;
  }
  occupiesColumn(e) {
    return this.left <= e.getPosition() - 1 && e.getPosition() - 1 <= this.right;
  }
  overlaps(e, t, i, n) {
    return !(this.left > i || e > this.right || this.top > n || t > this.bottom);
  }
  getData() {
    var e = [], t = this.getRows(), i = this.getColumns();
    return t.forEach((n) => {
      var s = n.getData(), a = {};
      i.forEach((o) => {
        a[o.field] = s[o.field];
      }), e.push(a);
    }), e;
  }
  getCells(e, t) {
    var i = [], n = this.getRows(), s = this.getColumns();
    return e ? i = n.map((a) => {
      var o = [];
      return a.getCells().forEach((l) => {
        s.includes(l.column) && o.push(t ? l.getComponent() : l);
      }), o;
    }) : n.forEach((a) => {
      a.getCells().forEach((o) => {
        s.includes(o.column) && i.push(t ? o.getComponent() : o);
      });
    }), i;
  }
  getStructuredCells() {
    return this.getCells(!0, !0);
  }
  getRows() {
    return this._getTableRows().slice(this.top, this.bottom + 1);
  }
  getColumns() {
    return this._getTableColumns().slice(this.left, this.right + 1);
  }
  clearValues() {
    var e = this.getCells(), t = this.table.options.selectableRangeClearCellsValue;
    this.table.blockRedraw(), e.forEach((i) => {
      i.setValue(t);
    }), this.table.restoreRedraw();
  }
  getBounds(e) {
    var t = this.getCells(!1, e), i = {
      start: null,
      end: null
    };
    return t.length ? (i.start = t[0], i.end = t[t.length - 1]) : console.warn("No bounds defined on range"), i;
  }
  getComponent() {
    return this.component || (this.component = new Qy(this)), this.component;
  }
  destroy(e) {
    this.destroyed = !0, this.element.remove(), e && this.rangeManager.rangeRemoved(this), this.initialized && this.dispatchExternal("rangeRemoved", this.getComponent());
  }
  destroyedGuard(e) {
    return this.destroyed && console.warn("You cannot call the " + e + " function on a destroyed range"), !this.destroyed;
  }
}
var tw = {
  rangeJumpUp: ["ctrl + 38", "meta + 38"],
  rangeJumpDown: ["ctrl + 40", "meta + 40"],
  rangeJumpLeft: ["ctrl + 37", "meta + 37"],
  rangeJumpRight: ["ctrl + 39", "meta + 39"],
  rangeExpandUp: "shift + 38",
  rangeExpandDown: "shift + 40",
  rangeExpandLeft: "shift + 37",
  rangeExpandRight: "shift + 39",
  rangeExpandJumpUp: ["ctrl + shift + 38", "meta + shift + 38"],
  rangeExpandJumpDown: ["ctrl + shift + 40", "meta + shift + 40"],
  rangeExpandJumpLeft: ["ctrl + shift + 37", "meta + shift + 37"],
  rangeExpandJumpRight: ["ctrl + shift + 39", "meta + shift + 39"]
}, iw = {
  rangeJumpLeft: function(r) {
    this.dispatch("keybinding-nav-range", r, "left", !0, !1);
  },
  rangeJumpRight: function(r) {
    this.dispatch("keybinding-nav-range", r, "right", !0, !1);
  },
  rangeJumpUp: function(r) {
    this.dispatch("keybinding-nav-range", r, "up", !0, !1);
  },
  rangeJumpDown: function(r) {
    this.dispatch("keybinding-nav-range", r, "down", !0, !1);
  },
  rangeExpandLeft: function(r) {
    this.dispatch("keybinding-nav-range", r, "left", !1, !0);
  },
  rangeExpandRight: function(r) {
    this.dispatch("keybinding-nav-range", r, "right", !1, !0);
  },
  rangeExpandUp: function(r) {
    this.dispatch("keybinding-nav-range", r, "up", !1, !0);
  },
  rangeExpandDown: function(r) {
    this.dispatch("keybinding-nav-range", r, "down", !1, !0);
  },
  rangeExpandJumpLeft: function(r) {
    this.dispatch("keybinding-nav-range", r, "left", !0, !0);
  },
  rangeExpandJumpRight: function(r) {
    this.dispatch("keybinding-nav-range", r, "right", !0, !0);
  },
  rangeExpandJumpUp: function(r) {
    this.dispatch("keybinding-nav-range", r, "up", !0, !0);
  },
  rangeExpandJumpDown: function(r) {
    this.dispatch("keybinding-nav-range", r, "down", !0, !0);
  }
}, rw = {
  range: function(r) {
    var e = [], t = this.table.modules.selectRange.activeRange, i = !1, n, s, a, o, l;
    return l = r.length, t && (n = t.getBounds(), s = n.start, n.start === n.end && (i = !0), s && (e = this.table.rowManager.activeRows.slice(), a = e.indexOf(s.row), i ? o = r.length : o = e.indexOf(n.end.row) - a + 1, a > -1 && (this.table.blockRedraw(), e = e.slice(a, a + o), e.forEach((h, u) => {
      h.updateData(r[u % l]);
    }), this.table.restoreRedraw()))), e;
  }
}, nw = {
  range: function(r) {
    var e = [], t = [], i = this.table.modules.selectRange.activeRange, n = !1, s, a, o, l, h;
    return i && (s = i.getBounds(), a = s.start, s.start === s.end && (n = !0), a && (r = r.split(`
`), r.forEach(function(u) {
      e.push(u.split("	"));
    }), e.length && (l = this.table.columnManager.getVisibleColumnsByIndex(), h = l.indexOf(a.column), h > -1))) ? (n ? o = e[0].length : o = l.indexOf(s.end.column) - h + 1, l = l.slice(h, h + o), e.forEach((u) => {
      var d = {}, c = u.length;
      l.forEach(function(f, p) {
        d[f.field] = u[p % c];
      }), t.push(d);
    }), t) : !1;
  }
}, sw = {
  range: function() {
    var r = this.modules.selectRange.selectedColumns();
    return this.columnManager.rowHeader && r.unshift(this.columnManager.rowHeader), r;
  }
}, aw = {
  range: function() {
    return this.modules.selectRange.selectedRows();
  }
}, ow = {
  keybindings: {
    bindings: tw,
    actions: iw
  },
  clipboard: {
    pasteActions: rw,
    pasteParsers: nw
  },
  export: {
    columnLookups: sw,
    rowLookups: aw
  }
};
class ea extends U {
  constructor(e) {
    super(e), this.selecting = "cell", this.mousedown = !1, this.ranges = [], this.overlay = null, this.rowHeader = null, this.layoutChangeTimeout = null, this.columnSelection = !1, this.rowSelection = !1, this.maxRanges = 0, this.activeRange = !1, this.blockKeydown = !1, this.keyDownEvent = this._handleKeyDown.bind(this), this.mouseUpEvent = this._handleMouseUp.bind(this), this.registerTableOption("selectableRange", !1), this.registerTableOption("selectableRangeColumns", !1), this.registerTableOption("selectableRangeRows", !1), this.registerTableOption("selectableRangeClearCells", !1), this.registerTableOption("selectableRangeClearCellsValue", void 0), this.registerTableOption("selectableRangeAutoFocus", !0), this.registerTableFunction("getRangesData", this.getRangesData.bind(this)), this.registerTableFunction("getRanges", this.getRanges.bind(this)), this.registerTableFunction("addRange", this.addRangeFromComponent.bind(this)), this.registerComponentFunction("cell", "getRanges", this.cellGetRanges.bind(this)), this.registerComponentFunction("row", "getRanges", this.rowGetRanges.bind(this)), this.registerComponentFunction("column", "getRanges", this.colGetRanges.bind(this));
  }
  ///////////////////////////////////
  ///////    Initialization   ///////
  ///////////////////////////////////
  initialize() {
    this.options("selectableRange") && (this.options("selectableRows") ? console.warn("SelectRange functionality cannot be used in conjunction with row selection") : (this.maxRanges = this.options("selectableRange"), this.initializeTable(), this.initializeWatchers()), this.options("columns").findIndex((e) => e.frozen) > 0 && console.warn("Having frozen column in arbitrary position with selectRange option may result in unpredictable behavior."), this.options("columns").filter((e) => e.frozen) > 1 && console.warn("Having multiple frozen columns with selectRange option may result in unpredictable behavior."));
  }
  initializeTable() {
    this.overlay = document.createElement("div"), this.overlay.classList.add("tabulator-range-overlay"), this.rangeContainer = document.createElement("div"), this.rangeContainer.classList.add("tabulator-range-container"), this.activeRangeCellElement = document.createElement("div"), this.activeRangeCellElement.classList.add("tabulator-range-cell-active"), this.overlay.appendChild(this.rangeContainer), this.overlay.appendChild(this.activeRangeCellElement), this.table.rowManager.element.addEventListener("keydown", this.keyDownEvent), this.resetRanges(), this.table.rowManager.element.appendChild(this.overlay), this.table.columnManager.element.setAttribute("tabindex", 0), this.table.element.classList.add("tabulator-ranges");
  }
  initializeWatchers() {
    this.columnSelection = this.options("selectableRangeColumns"), this.rowSelection = this.options("selectableRangeRows"), this.subscribe("column-init", this.initializeColumn.bind(this)), this.subscribe("column-mousedown", this.handleColumnMouseDown.bind(this)), this.subscribe("column-mousemove", this.handleColumnMouseMove.bind(this)), this.subscribe("column-resized", this.handleColumnResized.bind(this)), this.subscribe("column-moving", this.handleColumnMoving.bind(this)), this.subscribe("column-moved", this.handleColumnMoved.bind(this)), this.subscribe("column-width", this.layoutChange.bind(this)), this.subscribe("column-height", this.layoutChange.bind(this)), this.subscribe("column-resized", this.layoutChange.bind(this)), this.subscribe("columns-loaded", this.updateHeaderColumn.bind(this)), this.subscribe("cell-height", this.layoutChange.bind(this)), this.subscribe("cell-rendered", this.renderCell.bind(this)), this.subscribe("cell-mousedown", this.handleCellMouseDown.bind(this)), this.subscribe("cell-mousemove", this.handleCellMouseMove.bind(this)), this.subscribe("cell-click", this.handleCellClick.bind(this)), this.subscribe("cell-editing", this.handleEditingCell.bind(this)), this.subscribe("page-changed", this.redraw.bind(this)), this.subscribe("scroll-vertical", this.layoutChange.bind(this)), this.subscribe("scroll-horizontal", this.layoutChange.bind(this)), this.subscribe("data-destroy", this.tableDestroyed.bind(this)), this.subscribe("data-processed", this.resetRanges.bind(this)), this.subscribe("table-layout", this.layoutElement.bind(this)), this.subscribe("table-redraw", this.redraw.bind(this)), this.subscribe("table-destroy", this.tableDestroyed.bind(this)), this.subscribe("edit-editor-clear", this.finishEditingCell.bind(this)), this.subscribe("edit-blur", this.restoreFocus.bind(this)), this.subscribe("keybinding-nav-prev", this.keyNavigate.bind(this, "left")), this.subscribe("keybinding-nav-next", this.keyNavigate.bind(this, "right")), this.subscribe("keybinding-nav-left", this.keyNavigate.bind(this, "left")), this.subscribe("keybinding-nav-right", this.keyNavigate.bind(this, "right")), this.subscribe("keybinding-nav-up", this.keyNavigate.bind(this, "up")), this.subscribe("keybinding-nav-down", this.keyNavigate.bind(this, "down")), this.subscribe("keybinding-nav-range", this.keyNavigateRange.bind(this));
  }
  initializeColumn(e) {
    this.columnSelection && e.definition.headerSort && this.options("headerSortClickElement") !== "icon" && console.warn("Using column headerSort with selectableRangeColumns option may result in unpredictable behavior. Consider using headerSortClickElement: 'icon'."), e.modules.edit;
  }
  updateHeaderColumn() {
    var e;
    this.rowSelection && (this.rowHeader = this.table.columnManager.getVisibleColumnsByIndex()[0], this.rowHeader && (this.rowHeader.definition.cssClass = this.rowHeader.definition.cssClass + " tabulator-range-row-header", this.rowHeader.definition.headerSort && console.warn("Using column headerSort with selectableRangeRows option may result in unpredictable behavior"), this.rowHeader.definition.editor && console.warn("Using column editor with selectableRangeRows option may result in unpredictable behavior"))), this.table.modules.frozenColumns && this.table.modules.frozenColumns.active && (e = this.table.modules.frozenColumns.getFrozenColumns(), (e.length > 1 || e.length === 1 && e[0] !== this.rowHeader) && console.warn("Using frozen columns that are not the range header in combination with the selectRange option may result in unpredictable behavior"));
  }
  ///////////////////////////////////
  ///////   Table Functions   ///////
  ///////////////////////////////////
  getRanges() {
    return this.ranges.map((e) => e.getComponent());
  }
  getRangesData() {
    return this.ranges.map((e) => e.getData());
  }
  addRangeFromComponent(e, t) {
    return e = e ? e._cell : null, t = t ? t._cell : null, this.addRange(e, t);
  }
  ///////////////////////////////////
  /////// Component Functions ///////
  ///////////////////////////////////
  cellGetRanges(e) {
    var t = [];
    return e.column === this.rowHeader ? t = this.ranges.filter((i) => i.occupiesRow(e.row)) : t = this.ranges.filter((i) => i.occupies(e)), t.map((i) => i.getComponent());
  }
  rowGetRanges(e) {
    var t = this.ranges.filter((i) => i.occupiesRow(e));
    return t.map((i) => i.getComponent());
  }
  colGetRanges(e) {
    var t = this.ranges.filter((i) => i.occupiesColumn(e));
    return t.map((i) => i.getComponent());
  }
  ///////////////////////////////////
  ////////// Event Handlers /////////
  ///////////////////////////////////
  _handleMouseUp(e) {
    this.mousedown = !1, document.removeEventListener("mouseup", this.mouseUpEvent);
  }
  _handleKeyDown(e) {
    if (!this.blockKeydown && (!this.table.modules.edit || this.table.modules.edit && !this.table.modules.edit.currentCell)) {
      if (e.key === "Enter") {
        if (this.table.modules.edit && this.table.modules.edit.currentCell)
          return;
        this.table.modules.edit.editCell(this.getActiveCell()), e.preventDefault();
      }
      (e.key === "Backspace" || e.key === "Delete") && this.options("selectableRangeClearCells") && this.activeRange && this.activeRange.clearValues();
    }
  }
  initializeFocus(e) {
    var t;
    this.restoreFocus();
    try {
      document.selection ? (t = document.body.createTextRange(), t.moveToElementText(e.getElement()), t.select()) : window.getSelection && (t = document.createRange(), t.selectNode(e.getElement()), window.getSelection().removeAllRanges(), window.getSelection().addRange(t));
    } catch {
    }
  }
  restoreFocus(e) {
    return this.table.rowManager.element.focus(), !0;
  }
  ///////////////////////////////////
  ////// Column Functionality ///////
  ///////////////////////////////////
  handleColumnResized(e) {
    var t;
    this.selecting !== "column" && this.selecting !== "all" || (t = this.ranges.some((i) => i.occupiesColumn(e)), t && this.ranges.forEach((i) => {
      var n = i.getColumns(!0);
      n.forEach((s) => {
        s !== e && s.setWidth(e.width);
      });
    }));
  }
  handleColumnMoving(e, t) {
    this.resetRanges().setBounds(t), this.overlay.style.visibility = "hidden";
  }
  handleColumnMoved(e, t, i) {
    this.activeRange.setBounds(e), this.layoutElement();
  }
  handleColumnMouseDown(e, t) {
    e.button === 2 && (this.selecting === "column" || this.selecting === "all") && this.activeRange.occupiesColumn(t) || this.table.options.movableColumns && this.selecting === "column" && this.activeRange.occupiesColumn(t) || (this.mousedown = !0, document.addEventListener("mouseup", this.mouseUpEvent), this.newSelection(e, t));
  }
  handleColumnMouseMove(e, t) {
    t === this.rowHeader || !this.mousedown || this.selecting === "all" || this.activeRange.setBounds(!1, t, !0);
  }
  ///////////////////////////////////
  //////// Cell Functionality ///////
  ///////////////////////////////////
  renderCell(e) {
    var t = e.getElement(), i = this.ranges.findIndex((n) => n.occupies(e));
    t.classList.toggle("tabulator-range-selected", i !== -1), t.classList.toggle("tabulator-range-only-cell-selected", this.ranges.length === 1 && this.ranges[0].atTopLeft(e) && this.ranges[0].atBottomRight(e)), t.dataset.range = i;
  }
  handleCellMouseDown(e, t) {
    e.button === 2 && (this.activeRange.occupies(t) || (this.selecting === "row" || this.selecting === "all") && this.activeRange.occupiesRow(t.row)) || (this.mousedown = !0, document.addEventListener("mouseup", this.mouseUpEvent), this.newSelection(e, t));
  }
  handleCellMouseMove(e, t) {
    !this.mousedown || this.selecting === "all" || this.activeRange.setBounds(!1, t, !0);
  }
  handleCellClick(e, t) {
    this.initializeFocus(t);
  }
  handleEditingCell(e) {
    this.activeRange && this.activeRange.setBounds(e);
  }
  finishEditingCell() {
    this.blockKeydown = !0, this.table.rowManager.element.focus(), setTimeout(() => {
      this.blockKeydown = !1;
    }, 10);
  }
  ///////////////////////////////////
  ///////     Navigation      ///////
  ///////////////////////////////////
  keyNavigate(e, t) {
    this.navigate(!1, !1, e), t.preventDefault();
  }
  keyNavigateRange(e, t, i, n) {
    this.navigate(i, n, t), e.preventDefault();
  }
  navigate(e, t, i) {
    var n = !1, s, a, o, l, h, u, d, c, f, p, m;
    if (this.table.modules.edit && this.table.modules.edit.currentCell)
      return !1;
    if (this.ranges.length > 1 && (this.ranges = this.ranges.filter((g) => g === this.activeRange ? (g.setEnd(g.start.row, g.start.col), !0) : (g.destroy(), !1))), s = this.activeRange, o = {
      top: s.top,
      bottom: s.bottom,
      left: s.left,
      right: s.right
    }, a = t ? s.end : s.start, l = a.row, h = a.col, e)
      switch (i) {
        case "left":
          h = this.findJumpCellLeft(s.start.row, a.col);
          break;
        case "right":
          h = this.findJumpCellRight(s.start.row, a.col);
          break;
        case "up":
          l = this.findJumpCellUp(a.row, s.start.col);
          break;
        case "down":
          l = this.findJumpCellDown(a.row, s.start.col);
          break;
      }
    else {
      if (t && (this.selecting === "row" && (i === "left" || i === "right") || this.selecting === "column" && (i === "up" || i === "down")))
        return;
      switch (i) {
        case "left":
          h = Math.max(h - 1, 0);
          break;
        case "right":
          h = Math.min(h + 1, this.getTableColumns().length - 1);
          break;
        case "up":
          l = Math.max(l - 1, 0);
          break;
        case "down":
          l = Math.min(l + 1, this.getTableRows().length - 1);
          break;
      }
    }
    if (this.rowHeader && h === 0 && (h = 1), t || s.setStart(l, h), s.setEnd(l, h), t || (this.selecting = "cell"), n = o.top !== s.top || o.bottom !== s.bottom || o.left !== s.left || o.right !== s.right, n)
      return u = this.getRowByRangePos(s.end.row), d = this.getColumnByRangePos(s.end.col), c = u.getElement().getBoundingClientRect(), p = d.getElement().getBoundingClientRect(), f = this.table.rowManager.getElement().getBoundingClientRect(), m = this.table.columnManager.getElement().getBoundingClientRect(), c.top >= f.top && c.bottom <= f.bottom || (u.getElement().parentNode && d.getElement().parentNode ? this.autoScroll(s, u.getElement(), d.getElement()) : u.getComponent().scrollTo(void 0, !1)), p.left >= m.left + this.getRowHeaderWidth() && p.right <= m.right || (u.getElement().parentNode && d.getElement().parentNode ? this.autoScroll(s, u.getElement(), d.getElement()) : d.getComponent().scrollTo(void 0, !1)), this.layoutElement(), !0;
  }
  rangeRemoved(e) {
    this.ranges = this.ranges.filter((t) => t !== e), this.activeRange === e && (this.ranges.length ? this.activeRange = this.ranges[this.ranges.length - 1] : this.addRange()), this.layoutElement();
  }
  findJumpRow(e, t, i, n, s) {
    return i && (t = t.reverse()), this.findJumpItem(n, s, t, function(a) {
      return a.getData()[e.getField()];
    });
  }
  findJumpCol(e, t, i, n, s) {
    return i && (t = t.reverse()), this.findJumpItem(n, s, t, function(a) {
      return e.getData()[a.getField()];
    });
  }
  findJumpItem(e, t, i, n) {
    var s;
    for (let a of i) {
      let o = n(a);
      if (e) {
        if (s = a, o)
          break;
      } else if (t) {
        if (s = a, o)
          break;
      } else if (o)
        s = a;
      else
        break;
    }
    return s;
  }
  findJumpCellLeft(e, t) {
    var i = this.getRowByRangePos(e), n = this.getTableColumns(), s = this.isEmpty(i.getData()[n[t].getField()]), a = n[t - 1] ? this.isEmpty(i.getData()[n[t - 1].getField()]) : !1, o = this.rowHeader ? n.slice(1, t) : n.slice(0, t), l = this.findJumpCol(i, o, !0, s, a);
    return l ? l.getPosition() - 1 : t;
  }
  findJumpCellRight(e, t) {
    var i = this.getRowByRangePos(e), n = this.getTableColumns(), s = this.isEmpty(i.getData()[n[t].getField()]), a = n[t + 1] ? this.isEmpty(i.getData()[n[t + 1].getField()]) : !1, o = this.findJumpCol(i, n.slice(t + 1, n.length), !1, s, a);
    return o ? o.getPosition() - 1 : t;
  }
  findJumpCellUp(e, t) {
    var i = this.getColumnByRangePos(t), n = this.getTableRows(), s = this.isEmpty(n[e].getData()[i.getField()]), a = n[e - 1] ? this.isEmpty(n[e - 1].getData()[i.getField()]) : !1, o = this.findJumpRow(i, n.slice(0, e), !0, s, a);
    return o ? o.position - 1 : e;
  }
  findJumpCellDown(e, t) {
    var i = this.getColumnByRangePos(t), n = this.getTableRows(), s = this.isEmpty(n[e].getData()[i.getField()]), a = n[e + 1] ? this.isEmpty(n[e + 1].getData()[i.getField()]) : !1, o = this.findJumpRow(i, n.slice(e + 1, n.length), !1, s, a);
    return o ? o.position - 1 : e;
  }
  ///////////////////////////////////
  ///////      Selection      ///////
  ///////////////////////////////////
  newSelection(e, t) {
    var i;
    if (t.type === "column") {
      if (!this.columnSelection)
        return;
      if (t === this.rowHeader) {
        i = this.resetRanges(), this.selecting = "all";
        var n, s = this.getCell(-1, -1);
        this.rowHeader ? n = this.getCell(0, 1) : n = this.getCell(0, 0), i.setBounds(n, s);
        return;
      } else
        this.selecting = "column";
    } else t.column === this.rowHeader ? this.selecting = "row" : this.selecting = "cell";
    e.shiftKey ? this.activeRange.setBounds(!1, t) : e.ctrlKey ? this.addRange().setBounds(t) : this.resetRanges().setBounds(t);
  }
  autoScroll(e, t, i) {
    var n = this.table.rowManager.element, s, a, o, l;
    typeof t > "u" && (t = this.getRowByRangePos(e.end.row).getElement()), typeof i > "u" && (i = this.getColumnByRangePos(e.end.col).getElement()), s = {
      left: i.offsetLeft,
      right: i.offsetLeft + i.offsetWidth,
      top: t.offsetTop,
      bottom: t.offsetTop + t.offsetHeight
    }, a = {
      left: n.scrollLeft + this.getRowHeaderWidth(),
      right: Math.ceil(n.scrollLeft + n.clientWidth),
      top: n.scrollTop,
      bottom: n.scrollTop + n.offsetHeight - this.table.rowManager.scrollbarWidth
    }, o = a.left < s.left && s.left < a.right && a.left < s.right && s.right < a.right, l = a.top < s.top && s.top < a.bottom && a.top < s.bottom && s.bottom < a.bottom, o || (s.left < a.left ? n.scrollLeft = s.left - this.getRowHeaderWidth() : s.right > a.right && (n.scrollLeft = Math.min(s.right - n.clientWidth, s.left - this.getRowHeaderWidth()))), l || (s.top < a.top ? n.scrollTop = s.top : s.bottom > a.bottom && (n.scrollTop = s.bottom - n.clientHeight));
  }
  ///////////////////////////////////
  ///////       Layout        ///////
  ///////////////////////////////////
  layoutChange() {
    this.overlay.style.visibility = "hidden", clearTimeout(this.layoutChangeTimeout), this.layoutChangeTimeout = setTimeout(this.layoutRanges.bind(this), 200);
  }
  redraw(e) {
    e && (this.selecting = "cell", this.resetRanges(), this.layoutElement());
  }
  layoutElement(e) {
    var t;
    e ? t = this.table.rowManager.getVisibleRows(!0) : t = this.table.rowManager.getRows(), t.forEach((i) => {
      i.type === "row" && (this.layoutRow(i), i.cells.forEach((n) => this.renderCell(n)));
    }), this.getTableColumns().forEach((i) => {
      this.layoutColumn(i);
    }), this.layoutRanges();
  }
  layoutRow(e) {
    var t = e.getElement(), i = !1, n = this.ranges.some((s) => s.occupiesRow(e));
    this.selecting === "row" ? i = n : this.selecting === "all" && (i = !0), t.classList.toggle("tabulator-range-selected", i), t.classList.toggle("tabulator-range-highlight", n);
  }
  layoutColumn(e) {
    var t = e.getElement(), i = !1, n = this.ranges.some((s) => s.occupiesColumn(e));
    this.selecting === "column" ? i = n : this.selecting === "all" && (i = !0), t.classList.toggle("tabulator-range-selected", i), t.classList.toggle("tabulator-range-highlight", n);
  }
  layoutRanges() {
    var e, t, i;
    this.table.initialized && (e = this.getActiveCell(), e && (t = e.getElement(), i = e.row.getElement(), this.table.rtl ? this.activeRangeCellElement.style.right = i.offsetWidth - t.offsetLeft - t.offsetWidth + "px" : this.activeRangeCellElement.style.left = i.offsetLeft + t.offsetLeft + "px", this.activeRangeCellElement.style.top = i.offsetTop + "px", this.activeRangeCellElement.style.width = t.offsetWidth + "px", this.activeRangeCellElement.style.height = i.offsetHeight + "px", this.ranges.forEach((n) => n.layout()), this.overlay.style.visibility = "visible"));
  }
  ///////////////////////////////////
  ///////  Helper Functions   ///////
  ///////////////////////////////////	
  getCell(e, t) {
    var i;
    return t < 0 && (t = this.getTableColumns().length + t, t < 0) ? null : (e < 0 && (e = this.getTableRows().length + e), i = this.table.rowManager.getRowFromPosition(e + 1), i ? i.getCells(!1, !0).filter((n) => n.column.visible)[t] : null);
  }
  getActiveCell() {
    return this.getCell(this.activeRange.start.row, this.activeRange.start.col);
  }
  getRowByRangePos(e) {
    return this.getTableRows()[e];
  }
  getColumnByRangePos(e) {
    return this.getTableColumns()[e];
  }
  getTableRows() {
    return this.table.rowManager.getDisplayRows().filter((e) => e.type === "row");
  }
  getTableColumns() {
    return this.table.columnManager.getVisibleColumnsByIndex();
  }
  addRange(e, t) {
    var i;
    return this.maxRanges !== !0 && this.ranges.length >= this.maxRanges && this.ranges.shift().destroy(), i = new ew(this.table, this, e, t), this.activeRange = i, this.ranges.push(i), this.rangeContainer.appendChild(i.element), i;
  }
  resetRanges() {
    var e, t, i;
    return this.ranges.forEach((n) => n.destroy()), this.ranges = [], e = this.addRange(), this.table.rowManager.activeRows.length && (i = this.table.rowManager.activeRows[0].cells.filter((n) => n.column.visible), t = i[this.rowHeader ? 1 : 0], t && (e.setBounds(t), this.options("selectableRangeAutoFocus") && this.initializeFocus(t))), e;
  }
  tableDestroyed() {
    document.removeEventListener("mouseup", this.mouseUpEvent), this.table.rowManager.element.removeEventListener("keydown", this.keyDownEvent);
  }
  selectedRows(e) {
    return e ? this.activeRange.getRows().map((t) => t.getComponent()) : this.activeRange.getRows();
  }
  selectedColumns(e) {
    return e ? this.activeRange.getColumns().map((t) => t.getComponent()) : this.activeRange.getColumns();
  }
  getRowHeaderWidth() {
    return this.rowHeader ? this.rowHeader.getElement().offsetWidth : 0;
  }
  isEmpty(e) {
    return e == null || e === "";
  }
}
A(ea, "moduleName", "selectRange"), A(ea, "moduleInitOrder", 1), A(ea, "moduleExtensions", ow);
function lw(r, e, t, i, n, s, a) {
  var o = a.alignEmptyValues, l = a.decimalSeparator, h = a.thousandSeparator, u = 0;
  if (r = String(r), e = String(e), h && (r = r.split(h).join(""), e = e.split(h).join("")), l && (r = r.split(l).join("."), e = e.split(l).join(".")), r = parseFloat(r), e = parseFloat(e), isNaN(r))
    u = isNaN(e) ? 0 : -1;
  else if (isNaN(e))
    u = 1;
  else
    return r - e;
  return (o === "top" && s === "desc" || o === "bottom" && s === "asc") && (u *= -1), u;
}
function hw(r, e, t, i, n, s, a) {
  var o = a.alignEmptyValues, l = 0, h;
  if (!r)
    l = e ? -1 : 0;
  else if (!e)
    l = 1;
  else {
    switch (typeof a.locale) {
      case "boolean":
        a.locale && (h = this.langLocale());
        break;
      case "string":
        h = a.locale;
        break;
    }
    return String(r).toLowerCase().localeCompare(String(e).toLowerCase(), h);
  }
  return (o === "top" && s === "desc" || o === "bottom" && s === "asc") && (l *= -1), l;
}
function su(r, e, t, i, n, s, a) {
  var o = this.table.dependencyRegistry.lookup(["luxon", "DateTime"], "DateTime"), l = a.format || "dd/MM/yyyy HH:mm:ss", h = a.alignEmptyValues, u = 0;
  if (typeof o < "u") {
    if (o.isDateTime(r) || (l === "iso" ? r = o.fromISO(String(r)) : r = o.fromFormat(String(r), l)), o.isDateTime(e) || (l === "iso" ? e = o.fromISO(String(e)) : e = o.fromFormat(String(e), l)), !r.isValid)
      u = e.isValid ? -1 : 0;
    else if (!e.isValid)
      u = 1;
    else
      return r - e;
    return (h === "top" && s === "desc" || h === "bottom" && s === "asc") && (u *= -1), u;
  } else
    console.error("Sort Error - 'datetime' sorter is dependant on luxon.js");
}
function uw(r, e, t, i, n, s, a) {
  return a.format || (a.format = "dd/MM/yyyy"), su.call(this, r, e, t, i, n, s, a);
}
function dw(r, e, t, i, n, s, a) {
  return a.format || (a.format = "HH:mm"), su.call(this, r, e, t, i, n, s, a);
}
function cw(r, e, t, i, n, s, a) {
  var o = r === !0 || r === "true" || r === "True" || r === 1 ? 1 : 0, l = e === !0 || e === "true" || e === "True" || e === 1 ? 1 : 0;
  return o - l;
}
function fw(r, e, t, i, n, s, a) {
  var o = a.type || "length", l = a.alignEmptyValues, h = 0, u = this.table, d;
  a.valueMap && (typeof a.valueMap == "string" ? d = function(f) {
    return f.map((p) => de.retrieveNestedData(u.options.nestedFieldSeparator, a.valueMap, p));
  } : d = a.valueMap);
  function c(f) {
    var p;
    switch (d && (f = d(f)), o) {
      case "length":
        p = f.length;
        break;
      case "sum":
        p = f.reduce(function(m, g) {
          return m + g;
        });
        break;
      case "max":
        p = Math.max.apply(null, f);
        break;
      case "min":
        p = Math.min.apply(null, f);
        break;
      case "avg":
        p = f.reduce(function(m, g) {
          return m + g;
        }) / f.length;
        break;
      case "string":
        p = f.join("");
        break;
    }
    return p;
  }
  if (!Array.isArray(r))
    h = Array.isArray(e) ? -1 : 0;
  else if (!Array.isArray(e))
    h = 1;
  else
    return o === "string" ? String(c(r)).toLowerCase().localeCompare(String(c(e)).toLowerCase()) : c(e) - c(r);
  return (l === "top" && s === "desc" || l === "bottom" && s === "asc") && (h *= -1), h;
}
function pw(r, e, t, i, n, s, a) {
  var o = typeof r > "u" ? 0 : 1, l = typeof e > "u" ? 0 : 1;
  return o - l;
}
function gw(r, e, t, i, n, s, a) {
  var o, l, h, u, d = 0, c, f = /(\d+)|(\D+)/g, p = /\d/, m = a.alignEmptyValues, g = 0;
  if (!r && r !== 0)
    g = !e && e !== 0 ? 0 : -1;
  else if (!e && e !== 0)
    g = 1;
  else {
    if (isFinite(r) && isFinite(e)) return r - e;
    if (o = String(r).toLowerCase(), l = String(e).toLowerCase(), o === l) return 0;
    if (!(p.test(o) && p.test(l))) return o > l ? 1 : -1;
    for (o = o.match(f), l = l.match(f), c = o.length > l.length ? l.length : o.length; d < c; )
      if (h = o[d], u = l[d++], h !== u)
        return isFinite(h) && isFinite(u) ? (h.charAt(0) === "0" && (h = "." + h), u.charAt(0) === "0" && (u = "." + u), h - u) : h > u ? 1 : -1;
    return o.length > l.length;
  }
  return (m === "top" && s === "desc" || m === "bottom" && s === "asc") && (g *= -1), g;
}
var vw = {
  number: lw,
  string: hw,
  date: uw,
  time: dw,
  datetime: su,
  boolean: cw,
  array: fw,
  exists: pw,
  alphanum: gw
};
const Qi = class Qi extends U {
  constructor(e) {
    super(e), this.sortList = [], this.changed = !1, this.registerTableOption("sortMode", "local"), this.registerTableOption("initialSort", !1), this.registerTableOption("columnHeaderSortMulti", !0), this.registerTableOption("sortOrderReverse", !1), this.registerTableOption("headerSortElement", "<div class='tabulator-arrow'></div>"), this.registerTableOption("headerSortClickElement", "header"), this.registerColumnOption("sorter"), this.registerColumnOption("sorterParams"), this.registerColumnOption("headerSort", !0), this.registerColumnOption("headerSortStartingDir"), this.registerColumnOption("headerSortTristate");
  }
  initialize() {
    this.subscribe("column-layout", this.initializeColumn.bind(this)), this.subscribe("table-built", this.tableBuilt.bind(this)), this.registerDataHandler(this.sort.bind(this), 20), this.registerTableFunction("setSort", this.userSetSort.bind(this)), this.registerTableFunction("getSorters", this.getSort.bind(this)), this.registerTableFunction("clearSort", this.clearSort.bind(this)), this.table.options.sortMode === "remote" && this.subscribe("data-params", this.remoteSortParams.bind(this));
  }
  tableBuilt() {
    this.table.options.initialSort && this.setSort(this.table.options.initialSort);
  }
  remoteSortParams(e, t, i, n) {
    var s = this.getSort();
    return s.forEach((a) => {
      delete a.column;
    }), n.sort = s, n;
  }
  ///////////////////////////////////
  ///////// Table Functions /////////
  ///////////////////////////////////
  userSetSort(e, t) {
    this.setSort(e, t), this.refreshSort();
  }
  clearSort() {
    this.clear(), this.refreshSort();
  }
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  //initialize column header for sorting
  initializeColumn(e) {
    var t = !1, i, n;
    switch (typeof e.definition.sorter) {
      case "string":
        Qi.sorters[e.definition.sorter] ? t = Qi.sorters[e.definition.sorter] : console.warn("Sort Error - No such sorter found: ", e.definition.sorter);
        break;
      case "function":
        t = e.definition.sorter;
        break;
    }
    if (e.modules.sort = {
      sorter: t,
      dir: "none",
      params: e.definition.sorterParams || {},
      startingDir: e.definition.headerSortStartingDir || "asc",
      tristate: e.definition.headerSortTristate
    }, e.definition.headerSort !== !1) {
      switch (i = e.getElement(), i.classList.add("tabulator-sortable"), n = document.createElement("div"), n.classList.add("tabulator-col-sorter"), this.table.options.headerSortClickElement) {
        case "icon":
          n.classList.add("tabulator-col-sorter-element");
          break;
        case "header":
          i.classList.add("tabulator-col-sorter-element");
          break;
        default:
          i.classList.add("tabulator-col-sorter-element");
          break;
      }
      switch (this.table.options.headerSortElement) {
        case "function":
          break;
        case "object":
          n.appendChild(this.table.options.headerSortElement);
          break;
        default:
          n.innerHTML = this.table.options.headerSortElement;
      }
      e.titleHolderElement.appendChild(n), e.modules.sort.element = n, this.setColumnHeaderSortIcon(e, "none"), this.table.options.headerSortClickElement === "icon" && n.addEventListener("mousedown", (s) => {
        s.stopPropagation();
      }), (this.table.options.headerSortClickElement === "icon" ? n : i).addEventListener("click", (s) => {
        var a = "", o = [], l = !1;
        if (e.modules.sort) {
          if (e.modules.sort.tristate)
            e.modules.sort.dir == "none" ? a = e.modules.sort.startingDir : e.modules.sort.dir == e.modules.sort.startingDir ? a = e.modules.sort.dir == "asc" ? "desc" : "asc" : a = "none";
          else
            switch (e.modules.sort.dir) {
              case "asc":
                a = "desc";
                break;
              case "desc":
                a = "asc";
                break;
              default:
                a = e.modules.sort.startingDir;
            }
          this.table.options.columnHeaderSortMulti && (s.shiftKey || s.ctrlKey) ? (o = this.getSort(), l = o.findIndex((h) => h.field === e.getField()), l > -1 ? (o[l].dir = a, l = o.splice(l, 1)[0], a != "none" && o.push(l)) : a != "none" && o.push({ column: e, dir: a }), this.setSort(o)) : a == "none" ? this.clear() : this.setSort(e, a), this.refreshSort();
        }
      });
    }
  }
  refreshSort() {
    this.table.options.sortMode === "remote" ? this.reloadData(null, !1, !1) : this.refreshData(!0);
  }
  //check if the sorters have changed since last use
  hasChanged() {
    var e = this.changed;
    return this.changed = !1, e;
  }
  //return current sorters
  getSort() {
    var e = this, t = [];
    return e.sortList.forEach(function(i) {
      i.column && t.push({ column: i.column.getComponent(), field: i.column.getField(), dir: i.dir });
    }), t;
  }
  //change sort list and trigger sort
  setSort(e, t) {
    var i = this, n = [];
    Array.isArray(e) || (e = [{ column: e, dir: t }]), e.forEach(function(s) {
      var a;
      a = i.table.columnManager.findColumn(s.column), a ? (s.column = a, n.push(s), i.changed = !0) : console.warn("Sort Warning - Sort field does not exist and is being ignored: ", s.column);
    }), i.sortList = n, this.dispatch("sort-changed");
  }
  //clear sorters
  clear() {
    this.setSort([]);
  }
  //find appropriate sorter for column
  findSorter(e) {
    var t = this.table.rowManager.activeRows[0], i = "string", n, s;
    if (t && (t = t.getData(), n = e.getField(), n))
      switch (s = e.getFieldValue(t), typeof s) {
        case "undefined":
          i = "string";
          break;
        case "boolean":
          i = "boolean";
          break;
        default:
          !isNaN(s) && s !== "" ? i = "number" : s.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i) && (i = "alphanum");
          break;
      }
    return Qi.sorters[i];
  }
  //work through sort list sorting data
  sort(e, t) {
    var i = this, n = this.table.options.sortOrderReverse ? i.sortList.slice().reverse() : i.sortList, s = [], a = [];
    return this.subscribedExternal("dataSorting") && this.dispatchExternal("dataSorting", i.getSort()), t || i.clearColumnHeaders(), this.table.options.sortMode !== "remote" ? (n.forEach(function(o, l) {
      var h;
      o.column && (h = o.column.modules.sort, h && (h.sorter || (h.sorter = i.findSorter(o.column)), o.params = typeof h.params == "function" ? h.params(o.column.getComponent(), o.dir) : h.params, s.push(o)), t || i.setColumnHeader(o.column, o.dir));
    }), s.length && i._sortItems(e, s)) : t || n.forEach(function(o, l) {
      i.setColumnHeader(o.column, o.dir);
    }), this.subscribedExternal("dataSorted") && (e.forEach((o) => {
      a.push(o.getComponent());
    }), this.dispatchExternal("dataSorted", i.getSort(), a)), e;
  }
  //clear sort arrows on columns
  clearColumnHeaders() {
    this.table.columnManager.getRealColumns().forEach((e) => {
      e.modules.sort && (e.modules.sort.dir = "none", e.getElement().setAttribute("aria-sort", "none"), this.setColumnHeaderSortIcon(e, "none"));
    });
  }
  //set the column header sort direction
  setColumnHeader(e, t) {
    e.modules.sort.dir = t, e.getElement().setAttribute("aria-sort", t === "asc" ? "ascending" : "descending"), this.setColumnHeaderSortIcon(e, t);
  }
  setColumnHeaderSortIcon(e, t) {
    var i = e.modules.sort.element, n;
    if (e.definition.headerSort && typeof this.table.options.headerSortElement == "function") {
      for (; i.firstChild; ) i.removeChild(i.firstChild);
      n = this.table.options.headerSortElement.call(this.table, e.getComponent(), t), typeof n == "object" ? i.appendChild(n) : i.innerHTML = n;
    }
  }
  //sort each item in sort list
  _sortItems(e, t) {
    var i = t.length - 1;
    e.sort((n, s) => {
      for (var a, o = i; o >= 0; o--) {
        let l = t[o];
        if (a = this._sortRow(n, s, l.column, l.dir, l.params), a !== 0)
          break;
      }
      return a;
    });
  }
  //process individual rows for a sort function on active data
  _sortRow(e, t, i, n, s) {
    var a, o, l = n == "asc" ? e : t, h = n == "asc" ? t : e;
    return e = i.getFieldValue(l.getData()), t = i.getFieldValue(h.getData()), e = typeof e < "u" ? e : "", t = typeof t < "u" ? t : "", a = l.getComponent(), o = h.getComponent(), i.modules.sort.sorter.call(this, e, t, a, o, i.getComponent(), n, s);
  }
};
A(Qi, "moduleName", "sort"), //load defaults
A(Qi, "sorters", vw);
let ih = Qi;
class mw {
  constructor(e, t) {
    this.columnCount = e, this.rowCount = t, this.columnString = [], this.columns = [], this.rows = [];
  }
  genColumns(e) {
    var t = Math.max(this.columnCount, Math.max(...e.map((i) => i.length)));
    this.columnString = [], this.columns = [];
    for (let i = 1; i <= t; i++)
      this.incrementChar(this.columnString.length - 1), this.columns.push(this.columnString.join(""));
    return this.columns;
  }
  genRows(e) {
    var t = Math.max(this.rowCount, e.length);
    this.rows = [];
    for (let i = 1; i <= t; i++)
      this.rows.push(i);
    return this.rows;
  }
  incrementChar(e) {
    let t = this.columnString[e];
    t ? t !== "Z" ? this.columnString[e] = String.fromCharCode(this.columnString[e].charCodeAt(0) + 1) : (this.columnString[e] = "A", e ? this.incrementChar(e - 1) : this.columnString.push("A")) : this.columnString.push("A");
  }
  setRowCount(e) {
    this.rowCount = e;
  }
  setColumnCount(e) {
    this.columnCount = e;
  }
}
class $p {
  constructor(e) {
    return this._sheet = e, new Proxy(this, {
      get: function(t, i, n) {
        return typeof t[i] < "u" ? t[i] : t._sheet.table.componentFunctionBinder.handle("sheet", t._sheet, i);
      }
    });
  }
  getTitle() {
    return this._sheet.title;
  }
  getKey() {
    return this._sheet.key;
  }
  getDefinition() {
    return this._sheet.getDefinition();
  }
  getData() {
    return this._sheet.getData();
  }
  setData(e) {
    return this._sheet.setData(e);
  }
  clear() {
    return this._sheet.clear();
  }
  remove() {
    return this._sheet.remove();
  }
  active() {
    return this._sheet.active();
  }
  setTitle(e) {
    return this._sheet.setTitle(e);
  }
  setRows(e) {
    return this._sheet.setRows(e);
  }
  setColumns(e) {
    return this._sheet.setColumns(e);
  }
}
class ad extends ke {
  constructor(e, t) {
    super(e.table), this.spreadsheetManager = e, this.definition = t, this.title = this.definition.title || "", this.key = this.definition.key || this.definition.title, this.rowCount = this.definition.rows, this.columnCount = this.definition.columns, this.data = this.definition.data || [], this.element = null, this.isActive = !1, this.grid = new mw(this.columnCount, this.rowCount), this.defaultColumnDefinition = { width: 100, headerHozAlign: "center", headerSort: !1 }, this.columnDefinition = Object.assign(this.defaultColumnDefinition, this.options("spreadsheetColumnDefinition")), this.columnDefs = [], this.rowDefs = [], this.columnFields = [], this.columns = [], this.rows = [], this.scrollTop = null, this.scrollLeft = null, this.initialize(), this.dispatchExternal("sheetAdded", this.getComponent());
  }
  ///////////////////////////////////
  ///////// Initialization //////////
  ///////////////////////////////////
  initialize() {
    this.initializeElement(), this.initializeColumns(), this.initializeRows();
  }
  reinitialize() {
    this.initializeColumns(), this.initializeRows();
  }
  initializeElement() {
    this.element = document.createElement("div"), this.element.classList.add("tabulator-spreadsheet-tab"), this.element.innerText = this.title, this.element.addEventListener("click", () => {
      this.spreadsheetManager.loadSheet(this);
    });
  }
  initializeColumns() {
    this.grid.setColumnCount(this.columnCount), this.columnFields = this.grid.genColumns(this.data), this.columnDefs = [], this.columnFields.forEach((e) => {
      var t = Object.assign({}, this.columnDefinition);
      t.field = e, t.title = e, this.columnDefs.push(t);
    });
  }
  initializeRows() {
    var e;
    this.grid.setRowCount(this.rowCount), e = this.grid.genRows(this.data), this.rowDefs = [], e.forEach((t, i) => {
      var n = { _id: t }, s = this.data[i];
      s && s.forEach((a, o) => {
        var l = this.columnFields[o];
        l && (n[l] = a);
      }), this.rowDefs.push(n);
    });
  }
  unload() {
    this.isActive = !1, this.scrollTop = this.table.rowManager.scrollTop, this.scrollLeft = this.table.rowManager.scrollLeft, this.data = this.getData(!0), this.element.classList.remove("tabulator-spreadsheet-tab-active");
  }
  load() {
    var e = !this.isActive;
    this.isActive = !0, this.table.blockRedraw(), this.table.setData([]), this.table.setColumns(this.columnDefs), this.table.setData(this.rowDefs), this.table.restoreRedraw(), e && this.scrollTop !== null && (this.table.rowManager.element.scrollLeft = this.scrollLeft, this.table.rowManager.element.scrollTop = this.scrollTop), this.element.classList.add("tabulator-spreadsheet-tab-active"), this.dispatchExternal("sheetLoaded", this.getComponent());
  }
  ///////////////////////////////////
  //////// Helper Functions /////////
  ///////////////////////////////////
  getComponent() {
    return new $p(this);
  }
  getDefinition() {
    return {
      title: this.title,
      key: this.key,
      rows: this.rowCount,
      columns: this.columnCount,
      data: this.getData()
    };
  }
  getData(e) {
    var t = [], i, n, s;
    return this.rowDefs.forEach((a) => {
      var o = [];
      this.columnFields.forEach((l) => {
        o.push(a[l]);
      }), t.push(o);
    }), !e && !this.options("spreadsheetOutputFull") && (i = t.map((a) => a.findLastIndex((o) => typeof o < "u") + 1), n = Math.max(...i), s = i.findLastIndex((a) => a > 0) + 1, t = t.slice(0, s), t = t.map((a) => a.slice(0, n))), t;
  }
  setData(e) {
    this.data = e, this.reinitialize(), this.dispatchExternal("sheetUpdated", this.getComponent()), this.isActive && this.load();
  }
  clear() {
    this.setData([]);
  }
  setTitle(e) {
    this.title = e, this.element.innerText = e, this.dispatchExternal("sheetUpdated", this.getComponent());
  }
  setRows(e) {
    this.rowCount = e, this.initializeRows(), this.dispatchExternal("sheetUpdated", this.getComponent()), this.isActive && this.load();
  }
  setColumns(e) {
    this.columnCount = e, this.reinitialize(), this.dispatchExternal("sheetUpdated", this.getComponent()), this.isActive && this.load();
  }
  remove() {
    this.spreadsheetManager.removeSheet(this);
  }
  destroy() {
    this.element.parentNode && this.element.parentNode.removeChild(this.element), this.dispatchExternal("sheetRemoved", this.getComponent());
  }
  active() {
    this.spreadsheetManager.loadSheet(this);
  }
}
class qp extends U {
  constructor(e) {
    super(e), this.sheets = [], this.element = null, this.registerTableOption("spreadsheet", !1), this.registerTableOption("spreadsheetRows", 50), this.registerTableOption("spreadsheetColumns", 50), this.registerTableOption("spreadsheetColumnDefinition", {}), this.registerTableOption("spreadsheetOutputFull", !1), this.registerTableOption("spreadsheetData", !1), this.registerTableOption("spreadsheetSheets", !1), this.registerTableOption("spreadsheetSheetTabs", !1), this.registerTableOption("spreadsheetSheetTabsElement", !1), this.registerTableFunction("setSheets", this.setSheets.bind(this)), this.registerTableFunction("addSheet", this.addSheet.bind(this)), this.registerTableFunction("getSheets", this.getSheets.bind(this)), this.registerTableFunction("getSheetDefinitions", this.getSheetDefinitions.bind(this)), this.registerTableFunction("setSheetData", this.setSheetData.bind(this)), this.registerTableFunction("getSheet", this.getSheet.bind(this)), this.registerTableFunction("getSheetData", this.getSheetData.bind(this)), this.registerTableFunction("clearSheet", this.clearSheet.bind(this)), this.registerTableFunction("removeSheet", this.removeSheetFunc.bind(this)), this.registerTableFunction("activeSheet", this.activeSheetFunc.bind(this));
  }
  ///////////////////////////////////
  ////// Module Initialization //////
  ///////////////////////////////////
  initialize() {
    this.options("spreadsheet") && (this.subscribe("table-initialized", this.tableInitialized.bind(this)), this.subscribe("data-loaded", this.loadRemoteData.bind(this)), this.table.options.index = "_id", this.options("spreadsheetData") && this.options("spreadsheetSheets") && (console.warn("You cannot use spreadsheetData and spreadsheetSheets at the same time, ignoring spreadsheetData"), this.table.options.spreadsheetData = !1), this.compatibilityCheck(), this.options("spreadsheetSheetTabs") && this.initializeTabset());
  }
  compatibilityCheck() {
    this.options("data") && console.warn("Do not use the data option when working with spreadsheets, use either spreadsheetData or spreadsheetSheets to pass data into the table"), this.options("pagination") && console.warn("The spreadsheet module is not compatible with the pagination module"), this.options("groupBy") && console.warn("The spreadsheet module is not compatible with the row grouping module"), this.options("responsiveCollapse") && console.warn("The spreadsheet module is not compatible with the responsive collapse module");
  }
  initializeTabset() {
    this.element = document.createElement("div"), this.element.classList.add("tabulator-spreadsheet-tabs");
    var e = this.options("spreadsheetSheetTabsElement");
    e && !(e instanceof HTMLElement) && (e = document.querySelector(e), e || console.warn("Unable to find element matching spreadsheetSheetTabsElement selector:", this.options("spreadsheetSheetTabsElement"))), e ? e.appendChild(this.element) : this.footerAppend(this.element);
  }
  tableInitialized() {
    this.sheets.length ? this.loadSheet(this.sheets[0]) : this.options("spreadsheetSheets") ? this.loadSheets(this.options("spreadsheetSheets")) : this.options("spreadsheetData") && this.loadData(this.options("spreadsheetData"));
  }
  ///////////////////////////////////
  /////////// Ajax Parsing //////////
  ///////////////////////////////////
  loadRemoteData(e, t, i) {
    return console.log("data", e, t, i), Array.isArray(e) ? (this.table.dataLoader.clearAlert(), this.dispatchExternal("dataLoaded", e), !e.length || Array.isArray(e[0]) ? this.loadData(e) : this.loadSheets(e)) : console.error(`Spreadsheet Loading Error - Unable to process remote data due to invalid data type 
Expecting: array 
Received: `, typeof e, `
Data:     `, e), !1;
  }
  ///////////////////////////////////
  ///////// Sheet Management ////////
  ///////////////////////////////////
  loadData(e) {
    var t = {
      data: e
    };
    this.loadSheet(this.newSheet(t));
  }
  destroySheets() {
    this.sheets.forEach((e) => {
      e.destroy();
    }), this.sheets = [], this.activeSheet = null;
  }
  loadSheets(e) {
    Array.isArray(e) || (e = []), this.destroySheets(), e.forEach((t) => {
      this.newSheet(t);
    }), this.loadSheet(this.sheets[0]);
  }
  loadSheet(e) {
    this.activeSheet !== e && (this.activeSheet && this.activeSheet.unload(), this.activeSheet = e, e.load());
  }
  newSheet(e = {}) {
    var t;
    return e.rows || (e.rows = this.options("spreadsheetRows")), e.columns || (e.columns = this.options("spreadsheetColumns")), t = new ad(this, e), this.sheets.push(t), this.element && this.element.appendChild(t.element), t;
  }
  removeSheet(e) {
    var t = this.sheets.indexOf(e), i;
    this.sheets.length > 1 ? t > -1 && (this.sheets.splice(t, 1), e.destroy(), this.activeSheet === e && (i = this.sheets[t - 1] || this.sheets[0], i ? this.loadSheet(i) : this.activeSheet = null)) : console.warn("Unable to remove sheet, at least one sheet must be active");
  }
  lookupSheet(e) {
    return e ? e instanceof ad ? e : e instanceof $p ? e._sheet : this.sheets.find((t) => t.key === e) || !1 : this.activeSheet;
  }
  ///////////////////////////////////
  //////// Public Functions /////////
  ///////////////////////////////////
  setSheets(e) {
    return this.loadSheets(e), this.getSheets();
  }
  addSheet(e) {
    return this.newSheet(e).getComponent();
  }
  getSheetDefinitions() {
    return this.sheets.map((e) => e.getDefinition());
  }
  getSheets() {
    return this.sheets.map((e) => e.getComponent());
  }
  getSheet(e) {
    var t = this.lookupSheet(e);
    return t ? t.getComponent() : !1;
  }
  setSheetData(e, t) {
    e && !t && (t = e, e = !1);
    var i = this.lookupSheet(e);
    return i ? i.setData(t) : !1;
  }
  getSheetData(e) {
    var t = this.lookupSheet(e);
    return t ? t.getData() : !1;
  }
  clearSheet(e) {
    var t = this.lookupSheet(e);
    return t ? t.clear() : !1;
  }
  removeSheetFunc(e) {
    var t = this.lookupSheet(e);
    t && this.removeSheet(t);
  }
  activeSheetFunc(e) {
    var t = this.lookupSheet(e);
    return t ? this.loadSheet(t) : !1;
  }
}
A(qp, "moduleName", "spreadsheet");
class Kp extends U {
  constructor(e) {
    super(e), this.tooltipSubscriber = null, this.headerSubscriber = null, this.timeout = null, this.popupInstance = null, this.registerTableOption("tooltipDelay", 300), this.registerColumnOption("tooltip"), this.registerColumnOption("headerTooltip");
  }
  initialize() {
    this.deprecatedOptionsCheck(), this.subscribe("column-init", this.initializeColumn.bind(this));
  }
  deprecatedOptionsCheck() {
  }
  initializeColumn(e) {
    e.definition.headerTooltip && !this.headerSubscriber && (this.headerSubscriber = !0, this.subscribe("column-mousemove", this.mousemoveCheck.bind(this, "headerTooltip")), this.subscribe("column-mouseout", this.mouseoutCheck.bind(this, "headerTooltip"))), e.definition.tooltip && !this.tooltipSubscriber && (this.tooltipSubscriber = !0, this.subscribe("cell-mousemove", this.mousemoveCheck.bind(this, "tooltip")), this.subscribe("cell-mouseout", this.mouseoutCheck.bind(this, "tooltip")));
  }
  mousemoveCheck(e, t, i) {
    var n = e === "tooltip" ? i.column.definition.tooltip : i.definition.headerTooltip;
    n && (this.clearPopup(), this.timeout = setTimeout(this.loadTooltip.bind(this, t, i, n), this.table.options.tooltipDelay));
  }
  mouseoutCheck(e, t, i) {
    this.popupInstance || this.clearPopup();
  }
  clearPopup(e, t, i) {
    clearTimeout(this.timeout), this.timeout = null, this.popupInstance && this.popupInstance.hide();
  }
  loadTooltip(e, t, i) {
    var n, s, a;
    function o(l) {
      s = l;
    }
    typeof i == "function" && (i = i(e, t.getComponent(), o)), i instanceof HTMLElement ? n = i : (n = document.createElement("div"), i === !0 && (t instanceof gs ? i = t.value : t.definition.field ? this.langBind("columns|" + t.definition.field, (l) => {
      n.innerHTML = i = l || t.definition.title;
    }) : i = t.definition.title), n.innerHTML = i), (i || i === 0 || i === !1) && (n.classList.add("tabulator-tooltip"), n.addEventListener("mousemove", (l) => l.preventDefault()), this.popupInstance = this.popup(n), typeof s == "function" && this.popupInstance.renderCallback(s), a = this.popupInstance.containerEventCoords(e), this.popupInstance.show(a.x + 15, a.y + 15).hideOnBlur(() => {
      this.dispatchExternal("TooltipClosed", t.getComponent()), this.popupInstance = null;
    }), this.dispatchExternal("TooltipOpened", t.getComponent()));
  }
}
A(Kp, "moduleName", "tooltip");
var bw = {
  //is integer
  integer: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : (e = Number(e), !isNaN(e) && isFinite(e) && Math.floor(e) === e);
  },
  //is float
  float: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : (e = Number(e), !isNaN(e) && isFinite(e) && e % 1 !== 0);
  },
  //must be a number
  numeric: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : !isNaN(e);
  },
  //must be a string
  string: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : isNaN(e);
  },
  //must be alphanumeric
  alphanumeric: function(r, e, t) {
    if (e === "" || e === null || typeof e > "u")
      return !0;
    var i = new RegExp(/^[a-z0-9]+$/i);
    return i.test(e);
  },
  //maximum value
  max: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : parseFloat(e) <= t;
  },
  //minimum value
  min: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : parseFloat(e) >= t;
  },
  //starts with  value
  starts: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : String(e).toLowerCase().startsWith(String(t).toLowerCase());
  },
  //ends with  value
  ends: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : String(e).toLowerCase().endsWith(String(t).toLowerCase());
  },
  //minimum string length
  minLength: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : String(e).length >= t;
  },
  //maximum string length
  maxLength: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : String(e).length <= t;
  },
  //in provided value list
  in: function(r, e, t) {
    return e === "" || e === null || typeof e > "u" ? !0 : (typeof t == "string" && (t = t.split("|")), t.indexOf(e) > -1);
  },
  //must match provided regex
  regex: function(r, e, t) {
    if (e === "" || e === null || typeof e > "u")
      return !0;
    var i = new RegExp(t);
    return i.test(e);
  },
  //value must be unique in this column
  unique: function(r, e, t) {
    if (e === "" || e === null || typeof e > "u")
      return !0;
    var i = !0, n = r.getData(), s = r.getColumn()._getSelf();
    return this.table.rowManager.rows.forEach(function(a) {
      var o = a.getData();
      o !== n && e == s.getFieldValue(o) && (i = !1);
    }), i;
  },
  //must have a value
  required: function(r, e, t) {
    return e !== "" && e !== null && typeof e < "u";
  }
};
const is = class is extends U {
  constructor(e) {
    super(e), this.invalidCells = [], this.registerTableOption("validationMode", "blocking"), this.registerColumnOption("validator"), this.registerTableFunction("getInvalidCells", this.getInvalidCells.bind(this)), this.registerTableFunction("clearCellValidation", this.userClearCellValidation.bind(this)), this.registerTableFunction("validate", this.userValidate.bind(this)), this.registerComponentFunction("cell", "isValid", this.cellIsValid.bind(this)), this.registerComponentFunction("cell", "clearValidation", this.clearValidation.bind(this)), this.registerComponentFunction("cell", "validate", this.cellValidate.bind(this)), this.registerComponentFunction("column", "validate", this.columnValidate.bind(this)), this.registerComponentFunction("row", "validate", this.rowValidate.bind(this));
  }
  initialize() {
    this.subscribe("cell-delete", this.clearValidation.bind(this)), this.subscribe("column-layout", this.initializeColumnCheck.bind(this)), this.subscribe("edit-success", this.editValidate.bind(this)), this.subscribe("edit-editor-clear", this.editorClear.bind(this)), this.subscribe("edit-edited-clear", this.editedClear.bind(this));
  }
  ///////////////////////////////////
  ///////// Event Handling //////////
  ///////////////////////////////////
  editValidate(e, t, i) {
    var n = this.table.options.validationMode !== "manual" ? this.validate(e.column.modules.validate, e, t) : !0;
    return n !== !0 && setTimeout(() => {
      e.getElement().classList.add("tabulator-validation-fail"), this.dispatchExternal("validationFailed", e.getComponent(), t, n);
    }), n;
  }
  editorClear(e, t) {
    t && e.column.modules.validate && this.cellValidate(e), e.getElement().classList.remove("tabulator-validation-fail");
  }
  editedClear(e) {
    e.modules.validate && (e.modules.validate.invalid = !1);
  }
  ///////////////////////////////////
  ////////// Cell Functions /////////
  ///////////////////////////////////
  cellIsValid(e) {
    return e.modules.validate && e.modules.validate.invalid || !0;
  }
  cellValidate(e) {
    return this.validate(e.column.modules.validate, e, e.getValue());
  }
  ///////////////////////////////////
  ///////// Column Functions ////////
  ///////////////////////////////////
  columnValidate(e) {
    var t = [];
    return e.cells.forEach((i) => {
      this.cellValidate(i) !== !0 && t.push(i.getComponent());
    }), t.length ? t : !0;
  }
  ///////////////////////////////////
  ////////// Row Functions //////////
  ///////////////////////////////////
  rowValidate(e) {
    var t = [];
    return e.cells.forEach((i) => {
      this.cellValidate(i) !== !0 && t.push(i.getComponent());
    }), t.length ? t : !0;
  }
  ///////////////////////////////////
  ///////// Table Functions /////////
  ///////////////////////////////////
  userClearCellValidation(e) {
    e || (e = this.getInvalidCells()), Array.isArray(e) || (e = [e]), e.forEach((t) => {
      this.clearValidation(t._getSelf());
    });
  }
  userValidate(e) {
    var t = [];
    return this.table.rowManager.rows.forEach((i) => {
      i = i.getComponent();
      var n = i.validate();
      n !== !0 && (t = t.concat(n));
    }), t.length ? t : !0;
  }
  ///////////////////////////////////
  ///////// Internal Logic //////////
  ///////////////////////////////////
  initializeColumnCheck(e) {
    typeof e.definition.validator < "u" && this.initializeColumn(e);
  }
  //validate
  initializeColumn(e) {
    var t = this, i = [], n;
    e.definition.validator && (Array.isArray(e.definition.validator) ? e.definition.validator.forEach((s) => {
      n = t._extractValidator(s), n && i.push(n);
    }) : (n = this._extractValidator(e.definition.validator), n && i.push(n)), e.modules.validate = i.length ? i : !1);
  }
  _extractValidator(e) {
    var t, i, n;
    switch (typeof e) {
      case "string":
        return n = e.indexOf(":"), n > -1 ? (t = e.substring(0, n), i = e.substring(n + 1)) : t = e, this._buildValidator(t, i);
      case "function":
        return this._buildValidator(e);
      case "object":
        return this._buildValidator(e.type, e.parameters);
    }
  }
  _buildValidator(e, t) {
    var i = typeof e == "function" ? e : is.validators[e];
    return i ? {
      type: typeof e == "function" ? "function" : e,
      func: i,
      params: t
    } : (console.warn("Validator Setup Error - No matching validator found:", e), !1);
  }
  validate(e, t, i) {
    var n = this, s = [], a = this.invalidCells.indexOf(t);
    return e && e.forEach((o) => {
      o.func.call(n, t.getComponent(), i, o.params) || s.push({
        type: o.type,
        parameters: o.params
      });
    }), t.modules.validate || (t.modules.validate = {}), s.length ? (t.modules.validate.invalid = s, this.table.options.validationMode !== "manual" && t.getElement().classList.add("tabulator-validation-fail"), a == -1 && this.invalidCells.push(t)) : (t.modules.validate.invalid = !1, t.getElement().classList.remove("tabulator-validation-fail"), a > -1 && this.invalidCells.splice(a, 1)), s.length ? s : !0;
  }
  getInvalidCells() {
    var e = [];
    return this.invalidCells.forEach((t) => {
      e.push(t.getComponent());
    }), e;
  }
  clearValidation(e) {
    var t;
    e.modules.validate && e.modules.validate.invalid && (e.getElement().classList.remove("tabulator-validation-fail"), e.modules.validate.invalid = !1, t = this.invalidCells.indexOf(e), t > -1 && this.invalidCells.splice(t, 1));
  }
};
A(is, "moduleName", "validate"), //load defaults
A(is, "validators", bw);
let rh = is;
var yo = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  AccessorModule: zl,
  AjaxModule: Nl,
  ClipboardModule: Bl,
  ColumnCalcsModule: Vl,
  DataTreeModule: Pp,
  DownloadModule: Wl,
  EditModule: Gl,
  ExportModule: Ul,
  FilterModule: jl,
  FormatModule: Yl,
  FrozenColumnsModule: Op,
  FrozenRowsModule: Ip,
  GroupRowsModule: Fp,
  HistoryModule: Xl,
  HtmlTableImportModule: Hp,
  ImportModule: $l,
  InteractionModule: Np,
  KeybindingsModule: ql,
  MenuModule: Bp,
  MoveColumnsModule: Vp,
  MoveRowsModule: Kl,
  MutatorModule: Zl,
  PageModule: Jl,
  PersistenceModule: Ql,
  PopupModule: Wp,
  PrintModule: Gp,
  ReactiveDataModule: Up,
  ResizeColumnsModule: jp,
  ResizeRowsModule: Yp,
  ResizeTableModule: Xp,
  ResponsiveLayoutModule: eh,
  SelectRangeModule: ea,
  SelectRowModule: th,
  SortModule: ih,
  SpreadsheetModule: qp,
  TooltipModule: Kp,
  ValidateModule: rh
}), yw = {
  debugEventsExternal: !1,
  //flag to console log events
  debugEventsInternal: !1,
  //flag to console log events
  debugInvalidOptions: !0,
  //allow toggling of invalid option warnings
  debugInvalidComponentFuncs: !0,
  //allow toggling of invalid component warnings
  debugInitialization: !0,
  //allow toggling of pre initialization function call warnings
  debugDeprecation: !0,
  //allow toggling of deprecation warnings
  height: !1,
  //height of tabulator
  minHeight: !1,
  //minimum height of tabulator
  maxHeight: !1,
  //maximum height of tabulator
  columnHeaderVertAlign: "top",
  //vertical alignment of column headers
  popupContainer: !1,
  columns: [],
  //store for colum header info
  columnDefaults: {},
  //store column default props
  rowHeader: !1,
  data: !1,
  //default starting data
  autoColumns: !1,
  //build columns from data row structure
  autoColumnsDefinitions: !1,
  nestedFieldSeparator: ".",
  //separator for nested data
  footerElement: !1,
  //hold footer element
  index: "id",
  //filed for row index
  textDirection: "auto",
  addRowPos: "bottom",
  //position to insert blank rows, top|bottom
  headerVisible: !0,
  //hide header
  renderVertical: "virtual",
  renderHorizontal: "basic",
  renderVerticalBuffer: 0,
  // set virtual DOM buffer size
  scrollToRowPosition: "top",
  scrollToRowIfVisible: !0,
  scrollToColumnPosition: "left",
  scrollToColumnIfVisible: !0,
  rowFormatter: !1,
  rowFormatterPrint: null,
  rowFormatterClipboard: null,
  rowFormatterHtmlOutput: null,
  rowHeight: null,
  placeholder: !1,
  dataLoader: !0,
  dataLoaderLoading: !1,
  dataLoaderError: !1,
  dataLoaderErrorTimeout: 3e3,
  dataSendParams: {},
  dataReceiveParams: {},
  dependencies: {}
};
class Zp {
  constructor(e, t, i = {}) {
    this.table = e, this.msgType = t, this.registeredDefaults = Object.assign({}, i);
  }
  register(e, t) {
    this.registeredDefaults[e] = t;
  }
  generate(e, t = {}) {
    var i = Object.assign({}, this.registeredDefaults), n = this.table.options.debugInvalidOptions || t.debugInvalidOptions === !0;
    Object.assign(i, e);
    for (let s in t)
      i.hasOwnProperty(s) || (n && console.warn("Invalid " + this.msgType + " option:", s), i[s] = t.key);
    for (let s in i)
      s in t ? i[s] = t[s] : Array.isArray(i[s]) ? i[s] = Object.assign([], i[s]) : typeof i[s] == "object" && i[s] !== null ? i[s] = Object.assign({}, i[s]) : typeof i[s] > "u" && delete i[s];
    return i;
  }
}
class $a extends ke {
  constructor(e) {
    super(e), this.elementVertical = e.rowManager.element, this.elementHorizontal = e.columnManager.element, this.tableElement = e.rowManager.tableElement, this.verticalFillMode = "fit";
  }
  ///////////////////////////////////
  /////// Internal Bindings /////////
  ///////////////////////////////////
  initialize() {
  }
  clearRows() {
  }
  clearColumns() {
  }
  reinitializeColumnWidths(e) {
  }
  renderRows() {
  }
  renderColumns() {
  }
  rerenderRows(e) {
    e && e();
  }
  rerenderColumns(e, t) {
  }
  renderRowCells(e) {
  }
  rerenderRowCells(e, t) {
  }
  scrollColumns(e, t) {
  }
  scrollRows(e, t) {
  }
  resize() {
  }
  scrollToRow(e) {
  }
  scrollToRowNearestTop(e) {
  }
  visibleRows(e) {
    return [];
  }
  ///////////////////////////////////
  //////// Helper Functions /////////
  ///////////////////////////////////
  rows() {
    return this.table.rowManager.getDisplayRows();
  }
  styleRow(e, t) {
    var i = e.getElement();
    t % 2 ? (i.classList.add("tabulator-row-even"), i.classList.remove("tabulator-row-odd")) : (i.classList.add("tabulator-row-odd"), i.classList.remove("tabulator-row-even"));
  }
  ///////////////////////////////////
  /////// External Triggers /////////
  /////// (DO NOT OVERRIDE) /////////
  ///////////////////////////////////
  clear() {
    this.clearRows(), this.clearColumns();
  }
  render() {
    this.renderRows(), this.renderColumns();
  }
  rerender(e) {
    this.rerenderRows(), this.rerenderColumns();
  }
  scrollToRowPosition(e, t, i) {
    var n = this.rows().indexOf(e), s = e.getElement(), a = 0;
    return new Promise((o, l) => {
      if (n > -1) {
        if (typeof i > "u" && (i = this.table.options.scrollToRowIfVisible), !i && de.elVisible(s) && (a = de.elOffset(s).top - de.elOffset(this.elementVertical).top, a > 0 && a < this.elementVertical.clientHeight - s.offsetHeight))
          return o(), !1;
        switch (typeof t > "u" && (t = this.table.options.scrollToRowPosition), t === "nearest" && (t = this.scrollToRowNearestTop(e) ? "top" : "bottom"), this.scrollToRow(e), t) {
          case "middle":
          case "center":
            this.elementVertical.scrollHeight - this.elementVertical.scrollTop == this.elementVertical.clientHeight ? this.elementVertical.scrollTop = this.elementVertical.scrollTop + (s.offsetTop - this.elementVertical.scrollTop) - (this.elementVertical.scrollHeight - s.offsetTop) / 2 : this.elementVertical.scrollTop = this.elementVertical.scrollTop - this.elementVertical.clientHeight / 2;
            break;
          case "bottom":
            this.elementVertical.scrollHeight - this.elementVertical.scrollTop == this.elementVertical.clientHeight ? this.elementVertical.scrollTop = this.elementVertical.scrollTop - (this.elementVertical.scrollHeight - s.offsetTop) + s.offsetHeight : this.elementVertical.scrollTop = this.elementVertical.scrollTop - this.elementVertical.clientHeight + s.offsetHeight;
            break;
          case "top":
            this.elementVertical.scrollTop = s.offsetTop;
            break;
        }
        o();
      } else
        console.warn("Scroll Error - Row not visible"), l("Scroll Error - Row not visible");
    });
  }
}
class ww extends $a {
  constructor(e) {
    super(e);
  }
  renderRowCells(e, t) {
    const i = document.createDocumentFragment();
    e.cells.forEach((n) => {
      i.appendChild(n.getElement());
    }), e.element.appendChild(i), t || e.cells.forEach((n) => {
      n.cellRendered();
    });
  }
  reinitializeColumnWidths(e) {
    e.forEach(function(t) {
      t.reinitializeWidth();
    });
  }
}
class Cw extends $a {
  constructor(e) {
    super(e), this.leftCol = 0, this.rightCol = 0, this.scrollLeft = 0, this.vDomScrollPosLeft = 0, this.vDomScrollPosRight = 0, this.vDomPadLeft = 0, this.vDomPadRight = 0, this.fitDataColAvg = 0, this.windowBuffer = 200, this.visibleRows = null, this.initialized = !1, this.isFitData = !1, this.columns = [];
  }
  initialize() {
    this.compatibilityCheck(), this.layoutCheck(), this.vertScrollListen();
  }
  compatibilityCheck() {
    this.options("layout") == "fitDataTable" && console.warn("Horizontal Virtual DOM is not compatible with fitDataTable layout mode"), this.options("responsiveLayout") && console.warn("Horizontal Virtual DOM is not compatible with responsive columns"), this.options("rtl") && console.warn("Horizontal Virtual DOM is not currently compatible with RTL text direction");
  }
  layoutCheck() {
    this.isFitData = this.options("layout").startsWith("fitData");
  }
  vertScrollListen() {
    this.subscribe("scroll-vertical", this.clearVisRowCache.bind(this)), this.subscribe("data-refreshed", this.clearVisRowCache.bind(this));
  }
  clearVisRowCache() {
    this.visibleRows = null;
  }
  //////////////////////////////////////
  ///////// Public Functions ///////////
  //////////////////////////////////////
  renderColumns(e, t) {
    this.dataChange();
  }
  scrollColumns(e, t) {
    this.scrollLeft != e && (this.scrollLeft = e, this.scroll(e - (this.vDomScrollPosLeft + this.windowBuffer)));
  }
  calcWindowBuffer() {
    var e = this.elementVertical.clientWidth;
    this.table.columnManager.columnsByIndex.forEach((t) => {
      if (t.visible) {
        var i = t.getWidth();
        i > e && (e = i);
      }
    }), this.windowBuffer = e * 2;
  }
  rerenderColumns(e, t) {
    var i = {
      cols: this.columns,
      leftCol: this.leftCol,
      rightCol: this.rightCol
    }, n = 0;
    e && !this.initialized || (this.clear(), this.calcWindowBuffer(), this.scrollLeft = this.elementVertical.scrollLeft, this.vDomScrollPosLeft = this.scrollLeft - this.windowBuffer, this.vDomScrollPosRight = this.scrollLeft + this.elementVertical.clientWidth + this.windowBuffer, this.table.columnManager.columnsByIndex.forEach((s) => {
      var a = {}, o;
      s.visible && (s.modules.frozen || (o = s.getWidth(), a.leftPos = n, a.rightPos = n + o, a.width = o, this.isFitData && (a.fitDataCheck = s.modules.vdomHoz ? s.modules.vdomHoz.fitDataCheck : !0), n + o > this.vDomScrollPosLeft && n < this.vDomScrollPosRight ? (this.leftCol == -1 && (this.leftCol = this.columns.length, this.vDomPadLeft = n), this.rightCol = this.columns.length) : this.leftCol !== -1 && (this.vDomPadRight += o), this.columns.push(s), s.modules.vdomHoz = a, n += o));
    }), this.tableElement.style.paddingLeft = this.vDomPadLeft + "px", this.tableElement.style.paddingRight = this.vDomPadRight + "px", this.initialized = !0, t || (!e || this.reinitChanged(i)) && this.reinitializeRows(), this.elementVertical.scrollLeft = this.scrollLeft);
  }
  renderRowCells(e) {
    if (this.initialized)
      this.initializeRow(e);
    else {
      const t = document.createDocumentFragment();
      e.cells.forEach((i) => {
        t.appendChild(i.getElement());
      }), e.element.appendChild(t), e.cells.forEach((i) => {
        i.cellRendered();
      });
    }
  }
  rerenderRowCells(e, t) {
    this.reinitializeRow(e, t);
  }
  reinitializeColumnWidths(e) {
    for (let t = this.leftCol; t <= this.rightCol; t++) {
      let i = this.columns[t];
      i && i.reinitializeWidth();
    }
  }
  //////////////////////////////////////
  //////// Internal Rendering //////////
  //////////////////////////////////////
  deinitialize() {
    this.initialized = !1;
  }
  clear() {
    this.columns = [], this.leftCol = -1, this.rightCol = 0, this.vDomScrollPosLeft = 0, this.vDomScrollPosRight = 0, this.vDomPadLeft = 0, this.vDomPadRight = 0;
  }
  dataChange() {
    var e = !1, t, i;
    if (this.isFitData) {
      if (this.table.columnManager.columnsByIndex.forEach((n) => {
        !n.definition.width && n.visible && (e = !0);
      }), e && this.table.rowManager.getDisplayRows().length && (this.vDomScrollPosRight = this.scrollLeft + this.elementVertical.clientWidth + this.windowBuffer, t = this.chain("rows-sample", [1], [], () => this.table.rowManager.getDisplayRows())[0], t)) {
        i = t.getElement(), t.generateCells(), this.tableElement.appendChild(i);
        for (let n = 0; n < t.cells.length; n++) {
          let s = t.cells[n];
          i.appendChild(s.getElement()), s.column.reinitializeWidth();
        }
        i.parentNode.removeChild(i), this.rerenderColumns(!1, !0);
      }
    } else
      this.options("layout") === "fitColumns" && (this.layoutRefresh(), this.rerenderColumns(!1, !0));
  }
  reinitChanged(e) {
    var t = !0;
    return e.cols.length !== this.columns.length || e.leftCol !== this.leftCol || e.rightCol !== this.rightCol ? !0 : (e.cols.forEach((i, n) => {
      i !== this.columns[n] && (t = !1);
    }), !t);
  }
  reinitializeRows() {
    var e = this.getVisibleRows(), t = this.table.rowManager.getRows().filter((i) => !e.includes(i));
    e.forEach((i) => {
      this.reinitializeRow(i, !0);
    }), t.forEach((i) => {
      i.deinitialize();
    });
  }
  getVisibleRows() {
    return this.visibleRows || (this.visibleRows = this.table.rowManager.getVisibleRows()), this.visibleRows;
  }
  scroll(e) {
    this.vDomScrollPosLeft += e, this.vDomScrollPosRight += e, Math.abs(e) > this.windowBuffer / 2 ? this.rerenderColumns() : e > 0 ? (this.addColRight(), this.removeColLeft()) : (this.addColLeft(), this.removeColRight());
  }
  colPositionAdjust(e, t, i) {
    for (let n = e; n < t; n++) {
      let s = this.columns[n];
      s.modules.vdomHoz.leftPos += i, s.modules.vdomHoz.rightPos += i;
    }
  }
  addColRight() {
    for (var e = !1, t = !0; t; ) {
      let i = this.columns[this.rightCol + 1];
      i && i.modules.vdomHoz.leftPos <= this.vDomScrollPosRight ? (e = !0, this.getVisibleRows().forEach((n) => {
        if (n.type !== "group") {
          var s = n.getCell(i);
          n.getElement().insertBefore(s.getElement(), n.getCell(this.columns[this.rightCol]).getElement().nextSibling), s.cellRendered();
        }
      }), this.fitDataColActualWidthCheck(i), this.rightCol++, this.getVisibleRows().forEach((n) => {
        n.type !== "group" && (n.modules.vdomHoz.rightCol = this.rightCol);
      }), this.rightCol >= this.columns.length - 1 ? this.vDomPadRight = 0 : this.vDomPadRight -= i.getWidth()) : t = !1;
    }
    e && (this.tableElement.style.paddingRight = this.vDomPadRight + "px");
  }
  addColLeft() {
    for (var e = !1, t = !0; t; ) {
      let i = this.columns[this.leftCol - 1];
      if (i)
        if (i.modules.vdomHoz.rightPos >= this.vDomScrollPosLeft) {
          e = !0, this.getVisibleRows().forEach((s) => {
            if (s.type !== "group") {
              var a = s.getCell(i);
              s.getElement().insertBefore(a.getElement(), s.getCell(this.columns[this.leftCol]).getElement()), a.cellRendered();
            }
          }), this.leftCol--, this.getVisibleRows().forEach((s) => {
            s.type !== "group" && (s.modules.vdomHoz.leftCol = this.leftCol);
          }), this.leftCol <= 0 ? this.vDomPadLeft = 0 : this.vDomPadLeft -= i.getWidth();
          let n = this.fitDataColActualWidthCheck(i);
          n && (this.scrollLeft = this.elementVertical.scrollLeft = this.elementVertical.scrollLeft + n, this.vDomPadRight -= n);
        } else
          t = !1;
      else
        t = !1;
    }
    e && (this.tableElement.style.paddingLeft = this.vDomPadLeft + "px");
  }
  removeColRight() {
    for (var e = !1, t = !0; t; ) {
      let i = this.columns[this.rightCol];
      i && i.modules.vdomHoz.leftPos > this.vDomScrollPosRight ? (e = !0, this.getVisibleRows().forEach((n) => {
        if (n.type !== "group") {
          var s = n.getCell(i);
          try {
            n.getElement().removeChild(s.getElement());
          } catch (a) {
            console.warn("Could not removeColRight", a.message);
          }
        }
      }), this.vDomPadRight += i.getWidth(), this.rightCol--, this.getVisibleRows().forEach((n) => {
        n.type !== "group" && (n.modules.vdomHoz.rightCol = this.rightCol);
      })) : t = !1;
    }
    e && (this.tableElement.style.paddingRight = this.vDomPadRight + "px");
  }
  removeColLeft() {
    for (var e = !1, t = !0; t; ) {
      let i = this.columns[this.leftCol];
      i && i.modules.vdomHoz.rightPos < this.vDomScrollPosLeft ? (e = !0, this.getVisibleRows().forEach((n) => {
        if (n.type !== "group") {
          var s = n.getCell(i);
          try {
            n.getElement().removeChild(s.getElement());
          } catch (a) {
            console.warn("Could not removeColLeft", a.message);
          }
        }
      }), this.vDomPadLeft += i.getWidth(), this.leftCol++, this.getVisibleRows().forEach((n) => {
        n.type !== "group" && (n.modules.vdomHoz.leftCol = this.leftCol);
      })) : t = !1;
    }
    e && (this.tableElement.style.paddingLeft = this.vDomPadLeft + "px");
  }
  fitDataColActualWidthCheck(e) {
    var t, i;
    return e.modules.vdomHoz.fitDataCheck && (e.reinitializeWidth(), t = e.getWidth(), i = t - e.modules.vdomHoz.width, i && (e.modules.vdomHoz.rightPos += i, e.modules.vdomHoz.width = t, this.colPositionAdjust(this.columns.indexOf(e) + 1, this.columns.length, i)), e.modules.vdomHoz.fitDataCheck = !1), i;
  }
  initializeRow(e) {
    if (e.type !== "group") {
      e.modules.vdomHoz = {
        leftCol: this.leftCol,
        rightCol: this.rightCol
      }, this.table.modules.frozenColumns && this.table.modules.frozenColumns.leftColumns.forEach((t) => {
        this.appendCell(e, t);
      });
      for (let t = this.leftCol; t <= this.rightCol; t++)
        this.appendCell(e, this.columns[t]);
      this.table.modules.frozenColumns && this.table.modules.frozenColumns.rightColumns.forEach((t) => {
        this.appendCell(e, t);
      });
    }
  }
  appendCell(e, t) {
    if (t && t.visible) {
      let i = e.getCell(t);
      e.getElement().appendChild(i.getElement()), i.cellRendered();
    }
  }
  reinitializeRow(e, t) {
    if (e.type !== "group" && (t || !e.modules.vdomHoz || e.modules.vdomHoz.leftCol !== this.leftCol || e.modules.vdomHoz.rightCol !== this.rightCol)) {
      for (var i = e.getElement(); i.firstChild; ) i.removeChild(i.firstChild);
      this.initializeRow(e);
    }
  }
}
class _w extends ke {
  constructor(e) {
    super(e), this.blockHozScrollEvent = !1, this.headersElement = null, this.contentsElement = null, this.rowHeader = null, this.element = null, this.columns = [], this.columnsByIndex = [], this.columnsByField = {}, this.scrollLeft = 0, this.optionsList = new Zp(this.table, "column definition", Ap), this.redrawBlock = !1, this.redrawBlockUpdate = null, this.renderer = null;
  }
  ////////////// Setup Functions /////////////////
  initialize() {
    this.initializeRenderer(), this.headersElement = this.createHeadersElement(), this.contentsElement = this.createHeaderContentsElement(), this.element = this.createHeaderElement(), this.contentsElement.insertBefore(this.headersElement, this.contentsElement.firstChild), this.element.insertBefore(this.contentsElement, this.element.firstChild), this.initializeScrollWheelWatcher(), this.subscribe("scroll-horizontal", this.scrollHorizontal.bind(this)), this.subscribe("scrollbar-vertical", this.padVerticalScrollbar.bind(this));
  }
  padVerticalScrollbar(e) {
    this.table.rtl ? this.headersElement.style.marginLeft = e + "px" : this.headersElement.style.marginRight = e + "px";
  }
  initializeRenderer() {
    var e, t = {
      virtual: Cw,
      basic: ww
    };
    typeof this.table.options.renderHorizontal == "string" ? e = t[this.table.options.renderHorizontal] : e = this.table.options.renderHorizontal, e ? (this.renderer = new e(this.table, this.element, this.tableElement), this.renderer.initialize()) : console.error("Unable to find matching renderer:", this.table.options.renderHorizontal);
  }
  createHeadersElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-headers"), e.setAttribute("role", "row"), e;
  }
  createHeaderContentsElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-header-contents"), e.setAttribute("role", "rowgroup"), e;
  }
  createHeaderElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-header"), e.setAttribute("role", "rowgroup"), this.table.options.headerVisible || e.classList.add("tabulator-header-hidden"), e;
  }
  //return containing element
  getElement() {
    return this.element;
  }
  //return containing contents element
  getContentsElement() {
    return this.contentsElement;
  }
  //return header containing element
  getHeadersElement() {
    return this.headersElement;
  }
  //scroll horizontally to match table body
  scrollHorizontal(e) {
    this.contentsElement.scrollLeft = e, this.scrollLeft = e, this.renderer.scrollColumns(e);
  }
  initializeScrollWheelWatcher() {
    this.contentsElement.addEventListener("wheel", (e) => {
      var t;
      e.deltaX && (t = this.contentsElement.scrollLeft + e.deltaX, this.table.rowManager.scrollHorizontal(t), this.table.columnManager.scrollHorizontal(t));
    });
  }
  ///////////// Column Setup Functions /////////////
  generateColumnsFromRowData(e) {
    var t = [], i = {}, n = this.table.options.autoColumns === "full" ? e : [e[0]], s = this.table.options.autoColumnsDefinitions;
    if (e && e.length) {
      if (n.forEach((a) => {
        Object.keys(a).forEach((o, l) => {
          let h = a[o], u;
          i[o] ? i[o] !== !0 && typeof h < "u" && (i[o].sorter = this.calculateSorterFromValue(h), i[o] = !0) : (u = {
            field: o,
            title: o,
            sorter: this.calculateSorterFromValue(h)
          }, t.splice(l, 0, u), i[o] = typeof h > "u" ? u : !0);
        });
      }), s)
        switch (typeof s) {
          case "function":
            this.table.options.columns = s.call(this.table, t);
            break;
          case "object":
            Array.isArray(s) ? t.forEach((a) => {
              var o = s.find((l) => l.field === a.field);
              o && Object.assign(a, o);
            }) : t.forEach((a) => {
              s[a.field] && Object.assign(a, s[a.field]);
            }), this.table.options.columns = t;
            break;
        }
      else
        this.table.options.columns = t;
      this.setColumns(this.table.options.columns);
    }
  }
  calculateSorterFromValue(e) {
    var t;
    switch (typeof e) {
      case "undefined":
        t = "string";
        break;
      case "boolean":
        t = "boolean";
        break;
      case "number":
        t = "number";
        break;
      case "object":
        Array.isArray(e) ? t = "array" : t = "string";
        break;
      default:
        !isNaN(e) && e !== "" ? t = "number" : e.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i) ? t = "alphanum" : t = "string";
        break;
    }
    return t;
  }
  setColumns(e, t) {
    for (; this.headersElement.firstChild; ) this.headersElement.removeChild(this.headersElement.firstChild);
    this.columns = [], this.columnsByIndex = [], this.columnsByField = {}, this.dispatch("columns-loading"), this.dispatchExternal("columnsLoading"), this.table.options.rowHeader && (this.rowHeader = new rr(this.table.options.rowHeader === !0 ? {} : this.table.options.rowHeader, this, !0), this.columns.push(this.rowHeader), this.headersElement.appendChild(this.rowHeader.getElement()), this.rowHeader.columnRendered()), e.forEach((i, n) => {
      this._addColumn(i);
    }), this._reIndexColumns(), this.dispatch("columns-loaded"), this.subscribedExternal("columnsLoaded") && this.dispatchExternal("columnsLoaded", this.getComponents()), this.rerenderColumns(!1, !0), this.redraw(!0);
  }
  _addColumn(e, t, i) {
    var n = new rr(e, this), s = n.getElement(), a = i && this.findColumnIndex(i);
    if (t && this.rowHeader && (!i || i === this.rowHeader) && (t = !1, i = this.rowHeader, a = 0), i && a > -1) {
      var o = i.getTopColumn(), l = this.columns.indexOf(o), h = o.getElement();
      t ? (this.columns.splice(l, 0, n), h.parentNode.insertBefore(s, h)) : (this.columns.splice(l + 1, 0, n), h.parentNode.insertBefore(s, h.nextSibling));
    } else
      t ? (this.columns.unshift(n), this.headersElement.insertBefore(n.getElement(), this.headersElement.firstChild)) : (this.columns.push(n), this.headersElement.appendChild(n.getElement()));
    return n.columnRendered(), n;
  }
  registerColumnField(e) {
    e.definition.field && (this.columnsByField[e.definition.field] = e);
  }
  registerColumnPosition(e) {
    this.columnsByIndex.push(e);
  }
  _reIndexColumns() {
    this.columnsByIndex = [], this.columns.forEach(function(e) {
      e.reRegisterPosition();
    });
  }
  //ensure column headers take up the correct amount of space in column groups
  verticalAlignHeaders() {
    var e = 0;
    this.redrawBlock || (this.headersElement.style.height = "", this.columns.forEach((t) => {
      t.clearVerticalAlign();
    }), this.columns.forEach((t) => {
      var i = t.getHeight();
      i > e && (e = i);
    }), this.headersElement.style.height = e + "px", this.columns.forEach((t) => {
      t.verticalAlign(this.table.options.columnHeaderVertAlign, e);
    }), this.table.rowManager.adjustTableSize());
  }
  //////////////// Column Details /////////////////
  findColumn(e) {
    var t;
    if (typeof e == "object") {
      if (e instanceof rr)
        return e;
      if (e instanceof kp)
        return e._getSelf() || !1;
      if (typeof HTMLElement < "u" && e instanceof HTMLElement)
        return t = [], this.columns.forEach((n) => {
          t.push(n), t = t.concat(n.getColumns(!0));
        }), t.find((n) => n.element === e) || !1;
    } else
      return this.columnsByField[e] || !1;
    return !1;
  }
  getColumnByField(e) {
    return this.columnsByField[e];
  }
  getColumnsByFieldRoot(e) {
    var t = [];
    return Object.keys(this.columnsByField).forEach((i) => {
      var n = this.table.options.nestedFieldSeparator ? i.split(this.table.options.nestedFieldSeparator)[0] : i;
      n === e && t.push(this.columnsByField[i]);
    }), t;
  }
  getColumnByIndex(e) {
    return this.columnsByIndex[e];
  }
  getFirstVisibleColumn() {
    var e = this.columnsByIndex.findIndex((t) => t.visible);
    return e > -1 ? this.columnsByIndex[e] : !1;
  }
  getVisibleColumnsByIndex() {
    return this.columnsByIndex.filter((e) => e.visible);
  }
  getColumns() {
    return this.columns;
  }
  findColumnIndex(e) {
    return this.columnsByIndex.findIndex((t) => e === t);
  }
  //return all columns that are not groups
  getRealColumns() {
    return this.columnsByIndex;
  }
  //traverse across columns and call action
  traverse(e) {
    this.columnsByIndex.forEach((t, i) => {
      e(t, i);
    });
  }
  //get definitions of actual columns
  getDefinitions(e) {
    var t = [];
    return this.columnsByIndex.forEach((i) => {
      (!e || e && i.visible) && t.push(i.getDefinition());
    }), t;
  }
  //get full nested definition tree
  getDefinitionTree() {
    var e = [];
    return this.columns.forEach((t) => {
      e.push(t.getDefinition(!0));
    }), e;
  }
  getComponents(e) {
    var t = [], i = e ? this.columns : this.columnsByIndex;
    return i.forEach((n) => {
      t.push(n.getComponent());
    }), t;
  }
  getWidth() {
    var e = 0;
    return this.columnsByIndex.forEach((t) => {
      t.visible && (e += t.getWidth());
    }), e;
  }
  moveColumn(e, t, i) {
    t.element.parentNode.insertBefore(e.element, t.element), i && t.element.parentNode.insertBefore(t.element, e.element), this.moveColumnActual(e, t, i), this.verticalAlignHeaders(), this.table.rowManager.reinitialize();
  }
  moveColumnActual(e, t, i) {
    e.parent.isGroup ? this._moveColumnInArray(e.parent.columns, e, t, i) : this._moveColumnInArray(this.columns, e, t, i), this._moveColumnInArray(this.columnsByIndex, e, t, i, !0), this.rerenderColumns(!0), this.dispatch("column-moved", e, t, i), this.subscribedExternal("columnMoved") && this.dispatchExternal("columnMoved", e.getComponent(), this.table.columnManager.getComponents());
  }
  _moveColumnInArray(e, t, i, n, s) {
    var a = e.indexOf(t), o, l = [];
    a > -1 && (e.splice(a, 1), o = e.indexOf(i), o > -1 ? n && (o = o + 1) : o = a, e.splice(o, 0, t), s && (l = this.chain("column-moving-rows", [t, i, n], null, []) || [], l = l.concat(this.table.rowManager.rows), l.forEach(function(h) {
      if (h.cells.length) {
        var u = h.cells.splice(a, 1)[0];
        h.cells.splice(o, 0, u);
      }
    })));
  }
  scrollToColumn(e, t, i) {
    var n = 0, s = e.getLeftOffset(), a = 0, o = e.getElement();
    return new Promise((l, h) => {
      if (typeof t > "u" && (t = this.table.options.scrollToColumnPosition), typeof i > "u" && (i = this.table.options.scrollToColumnIfVisible), e.visible) {
        switch (t) {
          case "middle":
          case "center":
            a = -this.element.clientWidth / 2;
            break;
          case "right":
            a = o.clientWidth - this.headersElement.clientWidth;
            break;
        }
        if (!i && s > 0 && s + o.offsetWidth < this.element.clientWidth)
          return !1;
        n = s + a, n = Math.max(Math.min(n, this.table.rowManager.element.scrollWidth - this.table.rowManager.element.clientWidth), 0), this.table.rowManager.scrollHorizontal(n), this.scrollHorizontal(n), l();
      } else
        console.warn("Scroll Error - Column not visible"), h("Scroll Error - Column not visible");
    });
  }
  //////////////// Cell Management /////////////////
  generateCells(e) {
    var t = [];
    return this.columnsByIndex.forEach((i) => {
      t.push(i.generateCell(e));
    }), t;
  }
  //////////////// Column Management /////////////////
  getFlexBaseWidth() {
    var e = this.table.element.clientWidth, t = 0;
    return this.table.rowManager.element.scrollHeight > this.table.rowManager.element.clientHeight && (e -= this.table.rowManager.element.offsetWidth - this.table.rowManager.element.clientWidth), this.columnsByIndex.forEach(function(i) {
      var n, s, a;
      i.visible && (n = i.definition.width || 0, s = parseInt(i.minWidth), typeof n == "string" ? n.indexOf("%") > -1 ? a = e / 100 * parseInt(n) : a = parseInt(n) : a = n, t += a > s ? a : s);
    }), t;
  }
  addColumn(e, t, i) {
    return new Promise((n, s) => {
      var a = this._addColumn(e, t, i);
      this._reIndexColumns(), this.dispatch("column-add", e, t, i), this.layoutMode() != "fitColumns" && a.reinitializeWidth(), this.redraw(!0), this.table.rowManager.reinitialize(), this.rerenderColumns(), n(a);
    });
  }
  //remove column from system
  deregisterColumn(e) {
    var t = e.getField(), i;
    t && delete this.columnsByField[t], i = this.columnsByIndex.indexOf(e), i > -1 && this.columnsByIndex.splice(i, 1), i = this.columns.indexOf(e), i > -1 && this.columns.splice(i, 1), this.verticalAlignHeaders(), this.redraw();
  }
  rerenderColumns(e, t) {
    this.redrawBlock ? (e === !1 || e === !0 && this.redrawBlockUpdate === null) && (this.redrawBlockUpdate = e) : this.renderer.rerenderColumns(e, t);
  }
  blockRedraw() {
    this.redrawBlock = !0, this.redrawBlockUpdate = null;
  }
  restoreRedraw() {
    this.redrawBlock = !1, this.verticalAlignHeaders(), this.renderer.rerenderColumns(this.redrawBlockUpdate);
  }
  //redraw columns
  redraw(e) {
    de.elVisible(this.element) && this.verticalAlignHeaders(), e && (this.table.rowManager.resetScroll(), this.table.rowManager.reinitialize()), this.confirm("table-redrawing", e) || this.layoutRefresh(e), this.dispatch("table-redraw", e), this.table.footerManager.redraw();
  }
}
class Ew extends $a {
  constructor(e) {
    super(e), this.verticalFillMode = "fill", this.scrollTop = 0, this.scrollLeft = 0, this.scrollTop = 0, this.scrollLeft = 0;
  }
  clearRows() {
    for (var e = this.tableElement; e.firstChild; ) e.removeChild(e.firstChild);
    e.scrollTop = 0, e.scrollLeft = 0, e.style.minWidth = "", e.style.minHeight = "", e.style.display = "", e.style.visibility = "";
  }
  renderRows() {
    var e = this.tableElement, t = !0, i = document.createDocumentFragment(), n = this.rows();
    n.forEach((s, a) => {
      this.styleRow(s, a), s.initialize(!1, !0), s.type !== "group" && (t = !1), i.appendChild(s.getElement());
    }), e.appendChild(i), n.forEach((s) => {
      s.rendered(), s.heightInitialized || s.calcHeight(!0);
    }), n.forEach((s) => {
      s.heightInitialized || s.setCellHeight();
    }), t ? e.style.minWidth = this.table.columnManager.getWidth() + "px" : e.style.minWidth = "";
  }
  rerenderRows(e) {
    this.clearRows(), e && e(), this.renderRows(), this.rows().length || this.table.rowManager.tableEmpty();
  }
  scrollToRowNearestTop(e) {
    var t = de.elOffset(e.getElement()).top;
    return !(Math.abs(this.elementVertical.scrollTop - t) > Math.abs(this.elementVertical.scrollTop + this.elementVertical.clientHeight - t));
  }
  scrollToRow(e) {
    var t = e.getElement();
    this.elementVertical.scrollTop = de.elOffset(t).top - de.elOffset(this.elementVertical).top + this.elementVertical.scrollTop;
  }
  visibleRows(e) {
    return this.rows();
  }
}
class Tw extends $a {
  constructor(e) {
    super(e), this.verticalFillMode = "fill", this.scrollTop = 0, this.scrollLeft = 0, this.vDomRowHeight = 20, this.vDomTop = 0, this.vDomBottom = 0, this.vDomScrollPosTop = 0, this.vDomScrollPosBottom = 0, this.vDomTopPad = 0, this.vDomBottomPad = 0, this.vDomMaxRenderChain = 90, this.vDomWindowBuffer = 0, this.vDomWindowMinTotalRows = 20, this.vDomWindowMinMarginRows = 5, this.vDomTopNewRows = [], this.vDomBottomNewRows = [];
  }
  //////////////////////////////////////
  ///////// Public Functions ///////////
  //////////////////////////////////////
  clearRows() {
    for (var e = this.tableElement; e.firstChild; ) e.removeChild(e.firstChild);
    e.style.paddingTop = "", e.style.paddingBottom = "", e.style.minHeight = "", e.style.display = "", e.style.visibility = "", this.elementVertical.scrollTop = 0, this.elementVertical.scrollLeft = 0, this.scrollTop = 0, this.scrollLeft = 0, this.vDomTop = 0, this.vDomBottom = 0, this.vDomTopPad = 0, this.vDomBottomPad = 0, this.vDomScrollPosTop = 0, this.vDomScrollPosBottom = 0;
  }
  renderRows() {
    this._virtualRenderFill();
  }
  rerenderRows(e) {
    for (var t = this.elementVertical.scrollTop, i = !1, n = !1, s = this.table.rowManager.scrollLeft, a = this.rows(), o = this.vDomTop; o <= this.vDomBottom; o++)
      if (a[o]) {
        var l = t - a[o].getElement().offsetTop;
        if (n === !1 || Math.abs(l) < n)
          n = l, i = o;
        else
          break;
      }
    a.forEach((h) => {
      h.deinitializeHeight();
    }), e && e(), this.rows().length ? this._virtualRenderFill(i === !1 ? this.rows.length - 1 : i, !0, n || 0) : (this.clear(), this.table.rowManager.tableEmpty()), this.scrollColumns(s);
  }
  scrollColumns(e) {
    this.table.rowManager.scrollHorizontal(e);
  }
  scrollRows(e, t) {
    var i = e - this.vDomScrollPosTop, n = e - this.vDomScrollPosBottom, s = this.vDomWindowBuffer * 2, a = this.rows();
    if (this.scrollTop = e, -i > s || n > s) {
      var o = this.table.rowManager.scrollLeft;
      this._virtualRenderFill(Math.floor(this.elementVertical.scrollTop / this.elementVertical.scrollHeight * a.length)), this.scrollColumns(o);
    } else
      t ? (i < 0 && this._addTopRow(a, -i), n < 0 && (this.vDomScrollHeight - this.scrollTop > this.vDomWindowBuffer ? this._removeBottomRow(a, -n) : this.vDomScrollPosBottom = this.scrollTop)) : (n >= 0 && this._addBottomRow(a, n), i >= 0 && (this.scrollTop > this.vDomWindowBuffer ? this._removeTopRow(a, i) : this.vDomScrollPosTop = this.scrollTop));
  }
  resize() {
    this.vDomWindowBuffer = this.table.options.renderVerticalBuffer || this.elementVertical.clientHeight;
  }
  scrollToRowNearestTop(e) {
    var t = this.rows().indexOf(e);
    return !(Math.abs(this.vDomTop - t) > Math.abs(this.vDomBottom - t));
  }
  scrollToRow(e) {
    var t = this.rows().indexOf(e);
    t > -1 && this._virtualRenderFill(t, !0);
  }
  visibleRows(e) {
    var t = this.elementVertical.scrollTop, i = this.elementVertical.clientHeight + t, n = !1, s = 0, a = 0, o = this.rows();
    if (e)
      s = this.vDomTop, a = this.vDomBottom;
    else
      for (var l = this.vDomTop; l <= this.vDomBottom; l++)
        if (o[l])
          if (n)
            if (i - o[l].getElement().offsetTop >= 0)
              a = l;
            else
              break;
          else if (t - o[l].getElement().offsetTop >= 0)
            s = l;
          else if (n = !0, i - o[l].getElement().offsetTop >= 0)
            a = l;
          else
            break;
    return o.slice(s, a + 1);
  }
  //////////////////////////////////////
  //////// Internal Rendering //////////
  //////////////////////////////////////
  //full virtual render
  _virtualRenderFill(e, t, i) {
    var n = this.tableElement, s = this.elementVertical, a = 0, o = 0, l = 0, h = 0, u = 0, d = 0, c = this.rows(), f = c.length, p = 0, m, g, v = [], b = 0, y = 0, w = this.table.rowManager.fixedHeight, _ = this.elementVertical.clientHeight, E = this.table.options.rowHeight, x = !0;
    if (e = e || 0, i = i || 0, !e)
      this.clear();
    else {
      for (; n.firstChild; ) n.removeChild(n.firstChild);
      h = (f - e + 1) * this.vDomRowHeight, h < _ && (e -= Math.ceil((_ - h) / this.vDomRowHeight), e < 0 && (e = 0)), a = Math.min(Math.max(Math.floor(this.vDomWindowBuffer / this.vDomRowHeight), this.vDomWindowMinMarginRows), e), e -= a;
    }
    if (f && de.elVisible(this.elementVertical)) {
      for (this.vDomTop = e, this.vDomBottom = e - 1, w || this.table.options.maxHeight ? (E && (y = _ / E + this.vDomWindowBuffer / E), y = Math.max(this.vDomWindowMinTotalRows, Math.ceil(y))) : y = f; (y == f || o <= _ + this.vDomWindowBuffer || b < this.vDomWindowMinTotalRows) && this.vDomBottom < f - 1; ) {
        for (v = [], g = document.createDocumentFragment(), d = 0; d < y && this.vDomBottom < f - 1; )
          p = this.vDomBottom + 1, m = c[p], this.styleRow(m, p), m.initialize(!1, !0), !m.heightInitialized && !this.table.options.rowHeight && m.clearCellHeight(), g.appendChild(m.getElement()), v.push(m), this.vDomBottom++, d++;
        if (!v.length)
          break;
        n.appendChild(g), v.forEach((T) => {
          T.rendered(), T.heightInitialized || T.calcHeight(!0);
        }), v.forEach((T) => {
          T.heightInitialized || T.setCellHeight();
        }), v.forEach((T) => {
          l = T.getHeight(), b < a ? u += l : o += l, l > this.vDomWindowBuffer && (this.vDomWindowBuffer = l * 2), b++;
        }), x = this.table.rowManager.adjustTableSize(), _ = this.elementVertical.clientHeight, x && (w || this.table.options.maxHeight) && (E = o / b, y = Math.max(this.vDomWindowMinTotalRows, Math.ceil(_ / E + this.vDomWindowBuffer / E)));
      }
      e ? (this.vDomTopPad = t ? this.vDomRowHeight * this.vDomTop + i : this.scrollTop - u, this.vDomBottomPad = this.vDomBottom == f - 1 ? 0 : Math.max(this.vDomScrollHeight - this.vDomTopPad - o - u, 0)) : (this.vDomTopPad = 0, this.vDomRowHeight = Math.floor((o + u) / b), this.vDomBottomPad = this.vDomRowHeight * (f - this.vDomBottom - 1), this.vDomScrollHeight = u + o + this.vDomBottomPad - _), n.style.paddingTop = this.vDomTopPad + "px", n.style.paddingBottom = this.vDomBottomPad + "px", t && (this.scrollTop = this.vDomTopPad + u + i - (this.elementVertical.scrollWidth > this.elementVertical.clientWidth ? this.elementVertical.offsetHeight - _ : 0)), this.scrollTop = Math.min(this.scrollTop, this.elementVertical.scrollHeight - _), this.elementVertical.scrollWidth > this.elementVertical.clientWidth && t && (this.scrollTop += this.elementVertical.offsetHeight - _), this.vDomScrollPosTop = this.scrollTop, this.vDomScrollPosBottom = this.scrollTop, s.scrollTop = this.scrollTop, this.dispatch("render-virtual-fill");
    }
  }
  _addTopRow(e, t) {
    for (var i = this.tableElement, n = [], s = 0, a = this.vDomTop - 1, o = 0, l = !0; l; )
      if (this.vDomTop) {
        let h = e[a], u, d;
        h && o < this.vDomMaxRenderChain ? (u = h.getHeight() || this.vDomRowHeight, d = h.initialized, t >= u ? (this.styleRow(h, a), i.insertBefore(h.getElement(), i.firstChild), (!h.initialized || !h.heightInitialized) && n.push(h), h.initialize(), d || (u = h.getElement().offsetHeight, u > this.vDomWindowBuffer && (this.vDomWindowBuffer = u * 2)), t -= u, s += u, this.vDomTop--, a--, o++) : l = !1) : l = !1;
      } else
        l = !1;
    for (let h of n)
      h.clearCellHeight();
    this._quickNormalizeRowHeight(n), s && (this.vDomTopPad -= s, this.vDomTopPad < 0 && (this.vDomTopPad = a * this.vDomRowHeight), a < 1 && (this.vDomTopPad = 0), i.style.paddingTop = this.vDomTopPad + "px", this.vDomScrollPosTop -= s);
  }
  _removeTopRow(e, t) {
    for (var i = [], n = 0, s = 0, a = !0; a; ) {
      let o = e[this.vDomTop], l;
      o && s < this.vDomMaxRenderChain ? (l = o.getHeight() || this.vDomRowHeight, t >= l ? (this.vDomTop++, t -= l, n += l, i.push(o), s++) : a = !1) : a = !1;
    }
    for (let o of i) {
      let l = o.getElement();
      l.parentNode && l.parentNode.removeChild(l);
    }
    n && (this.vDomTopPad += n, this.tableElement.style.paddingTop = this.vDomTopPad + "px", this.vDomScrollPosTop += this.vDomTop ? n : n + this.vDomWindowBuffer);
  }
  _addBottomRow(e, t) {
    for (var i = this.tableElement, n = [], s = 0, a = this.vDomBottom + 1, o = 0, l = !0; l; ) {
      let h = e[a], u, d;
      h && o < this.vDomMaxRenderChain ? (u = h.getHeight() || this.vDomRowHeight, d = h.initialized, t >= u ? (this.styleRow(h, a), i.appendChild(h.getElement()), (!h.initialized || !h.heightInitialized) && n.push(h), h.initialize(), d || (u = h.getElement().offsetHeight, u > this.vDomWindowBuffer && (this.vDomWindowBuffer = u * 2)), t -= u, s += u, this.vDomBottom++, a++, o++) : l = !1) : l = !1;
    }
    for (let h of n)
      h.clearCellHeight();
    this._quickNormalizeRowHeight(n), s && (this.vDomBottomPad -= s, (this.vDomBottomPad < 0 || a == e.length - 1) && (this.vDomBottomPad = 0), i.style.paddingBottom = this.vDomBottomPad + "px", this.vDomScrollPosBottom += s);
  }
  _removeBottomRow(e, t) {
    for (var i = [], n = 0, s = 0, a = !0; a; ) {
      let o = e[this.vDomBottom], l;
      o && s < this.vDomMaxRenderChain ? (l = o.getHeight() || this.vDomRowHeight, t >= l ? (this.vDomBottom--, t -= l, n += l, i.push(o), s++) : a = !1) : a = !1;
    }
    for (let o of i) {
      let l = o.getElement();
      l.parentNode && l.parentNode.removeChild(l);
    }
    n && (this.vDomBottomPad += n, this.vDomBottomPad < 0 && (this.vDomBottomPad = 0), this.tableElement.style.paddingBottom = this.vDomBottomPad + "px", this.vDomScrollPosBottom -= n);
  }
  _quickNormalizeRowHeight(e) {
    for (let t of e)
      t.calcHeight();
    for (let t of e)
      t.setCellHeight();
  }
}
class xw extends ke {
  constructor(e) {
    super(e), this.element = this.createHolderElement(), this.tableElement = this.createTableElement(), this.heightFixer = this.createTableElement(), this.placeholder = null, this.placeholderContents = null, this.firstRender = !1, this.renderMode = "virtual", this.fixedHeight = !1, this.rows = [], this.activeRowsPipeline = [], this.activeRows = [], this.activeRowsCount = 0, this.displayRows = [], this.displayRowsCount = 0, this.scrollTop = 0, this.scrollLeft = 0, this.redrawBlock = !1, this.redrawBlockRestoreConfig = !1, this.redrawBlockRenderInPosition = !1, this.dataPipeline = [], this.displayPipeline = [], this.scrollbarWidth = 0, this.renderer = null;
  }
  //////////////// Setup Functions /////////////////
  createHolderElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-tableholder"), e.setAttribute("tabindex", 0), e;
  }
  createTableElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-table"), e.setAttribute("role", "rowgroup"), e;
  }
  initializePlaceholder() {
    var e = this.table.options.placeholder;
    if (typeof e == "function" && (e = e.call(this.table)), e = this.chain("placeholder", [e], e, e) || e, e) {
      let t = document.createElement("div");
      if (t.classList.add("tabulator-placeholder"), typeof e == "string") {
        let i = document.createElement("div");
        i.classList.add("tabulator-placeholder-contents"), i.innerHTML = e, t.appendChild(i), this.placeholderContents = i;
      } else typeof HTMLElement < "u" && e instanceof HTMLElement ? (t.appendChild(e), this.placeholderContents = e) : (console.warn("Invalid placeholder provided, must be string or HTML Element", e), this.el = null);
      this.placeholder = t;
    }
  }
  //return containing element
  getElement() {
    return this.element;
  }
  //return table element
  getTableElement() {
    return this.tableElement;
  }
  initialize() {
    this.initializePlaceholder(), this.initializeRenderer(), this.element.appendChild(this.tableElement), this.firstRender = !0, this.element.addEventListener("scroll", () => {
      var e = this.element.scrollLeft, t = this.scrollLeft > e, i = this.element.scrollTop, n = this.scrollTop > i;
      this.scrollLeft != e && (this.scrollLeft = e, this.dispatch("scroll-horizontal", e, t), this.dispatchExternal("scrollHorizontal", e, t), this._positionPlaceholder()), this.scrollTop != i && (this.scrollTop = i, this.renderer.scrollRows(i, n), this.dispatch("scroll-vertical", i, n), this.dispatchExternal("scrollVertical", i, n));
    });
  }
  ////////////////// Row Manipulation //////////////////
  findRow(e) {
    if (typeof e == "object") {
      if (e instanceof ze)
        return e;
      if (e instanceof Ya)
        return e._getSelf() || !1;
      if (typeof HTMLElement < "u" && e instanceof HTMLElement)
        return this.rows.find((i) => i.getElement() === e) || !1;
      if (e === null)
        return !1;
    } else return typeof e > "u" ? !1 : this.rows.find((i) => i.data[this.table.options.index] == e) || !1;
    return !1;
  }
  getRowFromDataObject(e) {
    var t = this.rows.find((i) => i.data === e);
    return t || !1;
  }
  getRowFromPosition(e) {
    return this.getDisplayRows().find((t) => t.type === "row" && t.getPosition() === e && t.isDisplayed());
  }
  scrollToRow(e, t, i) {
    return this.renderer.scrollToRowPosition(e, t, i);
  }
  ////////////////// Data Handling //////////////////
  setData(e, t, i) {
    return new Promise((n, s) => {
      t && this.getDisplayRows().length ? this.table.options.pagination ? this._setDataActual(e, !0) : this.reRenderInPosition(() => {
        this._setDataActual(e);
      }) : (this.table.options.autoColumns && i && this.table.initialized && this.table.columnManager.generateColumnsFromRowData(e), this.resetScroll(), this._setDataActual(e)), n();
    });
  }
  _setDataActual(e, t) {
    this.dispatchExternal("dataProcessing", e), this._wipeElements(), Array.isArray(e) ? (this.dispatch("data-processing", e), e.forEach((i, n) => {
      if (i && typeof i == "object") {
        var s = new ze(i, this);
        this.rows.push(s);
      } else
        console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:", i);
    }), this.refreshActiveData(!1, !1, t), this.dispatch("data-processed", e), this.dispatchExternal("dataProcessed", e)) : console.error(`Data Loading Error - Unable to process data due to invalid data type 
Expecting: array 
Received: `, typeof e, `
Data:     `, e);
  }
  _wipeElements() {
    this.dispatch("rows-wipe"), this.destroy(), this.adjustTableSize(), this.dispatch("rows-wiped");
  }
  destroy() {
    this.rows.forEach((e) => {
      e.wipe();
    }), this.rows = [], this.activeRows = [], this.activeRowsPipeline = [], this.activeRowsCount = 0, this.displayRows = [], this.displayRowsCount = 0;
  }
  deleteRow(e, t) {
    var i = this.rows.indexOf(e), n = this.activeRows.indexOf(e);
    n > -1 && this.activeRows.splice(n, 1), i > -1 && this.rows.splice(i, 1), this.setActiveRows(this.activeRows), this.displayRowIterator((s) => {
      var a = s.indexOf(e);
      a > -1 && s.splice(a, 1);
    }), t || this.reRenderInPosition(), this.regenerateRowPositions(), this.dispatchExternal("rowDeleted", e.getComponent()), this.displayRowsCount || this.tableEmpty(), this.subscribedExternal("dataChanged") && this.dispatchExternal("dataChanged", this.getData());
  }
  addRow(e, t, i, n) {
    var s = this.addRowActual(e, t, i, n);
    return s;
  }
  //add multiple rows
  addRows(e, t, i, n) {
    var s = [];
    return new Promise((a, o) => {
      t = this.findAddRowPos(t), Array.isArray(e) || (e = [e]), (typeof i > "u" && t || typeof i < "u" && !t) && e.reverse(), e.forEach((l, h) => {
        var u = this.addRow(l, t, i, !0);
        s.push(u), this.dispatch("row-added", u, l, t, i);
      }), this.refreshActiveData(n ? "displayPipeline" : !1, !1, !0), this.regenerateRowPositions(), this.displayRowsCount && this._clearPlaceholder(), a(s);
    });
  }
  findAddRowPos(e) {
    return typeof e > "u" && (e = this.table.options.addRowPos), e === "pos" && (e = !0), e === "bottom" && (e = !1), e;
  }
  addRowActual(e, t, i, n) {
    var s = e instanceof ze ? e : new ze(e || {}, this), a = this.findAddRowPos(t), o = -1, l, h;
    return i || (h = this.chain("row-adding-position", [s, a], null, { index: i, top: a }), i = h.index, a = h.top), typeof i < "u" && (i = this.findRow(i)), i = this.chain("row-adding-index", [s, i, a], null, i), i && (o = this.rows.indexOf(i)), i && o > -1 ? (l = this.activeRows.indexOf(i), this.displayRowIterator(function(u) {
      var d = u.indexOf(i);
      d > -1 && u.splice(a ? d : d + 1, 0, s);
    }), l > -1 && this.activeRows.splice(a ? l : l + 1, 0, s), this.rows.splice(a ? o : o + 1, 0, s)) : a ? (this.displayRowIterator(function(u) {
      u.unshift(s);
    }), this.activeRows.unshift(s), this.rows.unshift(s)) : (this.displayRowIterator(function(u) {
      u.push(s);
    }), this.activeRows.push(s), this.rows.push(s)), this.setActiveRows(this.activeRows), this.dispatchExternal("rowAdded", s.getComponent()), this.subscribedExternal("dataChanged") && this.dispatchExternal("dataChanged", this.table.rowManager.getData()), n || this.reRenderInPosition(), s;
  }
  moveRow(e, t, i) {
    this.dispatch("row-move", e, t, i), this.moveRowActual(e, t, i), this.regenerateRowPositions(), this.dispatch("row-moved", e, t, i), this.dispatchExternal("rowMoved", e.getComponent());
  }
  moveRowActual(e, t, i) {
    this.moveRowInArray(this.rows, e, t, i), this.moveRowInArray(this.activeRows, e, t, i), this.displayRowIterator((n) => {
      this.moveRowInArray(n, e, t, i);
    }), this.dispatch("row-moving", e, t, i);
  }
  moveRowInArray(e, t, i, n) {
    var s, a, o, l;
    if (t !== i && (s = e.indexOf(t), s > -1 && (e.splice(s, 1), a = e.indexOf(i), a > -1 ? n ? e.splice(a + 1, 0, t) : e.splice(a, 0, t) : e.splice(s, 0, t)), e === this.getDisplayRows())) {
      o = s < a ? s : a, l = a > s ? a : s + 1;
      for (let h = o; h <= l; h++)
        e[h] && this.styleRow(e[h], h);
    }
  }
  clearData() {
    this.setData([]);
  }
  getRowIndex(e) {
    return this.findRowIndex(e, this.rows);
  }
  getDisplayRowIndex(e) {
    var t = this.getDisplayRows().indexOf(e);
    return t > -1 ? t : !1;
  }
  nextDisplayRow(e, t) {
    var i = this.getDisplayRowIndex(e), n = !1;
    return i !== !1 && i < this.displayRowsCount - 1 && (n = this.getDisplayRows()[i + 1]), n && (!(n instanceof ze) || n.type != "row") ? this.nextDisplayRow(n, t) : n;
  }
  prevDisplayRow(e, t) {
    var i = this.getDisplayRowIndex(e), n = !1;
    return i && (n = this.getDisplayRows()[i - 1]), t && n && (!(n instanceof ze) || n.type != "row") ? this.prevDisplayRow(n, t) : n;
  }
  findRowIndex(e, t) {
    var i;
    return e = this.findRow(e), e && (i = t.indexOf(e), i > -1) ? i : !1;
  }
  getData(e, t) {
    var i = [], n = this.getRows(e);
    return n.forEach(function(s) {
      s.type == "row" && i.push(s.getData(t || "data"));
    }), i;
  }
  getComponents(e) {
    var t = [], i = this.getRows(e);
    return i.forEach(function(n) {
      t.push(n.getComponent());
    }), t;
  }
  getDataCount(e) {
    var t = this.getRows(e);
    return t.length;
  }
  scrollHorizontal(e) {
    this.scrollLeft = e, this.element.scrollLeft = e, this.dispatch("scroll-horizontal", e);
  }
  registerDataPipelineHandler(e, t) {
    typeof t < "u" ? (this.dataPipeline.push({ handler: e, priority: t }), this.dataPipeline.sort((i, n) => i.priority - n.priority)) : console.error("Data pipeline handlers must have a priority in order to be registered");
  }
  registerDisplayPipelineHandler(e, t) {
    typeof t < "u" ? (this.displayPipeline.push({ handler: e, priority: t }), this.displayPipeline.sort((i, n) => i.priority - n.priority)) : console.error("Display pipeline handlers must have a priority in order to be registered");
  }
  //set active data set
  refreshActiveData(e, t, i) {
    var n = this.table, s = "", a = 0, o = ["all", "dataPipeline", "display", "displayPipeline", "end"];
    if (!this.table.destroyed) {
      if (typeof e == "function")
        if (a = this.dataPipeline.findIndex((l) => l.handler === e), a > -1)
          s = "dataPipeline", t && (a == this.dataPipeline.length - 1 ? s = "display" : a++);
        else if (a = this.displayPipeline.findIndex((l) => l.handler === e), a > -1)
          s = "displayPipeline", t && (a == this.displayPipeline.length - 1 ? s = "end" : a++);
        else {
          console.error("Unable to refresh data, invalid handler provided", e);
          return;
        }
      else
        s = e || "all", a = 0;
      if (this.redrawBlock) {
        (!this.redrawBlockRestoreConfig || this.redrawBlockRestoreConfig && (this.redrawBlockRestoreConfig.stage === s && a < this.redrawBlockRestoreConfig.index || o.indexOf(s) < o.indexOf(this.redrawBlockRestoreConfig.stage))) && (this.redrawBlockRestoreConfig = {
          handler: e,
          skipStage: t,
          renderInPosition: i,
          stage: s,
          index: a
        });
        return;
      } else
        de.elVisible(this.element) ? i ? this.reRenderInPosition(this.refreshPipelines.bind(this, e, s, a, i)) : (this.refreshPipelines(e, s, a, i), e || this.table.columnManager.renderer.renderColumns(), this.renderTable(), n.options.layoutColumnsOnNewData && this.table.columnManager.redraw(!0)) : this.refreshPipelines(e, s, a, i), this.dispatch("data-refreshed");
    }
  }
  refreshPipelines(e, t, i, n) {
    switch (this.dispatch("data-refreshing"), (!e || !this.activeRowsPipeline[0]) && (this.activeRowsPipeline[0] = this.rows.slice(0)), t) {
      case "all":
      case "dataPipeline":
        for (let s = i; s < this.dataPipeline.length; s++) {
          let a = this.dataPipeline[s].handler(this.activeRowsPipeline[s].slice(0));
          this.activeRowsPipeline[s + 1] = a || this.activeRowsPipeline[s].slice(0);
        }
        this.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]);
      case "display":
        i = 0, this.resetDisplayRows();
      case "displayPipeline":
        for (let s = i; s < this.displayPipeline.length; s++) {
          let a = this.displayPipeline[s].handler((s ? this.getDisplayRows(s - 1) : this.activeRows).slice(0), n);
          this.setDisplayRows(a || this.getDisplayRows(s - 1).slice(0), s);
        }
      case "end":
        this.regenerateRowPositions();
    }
    this.getDisplayRows().length && this._clearPlaceholder();
  }
  //regenerate row positions
  regenerateRowPositions() {
    var e = this.getDisplayRows(), t = 1;
    e.forEach((i) => {
      i.type === "row" && (i.setPosition(t), t++);
    });
  }
  setActiveRows(e) {
    this.activeRows = this.activeRows = Object.assign([], e), this.activeRowsCount = this.activeRows.length;
  }
  //reset display rows array
  resetDisplayRows() {
    this.displayRows = [], this.displayRows.push(this.activeRows.slice(0)), this.displayRowsCount = this.displayRows[0].length;
  }
  //set display row pipeline data
  setDisplayRows(e, t) {
    this.displayRows[t] = e, t == this.displayRows.length - 1 && (this.displayRowsCount = this.displayRows[this.displayRows.length - 1].length);
  }
  getDisplayRows(e) {
    return typeof e > "u" ? this.displayRows.length ? this.displayRows[this.displayRows.length - 1] : [] : this.displayRows[e] || [];
  }
  getVisibleRows(e, t) {
    var i = Object.assign([], this.renderer.visibleRows(!t));
    return e && (i = this.chain("rows-visible", [t], i, i)), i;
  }
  //repeat action across display rows
  displayRowIterator(e) {
    this.activeRowsPipeline.forEach(e), this.displayRows.forEach(e), this.displayRowsCount = this.displayRows[this.displayRows.length - 1].length;
  }
  //return only actual rows (not group headers etc)
  getRows(e) {
    var t = [];
    switch (e) {
      case "active":
        t = this.activeRows;
        break;
      case "display":
        t = this.table.rowManager.getDisplayRows();
        break;
      case "visible":
        t = this.getVisibleRows(!1, !0);
        break;
      default:
        t = this.chain("rows-retrieve", e, null, this.rows) || this.rows;
    }
    return t;
  }
  ///////////////// Table Rendering /////////////////
  //trigger rerender of table in current position
  reRenderInPosition(e) {
    this.redrawBlock ? e ? e() : this.redrawBlockRenderInPosition = !0 : (this.dispatchExternal("renderStarted"), this.renderer.rerenderRows(e), this.fixedHeight || this.adjustTableSize(), this.scrollBarCheck(), this.dispatchExternal("renderComplete"));
  }
  scrollBarCheck() {
    var e = 0;
    this.element.scrollHeight > this.element.clientHeight && (e = this.element.offsetWidth - this.element.clientWidth), e !== this.scrollbarWidth && (this.scrollbarWidth = e, this.dispatch("scrollbar-vertical", e));
  }
  initializeRenderer() {
    var e, t = {
      virtual: Tw,
      basic: Ew
    };
    typeof this.table.options.renderVertical == "string" ? e = t[this.table.options.renderVertical] : e = this.table.options.renderVertical, e ? (this.renderMode = this.table.options.renderVertical, this.renderer = new e(this.table, this.element, this.tableElement), this.renderer.initialize(), (this.table.element.clientHeight || this.table.options.height) && !(this.table.options.minHeight && this.table.options.maxHeight) ? this.fixedHeight = !0 : this.fixedHeight = !1) : console.error("Unable to find matching renderer:", this.table.options.renderVertical);
  }
  getRenderMode() {
    return this.renderMode;
  }
  renderTable() {
    this.dispatchExternal("renderStarted"), this.element.scrollTop = 0, this._clearTable(), this.displayRowsCount ? (this.renderer.renderRows(), this.firstRender && (this.firstRender = !1, this.fixedHeight || this.adjustTableSize(), this.layoutRefresh(!0))) : this.renderEmptyScroll(), this.fixedHeight || this.adjustTableSize(), this.dispatch("table-layout"), this.displayRowsCount || this._showPlaceholder(), this.scrollBarCheck(), this.dispatchExternal("renderComplete");
  }
  //show scrollbars on empty table div
  renderEmptyScroll() {
    this.placeholder ? this.tableElement.style.display = "none" : this.tableElement.style.minWidth = this.table.columnManager.getWidth() + "px";
  }
  _clearTable() {
    this._clearPlaceholder(), this.scrollTop = 0, this.scrollLeft = 0, this.renderer.clearRows();
  }
  tableEmpty() {
    this.renderEmptyScroll(), this._showPlaceholder();
  }
  checkPlaceholder() {
    this.displayRowsCount ? this._clearPlaceholder() : this.tableEmpty();
  }
  _showPlaceholder() {
    this.placeholder && (this.placeholder && this.placeholder.parentNode && this.placeholder.parentNode.removeChild(this.placeholder), this.initializePlaceholder(), this.placeholder.setAttribute("tabulator-render-mode", this.renderMode), this.getElement().appendChild(this.placeholder), this._positionPlaceholder(), this.adjustTableSize());
  }
  _clearPlaceholder() {
    this.placeholder && this.placeholder.parentNode && this.placeholder.parentNode.removeChild(this.placeholder), this.tableElement.style.minWidth = "", this.tableElement.style.display = "";
  }
  _positionPlaceholder() {
    this.placeholder && this.placeholder.parentNode && (this.placeholder.style.width = this.table.columnManager.getWidth() + "px", this.placeholderContents.style.width = this.table.rowManager.element.clientWidth + "px", this.placeholderContents.style.marginLeft = this.scrollLeft + "px");
  }
  styleRow(e, t) {
    var i = e.getElement();
    t % 2 ? (i.classList.add("tabulator-row-even"), i.classList.remove("tabulator-row-odd")) : (i.classList.add("tabulator-row-odd"), i.classList.remove("tabulator-row-even"));
  }
  //normalize height of active rows
  normalizeHeight(e) {
    this.activeRows.forEach(function(t) {
      t.normalizeHeight(e);
    });
  }
  //adjust the height of the table holder to fit in the Tabulator element
  adjustTableSize() {
    let e = this.element.clientHeight, t, i = !1;
    if (this.renderer.verticalFillMode === "fill") {
      let n = Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height + (this.table.footerManager && this.table.footerManager.active && !this.table.footerManager.external ? this.table.footerManager.getElement().getBoundingClientRect().height : 0));
      if (this.fixedHeight) {
        t = isNaN(this.table.options.minHeight) ? this.table.options.minHeight : this.table.options.minHeight + "px";
        const s = "calc(100% - " + n + "px)";
        this.element.style.minHeight = t || "calc(100% - " + n + "px)", this.element.style.height = s, this.element.style.maxHeight = s;
      } else
        this.element.style.height = "", this.element.style.height = this.table.element.clientHeight - n + "px", this.element.scrollTop = this.scrollTop;
      this.renderer.resize(), !this.fixedHeight && e != this.element.clientHeight && (i = !0, this.subscribed("table-resize") ? this.dispatch("table-resize") : this.redraw()), this.scrollBarCheck();
    }
    return this._positionPlaceholder(), i;
  }
  //reinitialize all rows
  reinitialize() {
    this.rows.forEach(function(e) {
      e.reinitialize(!0);
    });
  }
  //prevent table from being redrawn
  blockRedraw() {
    this.redrawBlock = !0, this.redrawBlockRestoreConfig = !1;
  }
  //restore table redrawing
  restoreRedraw() {
    this.redrawBlock = !1, this.redrawBlockRestoreConfig ? (this.refreshActiveData(this.redrawBlockRestoreConfig.handler, this.redrawBlockRestoreConfig.skipStage, this.redrawBlockRestoreConfig.renderInPosition), this.redrawBlockRestoreConfig = !1) : this.redrawBlockRenderInPosition && this.reRenderInPosition(), this.redrawBlockRenderInPosition = !1;
  }
  //redraw table
  redraw(e) {
    this.adjustTableSize(), this.table.tableWidth = this.table.element.clientWidth, e ? this.renderTable() : (this.reRenderInPosition(), this.scrollHorizontal(this.scrollLeft));
  }
  resetScroll() {
    if (this.element.scrollLeft = 0, this.element.scrollTop = 0, this.table.browser === "ie") {
      var e = document.createEvent("Event");
      e.initEvent("scroll", !1, !0), this.element.dispatchEvent(e);
    } else
      this.element.dispatchEvent(new Event("scroll"));
  }
}
class Sw extends ke {
  constructor(e) {
    super(e), this.active = !1, this.element = this.createElement(), this.containerElement = this.createContainerElement(), this.external = !1;
  }
  initialize() {
    this.initializeElement();
  }
  createElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-footer"), e;
  }
  createContainerElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-footer-contents"), this.element.appendChild(e), e;
  }
  initializeElement() {
    if (this.table.options.footerElement)
      switch (typeof this.table.options.footerElement) {
        case "string":
          this.table.options.footerElement[0] === "<" ? this.containerElement.innerHTML = this.table.options.footerElement : (this.external = !0, this.containerElement = document.querySelector(this.table.options.footerElement));
          break;
        default:
          this.element = this.table.options.footerElement;
          break;
      }
  }
  getElement() {
    return this.element;
  }
  append(e) {
    this.activate(), this.containerElement.appendChild(e), this.table.rowManager.adjustTableSize();
  }
  prepend(e) {
    this.activate(), this.element.insertBefore(e, this.element.firstChild), this.table.rowManager.adjustTableSize();
  }
  remove(e) {
    e.parentNode.removeChild(e), this.deactivate();
  }
  deactivate(e) {
    (!this.element.firstChild || e) && (this.external || this.element.parentNode.removeChild(this.element), this.active = !1);
  }
  activate() {
    this.active || (this.active = !0, this.external || (this.table.element.appendChild(this.getElement()), this.table.element.style.display = ""));
  }
  redraw() {
    this.dispatch("footer-redraw");
  }
}
class Rw extends ke {
  constructor(e) {
    super(e), this.el = null, this.abortClasses = ["tabulator-headers", "tabulator-table"], this.previousTargets = {}, this.listeners = [
      "click",
      "dblclick",
      "contextmenu",
      "mouseenter",
      "mouseleave",
      "mouseover",
      "mouseout",
      "mousemove",
      "mouseup",
      "mousedown",
      "touchstart",
      "touchend"
    ], this.componentMap = {
      "tabulator-cell": "cell",
      "tabulator-row": "row",
      "tabulator-group": "group",
      "tabulator-col": "column"
    }, this.pseudoTrackers = {
      row: {
        subscriber: null,
        target: null
      },
      cell: {
        subscriber: null,
        target: null
      },
      group: {
        subscriber: null,
        target: null
      },
      column: {
        subscriber: null,
        target: null
      }
    }, this.pseudoTracking = !1;
  }
  initialize() {
    this.el = this.table.element, this.buildListenerMap(), this.bindSubscriptionWatchers();
  }
  buildListenerMap() {
    var e = {};
    this.listeners.forEach((t) => {
      e[t] = {
        handler: null,
        components: []
      };
    }), this.listeners = e;
  }
  bindPseudoEvents() {
    Object.keys(this.pseudoTrackers).forEach((e) => {
      this.pseudoTrackers[e].subscriber = this.pseudoMouseEnter.bind(this, e), this.subscribe(e + "-mouseover", this.pseudoTrackers[e].subscriber);
    }), this.pseudoTracking = !0;
  }
  pseudoMouseEnter(e, t, i) {
    this.pseudoTrackers[e].target !== i && (this.pseudoTrackers[e].target && this.dispatch(e + "-mouseleave", t, this.pseudoTrackers[e].target), this.pseudoMouseLeave(e, t), this.pseudoTrackers[e].target = i, this.dispatch(e + "-mouseenter", t, i));
  }
  pseudoMouseLeave(e, t) {
    var i = Object.keys(this.pseudoTrackers), n = {
      row: ["cell"],
      cell: ["row"]
    };
    i = i.filter((s) => {
      var a = n[e];
      return s !== e && (!a || a && !a.includes(s));
    }), i.forEach((s) => {
      var a = this.pseudoTrackers[s].target;
      this.pseudoTrackers[s].target && (this.dispatch(s + "-mouseleave", t, a), this.pseudoTrackers[s].target = null);
    });
  }
  bindSubscriptionWatchers() {
    var e = Object.keys(this.listeners), t = Object.values(this.componentMap);
    for (let i of t)
      for (let n of e) {
        let s = i + "-" + n;
        this.subscriptionChange(s, this.subscriptionChanged.bind(this, i, n));
      }
    this.subscribe("table-destroy", this.clearWatchers.bind(this));
  }
  subscriptionChanged(e, t, i) {
    var n = this.listeners[t].components, s = n.indexOf(e), a = !1;
    i ? s === -1 && (n.push(e), a = !0) : this.subscribed(e + "-" + t) || s > -1 && (n.splice(s, 1), a = !0), (t === "mouseenter" || t === "mouseleave") && !this.pseudoTracking && this.bindPseudoEvents(), a && this.updateEventListeners();
  }
  updateEventListeners() {
    for (let e in this.listeners) {
      let t = this.listeners[e];
      t.components.length ? t.handler || (t.handler = this.track.bind(this, e), this.el.addEventListener(e, t.handler)) : t.handler && (this.el.removeEventListener(e, t.handler), t.handler = null);
    }
  }
  track(e, t) {
    var i = t.composedPath && t.composedPath() || t.path, n = this.findTargets(i);
    n = this.bindComponents(e, n), this.triggerEvents(e, t, n), this.pseudoTracking && (e == "mouseover" || e == "mouseleave") && !Object.keys(n).length && this.pseudoMouseLeave("none", t);
  }
  findTargets(e) {
    var t = {};
    let i = Object.keys(this.componentMap);
    for (let n of e) {
      let s = n.classList ? [...n.classList] : [];
      if (s.filter((l) => this.abortClasses.includes(l)).length)
        break;
      let o = s.filter((l) => i.includes(l));
      for (let l of o)
        t[this.componentMap[l]] || (t[this.componentMap[l]] = n);
    }
    return t.group && t.group === t.row && delete t.row, t;
  }
  bindComponents(e, t) {
    var i = Object.keys(t).reverse(), n = this.listeners[e], s = {}, a = {}, o = {};
    for (let l of i) {
      let h, u = t[l], d = this.previousTargets[l];
      if (d && d.target === u)
        h = d.component;
      else
        switch (l) {
          case "row":
          case "group":
            (n.components.includes("row") || n.components.includes("cell") || n.components.includes("group")) && (h = this.table.rowManager.getVisibleRows(!0).find((f) => f.getElement() === u), t.row && t.row.parentNode && t.row.parentNode.closest(".tabulator-row") && (t[l] = !1));
            break;
          case "column":
            n.components.includes("column") && (h = this.table.columnManager.findColumn(u));
            break;
          case "cell":
            n.components.includes("cell") && (s.row instanceof ze ? h = s.row.findCell(u) : t.row && console.warn("Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?"));
            break;
        }
      h && (s[l] = h, o[l] = {
        target: u,
        component: h
      });
    }
    return this.previousTargets = o, Object.keys(t).forEach((l) => {
      let h = s[l];
      a[l] = h;
    }), a;
  }
  triggerEvents(e, t, i) {
    var n = this.listeners[e];
    for (let s in i)
      i[s] && n.components.includes(s) && this.dispatch(s + "-" + e, t, i[s]);
  }
  clearWatchers() {
    for (let e in this.listeners) {
      let t = this.listeners[e];
      t.handler && (this.el.removeEventListener(e, t.handler), t.handler = null);
    }
  }
}
class Mw {
  constructor(e) {
    this.table = e, this.bindings = {};
  }
  bind(e, t, i) {
    this.bindings[e] || (this.bindings[e] = {}), this.bindings[e][t] ? console.warn("Unable to bind component handler, a matching function name is already bound", e, t, i) : this.bindings[e][t] = i;
  }
  handle(e, t, i) {
    if (this.bindings[e] && this.bindings[e][i] && typeof this.bindings[e][i].bind == "function")
      return this.bindings[e][i].bind(null, t);
    i !== "then" && typeof i == "string" && !i.startsWith("_") && this.table.options.debugInvalidComponentFuncs && console.error("The " + e + " component does not have a " + i + " function, have you checked that you have the correct Tabulator module installed?");
  }
}
class Dw extends ke {
  constructor(e) {
    super(e), this.requestOrder = 0, this.loading = !1;
  }
  initialize() {
  }
  load(e, t, i, n, s, a) {
    var o = ++this.requestOrder;
    if (this.table.destroyed)
      return Promise.resolve();
    if (this.dispatchExternal("dataLoading", e), e && (e.indexOf("{") == 0 || e.indexOf("[") == 0) && (e = JSON.parse(e)), this.confirm("data-loading", [e, t, i, s])) {
      this.loading = !0, s || this.alertLoader(), t = this.chain("data-params", [e, i, s], t || {}, t || {}), t = this.mapParams(t, this.table.options.dataSendParams);
      var l = this.chain("data-load", [e, t, i, s], !1, Promise.resolve([]));
      return l.then((h) => {
        if (this.table.destroyed)
          console.warn("Data Load Response Blocked - Table has been destroyed");
        else {
          !Array.isArray(h) && typeof h == "object" && (h = this.mapParams(h, this.objectInvert(this.table.options.dataReceiveParams)));
          var u = this.chain("data-loaded", [h], null, h);
          o == this.requestOrder ? (this.clearAlert(), u !== !1 && (this.dispatchExternal("dataLoaded", u), this.table.rowManager.setData(u, n, typeof a > "u" ? !n : a))) : console.warn("Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made");
        }
      }).catch((h) => {
        console.error("Data Load Error: ", h), this.dispatchExternal("dataLoadError", h), s || this.alertError(), setTimeout(() => {
          this.clearAlert();
        }, this.table.options.dataLoaderErrorTimeout);
      }).finally(() => {
        this.loading = !1;
      });
    } else
      return this.dispatchExternal("dataLoaded", e), e || (e = []), this.table.rowManager.setData(e, n, typeof a > "u" ? !n : a), Promise.resolve();
  }
  mapParams(e, t) {
    var i = {};
    for (let n in e)
      i[t.hasOwnProperty(n) ? t[n] : n] = e[n];
    return i;
  }
  objectInvert(e) {
    var t = {};
    for (let i in e)
      t[e[i]] = i;
    return t;
  }
  blockActiveLoad() {
    this.requestOrder++;
  }
  alertLoader() {
    var e = typeof this.table.options.dataLoader == "function" ? this.table.options.dataLoader() : this.table.options.dataLoader;
    e && this.table.alertManager.alert(this.table.options.dataLoaderLoading || this.langText("data|loading"));
  }
  alertError() {
    this.table.alertManager.alert(this.table.options.dataLoaderError || this.langText("data|error"), "error");
  }
  clearAlert() {
    this.table.alertManager.clear();
  }
}
class Lw {
  constructor(e, t, i) {
    this.table = e, this.events = {}, this.optionsList = t || {}, this.subscriptionNotifiers = {}, this.dispatch = i ? this._debugDispatch.bind(this) : this._dispatch.bind(this), this.debug = i;
  }
  subscriptionChange(e, t) {
    this.subscriptionNotifiers[e] || (this.subscriptionNotifiers[e] = []), this.subscriptionNotifiers[e].push(t), this.subscribed(e) && this._notifySubscriptionChange(e, !0);
  }
  subscribe(e, t) {
    this.events[e] || (this.events[e] = []), this.events[e].push(t), this._notifySubscriptionChange(e, !0);
  }
  unsubscribe(e, t) {
    var i;
    if (this.events[e])
      if (t)
        if (i = this.events[e].findIndex((n) => n === t), i > -1)
          this.events[e].splice(i, 1);
        else {
          console.warn("Cannot remove event, no matching event found:", e, t);
          return;
        }
      else
        delete this.events[e];
    else {
      console.warn("Cannot remove event, no events set on:", e);
      return;
    }
    this._notifySubscriptionChange(e, !1);
  }
  subscribed(e) {
    return this.events[e] && this.events[e].length;
  }
  _notifySubscriptionChange(e, t) {
    var i = this.subscriptionNotifiers[e];
    i && i.forEach((n) => {
      n(t);
    });
  }
  _dispatch() {
    var e = Array.from(arguments), t = e.shift(), i;
    return this.events[t] && this.events[t].forEach((n, s) => {
      let a = n.apply(this.table, e);
      s || (i = a);
    }), i;
  }
  _debugDispatch() {
    var e = Array.from(arguments), t = e[0];
    return e[0] = "ExternalEvent:" + e[0], (this.debug === !0 || this.debug.includes(t)) && console.log(...e), this._dispatch(...arguments);
  }
}
class kw {
  constructor(e) {
    this.events = {}, this.subscriptionNotifiers = {}, this.dispatch = e ? this._debugDispatch.bind(this) : this._dispatch.bind(this), this.chain = e ? this._debugChain.bind(this) : this._chain.bind(this), this.confirm = e ? this._debugConfirm.bind(this) : this._confirm.bind(this), this.debug = e;
  }
  subscriptionChange(e, t) {
    this.subscriptionNotifiers[e] || (this.subscriptionNotifiers[e] = []), this.subscriptionNotifiers[e].push(t), this.subscribed(e) && this._notifySubscriptionChange(e, !0);
  }
  subscribe(e, t, i = 1e4) {
    this.events[e] || (this.events[e] = []), this.events[e].push({ callback: t, priority: i }), this.events[e].sort((n, s) => n.priority - s.priority), this._notifySubscriptionChange(e, !0);
  }
  unsubscribe(e, t) {
    var i;
    if (this.events[e]) {
      if (t)
        if (i = this.events[e].findIndex((n) => n.callback === t), i > -1)
          this.events[e].splice(i, 1);
        else {
          console.warn("Cannot remove event, no matching event found:", e, t);
          return;
        }
    } else {
      console.warn("Cannot remove event, no events set on:", e);
      return;
    }
    this._notifySubscriptionChange(e, !1);
  }
  subscribed(e) {
    return this.events[e] && this.events[e].length;
  }
  _chain(e, t, i, n) {
    var s = i;
    return Array.isArray(t) || (t = [t]), this.subscribed(e) ? (this.events[e].forEach((a, o) => {
      s = a.callback.apply(this, t.concat([s]));
    }), s) : typeof n == "function" ? n() : n;
  }
  _confirm(e, t) {
    var i = !1;
    return Array.isArray(t) || (t = [t]), this.subscribed(e) && this.events[e].forEach((n, s) => {
      n.callback.apply(this, t) && (i = !0);
    }), i;
  }
  _notifySubscriptionChange(e, t) {
    var i = this.subscriptionNotifiers[e];
    i && i.forEach((n) => {
      n(t);
    });
  }
  _dispatch() {
    var e = Array.from(arguments), t = e.shift();
    this.events[t] && this.events[t].forEach((i) => {
      i.callback.apply(this, e);
    });
  }
  _debugDispatch() {
    var e = Array.from(arguments), t = e[0];
    return e[0] = "InternalEvent:" + t, (this.debug === !0 || this.debug.includes(t)) && console.log(...e), this._dispatch(...arguments);
  }
  _debugChain() {
    var e = Array.from(arguments), t = e[0];
    return e[0] = "InternalEvent:" + t, (this.debug === !0 || this.debug.includes(t)) && console.log(...e), this._chain(...arguments);
  }
  _debugConfirm() {
    var e = Array.from(arguments), t = e[0];
    return e[0] = "InternalEvent:" + t, (this.debug === !0 || this.debug.includes(t)) && console.log(...e), this._confirm(...arguments);
  }
}
class Aw extends ke {
  constructor(e) {
    super(e);
  }
  _warnUser() {
    this.options("debugDeprecation") && console.warn(...arguments);
  }
  check(e, t, i) {
    var n = "";
    return typeof this.options(e) < "u" ? (n = "Deprecated Setup Option - Use of the %c" + e + "%c option is now deprecated", t ? (n = n + ", Please use the %c" + t + "%c option instead", this._warnUser(n, "font-weight: bold;", "font-weight: normal;", "font-weight: bold;", "font-weight: normal;"), i && (this.table.options[t] = this.table.options[e])) : this._warnUser(n, "font-weight: bold;", "font-weight: normal;"), !1) : !0;
  }
  checkMsg(e, t) {
    return typeof this.options(e) < "u" ? (this._warnUser("%cDeprecated Setup Option - Use of the %c" + e + " %c option is now deprecated, " + t, "font-weight: normal;", "font-weight: bold;", "font-weight: normal;"), !1) : !0;
  }
  msg(e) {
    this._warnUser(e);
  }
}
class Pw extends ke {
  constructor(e) {
    super(e), this.deps = {}, this.props = {};
  }
  initialize() {
    this.deps = Object.assign({}, this.options("dependencies"));
  }
  lookup(e, t, i) {
    if (Array.isArray(e)) {
      for (const s of e) {
        var n = this.lookup(s, t, !0);
        if (n)
          break;
      }
      if (n)
        return n;
      this.error(e);
    } else
      return t ? this.lookupProp(e, t, i) : this.lookupKey(e, i);
  }
  lookupProp(e, t, i) {
    var n;
    if (this.props[e] && this.props[e][t])
      return this.props[e][t];
    if (n = this.lookupKey(e, i), n)
      return this.props[e] || (this.props[e] = {}), this.props[e][t] = n[t] || n, this.props[e][t];
  }
  lookupKey(e, t) {
    var i;
    return this.deps[e] ? i = this.deps[e] : window[e] ? (this.deps[e] = window[e], i = this.deps[e]) : t || this.error(e), i;
  }
  error(e) {
    console.error("Unable to find dependency", e, "Please check documentation and ensure you have imported the required library into your project");
  }
}
function Ow(r, e) {
  e && this.table.columnManager.renderer.reinitializeColumnWidths(r), this.table.options.responsiveLayout && this.table.modExists("responsiveLayout", !0) && this.table.modules.responsiveLayout.update();
}
function od(r, e) {
  r.forEach(function(t) {
    t.reinitializeWidth();
  }), this.table.options.responsiveLayout && this.table.modExists("responsiveLayout", !0) && this.table.modules.responsiveLayout.update();
}
function Iw(r, e) {
  var t = 0, i = this.table.rowManager.element.clientWidth, n = 0, s = !1;
  r.forEach((a, o) => {
    a.widthFixed || a.reinitializeWidth(), (this.table.options.responsiveLayout ? a.modules.responsive.visible : a.visible) && (s = a), a.visible && (t += a.getWidth());
  }), s ? (n = i - t + s.getWidth(), this.table.options.responsiveLayout && this.table.modExists("responsiveLayout", !0) && (s.setWidth(0), this.table.modules.responsiveLayout.update()), n > 0 ? s.setWidth(n) : s.reinitializeWidth()) : this.table.options.responsiveLayout && this.table.modExists("responsiveLayout", !0) && this.table.modules.responsiveLayout.update();
}
function zw(r, e) {
  var t = this.table.rowManager.element.getBoundingClientRect().width, i = 0, n = 0, s = 0, a = 0, o = [], l = [], h = 0, u = 0, d = 0;
  function c(p) {
    var m;
    return typeof p == "string" ? p.indexOf("%") > -1 ? m = t / 100 * parseInt(p) : m = parseInt(p) : m = p, m;
  }
  function f(p, m, g, v) {
    var b = [], y = 0, w = 0, _ = 0, E = s, x = 0, T = 0, C = [];
    function S(D) {
      return g * (D.column.definition.widthGrow || 1);
    }
    function R(D) {
      return c(D.width) - g * (D.column.definition.widthShrink || 0);
    }
    return p.forEach(function(D, k) {
      var L = v ? R(D) : S(D);
      D.column.minWidth >= L ? b.push(D) : D.column.maxWidth && D.column.maxWidth < L ? (D.width = D.column.maxWidth, m -= D.column.maxWidth, E -= v ? D.column.definition.widthShrink || 1 : D.column.definition.widthGrow || 1, E && (g = Math.floor(m / E))) : (C.push(D), T += v ? D.column.definition.widthShrink || 1 : D.column.definition.widthGrow || 1);
    }), b.length ? (b.forEach(function(D) {
      y += v ? D.width - D.column.minWidth : D.column.minWidth, D.width = D.column.minWidth;
    }), w = m - y, _ = T ? Math.floor(w / T) : w, x = f(C, w, _, v)) : (x = T ? m - Math.floor(m / T) * T : m, C.forEach(function(D) {
      D.width = v ? R(D) : S(D);
    })), x;
  }
  this.table.options.responsiveLayout && this.table.modExists("responsiveLayout", !0) && this.table.modules.responsiveLayout.update(), this.table.rowManager.element.scrollHeight > this.table.rowManager.element.clientHeight && (t -= this.table.rowManager.element.offsetWidth - this.table.rowManager.element.clientWidth), r.forEach(function(p) {
    var m, g, v;
    p.visible && (m = p.definition.width, g = parseInt(p.minWidth), m ? (v = c(m), i += v > g ? v : g, p.definition.widthShrink && (l.push({
      column: p,
      width: v > g ? v : g
    }), h += p.definition.widthShrink)) : (o.push({
      column: p,
      width: 0
    }), s += p.definition.widthGrow || 1));
  }), n = t - i, a = Math.floor(n / s), d = f(o, n, a, !1), o.length && d > 0 && (o[o.length - 1].width += d), o.forEach(function(p) {
    n -= p.width;
  }), u = Math.abs(d) + n, u > 0 && h && (d = f(l, u, Math.floor(u / h), !0)), d && l.length && (l[l.length - 1].width -= d), o.forEach(function(p) {
    p.column.setWidth(p.width);
  }), l.forEach(function(p) {
    p.column.setWidth(p.width);
  });
}
var Fw = {
  fitData: Ow,
  fitDataFill: od,
  fitDataTable: od,
  fitDataStretch: Iw,
  fitColumns: zw
};
const Br = class Br extends U {
  constructor(e) {
    super(e, "layout"), this.mode = null, this.registerTableOption("layout", "fitData"), this.registerTableOption("layoutColumnsOnNewData", !1), this.registerColumnOption("widthGrow"), this.registerColumnOption("widthShrink");
  }
  //initialize layout system
  initialize() {
    var e = this.table.options.layout;
    Br.modes[e] ? this.mode = e : (console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : " + e), this.mode = "fitData"), this.table.element.setAttribute("tabulator-layout", this.mode), this.subscribe("column-init", this.initializeColumn.bind(this));
  }
  initializeColumn(e) {
    e.definition.widthGrow && (e.definition.widthGrow = Number(e.definition.widthGrow)), e.definition.widthShrink && (e.definition.widthShrink = Number(e.definition.widthShrink));
  }
  getMode() {
    return this.mode;
  }
  //trigger table layout
  layout(e) {
    var t = this.table.columnManager.columnsByIndex.find((i) => i.definition.variableHeight || i.definition.formatter === "textarea");
    this.dispatch("layout-refreshing"), Br.modes[this.mode].call(this, this.table.columnManager.columnsByIndex, e), t && this.table.rowManager.normalizeHeight(!0), this.dispatch("layout-refreshed");
  }
};
A(Br, "moduleName", "layout"), //load defaults
A(Br, "modes", Fw);
let nh = Br;
var Hw = {
  default: {
    //hold default locale text
    groups: {
      item: "item",
      items: "items"
    },
    columns: {},
    data: {
      loading: "Loading",
      error: "Error"
    },
    pagination: {
      page_size: "Page Size",
      page_title: "Show Page",
      first: "First",
      first_title: "First Page",
      last: "Last",
      last_title: "Last Page",
      prev: "Prev",
      prev_title: "Prev Page",
      next: "Next",
      next_title: "Next Page",
      all: "All",
      counter: {
        showing: "Showing",
        of: "of",
        rows: "rows",
        pages: "pages"
      }
    },
    headerFilters: {
      default: "filter column...",
      columns: {}
    }
  }
};
const rs = class rs extends U {
  constructor(e) {
    super(e), this.locale = "default", this.lang = !1, this.bindings = {}, this.langList = {}, this.registerTableOption("locale", !1), this.registerTableOption("langs", {});
  }
  initialize() {
    this.langList = de.deepClone(rs.langs), this.table.options.columnDefaults.headerFilterPlaceholder !== !1 && this.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder);
    for (let e in this.table.options.langs)
      this.installLang(e, this.table.options.langs[e]);
    this.setLocale(this.table.options.locale), this.registerTableFunction("setLocale", this.setLocale.bind(this)), this.registerTableFunction("getLocale", this.getLocale.bind(this)), this.registerTableFunction("getLang", this.getLang.bind(this));
  }
  //set header placeholder
  setHeaderFilterPlaceholder(e) {
    this.langList.default.headerFilters.default = e;
  }
  //setup a lang description object
  installLang(e, t) {
    this.langList[e] ? this._setLangProp(this.langList[e], t) : this.langList[e] = t;
  }
  _setLangProp(e, t) {
    for (let i in t)
      e[i] && typeof e[i] == "object" ? this._setLangProp(e[i], t[i]) : e[i] = t[i];
  }
  //set current locale
  setLocale(e) {
    e = e || "default";
    function t(i, n) {
      for (var s in i)
        typeof i[s] == "object" ? (n[s] || (n[s] = {}), t(i[s], n[s])) : n[s] = i[s];
    }
    if (e === !0 && navigator.language && (e = navigator.language.toLowerCase()), e && !this.langList[e]) {
      let i = e.split("-")[0];
      this.langList[i] ? (console.warn("Localization Error - Exact matching locale not found, using closest match: ", e, i), e = i) : (console.warn("Localization Error - Matching locale not found, using default: ", e), e = "default");
    }
    this.locale = e, this.lang = de.deepClone(this.langList.default || {}), e != "default" && t(this.langList[e], this.lang), this.dispatchExternal("localized", this.locale, this.lang), this._executeBindings();
  }
  //get current locale
  getLocale(e) {
    return this.locale;
  }
  //get lang object for given local or current if none provided
  getLang(e) {
    return e ? this.langList[e] : this.lang;
  }
  //get text for current locale
  getText(e, t) {
    var i = t ? e + "|" + t : e, n = i.split("|"), s = this._getLangElement(n, this.locale);
    return s || "";
  }
  //traverse langs object and find localized copy
  _getLangElement(e, t) {
    var i = this.lang;
    return e.forEach(function(n) {
      var s;
      i && (s = i[n], typeof s < "u" ? i = s : i = !1);
    }), i;
  }
  //set update binding
  bind(e, t) {
    this.bindings[e] || (this.bindings[e] = []), this.bindings[e].push(t), t(this.getText(e), this.lang);
  }
  //iterate through bindings and trigger updates
  _executeBindings() {
    for (let e in this.bindings)
      this.bindings[e].forEach((t) => {
        t(this.getText(e), this.lang);
      });
  }
};
A(rs, "moduleName", "localize"), //load defaults
A(rs, "langs", Hw);
let sh = rs;
class Jp extends U {
  constructor(e) {
    super(e);
  }
  initialize() {
    this.registerTableFunction("tableComms", this.receive.bind(this));
  }
  getConnections(e) {
    var t = [], i;
    return i = this.table.constructor.registry.lookupTable(e), i.forEach((n) => {
      this.table !== n && t.push(n);
    }), t;
  }
  send(e, t, i, n) {
    var s = this.getConnections(e);
    s.forEach((a) => {
      a.tableComms(this.table.element, t, i, n);
    }), !s.length && e && console.warn("Table Connection Error - No tables matching selector found", e);
  }
  receive(e, t, i, n) {
    if (this.table.modExists(t))
      return this.table.modules[t].commsReceived(e, i, n);
    console.warn("Inter-table Comms Error - no such module:", t);
  }
}
A(Jp, "moduleName", "comms");
var Nw = /* @__PURE__ */ Object.freeze({
  __proto__: null,
  CommsModule: Jp,
  LayoutModule: nh,
  LocalizeModule: sh
});
const it = class it {
  static findTable(e) {
    var t = it.registry.lookupTable(e, !0);
    return Array.isArray(t) && !t.length ? !1 : t;
  }
};
A(it, "registry", {
  tables: [],
  register(e) {
    it.registry.tables.push(e);
  },
  deregister(e) {
    var t = it.registry.tables.indexOf(e);
    t > -1 && it.registry.tables.splice(t, 1);
  },
  lookupTable(e, t) {
    var i = [], n, s;
    if (typeof e == "string") {
      if (n = document.querySelectorAll(e), n.length)
        for (var a = 0; a < n.length; a++)
          s = it.registry.matchElement(n[a]), s && i.push(s);
    } else typeof HTMLElement < "u" && e instanceof HTMLElement || e instanceof it ? (s = it.registry.matchElement(e), s && i.push(s)) : Array.isArray(e) ? e.forEach(function(o) {
      i = i.concat(it.registry.lookupTable(o));
    }) : t || console.warn("Table Connection Error - Invalid Selector", e);
    return i;
  },
  matchElement(e) {
    return it.registry.tables.find(function(t) {
      return e instanceof it ? t === e : t.element === e;
    });
  }
});
let ah = it;
const se = class se extends ah {
  constructor() {
    super();
  }
  static initializeModuleBinder(e) {
    se.modulesRegistered || (se.modulesRegistered = !0, se._registerModules(Nw, !0), e && se._registerModules(e));
  }
  static _extendModule(e, t, i) {
    if (se.moduleBindings[e]) {
      var n = se.moduleBindings[e][t];
      if (n)
        if (typeof i == "object")
          for (let s in i)
            n[s] = i[s];
        else
          console.warn("Module Error - Invalid value type, it must be an object");
      else
        console.warn("Module Error - property does not exist:", t);
    } else
      console.warn("Module Error - module does not exist:", e);
  }
  static _registerModules(e, t) {
    var i = Object.values(e);
    t && i.forEach((n) => {
      n.prototype.moduleCore = !0;
    }), se._registerModule(i);
  }
  static _registerModule(e) {
    Array.isArray(e) || (e = [e]), e.forEach((t) => {
      se._registerModuleBinding(t), se._registerModuleExtensions(t);
    });
  }
  static _registerModuleBinding(e) {
    e.moduleName ? se.moduleBindings[e.moduleName] = e : console.error("Unable to bind module, no moduleName defined", e.moduleName);
  }
  static _registerModuleExtensions(e) {
    var t = e.moduleExtensions;
    if (e.moduleExtensions)
      for (let i in t) {
        let n = t[i];
        if (se.moduleBindings[i])
          for (let s in n)
            se._extendModule(i, s, n[s]);
        else {
          se.moduleExtensions[i] || (se.moduleExtensions[i] = {});
          for (let s in n)
            se.moduleExtensions[i][s] || (se.moduleExtensions[i][s] = {}), Object.assign(se.moduleExtensions[i][s], n[s]);
        }
      }
    se._extendModuleFromQueue(e);
  }
  static _extendModuleFromQueue(e) {
    var t = se.moduleExtensions[e.moduleName];
    if (t)
      for (let i in t)
        se._extendModule(e.moduleName, i, t[i]);
  }
  //ensure that module are bound to instantiated function
  _bindModules() {
    var e = [], t = [], i = [];
    this.modules = {};
    for (var n in se.moduleBindings) {
      let s = se.moduleBindings[n], a = new s(this);
      this.modules[n] = a, s.prototype.moduleCore ? this.modulesCore.push(a) : s.moduleInitOrder ? s.moduleInitOrder < 0 ? e.push(a) : t.push(a) : i.push(a);
    }
    e.sort((s, a) => s.moduleInitOrder > a.moduleInitOrder ? 1 : -1), t.sort((s, a) => s.moduleInitOrder > a.moduleInitOrder ? 1 : -1), this.modulesRegular = e.concat(i.concat(t));
  }
};
A(se, "moduleBindings", {}), A(se, "moduleExtensions", {}), A(se, "modulesRegistered", !1), A(se, "defaultModules", !1);
let oh = se;
class Bw extends ke {
  constructor(e) {
    super(e), this.element = this._createAlertElement(), this.msgElement = this._createMsgElement(), this.type = null, this.element.appendChild(this.msgElement);
  }
  _createAlertElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-alert"), e;
  }
  _createMsgElement() {
    var e = document.createElement("div");
    return e.classList.add("tabulator-alert-msg"), e.setAttribute("role", "alert"), e;
  }
  _typeClass() {
    return "tabulator-alert-state-" + this.type;
  }
  alert(e, t = "msg") {
    if (e) {
      for (this.clear(), this.dispatch("alert-show", t), this.type = t; this.msgElement.firstChild; ) this.msgElement.removeChild(this.msgElement.firstChild);
      this.msgElement.classList.add(this._typeClass()), typeof e == "function" && (e = e()), e instanceof HTMLElement ? this.msgElement.appendChild(e) : this.msgElement.innerHTML = e, this.table.element.appendChild(this.element);
    }
  }
  clear() {
    this.dispatch("alert-hide", this.type), this.element.parentNode && this.element.parentNode.removeChild(this.element), this.msgElement.classList.remove(this._typeClass());
  }
}
const qt = class qt extends oh {
  static extendModule() {
    qt.initializeModuleBinder(), qt._extendModule(...arguments);
  }
  static registerModule() {
    qt.initializeModuleBinder(), qt._registerModule(...arguments);
  }
  constructor(e, t, i) {
    super(), qt.initializeModuleBinder(i), this.options = {}, this.columnManager = null, this.rowManager = null, this.footerManager = null, this.alertManager = null, this.vdomHoz = null, this.externalEvents = null, this.eventBus = null, this.interactionMonitor = !1, this.browser = "", this.browserSlow = !1, this.browserMobile = !1, this.rtl = !1, this.originalElement = null, this.componentFunctionBinder = new Mw(this), this.dataLoader = !1, this.modules = {}, this.modulesCore = [], this.modulesRegular = [], this.deprecationAdvisor = new Aw(this), this.optionsList = new Zp(this, "table constructor"), this.dependencyRegistry = new Pw(this), this.initialized = !1, this.destroyed = !1, this.initializeElement(e) && (this.initializeCoreSystems(t), setTimeout(() => {
      this._create();
    })), this.constructor.registry.register(this);
  }
  initializeElement(e) {
    return typeof HTMLElement < "u" && e instanceof HTMLElement ? (this.element = e, !0) : typeof e == "string" ? (this.element = document.querySelector(e), this.element ? !0 : (console.error("Tabulator Creation Error - no element found matching selector: ", e), !1)) : (console.error("Tabulator Creation Error - Invalid element provided:", e), !1);
  }
  initializeCoreSystems(e) {
    this.columnManager = new _w(this), this.rowManager = new xw(this), this.footerManager = new Sw(this), this.dataLoader = new Dw(this), this.alertManager = new Bw(this), this._bindModules(), this.options = this.optionsList.generate(qt.defaultOptions, e), this._clearObjectPointers(), this._mapDeprecatedFunctionality(), this.externalEvents = new Lw(this, this.options, this.options.debugEventsExternal), this.eventBus = new kw(this.options.debugEventsInternal), this.interactionMonitor = new Rw(this), this.dataLoader.initialize(), this.footerManager.initialize(), this.dependencyRegistry.initialize();
  }
  //convert deprecated functionality to new functions
  _mapDeprecatedFunctionality() {
  }
  _clearSelection() {
    this.element.classList.add("tabulator-block-select"), window.getSelection ? window.getSelection().empty ? window.getSelection().empty() : window.getSelection().removeAllRanges && window.getSelection().removeAllRanges() : document.selection && document.selection.empty(), this.element.classList.remove("tabulator-block-select");
  }
  //create table
  _create() {
    this.externalEvents.dispatch("tableBuilding"), this.eventBus.dispatch("table-building"), this._rtlCheck(), this._buildElement(), this._initializeTable(), this.initialized = !0, this._loadInitialData().finally(() => {
      this.eventBus.dispatch("table-initialized"), this.externalEvents.dispatch("tableBuilt");
    });
  }
  _rtlCheck() {
    var e = window.getComputedStyle(this.element);
    switch (this.options.textDirection) {
      case "auto":
        if (e.direction !== "rtl")
          break;
      case "rtl":
        this.element.classList.add("tabulator-rtl"), this.rtl = !0;
        break;
      case "ltr":
        this.element.classList.add("tabulator-ltr");
      default:
        this.rtl = !1;
    }
  }
  //clear pointers to objects in default config object
  _clearObjectPointers() {
    this.options.columns = this.options.columns.slice(0), Array.isArray(this.options.data) && !this.options.reactiveData && (this.options.data = this.options.data.slice(0));
  }
  //build tabulator element
  _buildElement() {
    var e = this.element, t = this.options, i;
    if (e.tagName === "TABLE") {
      this.originalElement = this.element, i = document.createElement("div");
      var n = e.attributes;
      for (var s in n)
        typeof n[s] == "object" && i.setAttribute(n[s].name, n[s].value);
      e.parentNode.replaceChild(i, e), this.element = e = i;
    }
    for (e.classList.add("tabulator"), e.setAttribute("role", "grid"); e.firstChild; ) e.removeChild(e.firstChild);
    t.height && (t.height = isNaN(t.height) ? t.height : t.height + "px", e.style.height = t.height), t.minHeight !== !1 && (t.minHeight = isNaN(t.minHeight) ? t.minHeight : t.minHeight + "px", e.style.minHeight = t.minHeight), t.maxHeight !== !1 && (t.maxHeight = isNaN(t.maxHeight) ? t.maxHeight : t.maxHeight + "px", e.style.maxHeight = t.maxHeight);
  }
  //initialize core systems and modules
  _initializeTable() {
    var e = this.element, t = this.options;
    this.interactionMonitor.initialize(), this.columnManager.initialize(), this.rowManager.initialize(), this._detectBrowser(), this.modulesCore.forEach((i) => {
      i.initialize();
    }), e.appendChild(this.columnManager.getElement()), e.appendChild(this.rowManager.getElement()), t.footerElement && this.footerManager.activate(), t.autoColumns && t.data && this.columnManager.generateColumnsFromRowData(this.options.data), this.modulesRegular.forEach((i) => {
      i.initialize();
    }), this.columnManager.setColumns(t.columns), this.eventBus.dispatch("table-built");
  }
  _loadInitialData() {
    return this.dataLoader.load(this.options.data).finally(() => {
      this.columnManager.verticalAlignHeaders();
    });
  }
  //deconstructor
  destroy() {
    var e = this.element;
    for (this.destroyed = !0, this.constructor.registry.deregister(this), this.eventBus.dispatch("table-destroy"), this.rowManager.destroy(); e.firstChild; ) e.removeChild(e.firstChild);
    e.classList.remove("tabulator"), this.externalEvents.dispatch("tableDestroyed");
  }
  _detectBrowser() {
    var e = navigator.userAgent || navigator.vendor || window.opera;
    e.indexOf("Trident") > -1 ? (this.browser = "ie", this.browserSlow = !0) : e.indexOf("Edge") > -1 ? (this.browser = "edge", this.browserSlow = !0) : e.indexOf("Firefox") > -1 ? (this.browser = "firefox", this.browserSlow = !1) : e.indexOf("Mac OS") > -1 ? (this.browser = "safari", this.browserSlow = !1) : (this.browser = "other", this.browserSlow = !1), this.browserMobile = /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.slice(0, 4));
  }
  initGuard(e, t) {
    var i, n;
    return this.options.debugInitialization && !this.initialized && (e || (i = new Error().stack.split(`
`), n = i[0] == "Error" ? i[2] : i[1], n[0] == " " ? e = n.trim().split(" ")[1].split(".")[1] : e = n.trim().split("@")[0]), console.warn("Table Not Initialized - Calling the " + e + " function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function." + (t ? " " + t : ""))), this.initialized;
  }
  ////////////////// Data Handling //////////////////
  //block table redrawing
  blockRedraw() {
    this.initGuard(), this.eventBus.dispatch("redraw-blocking"), this.rowManager.blockRedraw(), this.columnManager.blockRedraw(), this.eventBus.dispatch("redraw-blocked");
  }
  //restore table redrawing
  restoreRedraw() {
    this.initGuard(), this.eventBus.dispatch("redraw-restoring"), this.rowManager.restoreRedraw(), this.columnManager.restoreRedraw(), this.eventBus.dispatch("redraw-restored");
  }
  //load data
  setData(e, t, i) {
    return this.initGuard(!1, "To set initial data please use the 'data' property in the table constructor."), this.dataLoader.load(e, t, i, !1);
  }
  //clear data
  clearData() {
    this.initGuard(), this.dataLoader.blockActiveLoad(), this.rowManager.clearData();
  }
  //get table data array
  getData(e) {
    return this.rowManager.getData(e);
  }
  //get table data array count
  getDataCount(e) {
    return this.rowManager.getDataCount(e);
  }
  //replace data, keeping table in position with same sort
  replaceData(e, t, i) {
    return this.initGuard(), this.dataLoader.load(e, t, i, !0, !0);
  }
  //update table data
  updateData(e) {
    var t = 0;
    return this.initGuard(), new Promise((i, n) => {
      this.dataLoader.blockActiveLoad(), typeof e == "string" && (e = JSON.parse(e)), e && e.length > 0 ? e.forEach((s) => {
        var a = this.rowManager.findRow(s[this.options.index]);
        a ? (t++, a.updateData(s).then(() => {
          t--, t || i();
        }).catch((o) => {
          n("Update Error - Unable to update row", s, o);
        })) : n("Update Error - Unable to find row", s);
      }) : (console.warn("Update Error - No data provided"), n("Update Error - No data provided"));
    });
  }
  addData(e, t, i) {
    return this.initGuard(), new Promise((n, s) => {
      this.dataLoader.blockActiveLoad(), typeof e == "string" && (e = JSON.parse(e)), e ? this.rowManager.addRows(e, t, i).then((a) => {
        var o = [];
        a.forEach(function(l) {
          o.push(l.getComponent());
        }), n(o);
      }) : (console.warn("Update Error - No data provided"), s("Update Error - No data provided"));
    });
  }
  //update table data
  updateOrAddData(e) {
    var t = [], i = 0;
    return this.initGuard(), new Promise((n, s) => {
      this.dataLoader.blockActiveLoad(), typeof e == "string" && (e = JSON.parse(e)), e && e.length > 0 ? e.forEach((a) => {
        var o = this.rowManager.findRow(a[this.options.index]);
        i++, o ? o.updateData(a).then(() => {
          i--, t.push(o.getComponent()), i || n(t);
        }) : this.rowManager.addRows(a).then((l) => {
          i--, t.push(l[0].getComponent()), i || n(t);
        });
      }) : (console.warn("Update Error - No data provided"), s("Update Error - No data provided"));
    });
  }
  //get row object
  getRow(e) {
    var t = this.rowManager.findRow(e);
    return t ? t.getComponent() : (console.warn("Find Error - No matching row found:", e), !1);
  }
  //get row object
  getRowFromPosition(e) {
    var t = this.rowManager.getRowFromPosition(e);
    return t ? t.getComponent() : (console.warn("Find Error - No matching row found:", e), !1);
  }
  //delete row from table
  deleteRow(e) {
    var t = [];
    this.initGuard(), Array.isArray(e) || (e = [e]);
    for (let i of e) {
      let n = this.rowManager.findRow(i, !0);
      if (n)
        t.push(n);
      else
        return console.error("Delete Error - No matching row found:", i), Promise.reject("Delete Error - No matching row found");
    }
    return t.sort((i, n) => this.rowManager.rows.indexOf(i) > this.rowManager.rows.indexOf(n) ? 1 : -1), t.forEach((i) => {
      i.delete();
    }), this.rowManager.reRenderInPosition(), Promise.resolve();
  }
  //add row to table
  addRow(e, t, i) {
    return this.initGuard(), typeof e == "string" && (e = JSON.parse(e)), this.rowManager.addRows(e, t, i, !0).then((n) => n[0].getComponent());
  }
  //update a row if it exists otherwise create it
  updateOrAddRow(e, t) {
    var i = this.rowManager.findRow(e);
    return this.initGuard(), typeof t == "string" && (t = JSON.parse(t)), i ? i.updateData(t).then(() => i.getComponent()) : this.rowManager.addRows(t).then((n) => n[0].getComponent());
  }
  //update row data
  updateRow(e, t) {
    var i = this.rowManager.findRow(e);
    return this.initGuard(), typeof t == "string" && (t = JSON.parse(t)), i ? i.updateData(t).then(() => Promise.resolve(i.getComponent())) : (console.warn("Update Error - No matching row found:", e), Promise.reject("Update Error - No matching row found"));
  }
  //scroll to row in DOM
  scrollToRow(e, t, i) {
    var n = this.rowManager.findRow(e);
    return n ? this.rowManager.scrollToRow(n, t, i) : (console.warn("Scroll Error - No matching row found:", e), Promise.reject("Scroll Error - No matching row found"));
  }
  moveRow(e, t, i) {
    var n = this.rowManager.findRow(e);
    this.initGuard(), n ? n.moveToRow(t, i) : console.warn("Move Error - No matching row found:", e);
  }
  getRows(e) {
    return this.rowManager.getComponents(e);
  }
  //get position of row in table
  getRowPosition(e) {
    var t = this.rowManager.findRow(e);
    return t ? t.getPosition() : (console.warn("Position Error - No matching row found:", e), !1);
  }
  /////////////// Column Functions  ///////////////
  setColumns(e) {
    this.initGuard(!1, "To set initial columns please use the 'columns' property in the table constructor"), this.columnManager.setColumns(e);
  }
  getColumns(e) {
    return this.columnManager.getComponents(e);
  }
  getColumn(e) {
    var t = this.columnManager.findColumn(e);
    return t ? t.getComponent() : (console.warn("Find Error - No matching column found:", e), !1);
  }
  getColumnDefinitions() {
    return this.columnManager.getDefinitionTree();
  }
  showColumn(e) {
    var t = this.columnManager.findColumn(e);
    if (this.initGuard(), t)
      t.show();
    else
      return console.warn("Column Show Error - No matching column found:", e), !1;
  }
  hideColumn(e) {
    var t = this.columnManager.findColumn(e);
    if (this.initGuard(), t)
      t.hide();
    else
      return console.warn("Column Hide Error - No matching column found:", e), !1;
  }
  toggleColumn(e) {
    var t = this.columnManager.findColumn(e);
    if (this.initGuard(), t)
      t.visible ? t.hide() : t.show();
    else
      return console.warn("Column Visibility Toggle Error - No matching column found:", e), !1;
  }
  addColumn(e, t, i) {
    var n = this.columnManager.findColumn(i);
    return this.initGuard(), this.columnManager.addColumn(e, t, n).then((s) => s.getComponent());
  }
  deleteColumn(e) {
    var t = this.columnManager.findColumn(e);
    return this.initGuard(), t ? t.delete() : (console.warn("Column Delete Error - No matching column found:", e), Promise.reject());
  }
  updateColumnDefinition(e, t) {
    var i = this.columnManager.findColumn(e);
    return this.initGuard(), i ? i.updateDefinition(t) : (console.warn("Column Update Error - No matching column found:", e), Promise.reject());
  }
  moveColumn(e, t, i) {
    var n = this.columnManager.findColumn(e), s = this.columnManager.findColumn(t);
    this.initGuard(), n ? s ? this.columnManager.moveColumn(n, s, i) : console.warn("Move Error - No matching column found:", s) : console.warn("Move Error - No matching column found:", e);
  }
  //scroll to column in DOM
  scrollToColumn(e, t, i) {
    return new Promise((n, s) => {
      var a = this.columnManager.findColumn(e);
      return a ? this.columnManager.scrollToColumn(a, t, i) : (console.warn("Scroll Error - No matching column found:", e), Promise.reject("Scroll Error - No matching column found"));
    });
  }
  //////////// General Public Functions ////////////
  //redraw list without updating data
  redraw(e) {
    this.initGuard(), this.columnManager.redraw(e), this.rowManager.redraw(e);
  }
  setHeight(e) {
    this.options.height = isNaN(e) ? e : e + "px", this.element.style.height = this.options.height, this.rowManager.initializeRenderer(), this.rowManager.redraw(!0);
  }
  //////////////////// Event Bus ///////////////////
  on(e, t) {
    this.externalEvents.subscribe(e, t);
  }
  off(e, t) {
    this.externalEvents.unsubscribe(e, t);
  }
  dispatchEvent() {
    var e = Array.from(arguments);
    e.shift(), this.externalEvents.dispatch(...arguments);
  }
  //////////////////// Alerts ///////////////////
  alert(e, t) {
    this.initGuard(), this.alertManager.alert(e, t);
  }
  clearAlert() {
    this.initGuard(), this.alertManager.clear();
  }
  ////////////// Extension Management //////////////
  modExists(e, t) {
    return this.modules[e] ? !0 : (t && console.error("Tabulator Module Not Installed: " + e), !1);
  }
  module(e) {
    var t = this.modules[e];
    return t || console.error("Tabulator module not installed: " + e), t;
  }
};
//default setup options
A(qt, "defaultOptions", yw);
let lh = qt;
var un = lh;
class Vw extends un {
  static extendModule() {
    un.initializeModuleBinder(yo), un._extendModule(...arguments);
  }
  static registerModule() {
    un.initializeModuleBinder(yo), un._registerModule(...arguments);
  }
  constructor(e, t, i) {
    super(e, t, yo);
  }
}
var Ww = Vw;
function Gw(r) {
  const { data: e, columns: t, isSuccess: i, placeholder: n = "No data available", rowFormatter: s, dataTree: a, dataTreeStartExpanded: o } = r, l = Qs(null), h = Qs(!1), u = Qs(null);
  function d() {
    var f;
    if (!l.value || h.value) {
      console.log("âš ï¸ Cannot initialize: div exists?", !!l.value, "already initialized?", h.value);
      return;
    }
    if (l.value.offsetParent === null) {
      console.log("âš ï¸ Table div is not visible, skipping initialization");
      return;
    }
    console.log("ðŸš€ Initializing Tabulator with data:", (f = e.value) == null ? void 0 : f.length, "rows");
    const c = {
      data: e.value || [],
      columns: t,
      layout: "fitColumns",
      placeholder: n,
      height: "100%",
      reactiveData: !0
    };
    s && (c.rowFormatter = s), a !== void 0 && (c.dataTree = a), o !== void 0 && (c.dataTreeStartExpanded = o), u.value = new Ww(l.value, c), h.value = !0, console.log("âœ… Tabulator initialized");
  }
  return Vr(
    [i, l],
    async ([c, f]) => {
      console.log("ðŸ‘€ Tabulator watch triggered:", { success: c, hasElement: !!f, initialized: h.value }), c && f && !h.value && (await Tp(), f.offsetParent !== null ? (console.log("ðŸš€ Initializing from watcher"), d()) : (console.log("â¸ï¸ Element not visible yet, will retry"), setTimeout(() => {
        f.offsetParent !== null && !h.value && (console.log("ðŸš€ Initializing after visibility check"), d());
      }, 100)));
    },
    { immediate: !0 }
  ), Vr(
    () => e.value,
    (c) => {
      u.value && c && (console.log("ðŸ”„ Updating Tabulator data:", c.length, "rows"), u.value.setData(c));
    }
  ), {
    tableDiv: l,
    tabulator: u,
    initializeTabulator: d,
    isTableInitialized: h
  };
}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var hh = function(r, e) {
  return hh = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t, i) {
    t.__proto__ = i;
  } || function(t, i) {
    for (var n in i) Object.prototype.hasOwnProperty.call(i, n) && (t[n] = i[n]);
  }, hh(r, e);
};
function De(r, e) {
  if (typeof e != "function" && e !== null)
    throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
  hh(r, e);
  function t() {
    this.constructor = r;
  }
  r.prototype = e === null ? Object.create(e) : (t.prototype = e.prototype, new t());
}
var Uw = /* @__PURE__ */ function() {
  function r() {
    this.firefox = !1, this.ie = !1, this.edge = !1, this.newEdge = !1, this.weChat = !1;
  }
  return r;
}(), jw = /* @__PURE__ */ function() {
  function r() {
    this.browser = new Uw(), this.node = !1, this.wxa = !1, this.worker = !1, this.svgSupported = !1, this.touchEventsSupported = !1, this.pointerEventsSupported = !1, this.domSupported = !1, this.transformSupported = !1, this.transform3dSupported = !1, this.hasGlobalWindow = typeof window < "u";
  }
  return r;
}(), W = new jw();
typeof wx == "object" && typeof wx.getSystemInfoSync == "function" ? (W.wxa = !0, W.touchEventsSupported = !0) : typeof document > "u" && typeof self < "u" ? W.worker = !0 : !W.hasGlobalWindow || "Deno" in window ? (W.node = !0, W.svgSupported = !0) : Yw(navigator.userAgent, W);
function Yw(r, e) {
  var t = e.browser, i = r.match(/Firefox\/([\d.]+)/), n = r.match(/MSIE\s([\d.]+)/) || r.match(/Trident\/.+?rv:(([\d.]+))/), s = r.match(/Edge?\/([\d.]+)/), a = /micromessenger/i.test(r);
  i && (t.firefox = !0, t.version = i[1]), n && (t.ie = !0, t.version = n[1]), s && (t.edge = !0, t.version = s[1], t.newEdge = +s[1].split(".")[0] > 18), a && (t.weChat = !0), e.svgSupported = typeof SVGRect < "u", e.touchEventsSupported = "ontouchstart" in window && !t.ie && !t.edge, e.pointerEventsSupported = "onpointerdown" in window && (t.edge || t.ie && +t.version >= 11), e.domSupported = typeof document < "u";
  var o = document.documentElement.style;
  e.transform3dSupported = (t.ie && "transition" in o || t.edge || "WebKitCSSMatrix" in window && "m11" in new WebKitCSSMatrix() || "MozPerspective" in o) && !("OTransition" in o), e.transformSupported = e.transform3dSupported || t.ie && +t.version >= 9;
}
var au = 12, Xw = "sans-serif", dr = au + "px " + Xw, $w = 20, qw = 100, Kw = "007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";
function Zw(r) {
  var e = {};
  if (typeof JSON > "u")
    return e;
  for (var t = 0; t < r.length; t++) {
    var i = String.fromCharCode(t + 32), n = (r.charCodeAt(t) - $w) / qw;
    e[i] = n;
  }
  return e;
}
var Jw = Zw(Kw), Qr = {
  createCanvas: function() {
    return typeof document < "u" && document.createElement("canvas");
  },
  measureText: /* @__PURE__ */ function() {
    var r, e;
    return function(t, i) {
      if (!r) {
        var n = Qr.createCanvas();
        r = n && n.getContext("2d");
      }
      if (r)
        return e !== i && (e = r.font = i || dr), r.measureText(t);
      t = t || "", i = i || dr;
      var s = /((?:\d+)?\.?\d*)px/.exec(i), a = s && +s[1] || au, o = 0;
      if (i.indexOf("mono") >= 0)
        o = a * t.length;
      else
        for (var l = 0; l < t.length; l++) {
          var h = Jw[t[l]];
          o += h == null ? a : h * a;
        }
      return { width: o };
    };
  }(),
  loadImage: function(r, e, t) {
    var i = new Image();
    return i.onload = e, i.onerror = t, i.src = r, i;
  }
}, Qp = tn([
  "Function",
  "RegExp",
  "Date",
  "Error",
  "CanvasGradient",
  "CanvasPattern",
  "Image",
  "Canvas"
], function(r, e) {
  return r["[object " + e + "]"] = !0, r;
}, {}), eg = tn([
  "Int8",
  "Uint8",
  "Uint8Clamped",
  "Int16",
  "Uint16",
  "Int32",
  "Uint32",
  "Float32",
  "Float64"
], function(r, e) {
  return r["[object " + e + "Array]"] = !0, r;
}, {}), en = Object.prototype.toString, qa = Array.prototype, Qw = qa.forEach, e0 = qa.filter, ou = qa.slice, t0 = qa.map, ld = (function() {
}).constructor, Cs = ld ? ld.prototype : null, lu = "__proto__", i0 = 2311;
function tg() {
  return i0++;
}
function nr() {
  for (var r = [], e = 0; e < arguments.length; e++)
    r[e] = arguments[e];
  typeof console < "u" && console.error.apply(console, r);
}
function $(r) {
  if (r == null || typeof r != "object")
    return r;
  var e = r, t = en.call(r);
  if (t === "[object Array]") {
    if (!Wn(r)) {
      e = [];
      for (var i = 0, n = r.length; i < n; i++)
        e[i] = $(r[i]);
    }
  } else if (eg[t]) {
    if (!Wn(r)) {
      var s = r.constructor;
      if (s.from)
        e = s.from(r);
      else {
        e = new s(r.length);
        for (var i = 0, n = r.length; i < n; i++)
          e[i] = r[i];
      }
    }
  } else if (!Qp[t] && !Wn(r) && !Yr(r)) {
    e = {};
    for (var a in r)
      r.hasOwnProperty(a) && a !== lu && (e[a] = $(r[a]));
  }
  return e;
}
function Ee(r, e, t) {
  if (!B(e) || !B(r))
    return t ? $(e) : r;
  for (var i in e)
    if (e.hasOwnProperty(i) && i !== lu) {
      var n = r[i], s = e[i];
      B(s) && B(n) && !F(s) && !F(n) && !Yr(s) && !Yr(n) && !hd(s) && !hd(n) && !Wn(s) && !Wn(n) ? Ee(n, s, t) : (t || !(i in r)) && (r[i] = $(e[i]));
    }
  return r;
}
function P(r, e) {
  if (Object.assign)
    Object.assign(r, e);
  else
    for (var t in e)
      e.hasOwnProperty(t) && t !== lu && (r[t] = e[t]);
  return r;
}
function ge(r, e, t) {
  for (var i = me(e), n = 0, s = i.length; n < s; n++) {
    var a = i[n];
    r[a] == null && (r[a] = e[a]);
  }
  return r;
}
function ue(r, e) {
  if (r) {
    if (r.indexOf)
      return r.indexOf(e);
    for (var t = 0, i = r.length; t < i; t++)
      if (r[t] === e)
        return t;
  }
  return -1;
}
function r0(r, e) {
  var t = r.prototype;
  function i() {
  }
  i.prototype = e.prototype, r.prototype = new i();
  for (var n in t)
    t.hasOwnProperty(n) && (r.prototype[n] = t[n]);
  r.prototype.constructor = r, r.superClass = e;
}
function ii(r, e, t) {
  if (r = "prototype" in r ? r.prototype : r, e = "prototype" in e ? e.prototype : e, Object.getOwnPropertyNames)
    for (var i = Object.getOwnPropertyNames(e), n = 0; n < i.length; n++) {
      var s = i[n];
      s !== "constructor" && r[s] == null && (r[s] = e[s]);
    }
  else
    ge(r, e);
}
function Je(r) {
  return !r || typeof r == "string" ? !1 : typeof r.length == "number";
}
function M(r, e, t) {
  if (r && e)
    if (r.forEach && r.forEach === Qw)
      r.forEach(e, t);
    else if (r.length === +r.length)
      for (var i = 0, n = r.length; i < n; i++)
        e.call(t, r[i], i, r);
    else
      for (var s in r)
        r.hasOwnProperty(s) && e.call(t, r[s], s, r);
}
function J(r, e, t) {
  if (!r)
    return [];
  if (!e)
    return hu(r);
  if (r.map && r.map === t0)
    return r.map(e, t);
  for (var i = [], n = 0, s = r.length; n < s; n++)
    i.push(e.call(t, r[n], n, r));
  return i;
}
function tn(r, e, t, i) {
  if (r && e) {
    for (var n = 0, s = r.length; n < s; n++)
      t = e.call(i, t, r[n], n, r);
    return t;
  }
}
function bt(r, e, t) {
  if (!r)
    return [];
  if (!e)
    return hu(r);
  if (r.filter && r.filter === e0)
    return r.filter(e, t);
  for (var i = [], n = 0, s = r.length; n < s; n++)
    e.call(t, r[n], n, r) && i.push(r[n]);
  return i;
}
function me(r) {
  if (!r)
    return [];
  if (Object.keys)
    return Object.keys(r);
  var e = [];
  for (var t in r)
    r.hasOwnProperty(t) && e.push(t);
  return e;
}
function n0(r, e) {
  for (var t = [], i = 2; i < arguments.length; i++)
    t[i - 2] = arguments[i];
  return function() {
    return r.apply(e, t.concat(ou.call(arguments)));
  };
}
var K = Cs && q(Cs.bind) ? Cs.call.bind(Cs.bind) : n0;
function He(r) {
  for (var e = [], t = 1; t < arguments.length; t++)
    e[t - 1] = arguments[t];
  return function() {
    return r.apply(this, e.concat(ou.call(arguments)));
  };
}
function F(r) {
  return Array.isArray ? Array.isArray(r) : en.call(r) === "[object Array]";
}
function q(r) {
  return typeof r == "function";
}
function V(r) {
  return typeof r == "string";
}
function va(r) {
  return en.call(r) === "[object String]";
}
function Re(r) {
  return typeof r == "number";
}
function B(r) {
  var e = typeof r;
  return e === "function" || !!r && e === "object";
}
function hd(r) {
  return !!Qp[en.call(r)];
}
function Ge(r) {
  return !!eg[en.call(r)];
}
function Yr(r) {
  return typeof r == "object" && typeof r.nodeType == "number" && typeof r.ownerDocument == "object";
}
function Ka(r) {
  return r.colorStops != null;
}
function s0(r) {
  return r.image != null;
}
function a0(r) {
  return en.call(r) === "[object RegExp]";
}
function ig(r) {
  return r !== r;
}
function Xr() {
  for (var r = [], e = 0; e < arguments.length; e++)
    r[e] = arguments[e];
  for (var t = 0, i = r.length; t < i; t++)
    if (r[t] != null)
      return r[t];
}
function j(r, e) {
  return r ?? e;
}
function ta(r, e, t) {
  return r ?? e ?? t;
}
function hu(r) {
  for (var e = [], t = 1; t < arguments.length; t++)
    e[t - 1] = arguments[t];
  return ou.apply(r, e);
}
function uu(r) {
  if (typeof r == "number")
    return [r, r, r, r];
  var e = r.length;
  return e === 2 ? [r[0], r[1], r[0], r[1]] : e === 3 ? [r[0], r[1], r[2], r[1]] : r;
}
function Y(r, e) {
  if (!r)
    throw new Error(e);
}
function zt(r) {
  return r == null ? null : typeof r.trim == "function" ? r.trim() : r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "");
}
var rg = "__ec_primitive__";
function uh(r) {
  r[rg] = !0;
}
function Wn(r) {
  return r[rg];
}
var o0 = function() {
  function r() {
    this.data = {};
  }
  return r.prototype.delete = function(e) {
    var t = this.has(e);
    return t && delete this.data[e], t;
  }, r.prototype.has = function(e) {
    return this.data.hasOwnProperty(e);
  }, r.prototype.get = function(e) {
    return this.data[e];
  }, r.prototype.set = function(e, t) {
    return this.data[e] = t, this;
  }, r.prototype.keys = function() {
    return me(this.data);
  }, r.prototype.forEach = function(e) {
    var t = this.data;
    for (var i in t)
      t.hasOwnProperty(i) && e(t[i], i);
  }, r;
}(), ng = typeof Map == "function";
function l0() {
  return ng ? /* @__PURE__ */ new Map() : new o0();
}
var h0 = function() {
  function r(e) {
    var t = F(e);
    this.data = l0();
    var i = this;
    e instanceof r ? e.each(n) : e && M(e, n);
    function n(s, a) {
      t ? i.set(s, a) : i.set(a, s);
    }
  }
  return r.prototype.hasKey = function(e) {
    return this.data.has(e);
  }, r.prototype.get = function(e) {
    return this.data.get(e);
  }, r.prototype.set = function(e, t) {
    return this.data.set(e, t), t;
  }, r.prototype.each = function(e, t) {
    this.data.forEach(function(i, n) {
      e.call(t, i, n);
    });
  }, r.prototype.keys = function() {
    var e = this.data.keys();
    return ng ? Array.from(e) : e;
  }, r.prototype.removeKey = function(e) {
    this.data.delete(e);
  }, r;
}();
function Z(r) {
  return new h0(r);
}
function u0(r, e) {
  for (var t = new r.constructor(r.length + e.length), i = 0; i < r.length; i++)
    t[i] = r[i];
  for (var n = r.length, i = 0; i < e.length; i++)
    t[i + n] = e[i];
  return t;
}
function Za(r, e) {
  var t;
  if (Object.create)
    t = Object.create(r);
  else {
    var i = function() {
    };
    i.prototype = r, t = new i();
  }
  return e && P(t, e), t;
}
function sg(r) {
  var e = r.style;
  e.webkitUserSelect = "none", e.userSelect = "none", e.webkitTapHighlightColor = "rgba(0,0,0,0)", e["-webkit-touch-callout"] = "none";
}
function $r(r, e) {
  return r.hasOwnProperty(e);
}
function Le() {
}
var d0 = 180 / Math.PI;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var dh = function(r, e) {
  return dh = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(t, i) {
    t.__proto__ = i;
  } || function(t, i) {
    for (var n in i) Object.prototype.hasOwnProperty.call(i, n) && (t[n] = i[n]);
  }, dh(r, e);
};
function oe(r, e) {
  if (typeof e != "function" && e !== null)
    throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
  dh(r, e);
  function t() {
    this.constructor = r;
  }
  r.prototype = e === null ? Object.create(e) : (t.prototype = e.prototype, new t());
}
function rn(r, e) {
  return r == null && (r = 0), e == null && (e = 0), [r, e];
}
function c0(r) {
  return [r[0], r[1]];
}
function ud(r, e, t) {
  return r[0] = e[0] + t[0], r[1] = e[1] + t[1], r;
}
function f0(r, e, t) {
  return r[0] = e[0] - t[0], r[1] = e[1] - t[1], r;
}
function p0(r) {
  return Math.sqrt(g0(r));
}
function g0(r) {
  return r[0] * r[0] + r[1] * r[1];
}
function wo(r, e, t) {
  return r[0] = e[0] * t, r[1] = e[1] * t, r;
}
function v0(r, e) {
  var t = p0(e);
  return t === 0 ? (r[0] = 0, r[1] = 0) : (r[0] = e[0] / t, r[1] = e[1] / t), r;
}
function ch(r, e) {
  return Math.sqrt((r[0] - e[0]) * (r[0] - e[0]) + (r[1] - e[1]) * (r[1] - e[1]));
}
var m0 = ch;
function b0(r, e) {
  return (r[0] - e[0]) * (r[0] - e[0]) + (r[1] - e[1]) * (r[1] - e[1]);
}
var Wr = b0;
function Ht(r, e, t) {
  var i = e[0], n = e[1];
  return r[0] = t[0] * i + t[2] * n + t[4], r[1] = t[1] * i + t[3] * n + t[5], r;
}
function Ar(r, e, t) {
  return r[0] = Math.min(e[0], t[0]), r[1] = Math.min(e[1], t[1]), r;
}
function Pr(r, e, t) {
  return r[0] = Math.max(e[0], t[0]), r[1] = Math.max(e[1], t[1]), r;
}
var vr = /* @__PURE__ */ function() {
  function r(e, t) {
    this.target = e, this.topTarget = t && t.topTarget;
  }
  return r;
}(), y0 = function() {
  function r(e) {
    this.handler = e, e.on("mousedown", this._dragStart, this), e.on("mousemove", this._drag, this), e.on("mouseup", this._dragEnd, this);
  }
  return r.prototype._dragStart = function(e) {
    for (var t = e.target; t && !t.draggable; )
      t = t.parent || t.__hostTarget;
    t && (this._draggingTarget = t, t.dragging = !0, this._x = e.offsetX, this._y = e.offsetY, this.handler.dispatchToElement(new vr(t, e), "dragstart", e.event));
  }, r.prototype._drag = function(e) {
    var t = this._draggingTarget;
    if (t) {
      var i = e.offsetX, n = e.offsetY, s = i - this._x, a = n - this._y;
      this._x = i, this._y = n, t.drift(s, a, e), this.handler.dispatchToElement(new vr(t, e), "drag", e.event);
      var o = this.handler.findHover(i, n, t).target, l = this._dropTarget;
      this._dropTarget = o, t !== o && (l && o !== l && this.handler.dispatchToElement(new vr(l, e), "dragleave", e.event), o && o !== l && this.handler.dispatchToElement(new vr(o, e), "dragenter", e.event));
    }
  }, r.prototype._dragEnd = function(e) {
    var t = this._draggingTarget;
    t && (t.dragging = !1), this.handler.dispatchToElement(new vr(t, e), "dragend", e.event), this._dropTarget && this.handler.dispatchToElement(new vr(this._dropTarget, e), "drop", e.event), this._draggingTarget = null, this._dropTarget = null;
  }, r;
}(), Mt = function() {
  function r(e) {
    e && (this._$eventProcessor = e);
  }
  return r.prototype.on = function(e, t, i, n) {
    this._$handlers || (this._$handlers = {});
    var s = this._$handlers;
    if (typeof t == "function" && (n = i, i = t, t = null), !i || !e)
      return this;
    var a = this._$eventProcessor;
    t != null && a && a.normalizeQuery && (t = a.normalizeQuery(t)), s[e] || (s[e] = []);
    for (var o = 0; o < s[e].length; o++)
      if (s[e][o].h === i)
        return this;
    var l = {
      h: i,
      query: t,
      ctx: n || this,
      callAtLast: i.zrEventfulCallAtLast
    }, h = s[e].length - 1, u = s[e][h];
    return u && u.callAtLast ? s[e].splice(h, 0, l) : s[e].push(l), this;
  }, r.prototype.isSilent = function(e) {
    var t = this._$handlers;
    return !t || !t[e] || !t[e].length;
  }, r.prototype.off = function(e, t) {
    var i = this._$handlers;
    if (!i)
      return this;
    if (!e)
      return this._$handlers = {}, this;
    if (t) {
      if (i[e]) {
        for (var n = [], s = 0, a = i[e].length; s < a; s++)
          i[e][s].h !== t && n.push(i[e][s]);
        i[e] = n;
      }
      i[e] && i[e].length === 0 && delete i[e];
    } else
      delete i[e];
    return this;
  }, r.prototype.trigger = function(e) {
    for (var t = [], i = 1; i < arguments.length; i++)
      t[i - 1] = arguments[i];
    if (!this._$handlers)
      return this;
    var n = this._$handlers[e], s = this._$eventProcessor;
    if (n)
      for (var a = t.length, o = n.length, l = 0; l < o; l++) {
        var h = n[l];
        if (!(s && s.filter && h.query != null && !s.filter(e, h.query)))
          switch (a) {
            case 0:
              h.h.call(h.ctx);
              break;
            case 1:
              h.h.call(h.ctx, t[0]);
              break;
            case 2:
              h.h.call(h.ctx, t[0], t[1]);
              break;
            default:
              h.h.apply(h.ctx, t);
              break;
          }
      }
    return s && s.afterTrigger && s.afterTrigger(e), this;
  }, r.prototype.triggerWithContext = function(e) {
    for (var t = [], i = 1; i < arguments.length; i++)
      t[i - 1] = arguments[i];
    if (!this._$handlers)
      return this;
    var n = this._$handlers[e], s = this._$eventProcessor;
    if (n)
      for (var a = t.length, o = t[a - 1], l = n.length, h = 0; h < l; h++) {
        var u = n[h];
        if (!(s && s.filter && u.query != null && !s.filter(e, u.query)))
          switch (a) {
            case 0:
              u.h.call(o);
              break;
            case 1:
              u.h.call(o, t[0]);
              break;
            case 2:
              u.h.call(o, t[0], t[1]);
              break;
            default:
              u.h.apply(o, t.slice(1, a - 1));
              break;
          }
      }
    return s && s.afterTrigger && s.afterTrigger(e), this;
  }, r;
}(), w0 = Math.log(2);
function fh(r, e, t, i, n, s) {
  var a = i + "-" + n, o = r.length;
  if (s.hasOwnProperty(a))
    return s[a];
  if (e === 1) {
    var l = Math.round(Math.log((1 << o) - 1 & ~n) / w0);
    return r[t][l];
  }
  for (var h = i | 1 << t, u = t + 1; i & 1 << u; )
    u++;
  for (var d = 0, c = 0, f = 0; c < o; c++) {
    var p = 1 << c;
    p & n || (d += (f % 2 ? -1 : 1) * r[t][c] * fh(r, e - 1, u, h, n | p, s), f++);
  }
  return s[a] = d, d;
}
function dd(r, e) {
  var t = [
    [r[0], r[1], 1, 0, 0, 0, -e[0] * r[0], -e[0] * r[1]],
    [0, 0, 0, r[0], r[1], 1, -e[1] * r[0], -e[1] * r[1]],
    [r[2], r[3], 1, 0, 0, 0, -e[2] * r[2], -e[2] * r[3]],
    [0, 0, 0, r[2], r[3], 1, -e[3] * r[2], -e[3] * r[3]],
    [r[4], r[5], 1, 0, 0, 0, -e[4] * r[4], -e[4] * r[5]],
    [0, 0, 0, r[4], r[5], 1, -e[5] * r[4], -e[5] * r[5]],
    [r[6], r[7], 1, 0, 0, 0, -e[6] * r[6], -e[6] * r[7]],
    [0, 0, 0, r[6], r[7], 1, -e[7] * r[6], -e[7] * r[7]]
  ], i = {}, n = fh(t, 8, 0, 0, 0, i);
  if (n !== 0) {
    for (var s = [], a = 0; a < 8; a++)
      for (var o = 0; o < 8; o++)
        s[o] == null && (s[o] = 0), s[o] += ((a + o) % 2 ? -1 : 1) * fh(t, 7, a === 0 ? 1 : 0, 1 << a, 1 << o, i) / n * e[a];
    return function(l, h, u) {
      var d = h * s[6] + u * s[7] + 1;
      l[0] = (h * s[0] + u * s[1] + s[2]) / d, l[1] = (h * s[3] + u * s[4] + s[5]) / d;
    };
  }
}
var cd = "___zrEVENTSAVED", Co = [];
function C0(r, e, t, i, n) {
  return ph(Co, e, i, n, !0) && ph(r, t, Co[0], Co[1]);
}
function ph(r, e, t, i, n) {
  if (e.getBoundingClientRect && W.domSupported && !ag(e)) {
    var s = e[cd] || (e[cd] = {}), a = _0(e, s), o = E0(a, s, n);
    if (o)
      return o(r, t, i), !0;
  }
  return !1;
}
function _0(r, e) {
  var t = e.markers;
  if (t)
    return t;
  t = e.markers = [];
  for (var i = ["left", "right"], n = ["top", "bottom"], s = 0; s < 4; s++) {
    var a = document.createElement("div"), o = a.style, l = s % 2, h = (s >> 1) % 2;
    o.cssText = [
      "position: absolute",
      "visibility: hidden",
      "padding: 0",
      "margin: 0",
      "border-width: 0",
      "user-select: none",
      "width:0",
      "height:0",
      i[l] + ":0",
      n[h] + ":0",
      i[1 - l] + ":auto",
      n[1 - h] + ":auto",
      ""
    ].join("!important;"), r.appendChild(a), t.push(a);
  }
  return t;
}
function E0(r, e, t) {
  for (var i = t ? "invTrans" : "trans", n = e[i], s = e.srcCoords, a = [], o = [], l = !0, h = 0; h < 4; h++) {
    var u = r[h].getBoundingClientRect(), d = 2 * h, c = u.left, f = u.top;
    a.push(c, f), l = l && s && c === s[d] && f === s[d + 1], o.push(r[h].offsetLeft, r[h].offsetTop);
  }
  return l && n ? n : (e.srcCoords = a, e[i] = t ? dd(o, a) : dd(a, o));
}
function ag(r) {
  return r.nodeName.toUpperCase() === "CANVAS";
}
var T0 = /([&<>"'])/g, x0 = {
  "&": "&amp;",
  "<": "&lt;",
  ">": "&gt;",
  '"': "&quot;",
  "'": "&#39;"
};
function $e(r) {
  return r == null ? "" : (r + "").replace(T0, function(e, t) {
    return x0[t];
  });
}
var S0 = /^(?:mouse|pointer|contextmenu|drag|drop)|click/, _o = [], R0 = W.browser.firefox && +W.browser.version.split(".")[0] < 39;
function gh(r, e, t, i) {
  return t = t || {}, i ? fd(r, e, t) : R0 && e.layerX != null && e.layerX !== e.offsetX ? (t.zrX = e.layerX, t.zrY = e.layerY) : e.offsetX != null ? (t.zrX = e.offsetX, t.zrY = e.offsetY) : fd(r, e, t), t;
}
function fd(r, e, t) {
  if (W.domSupported && r.getBoundingClientRect) {
    var i = e.clientX, n = e.clientY;
    if (ag(r)) {
      var s = r.getBoundingClientRect();
      t.zrX = i - s.left, t.zrY = n - s.top;
      return;
    } else if (ph(_o, r, i, n)) {
      t.zrX = _o[0], t.zrY = _o[1];
      return;
    }
  }
  t.zrX = t.zrY = 0;
}
function du(r) {
  return r || window.event;
}
function gt(r, e, t) {
  if (e = du(e), e.zrX != null)
    return e;
  var i = e.type, n = i && i.indexOf("touch") >= 0;
  if (n) {
    var a = i !== "touchend" ? e.targetTouches[0] : e.changedTouches[0];
    a && gh(r, a, e, t);
  } else {
    gh(r, e, e, t);
    var s = M0(e);
    e.zrDelta = s ? s / 120 : -(e.detail || 0) / 3;
  }
  var o = e.button;
  return e.which == null && o !== void 0 && S0.test(e.type) && (e.which = o & 1 ? 1 : o & 2 ? 3 : o & 4 ? 2 : 0), e;
}
function M0(r) {
  var e = r.wheelDelta;
  if (e)
    return e;
  var t = r.deltaX, i = r.deltaY;
  if (t == null || i == null)
    return e;
  var n = Math.abs(i !== 0 ? i : t), s = i > 0 ? -1 : i < 0 ? 1 : t > 0 ? -1 : 1;
  return 3 * n * s;
}
function D0(r, e, t, i) {
  r.addEventListener(e, t, i);
}
function L0(r, e, t, i) {
  r.removeEventListener(e, t, i);
}
var Ja = function(r) {
  r.preventDefault(), r.stopPropagation(), r.cancelBubble = !0;
};
function pd(r) {
  return r.which === 2 || r.which === 3;
}
var k0 = function() {
  function r() {
    this._track = [];
  }
  return r.prototype.recognize = function(e, t, i) {
    return this._doTrack(e, t, i), this._recognize(e);
  }, r.prototype.clear = function() {
    return this._track.length = 0, this;
  }, r.prototype._doTrack = function(e, t, i) {
    var n = e.touches;
    if (n) {
      for (var s = {
        points: [],
        touches: [],
        target: t,
        event: e
      }, a = 0, o = n.length; a < o; a++) {
        var l = n[a], h = gh(i, l, {});
        s.points.push([h.zrX, h.zrY]), s.touches.push(l);
      }
      this._track.push(s);
    }
  }, r.prototype._recognize = function(e) {
    for (var t in Eo)
      if (Eo.hasOwnProperty(t)) {
        var i = Eo[t](this._track, e);
        if (i)
          return i;
      }
  }, r;
}();
function gd(r) {
  var e = r[1][0] - r[0][0], t = r[1][1] - r[0][1];
  return Math.sqrt(e * e + t * t);
}
function A0(r) {
  return [
    (r[0][0] + r[1][0]) / 2,
    (r[0][1] + r[1][1]) / 2
  ];
}
var Eo = {
  pinch: function(r, e) {
    var t = r.length;
    if (t) {
      var i = (r[t - 1] || {}).points, n = (r[t - 2] || {}).points || i;
      if (n && n.length > 1 && i && i.length > 1) {
        var s = gd(i) / gd(n);
        !isFinite(s) && (s = 1), e.pinchScale = s;
        var a = A0(i);
        return e.pinchX = a[0], e.pinchY = a[1], {
          type: "pinch",
          target: r[0].target,
          event: e
        };
      }
    }
  }
};
function sr() {
  return [1, 0, 0, 1, 0, 0];
}
function cu(r) {
  return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 1, r[4] = 0, r[5] = 0, r;
}
function P0(r, e) {
  return r[0] = e[0], r[1] = e[1], r[2] = e[2], r[3] = e[3], r[4] = e[4], r[5] = e[5], r;
}
function Gr(r, e, t) {
  var i = e[0] * t[0] + e[2] * t[1], n = e[1] * t[0] + e[3] * t[1], s = e[0] * t[2] + e[2] * t[3], a = e[1] * t[2] + e[3] * t[3], o = e[0] * t[4] + e[2] * t[5] + e[4], l = e[1] * t[4] + e[3] * t[5] + e[5];
  return r[0] = i, r[1] = n, r[2] = s, r[3] = a, r[4] = o, r[5] = l, r;
}
function ns(r, e, t) {
  return r[0] = e[0], r[1] = e[1], r[2] = e[2], r[3] = e[3], r[4] = e[4] + t[0], r[5] = e[5] + t[1], r;
}
function fu(r, e, t, i) {
  i === void 0 && (i = [0, 0]);
  var n = e[0], s = e[2], a = e[4], o = e[1], l = e[3], h = e[5], u = Math.sin(t), d = Math.cos(t);
  return r[0] = n * d + o * u, r[1] = -n * u + o * d, r[2] = s * d + l * u, r[3] = -s * u + d * l, r[4] = d * (a - i[0]) + u * (h - i[1]) + i[0], r[5] = d * (h - i[1]) - u * (a - i[0]) + i[1], r;
}
function og(r, e, t) {
  var i = t[0], n = t[1];
  return r[0] = e[0] * i, r[1] = e[1] * n, r[2] = e[2] * i, r[3] = e[3] * n, r[4] = e[4] * i, r[5] = e[5] * n, r;
}
function lg(r, e) {
  var t = e[0], i = e[2], n = e[4], s = e[1], a = e[3], o = e[5], l = t * a - s * i;
  return l ? (l = 1 / l, r[0] = a * l, r[1] = -s * l, r[2] = -i * l, r[3] = t * l, r[4] = (i * o - a * n) * l, r[5] = (s * n - t * o) * l, r) : null;
}
var he = function() {
  function r(e, t) {
    this.x = e || 0, this.y = t || 0;
  }
  return r.prototype.copy = function(e) {
    return this.x = e.x, this.y = e.y, this;
  }, r.prototype.clone = function() {
    return new r(this.x, this.y);
  }, r.prototype.set = function(e, t) {
    return this.x = e, this.y = t, this;
  }, r.prototype.equal = function(e) {
    return e.x === this.x && e.y === this.y;
  }, r.prototype.add = function(e) {
    return this.x += e.x, this.y += e.y, this;
  }, r.prototype.scale = function(e) {
    this.x *= e, this.y *= e;
  }, r.prototype.scaleAndAdd = function(e, t) {
    this.x += e.x * t, this.y += e.y * t;
  }, r.prototype.sub = function(e) {
    return this.x -= e.x, this.y -= e.y, this;
  }, r.prototype.dot = function(e) {
    return this.x * e.x + this.y * e.y;
  }, r.prototype.len = function() {
    return Math.sqrt(this.x * this.x + this.y * this.y);
  }, r.prototype.lenSquare = function() {
    return this.x * this.x + this.y * this.y;
  }, r.prototype.normalize = function() {
    var e = this.len();
    return this.x /= e, this.y /= e, this;
  }, r.prototype.distance = function(e) {
    var t = this.x - e.x, i = this.y - e.y;
    return Math.sqrt(t * t + i * i);
  }, r.prototype.distanceSquare = function(e) {
    var t = this.x - e.x, i = this.y - e.y;
    return t * t + i * i;
  }, r.prototype.negate = function() {
    return this.x = -this.x, this.y = -this.y, this;
  }, r.prototype.transform = function(e) {
    if (e) {
      var t = this.x, i = this.y;
      return this.x = e[0] * t + e[2] * i + e[4], this.y = e[1] * t + e[3] * i + e[5], this;
    }
  }, r.prototype.toArray = function(e) {
    return e[0] = this.x, e[1] = this.y, e;
  }, r.prototype.fromArray = function(e) {
    this.x = e[0], this.y = e[1];
  }, r.set = function(e, t, i) {
    e.x = t, e.y = i;
  }, r.copy = function(e, t) {
    e.x = t.x, e.y = t.y;
  }, r.len = function(e) {
    return Math.sqrt(e.x * e.x + e.y * e.y);
  }, r.lenSquare = function(e) {
    return e.x * e.x + e.y * e.y;
  }, r.dot = function(e, t) {
    return e.x * t.x + e.y * t.y;
  }, r.add = function(e, t, i) {
    e.x = t.x + i.x, e.y = t.y + i.y;
  }, r.sub = function(e, t, i) {
    e.x = t.x - i.x, e.y = t.y - i.y;
  }, r.scale = function(e, t, i) {
    e.x = t.x * i, e.y = t.y * i;
  }, r.scaleAndAdd = function(e, t, i, n) {
    e.x = t.x + i.x * n, e.y = t.y + i.y * n;
  }, r.lerp = function(e, t, i, n) {
    var s = 1 - n;
    e.x = s * t.x + n * i.x, e.y = s * t.y + n * i.y;
  }, r;
}(), _s = Math.min, Es = Math.max, Ri = new he(), Mi = new he(), Di = new he(), Li = new he(), dn = new he(), cn = new he(), re = function() {
  function r(e, t, i, n) {
    i < 0 && (e = e + i, i = -i), n < 0 && (t = t + n, n = -n), this.x = e, this.y = t, this.width = i, this.height = n;
  }
  return r.prototype.union = function(e) {
    var t = _s(e.x, this.x), i = _s(e.y, this.y);
    isFinite(this.x) && isFinite(this.width) ? this.width = Es(e.x + e.width, this.x + this.width) - t : this.width = e.width, isFinite(this.y) && isFinite(this.height) ? this.height = Es(e.y + e.height, this.y + this.height) - i : this.height = e.height, this.x = t, this.y = i;
  }, r.prototype.applyTransform = function(e) {
    r.applyTransform(this, this, e);
  }, r.prototype.calculateTransform = function(e) {
    var t = this, i = e.width / t.width, n = e.height / t.height, s = sr();
    return ns(s, s, [-t.x, -t.y]), og(s, s, [i, n]), ns(s, s, [e.x, e.y]), s;
  }, r.prototype.intersect = function(e, t) {
    if (!e)
      return !1;
    e instanceof r || (e = r.create(e));
    var i = this, n = i.x, s = i.x + i.width, a = i.y, o = i.y + i.height, l = e.x, h = e.x + e.width, u = e.y, d = e.y + e.height, c = !(s < l || h < n || o < u || d < a);
    if (t) {
      var f = 1 / 0, p = 0, m = Math.abs(s - l), g = Math.abs(h - n), v = Math.abs(o - u), b = Math.abs(d - a), y = Math.min(m, g), w = Math.min(v, b);
      s < l || h < n ? y > p && (p = y, m < g ? he.set(cn, -m, 0) : he.set(cn, g, 0)) : y < f && (f = y, m < g ? he.set(dn, m, 0) : he.set(dn, -g, 0)), o < u || d < a ? w > p && (p = w, v < b ? he.set(cn, 0, -v) : he.set(cn, 0, b)) : y < f && (f = y, v < b ? he.set(dn, 0, v) : he.set(dn, 0, -b));
    }
    return t && he.copy(t, c ? dn : cn), c;
  }, r.prototype.contain = function(e, t) {
    var i = this;
    return e >= i.x && e <= i.x + i.width && t >= i.y && t <= i.y + i.height;
  }, r.prototype.clone = function() {
    return new r(this.x, this.y, this.width, this.height);
  }, r.prototype.copy = function(e) {
    r.copy(this, e);
  }, r.prototype.plain = function() {
    return {
      x: this.x,
      y: this.y,
      width: this.width,
      height: this.height
    };
  }, r.prototype.isFinite = function() {
    return isFinite(this.x) && isFinite(this.y) && isFinite(this.width) && isFinite(this.height);
  }, r.prototype.isZero = function() {
    return this.width === 0 || this.height === 0;
  }, r.create = function(e) {
    return new r(e.x, e.y, e.width, e.height);
  }, r.copy = function(e, t) {
    e.x = t.x, e.y = t.y, e.width = t.width, e.height = t.height;
  }, r.applyTransform = function(e, t, i) {
    if (!i) {
      e !== t && r.copy(e, t);
      return;
    }
    if (i[1] < 1e-5 && i[1] > -1e-5 && i[2] < 1e-5 && i[2] > -1e-5) {
      var n = i[0], s = i[3], a = i[4], o = i[5];
      e.x = t.x * n + a, e.y = t.y * s + o, e.width = t.width * n, e.height = t.height * s, e.width < 0 && (e.x += e.width, e.width = -e.width), e.height < 0 && (e.y += e.height, e.height = -e.height);
      return;
    }
    Ri.x = Di.x = t.x, Ri.y = Li.y = t.y, Mi.x = Li.x = t.x + t.width, Mi.y = Di.y = t.y + t.height, Ri.transform(i), Li.transform(i), Mi.transform(i), Di.transform(i), e.x = _s(Ri.x, Mi.x, Di.x, Li.x), e.y = _s(Ri.y, Mi.y, Di.y, Li.y);
    var l = Es(Ri.x, Mi.x, Di.x, Li.x), h = Es(Ri.y, Mi.y, Di.y, Li.y);
    e.width = l - e.x, e.height = h - e.y;
  }, r;
}(), hg = "silent";
function O0(r, e, t) {
  return {
    type: r,
    event: t,
    target: e.target,
    topTarget: e.topTarget,
    cancelBubble: !1,
    offsetX: t.zrX,
    offsetY: t.zrY,
    gestureEvent: t.gestureEvent,
    pinchX: t.pinchX,
    pinchY: t.pinchY,
    pinchScale: t.pinchScale,
    wheelDelta: t.zrDelta,
    zrByTouch: t.zrByTouch,
    which: t.which,
    stop: I0
  };
}
function I0() {
  Ja(this.event);
}
var z0 = function(r) {
  oe(e, r);
  function e() {
    var t = r !== null && r.apply(this, arguments) || this;
    return t.handler = null, t;
  }
  return e.prototype.dispose = function() {
  }, e.prototype.setCursor = function() {
  }, e;
}(Mt), fn = /* @__PURE__ */ function() {
  function r(e, t) {
    this.x = e, this.y = t;
  }
  return r;
}(), F0 = [
  "click",
  "dblclick",
  "mousewheel",
  "mouseout",
  "mouseup",
  "mousedown",
  "mousemove",
  "contextmenu"
], To = new re(0, 0, 0, 0), ug = function(r) {
  oe(e, r);
  function e(t, i, n, s, a) {
    var o = r.call(this) || this;
    return o._hovered = new fn(0, 0), o.storage = t, o.painter = i, o.painterRoot = s, o._pointerSize = a, n = n || new z0(), o.proxy = null, o.setHandlerProxy(n), o._draggingMgr = new y0(o), o;
  }
  return e.prototype.setHandlerProxy = function(t) {
    this.proxy && this.proxy.dispose(), t && (M(F0, function(i) {
      t.on && t.on(i, this[i], this);
    }, this), t.handler = this), this.proxy = t;
  }, e.prototype.mousemove = function(t) {
    var i = t.zrX, n = t.zrY, s = dg(this, i, n), a = this._hovered, o = a.target;
    o && !o.__zr && (a = this.findHover(a.x, a.y), o = a.target);
    var l = this._hovered = s ? new fn(i, n) : this.findHover(i, n), h = l.target, u = this.proxy;
    u.setCursor && u.setCursor(h ? h.cursor : "default"), o && h !== o && this.dispatchToElement(a, "mouseout", t), this.dispatchToElement(l, "mousemove", t), h && h !== o && this.dispatchToElement(l, "mouseover", t);
  }, e.prototype.mouseout = function(t) {
    var i = t.zrEventControl;
    i !== "only_globalout" && this.dispatchToElement(this._hovered, "mouseout", t), i !== "no_globalout" && this.trigger("globalout", { type: "globalout", event: t });
  }, e.prototype.resize = function() {
    this._hovered = new fn(0, 0);
  }, e.prototype.dispatch = function(t, i) {
    var n = this[t];
    n && n.call(this, i);
  }, e.prototype.dispose = function() {
    this.proxy.dispose(), this.storage = null, this.proxy = null, this.painter = null;
  }, e.prototype.setCursorStyle = function(t) {
    var i = this.proxy;
    i.setCursor && i.setCursor(t);
  }, e.prototype.dispatchToElement = function(t, i, n) {
    t = t || {};
    var s = t.target;
    if (!(s && s.silent)) {
      for (var a = "on" + i, o = O0(i, t, n); s && (s[a] && (o.cancelBubble = !!s[a].call(s, o)), s.trigger(i, o), s = s.__hostTarget ? s.__hostTarget : s.parent, !o.cancelBubble); )
        ;
      o.cancelBubble || (this.trigger(i, o), this.painter && this.painter.eachOtherLayer && this.painter.eachOtherLayer(function(l) {
        typeof l[a] == "function" && l[a].call(l, o), l.trigger && l.trigger(i, o);
      }));
    }
  }, e.prototype.findHover = function(t, i, n) {
    var s = this.storage.getDisplayList(), a = new fn(t, i);
    if (vd(s, a, t, i, n), this._pointerSize && !a.target) {
      for (var o = [], l = this._pointerSize, h = l / 2, u = new re(t - h, i - h, l, l), d = s.length - 1; d >= 0; d--) {
        var c = s[d];
        c !== n && !c.ignore && !c.ignoreCoarsePointer && (!c.parent || !c.parent.ignoreCoarsePointer) && (To.copy(c.getBoundingRect()), c.transform && To.applyTransform(c.transform), To.intersect(u) && o.push(c));
      }
      if (o.length)
        for (var f = 4, p = Math.PI / 12, m = Math.PI * 2, g = 0; g < h; g += f)
          for (var v = 0; v < m; v += p) {
            var b = t + g * Math.cos(v), y = i + g * Math.sin(v);
            if (vd(o, a, b, y, n), a.target)
              return a;
          }
    }
    return a;
  }, e.prototype.processGesture = function(t, i) {
    this._gestureMgr || (this._gestureMgr = new k0());
    var n = this._gestureMgr;
    i === "start" && n.clear();
    var s = n.recognize(t, this.findHover(t.zrX, t.zrY, null).target, this.proxy.dom);
    if (i === "end" && n.clear(), s) {
      var a = s.type;
      t.gestureEvent = a;
      var o = new fn();
      o.target = s.target, this.dispatchToElement(o, a, s.event);
    }
  }, e;
}(Mt);
M(["click", "mousedown", "mouseup", "mousewheel", "dblclick", "contextmenu"], function(r) {
  ug.prototype[r] = function(e) {
    var t = e.zrX, i = e.zrY, n = dg(this, t, i), s, a;
    if ((r !== "mouseup" || !n) && (s = this.findHover(t, i), a = s.target), r === "mousedown")
      this._downEl = a, this._downPoint = [e.zrX, e.zrY], this._upEl = a;
    else if (r === "mouseup")
      this._upEl = a;
    else if (r === "click") {
      if (this._downEl !== this._upEl || !this._downPoint || m0(this._downPoint, [e.zrX, e.zrY]) > 4)
        return;
      this._downPoint = null;
    }
    this.dispatchToElement(s, r, e);
  };
});
function H0(r, e, t) {
  if (r[r.rectHover ? "rectContain" : "contain"](e, t)) {
    for (var i = r, n = void 0, s = !1; i; ) {
      if (i.ignoreClip && (s = !0), !s) {
        var a = i.getClipPath();
        if (a && !a.contain(e, t))
          return !1;
      }
      i.silent && (n = !0);
      var o = i.__hostTarget;
      i = o || i.parent;
    }
    return n ? hg : !0;
  }
  return !1;
}
function vd(r, e, t, i, n) {
  for (var s = r.length - 1; s >= 0; s--) {
    var a = r[s], o = void 0;
    if (a !== n && !a.ignore && (o = H0(a, t, i)) && (!e.topTarget && (e.topTarget = a), o !== hg)) {
      e.target = a;
      break;
    }
  }
}
function dg(r, e, t) {
  var i = r.painter;
  return e < 0 || e > i.getWidth() || t < 0 || t > i.getHeight();
}
var cg = 32, pn = 7;
function N0(r) {
  for (var e = 0; r >= cg; )
    e |= r & 1, r >>= 1;
  return r + e;
}
function md(r, e, t, i) {
  var n = e + 1;
  if (n === t)
    return 1;
  if (i(r[n++], r[e]) < 0) {
    for (; n < t && i(r[n], r[n - 1]) < 0; )
      n++;
    B0(r, e, n);
  } else
    for (; n < t && i(r[n], r[n - 1]) >= 0; )
      n++;
  return n - e;
}
function B0(r, e, t) {
  for (t--; e < t; ) {
    var i = r[e];
    r[e++] = r[t], r[t--] = i;
  }
}
function bd(r, e, t, i, n) {
  for (i === e && i++; i < t; i++) {
    for (var s = r[i], a = e, o = i, l; a < o; )
      l = a + o >>> 1, n(s, r[l]) < 0 ? o = l : a = l + 1;
    var h = i - a;
    switch (h) {
      case 3:
        r[a + 3] = r[a + 2];
      case 2:
        r[a + 2] = r[a + 1];
      case 1:
        r[a + 1] = r[a];
        break;
      default:
        for (; h > 0; )
          r[a + h] = r[a + h - 1], h--;
    }
    r[a] = s;
  }
}
function xo(r, e, t, i, n, s) {
  var a = 0, o = 0, l = 1;
  if (s(r, e[t + n]) > 0) {
    for (o = i - n; l < o && s(r, e[t + n + l]) > 0; )
      a = l, l = (l << 1) + 1, l <= 0 && (l = o);
    l > o && (l = o), a += n, l += n;
  } else {
    for (o = n + 1; l < o && s(r, e[t + n - l]) <= 0; )
      a = l, l = (l << 1) + 1, l <= 0 && (l = o);
    l > o && (l = o);
    var h = a;
    a = n - l, l = n - h;
  }
  for (a++; a < l; ) {
    var u = a + (l - a >>> 1);
    s(r, e[t + u]) > 0 ? a = u + 1 : l = u;
  }
  return l;
}
function So(r, e, t, i, n, s) {
  var a = 0, o = 0, l = 1;
  if (s(r, e[t + n]) < 0) {
    for (o = n + 1; l < o && s(r, e[t + n - l]) < 0; )
      a = l, l = (l << 1) + 1, l <= 0 && (l = o);
    l > o && (l = o);
    var h = a;
    a = n - l, l = n - h;
  } else {
    for (o = i - n; l < o && s(r, e[t + n + l]) >= 0; )
      a = l, l = (l << 1) + 1, l <= 0 && (l = o);
    l > o && (l = o), a += n, l += n;
  }
  for (a++; a < l; ) {
    var u = a + (l - a >>> 1);
    s(r, e[t + u]) < 0 ? l = u : a = u + 1;
  }
  return l;
}
function V0(r, e) {
  var t = pn, i, n, s = 0, a = [];
  i = [], n = [];
  function o(f, p) {
    i[s] = f, n[s] = p, s += 1;
  }
  function l() {
    for (; s > 1; ) {
      var f = s - 2;
      if (f >= 1 && n[f - 1] <= n[f] + n[f + 1] || f >= 2 && n[f - 2] <= n[f] + n[f - 1])
        n[f - 1] < n[f + 1] && f--;
      else if (n[f] > n[f + 1])
        break;
      u(f);
    }
  }
  function h() {
    for (; s > 1; ) {
      var f = s - 2;
      f > 0 && n[f - 1] < n[f + 1] && f--, u(f);
    }
  }
  function u(f) {
    var p = i[f], m = n[f], g = i[f + 1], v = n[f + 1];
    n[f] = m + v, f === s - 3 && (i[f + 1] = i[f + 2], n[f + 1] = n[f + 2]), s--;
    var b = So(r[g], r, p, m, 0, e);
    p += b, m -= b, m !== 0 && (v = xo(r[p + m - 1], r, g, v, v - 1, e), v !== 0 && (m <= v ? d(p, m, g, v) : c(p, m, g, v)));
  }
  function d(f, p, m, g) {
    var v = 0;
    for (v = 0; v < p; v++)
      a[v] = r[f + v];
    var b = 0, y = m, w = f;
    if (r[w++] = r[y++], --g === 0) {
      for (v = 0; v < p; v++)
        r[w + v] = a[b + v];
      return;
    }
    if (p === 1) {
      for (v = 0; v < g; v++)
        r[w + v] = r[y + v];
      r[w + g] = a[b];
      return;
    }
    for (var _ = t, E, x, T; ; ) {
      E = 0, x = 0, T = !1;
      do
        if (e(r[y], a[b]) < 0) {
          if (r[w++] = r[y++], x++, E = 0, --g === 0) {
            T = !0;
            break;
          }
        } else if (r[w++] = a[b++], E++, x = 0, --p === 1) {
          T = !0;
          break;
        }
      while ((E | x) < _);
      if (T)
        break;
      do {
        if (E = So(r[y], a, b, p, 0, e), E !== 0) {
          for (v = 0; v < E; v++)
            r[w + v] = a[b + v];
          if (w += E, b += E, p -= E, p <= 1) {
            T = !0;
            break;
          }
        }
        if (r[w++] = r[y++], --g === 0) {
          T = !0;
          break;
        }
        if (x = xo(a[b], r, y, g, 0, e), x !== 0) {
          for (v = 0; v < x; v++)
            r[w + v] = r[y + v];
          if (w += x, y += x, g -= x, g === 0) {
            T = !0;
            break;
          }
        }
        if (r[w++] = a[b++], --p === 1) {
          T = !0;
          break;
        }
        _--;
      } while (E >= pn || x >= pn);
      if (T)
        break;
      _ < 0 && (_ = 0), _ += 2;
    }
    if (t = _, t < 1 && (t = 1), p === 1) {
      for (v = 0; v < g; v++)
        r[w + v] = r[y + v];
      r[w + g] = a[b];
    } else {
      if (p === 0)
        throw new Error();
      for (v = 0; v < p; v++)
        r[w + v] = a[b + v];
    }
  }
  function c(f, p, m, g) {
    var v = 0;
    for (v = 0; v < g; v++)
      a[v] = r[m + v];
    var b = f + p - 1, y = g - 1, w = m + g - 1, _ = 0, E = 0;
    if (r[w--] = r[b--], --p === 0) {
      for (_ = w - (g - 1), v = 0; v < g; v++)
        r[_ + v] = a[v];
      return;
    }
    if (g === 1) {
      for (w -= p, b -= p, E = w + 1, _ = b + 1, v = p - 1; v >= 0; v--)
        r[E + v] = r[_ + v];
      r[w] = a[y];
      return;
    }
    for (var x = t; ; ) {
      var T = 0, C = 0, S = !1;
      do
        if (e(a[y], r[b]) < 0) {
          if (r[w--] = r[b--], T++, C = 0, --p === 0) {
            S = !0;
            break;
          }
        } else if (r[w--] = a[y--], C++, T = 0, --g === 1) {
          S = !0;
          break;
        }
      while ((T | C) < x);
      if (S)
        break;
      do {
        if (T = p - So(a[y], r, f, p, p - 1, e), T !== 0) {
          for (w -= T, b -= T, p -= T, E = w + 1, _ = b + 1, v = T - 1; v >= 0; v--)
            r[E + v] = r[_ + v];
          if (p === 0) {
            S = !0;
            break;
          }
        }
        if (r[w--] = a[y--], --g === 1) {
          S = !0;
          break;
        }
        if (C = g - xo(r[b], a, 0, g, g - 1, e), C !== 0) {
          for (w -= C, y -= C, g -= C, E = w + 1, _ = y + 1, v = 0; v < C; v++)
            r[E + v] = a[_ + v];
          if (g <= 1) {
            S = !0;
            break;
          }
        }
        if (r[w--] = r[b--], --p === 0) {
          S = !0;
          break;
        }
        x--;
      } while (T >= pn || C >= pn);
      if (S)
        break;
      x < 0 && (x = 0), x += 2;
    }
    if (t = x, t < 1 && (t = 1), g === 1) {
      for (w -= p, b -= p, E = w + 1, _ = b + 1, v = p - 1; v >= 0; v--)
        r[E + v] = r[_ + v];
      r[w] = a[y];
    } else {
      if (g === 0)
        throw new Error();
      for (_ = w - (g - 1), v = 0; v < g; v++)
        r[_ + v] = a[v];
    }
  }
  return {
    mergeRuns: l,
    forceMergeRuns: h,
    pushRun: o
  };
}
function ia(r, e, t, i) {
  t || (t = 0), i || (i = r.length);
  var n = i - t;
  if (!(n < 2)) {
    var s = 0;
    if (n < cg) {
      s = md(r, t, i, e), bd(r, t, i, t + s, e);
      return;
    }
    var a = V0(r, e), o = N0(n);
    do {
      if (s = md(r, t, i, e), s < o) {
        var l = n;
        l > o && (l = o), bd(r, t, t + l, t + s, e), s = l;
      }
      a.pushRun(t, s), a.mergeRuns(), n -= s, t += s;
    } while (n !== 0);
    a.forceMergeRuns();
  }
}
var nt = 1, Pn = 2, Lr = 4, yd = !1;
function Ro() {
  yd || (yd = !0, console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"));
}
function wd(r, e) {
  return r.zlevel === e.zlevel ? r.z === e.z ? r.z2 - e.z2 : r.z - e.z : r.zlevel - e.zlevel;
}
var W0 = function() {
  function r() {
    this._roots = [], this._displayList = [], this._displayListLen = 0, this.displayableSortFunc = wd;
  }
  return r.prototype.traverse = function(e, t) {
    for (var i = 0; i < this._roots.length; i++)
      this._roots[i].traverse(e, t);
  }, r.prototype.getDisplayList = function(e, t) {
    t = t || !1;
    var i = this._displayList;
    return (e || !i.length) && this.updateDisplayList(t), i;
  }, r.prototype.updateDisplayList = function(e) {
    this._displayListLen = 0;
    for (var t = this._roots, i = this._displayList, n = 0, s = t.length; n < s; n++)
      this._updateAndAddDisplayable(t[n], null, e);
    i.length = this._displayListLen, ia(i, wd);
  }, r.prototype._updateAndAddDisplayable = function(e, t, i) {
    if (!(e.ignore && !i)) {
      e.beforeUpdate(), e.update(), e.afterUpdate();
      var n = e.getClipPath();
      if (e.ignoreClip)
        t = null;
      else if (n) {
        t ? t = t.slice() : t = [];
        for (var s = n, a = e; s; )
          s.parent = a, s.updateTransform(), t.push(s), a = s, s = s.getClipPath();
      }
      if (e.childrenRef) {
        for (var o = e.childrenRef(), l = 0; l < o.length; l++) {
          var h = o[l];
          e.__dirty && (h.__dirty |= nt), this._updateAndAddDisplayable(h, t, i);
        }
        e.__dirty = 0;
      } else {
        var u = e;
        t && t.length ? u.__clipPaths = t : u.__clipPaths && u.__clipPaths.length > 0 && (u.__clipPaths = []), isNaN(u.z) && (Ro(), u.z = 0), isNaN(u.z2) && (Ro(), u.z2 = 0), isNaN(u.zlevel) && (Ro(), u.zlevel = 0), this._displayList[this._displayListLen++] = u;
      }
      var d = e.getDecalElement && e.getDecalElement();
      d && this._updateAndAddDisplayable(d, t, i);
      var c = e.getTextGuideLine();
      c && this._updateAndAddDisplayable(c, t, i);
      var f = e.getTextContent();
      f && this._updateAndAddDisplayable(f, t, i);
    }
  }, r.prototype.addRoot = function(e) {
    e.__zr && e.__zr.storage === this || this._roots.push(e);
  }, r.prototype.delRoot = function(e) {
    if (e instanceof Array) {
      for (var t = 0, i = e.length; t < i; t++)
        this.delRoot(e[t]);
      return;
    }
    var n = ue(this._roots, e);
    n >= 0 && this._roots.splice(n, 1);
  }, r.prototype.delAllRoots = function() {
    this._roots = [], this._displayList = [], this._displayListLen = 0;
  }, r.prototype.getRoots = function() {
    return this._roots;
  }, r.prototype.dispose = function() {
    this._displayList = null, this._roots = null;
  }, r;
}(), ma;
ma = W.hasGlobalWindow && (window.requestAnimationFrame && window.requestAnimationFrame.bind(window) || window.msRequestAnimationFrame && window.msRequestAnimationFrame.bind(window) || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame) || function(r) {
  return setTimeout(r, 16);
};
var Gn = {
  linear: function(r) {
    return r;
  },
  quadraticIn: function(r) {
    return r * r;
  },
  quadraticOut: function(r) {
    return r * (2 - r);
  },
  quadraticInOut: function(r) {
    return (r *= 2) < 1 ? 0.5 * r * r : -0.5 * (--r * (r - 2) - 1);
  },
  cubicIn: function(r) {
    return r * r * r;
  },
  cubicOut: function(r) {
    return --r * r * r + 1;
  },
  cubicInOut: function(r) {
    return (r *= 2) < 1 ? 0.5 * r * r * r : 0.5 * ((r -= 2) * r * r + 2);
  },
  quarticIn: function(r) {
    return r * r * r * r;
  },
  quarticOut: function(r) {
    return 1 - --r * r * r * r;
  },
  quarticInOut: function(r) {
    return (r *= 2) < 1 ? 0.5 * r * r * r * r : -0.5 * ((r -= 2) * r * r * r - 2);
  },
  quinticIn: function(r) {
    return r * r * r * r * r;
  },
  quinticOut: function(r) {
    return --r * r * r * r * r + 1;
  },
  quinticInOut: function(r) {
    return (r *= 2) < 1 ? 0.5 * r * r * r * r * r : 0.5 * ((r -= 2) * r * r * r * r + 2);
  },
  sinusoidalIn: function(r) {
    return 1 - Math.cos(r * Math.PI / 2);
  },
  sinusoidalOut: function(r) {
    return Math.sin(r * Math.PI / 2);
  },
  sinusoidalInOut: function(r) {
    return 0.5 * (1 - Math.cos(Math.PI * r));
  },
  exponentialIn: function(r) {
    return r === 0 ? 0 : Math.pow(1024, r - 1);
  },
  exponentialOut: function(r) {
    return r === 1 ? 1 : 1 - Math.pow(2, -10 * r);
  },
  exponentialInOut: function(r) {
    return r === 0 ? 0 : r === 1 ? 1 : (r *= 2) < 1 ? 0.5 * Math.pow(1024, r - 1) : 0.5 * (-Math.pow(2, -10 * (r - 1)) + 2);
  },
  circularIn: function(r) {
    return 1 - Math.sqrt(1 - r * r);
  },
  circularOut: function(r) {
    return Math.sqrt(1 - --r * r);
  },
  circularInOut: function(r) {
    return (r *= 2) < 1 ? -0.5 * (Math.sqrt(1 - r * r) - 1) : 0.5 * (Math.sqrt(1 - (r -= 2) * r) + 1);
  },
  elasticIn: function(r) {
    var e, t = 0.1, i = 0.4;
    return r === 0 ? 0 : r === 1 ? 1 : (!t || t < 1 ? (t = 1, e = i / 4) : e = i * Math.asin(1 / t) / (2 * Math.PI), -(t * Math.pow(2, 10 * (r -= 1)) * Math.sin((r - e) * (2 * Math.PI) / i)));
  },
  elasticOut: function(r) {
    var e, t = 0.1, i = 0.4;
    return r === 0 ? 0 : r === 1 ? 1 : (!t || t < 1 ? (t = 1, e = i / 4) : e = i * Math.asin(1 / t) / (2 * Math.PI), t * Math.pow(2, -10 * r) * Math.sin((r - e) * (2 * Math.PI) / i) + 1);
  },
  elasticInOut: function(r) {
    var e, t = 0.1, i = 0.4;
    return r === 0 ? 0 : r === 1 ? 1 : (!t || t < 1 ? (t = 1, e = i / 4) : e = i * Math.asin(1 / t) / (2 * Math.PI), (r *= 2) < 1 ? -0.5 * (t * Math.pow(2, 10 * (r -= 1)) * Math.sin((r - e) * (2 * Math.PI) / i)) : t * Math.pow(2, -10 * (r -= 1)) * Math.sin((r - e) * (2 * Math.PI) / i) * 0.5 + 1);
  },
  backIn: function(r) {
    var e = 1.70158;
    return r * r * ((e + 1) * r - e);
  },
  backOut: function(r) {
    var e = 1.70158;
    return --r * r * ((e + 1) * r + e) + 1;
  },
  backInOut: function(r) {
    var e = 2.5949095;
    return (r *= 2) < 1 ? 0.5 * (r * r * ((e + 1) * r - e)) : 0.5 * ((r -= 2) * r * ((e + 1) * r + e) + 2);
  },
  bounceIn: function(r) {
    return 1 - Gn.bounceOut(1 - r);
  },
  bounceOut: function(r) {
    return r < 1 / 2.75 ? 7.5625 * r * r : r < 2 / 2.75 ? 7.5625 * (r -= 1.5 / 2.75) * r + 0.75 : r < 2.5 / 2.75 ? 7.5625 * (r -= 2.25 / 2.75) * r + 0.9375 : 7.5625 * (r -= 2.625 / 2.75) * r + 0.984375;
  },
  bounceInOut: function(r) {
    return r < 0.5 ? Gn.bounceIn(r * 2) * 0.5 : Gn.bounceOut(r * 2 - 1) * 0.5 + 0.5;
  }
}, Ts = Math.pow, Ci = Math.sqrt, ba = 1e-8, fg = 1e-4, Cd = Ci(3), xs = 1 / 3, It = rn(), yt = rn(), Ur = rn();
function yi(r) {
  return r > -ba && r < ba;
}
function pg(r) {
  return r > ba || r < -ba;
}
function We(r, e, t, i, n) {
  var s = 1 - n;
  return s * s * (s * r + 3 * n * e) + n * n * (n * i + 3 * s * t);
}
function _d(r, e, t, i, n) {
  var s = 1 - n;
  return 3 * (((e - r) * s + 2 * (t - e) * n) * s + (i - t) * n * n);
}
function gg(r, e, t, i, n, s) {
  var a = i + 3 * (e - t) - r, o = 3 * (t - e * 2 + r), l = 3 * (e - r), h = r - n, u = o * o - 3 * a * l, d = o * l - 9 * a * h, c = l * l - 3 * o * h, f = 0;
  if (yi(u) && yi(d))
    if (yi(o))
      s[0] = 0;
    else {
      var p = -l / o;
      p >= 0 && p <= 1 && (s[f++] = p);
    }
  else {
    var m = d * d - 4 * u * c;
    if (yi(m)) {
      var g = d / u, p = -o / a + g, v = -g / 2;
      p >= 0 && p <= 1 && (s[f++] = p), v >= 0 && v <= 1 && (s[f++] = v);
    } else if (m > 0) {
      var b = Ci(m), y = u * o + 1.5 * a * (-d + b), w = u * o + 1.5 * a * (-d - b);
      y < 0 ? y = -Ts(-y, xs) : y = Ts(y, xs), w < 0 ? w = -Ts(-w, xs) : w = Ts(w, xs);
      var p = (-o - (y + w)) / (3 * a);
      p >= 0 && p <= 1 && (s[f++] = p);
    } else {
      var _ = (2 * u * o - 3 * a * d) / (2 * Ci(u * u * u)), E = Math.acos(_) / 3, x = Ci(u), T = Math.cos(E), p = (-o - 2 * x * T) / (3 * a), v = (-o + x * (T + Cd * Math.sin(E))) / (3 * a), C = (-o + x * (T - Cd * Math.sin(E))) / (3 * a);
      p >= 0 && p <= 1 && (s[f++] = p), v >= 0 && v <= 1 && (s[f++] = v), C >= 0 && C <= 1 && (s[f++] = C);
    }
  }
  return f;
}
function vg(r, e, t, i, n) {
  var s = 6 * t - 12 * e + 6 * r, a = 9 * e + 3 * i - 3 * r - 9 * t, o = 3 * e - 3 * r, l = 0;
  if (yi(a)) {
    if (pg(s)) {
      var h = -o / s;
      h >= 0 && h <= 1 && (n[l++] = h);
    }
  } else {
    var u = s * s - 4 * a * o;
    if (yi(u))
      n[0] = -s / (2 * a);
    else if (u > 0) {
      var d = Ci(u), h = (-s + d) / (2 * a), c = (-s - d) / (2 * a);
      h >= 0 && h <= 1 && (n[l++] = h), c >= 0 && c <= 1 && (n[l++] = c);
    }
  }
  return l;
}
function ya(r, e, t, i, n, s) {
  var a = (e - r) * n + r, o = (t - e) * n + e, l = (i - t) * n + t, h = (o - a) * n + a, u = (l - o) * n + o, d = (u - h) * n + h;
  s[0] = r, s[1] = a, s[2] = h, s[3] = d, s[4] = d, s[5] = u, s[6] = l, s[7] = i;
}
function G0(r, e, t, i, n, s, a, o, l, h, u) {
  var d, c = 5e-3, f = 1 / 0, p, m, g, v;
  It[0] = l, It[1] = h;
  for (var b = 0; b < 1; b += 0.05)
    yt[0] = We(r, t, n, a, b), yt[1] = We(e, i, s, o, b), g = Wr(It, yt), g < f && (d = b, f = g);
  f = 1 / 0;
  for (var y = 0; y < 32 && !(c < fg); y++)
    p = d - c, m = d + c, yt[0] = We(r, t, n, a, p), yt[1] = We(e, i, s, o, p), g = Wr(yt, It), p >= 0 && g < f ? (d = p, f = g) : (Ur[0] = We(r, t, n, a, m), Ur[1] = We(e, i, s, o, m), v = Wr(Ur, It), m <= 1 && v < f ? (d = m, f = v) : c *= 0.5);
  return Ci(f);
}
function U0(r, e, t, i, n, s, a, o, l) {
  for (var h = r, u = e, d = 0, c = 1 / l, f = 1; f <= l; f++) {
    var p = f * c, m = We(r, t, n, a, p), g = We(e, i, s, o, p), v = m - h, b = g - u;
    d += Math.sqrt(v * v + b * b), h = m, u = g;
  }
  return d;
}
function qe(r, e, t, i) {
  var n = 1 - i;
  return n * (n * r + 2 * i * e) + i * i * t;
}
function Ed(r, e, t, i) {
  return 2 * ((1 - i) * (e - r) + i * (t - e));
}
function j0(r, e, t, i, n) {
  var s = r - 2 * e + t, a = 2 * (e - r), o = r - i, l = 0;
  if (yi(s)) {
    if (pg(a)) {
      var h = -o / a;
      h >= 0 && h <= 1 && (n[l++] = h);
    }
  } else {
    var u = a * a - 4 * s * o;
    if (yi(u)) {
      var h = -a / (2 * s);
      h >= 0 && h <= 1 && (n[l++] = h);
    } else if (u > 0) {
      var d = Ci(u), h = (-a + d) / (2 * s), c = (-a - d) / (2 * s);
      h >= 0 && h <= 1 && (n[l++] = h), c >= 0 && c <= 1 && (n[l++] = c);
    }
  }
  return l;
}
function mg(r, e, t) {
  var i = r + t - 2 * e;
  return i === 0 ? 0.5 : (r - e) / i;
}
function wa(r, e, t, i, n) {
  var s = (e - r) * i + r, a = (t - e) * i + e, o = (a - s) * i + s;
  n[0] = r, n[1] = s, n[2] = o, n[3] = o, n[4] = a, n[5] = t;
}
function Y0(r, e, t, i, n, s, a, o, l) {
  var h, u = 5e-3, d = 1 / 0;
  It[0] = a, It[1] = o;
  for (var c = 0; c < 1; c += 0.05) {
    yt[0] = qe(r, t, n, c), yt[1] = qe(e, i, s, c);
    var f = Wr(It, yt);
    f < d && (h = c, d = f);
  }
  d = 1 / 0;
  for (var p = 0; p < 32 && !(u < fg); p++) {
    var m = h - u, g = h + u;
    yt[0] = qe(r, t, n, m), yt[1] = qe(e, i, s, m);
    var f = Wr(yt, It);
    if (m >= 0 && f < d)
      h = m, d = f;
    else {
      Ur[0] = qe(r, t, n, g), Ur[1] = qe(e, i, s, g);
      var v = Wr(Ur, It);
      g <= 1 && v < d ? (h = g, d = v) : u *= 0.5;
    }
  }
  return Ci(d);
}
function X0(r, e, t, i, n, s, a) {
  for (var o = r, l = e, h = 0, u = 1 / a, d = 1; d <= a; d++) {
    var c = d * u, f = qe(r, t, n, c), p = qe(e, i, s, c), m = f - o, g = p - l;
    h += Math.sqrt(m * m + g * g), o = f, l = p;
  }
  return h;
}
var $0 = /cubic-bezier\(([0-9,\.e ]+)\)/;
function bg(r) {
  var e = r && $0.exec(r);
  if (e) {
    var t = e[1].split(","), i = +zt(t[0]), n = +zt(t[1]), s = +zt(t[2]), a = +zt(t[3]);
    if (isNaN(i + n + s + a))
      return;
    var o = [];
    return function(l) {
      return l <= 0 ? 0 : l >= 1 ? 1 : gg(0, i, s, 1, l, o) && We(0, n, a, 1, o[0]);
    };
  }
}
var q0 = function() {
  function r(e) {
    this._inited = !1, this._startTime = 0, this._pausedTime = 0, this._paused = !1, this._life = e.life || 1e3, this._delay = e.delay || 0, this.loop = e.loop || !1, this.onframe = e.onframe || Le, this.ondestroy = e.ondestroy || Le, this.onrestart = e.onrestart || Le, e.easing && this.setEasing(e.easing);
  }
  return r.prototype.step = function(e, t) {
    if (this._inited || (this._startTime = e + this._delay, this._inited = !0), this._paused) {
      this._pausedTime += t;
      return;
    }
    var i = this._life, n = e - this._startTime - this._pausedTime, s = n / i;
    s < 0 && (s = 0), s = Math.min(s, 1);
    var a = this.easingFunc, o = a ? a(s) : s;
    if (this.onframe(o), s === 1)
      if (this.loop) {
        var l = n % i;
        this._startTime = e - l, this._pausedTime = 0, this.onrestart();
      } else
        return !0;
    return !1;
  }, r.prototype.pause = function() {
    this._paused = !0;
  }, r.prototype.resume = function() {
    this._paused = !1;
  }, r.prototype.setEasing = function(e) {
    this.easing = e, this.easingFunc = q(e) ? e : Gn[e] || bg(e);
  }, r;
}(), yg = /* @__PURE__ */ function() {
  function r(e) {
    this.value = e;
  }
  return r;
}(), K0 = function() {
  function r() {
    this._len = 0;
  }
  return r.prototype.insert = function(e) {
    var t = new yg(e);
    return this.insertEntry(t), t;
  }, r.prototype.insertEntry = function(e) {
    this.head ? (this.tail.next = e, e.prev = this.tail, e.next = null, this.tail = e) : this.head = this.tail = e, this._len++;
  }, r.prototype.remove = function(e) {
    var t = e.prev, i = e.next;
    t ? t.next = i : this.head = i, i ? i.prev = t : this.tail = t, e.next = e.prev = null, this._len--;
  }, r.prototype.len = function() {
    return this._len;
  }, r.prototype.clear = function() {
    this.head = this.tail = null, this._len = 0;
  }, r;
}(), vs = function() {
  function r(e) {
    this._list = new K0(), this._maxSize = 10, this._map = {}, this._maxSize = e;
  }
  return r.prototype.put = function(e, t) {
    var i = this._list, n = this._map, s = null;
    if (n[e] == null) {
      var a = i.len(), o = this._lastRemovedEntry;
      if (a >= this._maxSize && a > 0) {
        var l = i.head;
        i.remove(l), delete n[l.key], s = l.value, this._lastRemovedEntry = l;
      }
      o ? o.value = t : o = new yg(t), o.key = e, i.insertEntry(o), n[e] = o;
    }
    return s;
  }, r.prototype.get = function(e) {
    var t = this._map[e], i = this._list;
    if (t != null)
      return t !== i.tail && (i.remove(t), i.insertEntry(t)), t.value;
  }, r.prototype.clear = function() {
    this._list.clear(), this._map = {};
  }, r.prototype.len = function() {
    return this._list.len();
  }, r;
}(), Td = {
  transparent: [0, 0, 0, 0],
  aliceblue: [240, 248, 255, 1],
  antiquewhite: [250, 235, 215, 1],
  aqua: [0, 255, 255, 1],
  aquamarine: [127, 255, 212, 1],
  azure: [240, 255, 255, 1],
  beige: [245, 245, 220, 1],
  bisque: [255, 228, 196, 1],
  black: [0, 0, 0, 1],
  blanchedalmond: [255, 235, 205, 1],
  blue: [0, 0, 255, 1],
  blueviolet: [138, 43, 226, 1],
  brown: [165, 42, 42, 1],
  burlywood: [222, 184, 135, 1],
  cadetblue: [95, 158, 160, 1],
  chartreuse: [127, 255, 0, 1],
  chocolate: [210, 105, 30, 1],
  coral: [255, 127, 80, 1],
  cornflowerblue: [100, 149, 237, 1],
  cornsilk: [255, 248, 220, 1],
  crimson: [220, 20, 60, 1],
  cyan: [0, 255, 255, 1],
  darkblue: [0, 0, 139, 1],
  darkcyan: [0, 139, 139, 1],
  darkgoldenrod: [184, 134, 11, 1],
  darkgray: [169, 169, 169, 1],
  darkgreen: [0, 100, 0, 1],
  darkgrey: [169, 169, 169, 1],
  darkkhaki: [189, 183, 107, 1],
  darkmagenta: [139, 0, 139, 1],
  darkolivegreen: [85, 107, 47, 1],
  darkorange: [255, 140, 0, 1],
  darkorchid: [153, 50, 204, 1],
  darkred: [139, 0, 0, 1],
  darksalmon: [233, 150, 122, 1],
  darkseagreen: [143, 188, 143, 1],
  darkslateblue: [72, 61, 139, 1],
  darkslategray: [47, 79, 79, 1],
  darkslategrey: [47, 79, 79, 1],
  darkturquoise: [0, 206, 209, 1],
  darkviolet: [148, 0, 211, 1],
  deeppink: [255, 20, 147, 1],
  deepskyblue: [0, 191, 255, 1],
  dimgray: [105, 105, 105, 1],
  dimgrey: [105, 105, 105, 1],
  dodgerblue: [30, 144, 255, 1],
  firebrick: [178, 34, 34, 1],
  floralwhite: [255, 250, 240, 1],
  forestgreen: [34, 139, 34, 1],
  fuchsia: [255, 0, 255, 1],
  gainsboro: [220, 220, 220, 1],
  ghostwhite: [248, 248, 255, 1],
  gold: [255, 215, 0, 1],
  goldenrod: [218, 165, 32, 1],
  gray: [128, 128, 128, 1],
  green: [0, 128, 0, 1],
  greenyellow: [173, 255, 47, 1],
  grey: [128, 128, 128, 1],
  honeydew: [240, 255, 240, 1],
  hotpink: [255, 105, 180, 1],
  indianred: [205, 92, 92, 1],
  indigo: [75, 0, 130, 1],
  ivory: [255, 255, 240, 1],
  khaki: [240, 230, 140, 1],
  lavender: [230, 230, 250, 1],
  lavenderblush: [255, 240, 245, 1],
  lawngreen: [124, 252, 0, 1],
  lemonchiffon: [255, 250, 205, 1],
  lightblue: [173, 216, 230, 1],
  lightcoral: [240, 128, 128, 1],
  lightcyan: [224, 255, 255, 1],
  lightgoldenrodyellow: [250, 250, 210, 1],
  lightgray: [211, 211, 211, 1],
  lightgreen: [144, 238, 144, 1],
  lightgrey: [211, 211, 211, 1],
  lightpink: [255, 182, 193, 1],
  lightsalmon: [255, 160, 122, 1],
  lightseagreen: [32, 178, 170, 1],
  lightskyblue: [135, 206, 250, 1],
  lightslategray: [119, 136, 153, 1],
  lightslategrey: [119, 136, 153, 1],
  lightsteelblue: [176, 196, 222, 1],
  lightyellow: [255, 255, 224, 1],
  lime: [0, 255, 0, 1],
  limegreen: [50, 205, 50, 1],
  linen: [250, 240, 230, 1],
  magenta: [255, 0, 255, 1],
  maroon: [128, 0, 0, 1],
  mediumaquamarine: [102, 205, 170, 1],
  mediumblue: [0, 0, 205, 1],
  mediumorchid: [186, 85, 211, 1],
  mediumpurple: [147, 112, 219, 1],
  mediumseagreen: [60, 179, 113, 1],
  mediumslateblue: [123, 104, 238, 1],
  mediumspringgreen: [0, 250, 154, 1],
  mediumturquoise: [72, 209, 204, 1],
  mediumvioletred: [199, 21, 133, 1],
  midnightblue: [25, 25, 112, 1],
  mintcream: [245, 255, 250, 1],
  mistyrose: [255, 228, 225, 1],
  moccasin: [255, 228, 181, 1],
  navajowhite: [255, 222, 173, 1],
  navy: [0, 0, 128, 1],
  oldlace: [253, 245, 230, 1],
  olive: [128, 128, 0, 1],
  olivedrab: [107, 142, 35, 1],
  orange: [255, 165, 0, 1],
  orangered: [255, 69, 0, 1],
  orchid: [218, 112, 214, 1],
  palegoldenrod: [238, 232, 170, 1],
  palegreen: [152, 251, 152, 1],
  paleturquoise: [175, 238, 238, 1],
  palevioletred: [219, 112, 147, 1],
  papayawhip: [255, 239, 213, 1],
  peachpuff: [255, 218, 185, 1],
  peru: [205, 133, 63, 1],
  pink: [255, 192, 203, 1],
  plum: [221, 160, 221, 1],
  powderblue: [176, 224, 230, 1],
  purple: [128, 0, 128, 1],
  red: [255, 0, 0, 1],
  rosybrown: [188, 143, 143, 1],
  royalblue: [65, 105, 225, 1],
  saddlebrown: [139, 69, 19, 1],
  salmon: [250, 128, 114, 1],
  sandybrown: [244, 164, 96, 1],
  seagreen: [46, 139, 87, 1],
  seashell: [255, 245, 238, 1],
  sienna: [160, 82, 45, 1],
  silver: [192, 192, 192, 1],
  skyblue: [135, 206, 235, 1],
  slateblue: [106, 90, 205, 1],
  slategray: [112, 128, 144, 1],
  slategrey: [112, 128, 144, 1],
  snow: [255, 250, 250, 1],
  springgreen: [0, 255, 127, 1],
  steelblue: [70, 130, 180, 1],
  tan: [210, 180, 140, 1],
  teal: [0, 128, 128, 1],
  thistle: [216, 191, 216, 1],
  tomato: [255, 99, 71, 1],
  turquoise: [64, 224, 208, 1],
  violet: [238, 130, 238, 1],
  wheat: [245, 222, 179, 1],
  white: [255, 255, 255, 1],
  whitesmoke: [245, 245, 245, 1],
  yellow: [255, 255, 0, 1],
  yellowgreen: [154, 205, 50, 1]
};
function _i(r) {
  return r = Math.round(r), r < 0 ? 0 : r > 255 ? 255 : r;
}
function Z0(r) {
  return r = Math.round(r), r < 0 ? 0 : r > 360 ? 360 : r;
}
function Ca(r) {
  return r < 0 ? 0 : r > 1 ? 1 : r;
}
function Mo(r) {
  var e = r;
  return e.length && e.charAt(e.length - 1) === "%" ? _i(parseFloat(e) / 100 * 255) : _i(parseInt(e, 10));
}
function ar(r) {
  var e = r;
  return e.length && e.charAt(e.length - 1) === "%" ? Ca(parseFloat(e) / 100) : Ca(parseFloat(e));
}
function Do(r, e, t) {
  return t < 0 ? t += 1 : t > 1 && (t -= 1), t * 6 < 1 ? r + (e - r) * t * 6 : t * 2 < 1 ? e : t * 3 < 2 ? r + (e - r) * (2 / 3 - t) * 6 : r;
}
function Ss(r, e, t) {
  return r + (e - r) * t;
}
function pt(r, e, t, i, n) {
  return r[0] = e, r[1] = t, r[2] = i, r[3] = n, r;
}
function vh(r, e) {
  return r[0] = e[0], r[1] = e[1], r[2] = e[2], r[3] = e[3], r;
}
var wg = new vs(20), Rs = null;
function mr(r, e) {
  Rs && vh(Rs, e), Rs = wg.put(r, Rs || e.slice());
}
function Zt(r, e) {
  if (r) {
    e = e || [];
    var t = wg.get(r);
    if (t)
      return vh(e, t);
    r = r + "";
    var i = r.replace(/ /g, "").toLowerCase();
    if (i in Td)
      return vh(e, Td[i]), mr(r, e), e;
    var n = i.length;
    if (i.charAt(0) === "#") {
      if (n === 4 || n === 5) {
        var s = parseInt(i.slice(1, 4), 16);
        if (!(s >= 0 && s <= 4095)) {
          pt(e, 0, 0, 0, 1);
          return;
        }
        return pt(e, (s & 3840) >> 4 | (s & 3840) >> 8, s & 240 | (s & 240) >> 4, s & 15 | (s & 15) << 4, n === 5 ? parseInt(i.slice(4), 16) / 15 : 1), mr(r, e), e;
      } else if (n === 7 || n === 9) {
        var s = parseInt(i.slice(1, 7), 16);
        if (!(s >= 0 && s <= 16777215)) {
          pt(e, 0, 0, 0, 1);
          return;
        }
        return pt(e, (s & 16711680) >> 16, (s & 65280) >> 8, s & 255, n === 9 ? parseInt(i.slice(7), 16) / 255 : 1), mr(r, e), e;
      }
      return;
    }
    var a = i.indexOf("("), o = i.indexOf(")");
    if (a !== -1 && o + 1 === n) {
      var l = i.substr(0, a), h = i.substr(a + 1, o - (a + 1)).split(","), u = 1;
      switch (l) {
        case "rgba":
          if (h.length !== 4)
            return h.length === 3 ? pt(e, +h[0], +h[1], +h[2], 1) : pt(e, 0, 0, 0, 1);
          u = ar(h.pop());
        case "rgb":
          if (h.length >= 3)
            return pt(e, Mo(h[0]), Mo(h[1]), Mo(h[2]), h.length === 3 ? u : ar(h[3])), mr(r, e), e;
          pt(e, 0, 0, 0, 1);
          return;
        case "hsla":
          if (h.length !== 4) {
            pt(e, 0, 0, 0, 1);
            return;
          }
          return h[3] = ar(h[3]), mh(h, e), mr(r, e), e;
        case "hsl":
          if (h.length !== 3) {
            pt(e, 0, 0, 0, 1);
            return;
          }
          return mh(h, e), mr(r, e), e;
        default:
          return;
      }
    }
    pt(e, 0, 0, 0, 1);
  }
}
function mh(r, e) {
  var t = (parseFloat(r[0]) % 360 + 360) % 360 / 360, i = ar(r[1]), n = ar(r[2]), s = n <= 0.5 ? n * (i + 1) : n + i - n * i, a = n * 2 - s;
  return e = e || [], pt(e, _i(Do(a, s, t + 1 / 3) * 255), _i(Do(a, s, t) * 255), _i(Do(a, s, t - 1 / 3) * 255), 1), r.length === 4 && (e[3] = r[3]), e;
}
function J0(r) {
  if (r) {
    var e = r[0] / 255, t = r[1] / 255, i = r[2] / 255, n = Math.min(e, t, i), s = Math.max(e, t, i), a = s - n, o = (s + n) / 2, l, h;
    if (a === 0)
      l = 0, h = 0;
    else {
      o < 0.5 ? h = a / (s + n) : h = a / (2 - s - n);
      var u = ((s - e) / 6 + a / 2) / a, d = ((s - t) / 6 + a / 2) / a, c = ((s - i) / 6 + a / 2) / a;
      e === s ? l = c - d : t === s ? l = 1 / 3 + u - c : i === s && (l = 2 / 3 + d - u), l < 0 && (l += 1), l > 1 && (l -= 1);
    }
    var f = [l * 360, h, o];
    return r[3] != null && f.push(r[3]), f;
  }
}
function xd(r, e) {
  var t = Zt(r);
  if (t) {
    for (var i = 0; i < 3; i++)
      t[i] = t[i] * (1 - e) | 0, t[i] > 255 ? t[i] = 255 : t[i] < 0 && (t[i] = 0);
    return or(t, t.length === 4 ? "rgba" : "rgb");
  }
}
function Lo(r, e, t) {
  if (!(!(e && e.length) || !(r >= 0 && r <= 1))) {
    t = t || [];
    var i = r * (e.length - 1), n = Math.floor(i), s = Math.ceil(i), a = e[n], o = e[s], l = i - n;
    return t[0] = _i(Ss(a[0], o[0], l)), t[1] = _i(Ss(a[1], o[1], l)), t[2] = _i(Ss(a[2], o[2], l)), t[3] = Ca(Ss(a[3], o[3], l)), t;
  }
}
function Un(r, e, t, i) {
  var n = Zt(r);
  if (r)
    return n = J0(n), e != null && (n[0] = Z0(e)), t != null && (n[1] = ar(t)), i != null && (n[2] = ar(i)), or(mh(n), "rgba");
}
function Cg(r, e) {
  var t = Zt(r);
  if (t && e != null)
    return t[3] = Ca(e), or(t, "rgba");
}
function or(r, e) {
  if (!(!r || !r.length)) {
    var t = r[0] + "," + r[1] + "," + r[2];
    return (e === "rgba" || e === "hsva" || e === "hsla") && (t += "," + r[3]), e + "(" + t + ")";
  }
}
function _a(r, e) {
  var t = Zt(r);
  return t ? (0.299 * t[0] + 0.587 * t[1] + 0.114 * t[2]) * t[3] / 255 + (1 - t[3]) * e : 0;
}
var Sd = new vs(100);
function Rd(r) {
  if (V(r)) {
    var e = Sd.get(r);
    return e || (e = xd(r, -0.1), Sd.put(r, e)), e;
  } else if (Ka(r)) {
    var t = P({}, r);
    return t.colorStops = J(r.colorStops, function(i) {
      return {
        offset: i.offset,
        color: xd(i.color, -0.1)
      };
    }), t;
  }
  return r;
}
function Q0(r) {
  return r.type === "linear";
}
function eC(r) {
  return r.type === "radial";
}
(function() {
  return W.hasGlobalWindow && q(window.btoa) ? function(r) {
    return window.btoa(unescape(encodeURIComponent(r)));
  } : typeof Buffer < "u" ? function(r) {
    return Buffer.from(r).toString("base64");
  } : function(r) {
    return process.env.NODE_ENV !== "production" && nr("Base64 isn't natively supported in the current environment."), null;
  };
})();
var bh = Array.prototype.slice;
function Xt(r, e, t) {
  return (e - r) * t + r;
}
function ko(r, e, t, i) {
  for (var n = e.length, s = 0; s < n; s++)
    r[s] = Xt(e[s], t[s], i);
  return r;
}
function tC(r, e, t, i) {
  for (var n = e.length, s = n && e[0].length, a = 0; a < n; a++) {
    r[a] || (r[a] = []);
    for (var o = 0; o < s; o++)
      r[a][o] = Xt(e[a][o], t[a][o], i);
  }
  return r;
}
function Ms(r, e, t, i) {
  for (var n = e.length, s = 0; s < n; s++)
    r[s] = e[s] + t[s] * i;
  return r;
}
function Md(r, e, t, i) {
  for (var n = e.length, s = n && e[0].length, a = 0; a < n; a++) {
    r[a] || (r[a] = []);
    for (var o = 0; o < s; o++)
      r[a][o] = e[a][o] + t[a][o] * i;
  }
  return r;
}
function iC(r, e) {
  for (var t = r.length, i = e.length, n = t > i ? e : r, s = Math.min(t, i), a = n[s - 1] || { color: [0, 0, 0, 0], offset: 0 }, o = s; o < Math.max(t, i); o++)
    n.push({
      offset: a.offset,
      color: a.color.slice()
    });
}
function rC(r, e, t) {
  var i = r, n = e;
  if (!(!i.push || !n.push)) {
    var s = i.length, a = n.length;
    if (s !== a) {
      var o = s > a;
      if (o)
        i.length = a;
      else
        for (var l = s; l < a; l++)
          i.push(t === 1 ? n[l] : bh.call(n[l]));
    }
    for (var h = i[0] && i[0].length, l = 0; l < i.length; l++)
      if (t === 1)
        isNaN(i[l]) && (i[l] = n[l]);
      else
        for (var u = 0; u < h; u++)
          isNaN(i[l][u]) && (i[l][u] = n[l][u]);
  }
}
function ra(r) {
  if (Je(r)) {
    var e = r.length;
    if (Je(r[0])) {
      for (var t = [], i = 0; i < e; i++)
        t.push(bh.call(r[i]));
      return t;
    }
    return bh.call(r);
  }
  return r;
}
function na(r) {
  return r[0] = Math.floor(r[0]) || 0, r[1] = Math.floor(r[1]) || 0, r[2] = Math.floor(r[2]) || 0, r[3] = r[3] == null ? 1 : r[3], "rgba(" + r.join(",") + ")";
}
function nC(r) {
  return Je(r && r[0]) ? 2 : 1;
}
var Ds = 0, sa = 1, _g = 2, On = 3, yh = 4, wh = 5, Dd = 6;
function Ld(r) {
  return r === yh || r === wh;
}
function Ls(r) {
  return r === sa || r === _g;
}
var gn = [0, 0, 0, 0], sC = function() {
  function r(e) {
    this.keyframes = [], this.discrete = !1, this._invalid = !1, this._needsSort = !1, this._lastFr = 0, this._lastFrP = 0, this.propName = e;
  }
  return r.prototype.isFinished = function() {
    return this._finished;
  }, r.prototype.setFinished = function() {
    this._finished = !0, this._additiveTrack && this._additiveTrack.setFinished();
  }, r.prototype.needsAnimate = function() {
    return this.keyframes.length >= 1;
  }, r.prototype.getAdditiveTrack = function() {
    return this._additiveTrack;
  }, r.prototype.addKeyframe = function(e, t, i) {
    this._needsSort = !0;
    var n = this.keyframes, s = n.length, a = !1, o = Dd, l = t;
    if (Je(t)) {
      var h = nC(t);
      o = h, (h === 1 && !Re(t[0]) || h === 2 && !Re(t[0][0])) && (a = !0);
    } else if (Re(t) && !ig(t))
      o = Ds;
    else if (V(t))
      if (!isNaN(+t))
        o = Ds;
      else {
        var u = Zt(t);
        u && (l = u, o = On);
      }
    else if (Ka(t)) {
      var d = P({}, l);
      d.colorStops = J(t.colorStops, function(f) {
        return {
          offset: f.offset,
          color: Zt(f.color)
        };
      }), Q0(t) ? o = yh : eC(t) && (o = wh), l = d;
    }
    s === 0 ? this.valType = o : (o !== this.valType || o === Dd) && (a = !0), this.discrete = this.discrete || a;
    var c = {
      time: e,
      value: l,
      rawValue: t,
      percent: 0
    };
    return i && (c.easing = i, c.easingFunc = q(i) ? i : Gn[i] || bg(i)), n.push(c), c;
  }, r.prototype.prepare = function(e, t) {
    var i = this.keyframes;
    this._needsSort && i.sort(function(m, g) {
      return m.time - g.time;
    });
    for (var n = this.valType, s = i.length, a = i[s - 1], o = this.discrete, l = Ls(n), h = Ld(n), u = 0; u < s; u++) {
      var d = i[u], c = d.value, f = a.value;
      d.percent = d.time / e, o || (l && u !== s - 1 ? rC(c, f, n) : h && iC(c.colorStops, f.colorStops));
    }
    if (!o && n !== wh && t && this.needsAnimate() && t.needsAnimate() && n === t.valType && !t._finished) {
      this._additiveTrack = t;
      for (var p = i[0].value, u = 0; u < s; u++)
        n === Ds ? i[u].additiveValue = i[u].value - p : n === On ? i[u].additiveValue = Ms([], i[u].value, p, -1) : Ls(n) && (i[u].additiveValue = n === sa ? Ms([], i[u].value, p, -1) : Md([], i[u].value, p, -1));
    }
  }, r.prototype.step = function(e, t) {
    if (!this._finished) {
      this._additiveTrack && this._additiveTrack._finished && (this._additiveTrack = null);
      var i = this._additiveTrack != null, n = i ? "additiveValue" : "value", s = this.valType, a = this.keyframes, o = a.length, l = this.propName, h = s === On, u, d = this._lastFr, c = Math.min, f, p;
      if (o === 1)
        f = p = a[0];
      else {
        if (t < 0)
          u = 0;
        else if (t < this._lastFrP) {
          var m = c(d + 1, o - 1);
          for (u = m; u >= 0 && !(a[u].percent <= t); u--)
            ;
          u = c(u, o - 2);
        } else {
          for (u = d; u < o && !(a[u].percent > t); u++)
            ;
          u = c(u - 1, o - 2);
        }
        p = a[u + 1], f = a[u];
      }
      if (f && p) {
        this._lastFr = u, this._lastFrP = t;
        var g = p.percent - f.percent, v = g === 0 ? 1 : c((t - f.percent) / g, 1);
        p.easingFunc && (v = p.easingFunc(v));
        var b = i ? this._additiveValue : h ? gn : e[l];
        if ((Ls(s) || h) && !b && (b = this._additiveValue = []), this.discrete)
          e[l] = v < 1 ? f.rawValue : p.rawValue;
        else if (Ls(s))
          s === sa ? ko(b, f[n], p[n], v) : tC(b, f[n], p[n], v);
        else if (Ld(s)) {
          var y = f[n], w = p[n], _ = s === yh;
          e[l] = {
            type: _ ? "linear" : "radial",
            x: Xt(y.x, w.x, v),
            y: Xt(y.y, w.y, v),
            colorStops: J(y.colorStops, function(x, T) {
              var C = w.colorStops[T];
              return {
                offset: Xt(x.offset, C.offset, v),
                color: na(ko([], x.color, C.color, v))
              };
            }),
            global: w.global
          }, _ ? (e[l].x2 = Xt(y.x2, w.x2, v), e[l].y2 = Xt(y.y2, w.y2, v)) : e[l].r = Xt(y.r, w.r, v);
        } else if (h)
          ko(b, f[n], p[n], v), i || (e[l] = na(b));
        else {
          var E = Xt(f[n], p[n], v);
          i ? this._additiveValue = E : e[l] = E;
        }
        i && this._addToTarget(e);
      }
    }
  }, r.prototype._addToTarget = function(e) {
    var t = this.valType, i = this.propName, n = this._additiveValue;
    t === Ds ? e[i] = e[i] + n : t === On ? (Zt(e[i], gn), Ms(gn, gn, n, 1), e[i] = na(gn)) : t === sa ? Ms(e[i], e[i], n, 1) : t === _g && Md(e[i], e[i], n, 1);
  }, r;
}(), pu = function() {
  function r(e, t, i, n) {
    if (this._tracks = {}, this._trackKeys = [], this._maxTime = 0, this._started = 0, this._clip = null, this._target = e, this._loop = t, t && n) {
      nr("Can' use additive animation on looped animation.");
      return;
    }
    this._additiveAnimators = n, this._allowDiscrete = i;
  }
  return r.prototype.getMaxTime = function() {
    return this._maxTime;
  }, r.prototype.getDelay = function() {
    return this._delay;
  }, r.prototype.getLoop = function() {
    return this._loop;
  }, r.prototype.getTarget = function() {
    return this._target;
  }, r.prototype.changeTarget = function(e) {
    this._target = e;
  }, r.prototype.when = function(e, t, i) {
    return this.whenWithKeys(e, t, me(t), i);
  }, r.prototype.whenWithKeys = function(e, t, i, n) {
    for (var s = this._tracks, a = 0; a < i.length; a++) {
      var o = i[a], l = s[o];
      if (!l) {
        l = s[o] = new sC(o);
        var h = void 0, u = this._getAdditiveTrack(o);
        if (u) {
          var d = u.keyframes, c = d[d.length - 1];
          h = c && c.value, u.valType === On && h && (h = na(h));
        } else
          h = this._target[o];
        if (h == null)
          continue;
        e > 0 && l.addKeyframe(0, ra(h), n), this._trackKeys.push(o);
      }
      l.addKeyframe(e, ra(t[o]), n);
    }
    return this._maxTime = Math.max(this._maxTime, e), this;
  }, r.prototype.pause = function() {
    this._clip.pause(), this._paused = !0;
  }, r.prototype.resume = function() {
    this._clip.resume(), this._paused = !1;
  }, r.prototype.isPaused = function() {
    return !!this._paused;
  }, r.prototype.duration = function(e) {
    return this._maxTime = e, this._force = !0, this;
  }, r.prototype._doneCallback = function() {
    this._setTracksFinished(), this._clip = null;
    var e = this._doneCbs;
    if (e)
      for (var t = e.length, i = 0; i < t; i++)
        e[i].call(this);
  }, r.prototype._abortedCallback = function() {
    this._setTracksFinished();
    var e = this.animation, t = this._abortedCbs;
    if (e && e.removeClip(this._clip), this._clip = null, t)
      for (var i = 0; i < t.length; i++)
        t[i].call(this);
  }, r.prototype._setTracksFinished = function() {
    for (var e = this._tracks, t = this._trackKeys, i = 0; i < t.length; i++)
      e[t[i]].setFinished();
  }, r.prototype._getAdditiveTrack = function(e) {
    var t, i = this._additiveAnimators;
    if (i)
      for (var n = 0; n < i.length; n++) {
        var s = i[n].getTrack(e);
        s && (t = s);
      }
    return t;
  }, r.prototype.start = function(e) {
    if (!(this._started > 0)) {
      this._started = 1;
      for (var t = this, i = [], n = this._maxTime || 0, s = 0; s < this._trackKeys.length; s++) {
        var a = this._trackKeys[s], o = this._tracks[a], l = this._getAdditiveTrack(a), h = o.keyframes, u = h.length;
        if (o.prepare(n, l), o.needsAnimate())
          if (!this._allowDiscrete && o.discrete) {
            var d = h[u - 1];
            d && (t._target[o.propName] = d.rawValue), o.setFinished();
          } else
            i.push(o);
      }
      if (i.length || this._force) {
        var c = new q0({
          life: n,
          loop: this._loop,
          delay: this._delay || 0,
          onframe: function(f) {
            t._started = 2;
            var p = t._additiveAnimators;
            if (p) {
              for (var m = !1, g = 0; g < p.length; g++)
                if (p[g]._clip) {
                  m = !0;
                  break;
                }
              m || (t._additiveAnimators = null);
            }
            for (var g = 0; g < i.length; g++)
              i[g].step(t._target, f);
            var v = t._onframeCbs;
            if (v)
              for (var g = 0; g < v.length; g++)
                v[g](t._target, f);
          },
          ondestroy: function() {
            t._doneCallback();
          }
        });
        this._clip = c, this.animation && this.animation.addClip(c), e && c.setEasing(e);
      } else
        this._doneCallback();
      return this;
    }
  }, r.prototype.stop = function(e) {
    if (this._clip) {
      var t = this._clip;
      e && t.onframe(1), this._abortedCallback();
    }
  }, r.prototype.delay = function(e) {
    return this._delay = e, this;
  }, r.prototype.during = function(e) {
    return e && (this._onframeCbs || (this._onframeCbs = []), this._onframeCbs.push(e)), this;
  }, r.prototype.done = function(e) {
    return e && (this._doneCbs || (this._doneCbs = []), this._doneCbs.push(e)), this;
  }, r.prototype.aborted = function(e) {
    return e && (this._abortedCbs || (this._abortedCbs = []), this._abortedCbs.push(e)), this;
  }, r.prototype.getClip = function() {
    return this._clip;
  }, r.prototype.getTrack = function(e) {
    return this._tracks[e];
  }, r.prototype.getTracks = function() {
    var e = this;
    return J(this._trackKeys, function(t) {
      return e._tracks[t];
    });
  }, r.prototype.stopTracks = function(e, t) {
    if (!e.length || !this._clip)
      return !0;
    for (var i = this._tracks, n = this._trackKeys, s = 0; s < e.length; s++) {
      var a = i[e[s]];
      a && !a.isFinished() && (t ? a.step(this._target, 1) : this._started === 1 && a.step(this._target, 0), a.setFinished());
    }
    for (var o = !0, s = 0; s < n.length; s++)
      if (!i[n[s]].isFinished()) {
        o = !1;
        break;
      }
    return o && this._abortedCallback(), o;
  }, r.prototype.saveTo = function(e, t, i) {
    if (e) {
      t = t || this._trackKeys;
      for (var n = 0; n < t.length; n++) {
        var s = t[n], a = this._tracks[s];
        if (!(!a || a.isFinished())) {
          var o = a.keyframes, l = o[i ? 0 : o.length - 1];
          l && (e[s] = ra(l.rawValue));
        }
      }
    }
  }, r.prototype.__changeFinalValue = function(e, t) {
    t = t || me(e);
    for (var i = 0; i < t.length; i++) {
      var n = t[i], s = this._tracks[n];
      if (s) {
        var a = s.keyframes;
        if (a.length > 1) {
          var o = a.pop();
          s.addKeyframe(o.time, e[n]), s.prepare(this._maxTime, s.getAdditiveTrack());
        }
      }
    }
  }, r;
}();
function Or() {
  return (/* @__PURE__ */ new Date()).getTime();
}
var aC = function(r) {
  oe(e, r);
  function e(t) {
    var i = r.call(this) || this;
    return i._running = !1, i._time = 0, i._pausedTime = 0, i._pauseStart = 0, i._paused = !1, t = t || {}, i.stage = t.stage || {}, i;
  }
  return e.prototype.addClip = function(t) {
    t.animation && this.removeClip(t), this._head ? (this._tail.next = t, t.prev = this._tail, t.next = null, this._tail = t) : this._head = this._tail = t, t.animation = this;
  }, e.prototype.addAnimator = function(t) {
    t.animation = this;
    var i = t.getClip();
    i && this.addClip(i);
  }, e.prototype.removeClip = function(t) {
    if (t.animation) {
      var i = t.prev, n = t.next;
      i ? i.next = n : this._head = n, n ? n.prev = i : this._tail = i, t.next = t.prev = t.animation = null;
    }
  }, e.prototype.removeAnimator = function(t) {
    var i = t.getClip();
    i && this.removeClip(i), t.animation = null;
  }, e.prototype.update = function(t) {
    for (var i = Or() - this._pausedTime, n = i - this._time, s = this._head; s; ) {
      var a = s.next, o = s.step(i, n);
      o && (s.ondestroy(), this.removeClip(s)), s = a;
    }
    this._time = i, t || (this.trigger("frame", n), this.stage.update && this.stage.update());
  }, e.prototype._startLoop = function() {
    var t = this;
    this._running = !0;
    function i() {
      t._running && (ma(i), !t._paused && t.update());
    }
    ma(i);
  }, e.prototype.start = function() {
    this._running || (this._time = Or(), this._pausedTime = 0, this._startLoop());
  }, e.prototype.stop = function() {
    this._running = !1;
  }, e.prototype.pause = function() {
    this._paused || (this._pauseStart = Or(), this._paused = !0);
  }, e.prototype.resume = function() {
    this._paused && (this._pausedTime += Or() - this._pauseStart, this._paused = !1);
  }, e.prototype.clear = function() {
    for (var t = this._head; t; ) {
      var i = t.next;
      t.prev = t.next = t.animation = null, t = i;
    }
    this._head = this._tail = null;
  }, e.prototype.isFinished = function() {
    return this._head == null;
  }, e.prototype.animate = function(t, i) {
    i = i || {}, this.start();
    var n = new pu(t, i.loop);
    return this.addAnimator(n), n;
  }, e;
}(Mt), oC = 300, Ao = W.domSupported, Po = function() {
  var r = [
    "click",
    "dblclick",
    "mousewheel",
    "wheel",
    "mouseout",
    "mouseup",
    "mousedown",
    "mousemove",
    "contextmenu"
  ], e = [
    "touchstart",
    "touchend",
    "touchmove"
  ], t = {
    pointerdown: 1,
    pointerup: 1,
    pointermove: 1,
    pointerout: 1
  }, i = J(r, function(n) {
    var s = n.replace("mouse", "pointer");
    return t.hasOwnProperty(s) ? s : n;
  });
  return {
    mouse: r,
    touch: e,
    pointer: i
  };
}(), kd = {
  mouse: ["mousemove", "mouseup"],
  pointer: ["pointermove", "pointerup"]
}, Ad = !1;
function Ch(r) {
  var e = r.pointerType;
  return e === "pen" || e === "touch";
}
function lC(r) {
  r.touching = !0, r.touchTimer != null && (clearTimeout(r.touchTimer), r.touchTimer = null), r.touchTimer = setTimeout(function() {
    r.touching = !1, r.touchTimer = null;
  }, 700);
}
function Oo(r) {
  r && (r.zrByTouch = !0);
}
function hC(r, e) {
  return gt(r.dom, new uC(r, e), !0);
}
function Eg(r, e) {
  for (var t = e, i = !1; t && t.nodeType !== 9 && !(i = t.domBelongToZr || t !== e && t === r.painterRoot); )
    t = t.parentNode;
  return i;
}
var uC = /* @__PURE__ */ function() {
  function r(e, t) {
    this.stopPropagation = Le, this.stopImmediatePropagation = Le, this.preventDefault = Le, this.type = t.type, this.target = this.currentTarget = e.dom, this.pointerType = t.pointerType, this.clientX = t.clientX, this.clientY = t.clientY;
  }
  return r;
}(), xt = {
  mousedown: function(r) {
    r = gt(this.dom, r), this.__mayPointerCapture = [r.zrX, r.zrY], this.trigger("mousedown", r);
  },
  mousemove: function(r) {
    r = gt(this.dom, r);
    var e = this.__mayPointerCapture;
    e && (r.zrX !== e[0] || r.zrY !== e[1]) && this.__togglePointerCapture(!0), this.trigger("mousemove", r);
  },
  mouseup: function(r) {
    r = gt(this.dom, r), this.__togglePointerCapture(!1), this.trigger("mouseup", r);
  },
  mouseout: function(r) {
    r = gt(this.dom, r);
    var e = r.toElement || r.relatedTarget;
    Eg(this, e) || (this.__pointerCapturing && (r.zrEventControl = "no_globalout"), this.trigger("mouseout", r));
  },
  wheel: function(r) {
    Ad = !0, r = gt(this.dom, r), this.trigger("mousewheel", r);
  },
  mousewheel: function(r) {
    Ad || (r = gt(this.dom, r), this.trigger("mousewheel", r));
  },
  touchstart: function(r) {
    r = gt(this.dom, r), Oo(r), this.__lastTouchMoment = /* @__PURE__ */ new Date(), this.handler.processGesture(r, "start"), xt.mousemove.call(this, r), xt.mousedown.call(this, r);
  },
  touchmove: function(r) {
    r = gt(this.dom, r), Oo(r), this.handler.processGesture(r, "change"), xt.mousemove.call(this, r);
  },
  touchend: function(r) {
    r = gt(this.dom, r), Oo(r), this.handler.processGesture(r, "end"), xt.mouseup.call(this, r), +/* @__PURE__ */ new Date() - +this.__lastTouchMoment < oC && xt.click.call(this, r);
  },
  pointerdown: function(r) {
    xt.mousedown.call(this, r);
  },
  pointermove: function(r) {
    Ch(r) || xt.mousemove.call(this, r);
  },
  pointerup: function(r) {
    xt.mouseup.call(this, r);
  },
  pointerout: function(r) {
    Ch(r) || xt.mouseout.call(this, r);
  }
};
M(["click", "dblclick", "contextmenu"], function(r) {
  xt[r] = function(e) {
    e = gt(this.dom, e), this.trigger(r, e);
  };
});
var _h = {
  pointermove: function(r) {
    Ch(r) || _h.mousemove.call(this, r);
  },
  pointerup: function(r) {
    _h.mouseup.call(this, r);
  },
  mousemove: function(r) {
    this.trigger("mousemove", r);
  },
  mouseup: function(r) {
    var e = this.__pointerCapturing;
    this.__togglePointerCapture(!1), this.trigger("mouseup", r), e && (r.zrEventControl = "only_globalout", this.trigger("mouseout", r));
  }
};
function dC(r, e) {
  var t = e.domHandlers;
  W.pointerEventsSupported ? M(Po.pointer, function(i) {
    aa(e, i, function(n) {
      t[i].call(r, n);
    });
  }) : (W.touchEventsSupported && M(Po.touch, function(i) {
    aa(e, i, function(n) {
      t[i].call(r, n), lC(e);
    });
  }), M(Po.mouse, function(i) {
    aa(e, i, function(n) {
      n = du(n), e.touching || t[i].call(r, n);
    });
  }));
}
function cC(r, e) {
  W.pointerEventsSupported ? M(kd.pointer, t) : W.touchEventsSupported || M(kd.mouse, t);
  function t(i) {
    function n(s) {
      s = du(s), Eg(r, s.target) || (s = hC(r, s), e.domHandlers[i].call(r, s));
    }
    aa(e, i, n, { capture: !0 });
  }
}
function aa(r, e, t, i) {
  r.mounted[e] = t, r.listenerOpts[e] = i, D0(r.domTarget, e, t, i);
}
function Io(r) {
  var e = r.mounted;
  for (var t in e)
    e.hasOwnProperty(t) && L0(r.domTarget, t, e[t], r.listenerOpts[t]);
  r.mounted = {};
}
var Pd = /* @__PURE__ */ function() {
  function r(e, t) {
    this.mounted = {}, this.listenerOpts = {}, this.touching = !1, this.domTarget = e, this.domHandlers = t;
  }
  return r;
}(), fC = function(r) {
  oe(e, r);
  function e(t, i) {
    var n = r.call(this) || this;
    return n.__pointerCapturing = !1, n.dom = t, n.painterRoot = i, n._localHandlerScope = new Pd(t, xt), Ao && (n._globalHandlerScope = new Pd(document, _h)), dC(n, n._localHandlerScope), n;
  }
  return e.prototype.dispose = function() {
    Io(this._localHandlerScope), Ao && Io(this._globalHandlerScope);
  }, e.prototype.setCursor = function(t) {
    this.dom.style && (this.dom.style.cursor = t || "default");
  }, e.prototype.__togglePointerCapture = function(t) {
    if (this.__mayPointerCapture = null, Ao && +this.__pointerCapturing ^ +t) {
      this.__pointerCapturing = t;
      var i = this._globalHandlerScope;
      t ? cC(this, i) : Io(i);
    }
  }, e;
}(Mt), Tg = 1;
W.hasGlobalWindow && (Tg = Math.max(window.devicePixelRatio || window.screen && window.screen.deviceXDPI / window.screen.logicalXDPI || 1, 1));
var Ea = Tg, Eh = 0.4, Th = "#333", xh = "#ccc", pC = "#eee", Od = cu, Id = 5e-5;
function ki(r) {
  return r > Id || r < -Id;
}
var Ai = [], br = [], zo = sr(), Fo = Math.abs, gu = function() {
  function r() {
  }
  return r.prototype.getLocalTransform = function(e) {
    return r.getLocalTransform(this, e);
  }, r.prototype.setPosition = function(e) {
    this.x = e[0], this.y = e[1];
  }, r.prototype.setScale = function(e) {
    this.scaleX = e[0], this.scaleY = e[1];
  }, r.prototype.setSkew = function(e) {
    this.skewX = e[0], this.skewY = e[1];
  }, r.prototype.setOrigin = function(e) {
    this.originX = e[0], this.originY = e[1];
  }, r.prototype.needLocalTransform = function() {
    return ki(this.rotation) || ki(this.x) || ki(this.y) || ki(this.scaleX - 1) || ki(this.scaleY - 1) || ki(this.skewX) || ki(this.skewY);
  }, r.prototype.updateTransform = function() {
    var e = this.parent && this.parent.transform, t = this.needLocalTransform(), i = this.transform;
    if (!(t || e)) {
      i && (Od(i), this.invTransform = null);
      return;
    }
    i = i || sr(), t ? this.getLocalTransform(i) : Od(i), e && (t ? Gr(i, e, i) : P0(i, e)), this.transform = i, this._resolveGlobalScaleRatio(i);
  }, r.prototype._resolveGlobalScaleRatio = function(e) {
    var t = this.globalScaleRatio;
    if (t != null && t !== 1) {
      this.getGlobalScale(Ai);
      var i = Ai[0] < 0 ? -1 : 1, n = Ai[1] < 0 ? -1 : 1, s = ((Ai[0] - i) * t + i) / Ai[0] || 0, a = ((Ai[1] - n) * t + n) / Ai[1] || 0;
      e[0] *= s, e[1] *= s, e[2] *= a, e[3] *= a;
    }
    this.invTransform = this.invTransform || sr(), lg(this.invTransform, e);
  }, r.prototype.getComputedTransform = function() {
    for (var e = this, t = []; e; )
      t.push(e), e = e.parent;
    for (; e = t.pop(); )
      e.updateTransform();
    return this.transform;
  }, r.prototype.setLocalTransform = function(e) {
    if (e) {
      var t = e[0] * e[0] + e[1] * e[1], i = e[2] * e[2] + e[3] * e[3], n = Math.atan2(e[1], e[0]), s = Math.PI / 2 + n - Math.atan2(e[3], e[2]);
      i = Math.sqrt(i) * Math.cos(s), t = Math.sqrt(t), this.skewX = s, this.skewY = 0, this.rotation = -n, this.x = +e[4], this.y = +e[5], this.scaleX = t, this.scaleY = i, this.originX = 0, this.originY = 0;
    }
  }, r.prototype.decomposeTransform = function() {
    if (this.transform) {
      var e = this.parent, t = this.transform;
      e && e.transform && (e.invTransform = e.invTransform || sr(), Gr(br, e.invTransform, t), t = br);
      var i = this.originX, n = this.originY;
      (i || n) && (zo[4] = i, zo[5] = n, Gr(br, t, zo), br[4] -= i, br[5] -= n, t = br), this.setLocalTransform(t);
    }
  }, r.prototype.getGlobalScale = function(e) {
    var t = this.transform;
    return e = e || [], t ? (e[0] = Math.sqrt(t[0] * t[0] + t[1] * t[1]), e[1] = Math.sqrt(t[2] * t[2] + t[3] * t[3]), t[0] < 0 && (e[0] = -e[0]), t[3] < 0 && (e[1] = -e[1]), e) : (e[0] = 1, e[1] = 1, e);
  }, r.prototype.transformCoordToLocal = function(e, t) {
    var i = [e, t], n = this.invTransform;
    return n && Ht(i, i, n), i;
  }, r.prototype.transformCoordToGlobal = function(e, t) {
    var i = [e, t], n = this.transform;
    return n && Ht(i, i, n), i;
  }, r.prototype.getLineScale = function() {
    var e = this.transform;
    return e && Fo(e[0] - 1) > 1e-10 && Fo(e[3] - 1) > 1e-10 ? Math.sqrt(Fo(e[0] * e[3] - e[2] * e[1])) : 1;
  }, r.prototype.copyTransform = function(e) {
    gC(this, e);
  }, r.getLocalTransform = function(e, t) {
    t = t || [];
    var i = e.originX || 0, n = e.originY || 0, s = e.scaleX, a = e.scaleY, o = e.anchorX, l = e.anchorY, h = e.rotation || 0, u = e.x, d = e.y, c = e.skewX ? Math.tan(e.skewX) : 0, f = e.skewY ? Math.tan(-e.skewY) : 0;
    if (i || n || o || l) {
      var p = i + o, m = n + l;
      t[4] = -p * s - c * m * a, t[5] = -m * a - f * p * s;
    } else
      t[4] = t[5] = 0;
    return t[0] = s, t[3] = a, t[1] = f * s, t[2] = c * a, h && fu(t, t, h), t[4] += i + u, t[5] += n + d, t;
  }, r.initDefaultProps = function() {
    var e = r.prototype;
    e.scaleX = e.scaleY = e.globalScaleRatio = 1, e.x = e.y = e.originX = e.originY = e.skewX = e.skewY = e.rotation = e.anchorX = e.anchorY = 0;
  }(), r;
}(), ss = [
  "x",
  "y",
  "originX",
  "originY",
  "anchorX",
  "anchorY",
  "rotation",
  "scaleX",
  "scaleY",
  "skewX",
  "skewY"
];
function gC(r, e) {
  for (var t = 0; t < ss.length; t++) {
    var i = ss[t];
    r[i] = e[i];
  }
}
var zd = {};
function st(r, e) {
  e = e || dr;
  var t = zd[e];
  t || (t = zd[e] = new vs(500));
  var i = t.get(r);
  return i == null && (i = Qr.measureText(r, e).width, t.put(r, i)), i;
}
function Fd(r, e, t, i) {
  var n = st(r, e), s = vu(e), a = In(0, n, t), o = kr(0, s, i), l = new re(a, o, n, s);
  return l;
}
function xg(r, e, t, i) {
  var n = ((r || "") + "").split(`
`), s = n.length;
  if (s === 1)
    return Fd(n[0], e, t, i);
  for (var a = new re(0, 0, 0, 0), o = 0; o < n.length; o++) {
    var l = Fd(n[o], e, t, i);
    o === 0 ? a.copy(l) : a.union(l);
  }
  return a;
}
function In(r, e, t) {
  return t === "right" ? r -= e : t === "center" && (r -= e / 2), r;
}
function kr(r, e, t) {
  return t === "middle" ? r -= e / 2 : t === "bottom" && (r -= e), r;
}
function vu(r) {
  return st("å›½", r);
}
function as(r, e) {
  return typeof r == "string" ? r.lastIndexOf("%") >= 0 ? parseFloat(r) / 100 * e : parseFloat(r) : r;
}
function Sg(r, e, t) {
  var i = e.position || "inside", n = e.distance != null ? e.distance : 5, s = t.height, a = t.width, o = s / 2, l = t.x, h = t.y, u = "left", d = "top";
  if (i instanceof Array)
    l += as(i[0], t.width), h += as(i[1], t.height), u = null, d = null;
  else
    switch (i) {
      case "left":
        l -= n, h += o, u = "right", d = "middle";
        break;
      case "right":
        l += n + a, h += o, d = "middle";
        break;
      case "top":
        l += a / 2, h -= n, u = "center", d = "bottom";
        break;
      case "bottom":
        l += a / 2, h += s + n, u = "center";
        break;
      case "inside":
        l += a / 2, h += o, u = "center", d = "middle";
        break;
      case "insideLeft":
        l += n, h += o, d = "middle";
        break;
      case "insideRight":
        l += a - n, h += o, u = "right", d = "middle";
        break;
      case "insideTop":
        l += a / 2, h += n, u = "center";
        break;
      case "insideBottom":
        l += a / 2, h += s - n, u = "center", d = "bottom";
        break;
      case "insideTopLeft":
        l += n, h += n;
        break;
      case "insideTopRight":
        l += a - n, h += n, u = "right";
        break;
      case "insideBottomLeft":
        l += n, h += s - n, d = "bottom";
        break;
      case "insideBottomRight":
        l += a - n, h += s - n, u = "right", d = "bottom";
        break;
    }
  return r = r || {}, r.x = l, r.y = h, r.align = u, r.verticalAlign = d, r;
}
var Ho = "__zr_normal__", No = ss.concat(["ignore"]), vC = tn(ss, function(r, e) {
  return r[e] = !0, r;
}, { ignore: !1 }), yr = {}, mC = new re(0, 0, 0, 0), Qa = function() {
  function r(e) {
    this.id = tg(), this.animators = [], this.currentStates = [], this.states = {}, this._init(e);
  }
  return r.prototype._init = function(e) {
    this.attr(e);
  }, r.prototype.drift = function(e, t, i) {
    switch (this.draggable) {
      case "horizontal":
        t = 0;
        break;
      case "vertical":
        e = 0;
        break;
    }
    var n = this.transform;
    n || (n = this.transform = [1, 0, 0, 1, 0, 0]), n[4] += e, n[5] += t, this.decomposeTransform(), this.markRedraw();
  }, r.prototype.beforeUpdate = function() {
  }, r.prototype.afterUpdate = function() {
  }, r.prototype.update = function() {
    this.updateTransform(), this.__dirty && this.updateInnerText();
  }, r.prototype.updateInnerText = function(e) {
    var t = this._textContent;
    if (t && (!t.ignore || e)) {
      this.textConfig || (this.textConfig = {});
      var i = this.textConfig, n = i.local, s = t.innerTransformable, a = void 0, o = void 0, l = !1;
      s.parent = n ? this : null;
      var h = !1;
      if (s.copyTransform(t), i.position != null) {
        var u = mC;
        i.layoutRect ? u.copy(i.layoutRect) : u.copy(this.getBoundingRect()), n || u.applyTransform(this.transform), this.calculateTextPosition ? this.calculateTextPosition(yr, i, u) : Sg(yr, i, u), s.x = yr.x, s.y = yr.y, a = yr.align, o = yr.verticalAlign;
        var d = i.origin;
        if (d && i.rotation != null) {
          var c = void 0, f = void 0;
          d === "center" ? (c = u.width * 0.5, f = u.height * 0.5) : (c = as(d[0], u.width), f = as(d[1], u.height)), h = !0, s.originX = -s.x + c + (n ? 0 : u.x), s.originY = -s.y + f + (n ? 0 : u.y);
        }
      }
      i.rotation != null && (s.rotation = i.rotation);
      var p = i.offset;
      p && (s.x += p[0], s.y += p[1], h || (s.originX = -p[0], s.originY = -p[1]));
      var m = i.inside == null ? typeof i.position == "string" && i.position.indexOf("inside") >= 0 : i.inside, g = this._innerTextDefaultStyle || (this._innerTextDefaultStyle = {}), v = void 0, b = void 0, y = void 0;
      m && this.canBeInsideText() ? (v = i.insideFill, b = i.insideStroke, (v == null || v === "auto") && (v = this.getInsideTextFill()), (b == null || b === "auto") && (b = this.getInsideTextStroke(v), y = !0)) : (v = i.outsideFill, b = i.outsideStroke, (v == null || v === "auto") && (v = this.getOutsideFill()), (b == null || b === "auto") && (b = this.getOutsideStroke(v), y = !0)), v = v || "#000", (v !== g.fill || b !== g.stroke || y !== g.autoStroke || a !== g.align || o !== g.verticalAlign) && (l = !0, g.fill = v, g.stroke = b, g.autoStroke = y, g.align = a, g.verticalAlign = o, t.setDefaultTextStyle(g)), t.__dirty |= nt, l && t.dirtyStyle(!0);
    }
  }, r.prototype.canBeInsideText = function() {
    return !0;
  }, r.prototype.getInsideTextFill = function() {
    return "#fff";
  }, r.prototype.getInsideTextStroke = function(e) {
    return "#000";
  }, r.prototype.getOutsideFill = function() {
    return this.__zr && this.__zr.isDarkMode() ? xh : Th;
  }, r.prototype.getOutsideStroke = function(e) {
    var t = this.__zr && this.__zr.getBackgroundColor(), i = typeof t == "string" && Zt(t);
    i || (i = [255, 255, 255, 1]);
    for (var n = i[3], s = this.__zr.isDarkMode(), a = 0; a < 3; a++)
      i[a] = i[a] * n + (s ? 0 : 255) * (1 - n);
    return i[3] = 1, or(i, "rgba");
  }, r.prototype.traverse = function(e, t) {
  }, r.prototype.attrKV = function(e, t) {
    e === "textConfig" ? this.setTextConfig(t) : e === "textContent" ? this.setTextContent(t) : e === "clipPath" ? this.setClipPath(t) : e === "extra" ? (this.extra = this.extra || {}, P(this.extra, t)) : this[e] = t;
  }, r.prototype.hide = function() {
    this.ignore = !0, this.markRedraw();
  }, r.prototype.show = function() {
    this.ignore = !1, this.markRedraw();
  }, r.prototype.attr = function(e, t) {
    if (typeof e == "string")
      this.attrKV(e, t);
    else if (B(e))
      for (var i = e, n = me(i), s = 0; s < n.length; s++) {
        var a = n[s];
        this.attrKV(a, e[a]);
      }
    return this.markRedraw(), this;
  }, r.prototype.saveCurrentToNormalState = function(e) {
    this._innerSaveToNormal(e);
    for (var t = this._normalState, i = 0; i < this.animators.length; i++) {
      var n = this.animators[i], s = n.__fromStateTransition;
      if (!(n.getLoop() || s && s !== Ho)) {
        var a = n.targetName, o = a ? t[a] : t;
        n.saveTo(o);
      }
    }
  }, r.prototype._innerSaveToNormal = function(e) {
    var t = this._normalState;
    t || (t = this._normalState = {}), e.textConfig && !t.textConfig && (t.textConfig = this.textConfig), this._savePrimaryToNormal(e, t, No);
  }, r.prototype._savePrimaryToNormal = function(e, t, i) {
    for (var n = 0; n < i.length; n++) {
      var s = i[n];
      e[s] != null && !(s in t) && (t[s] = this[s]);
    }
  }, r.prototype.hasState = function() {
    return this.currentStates.length > 0;
  }, r.prototype.getState = function(e) {
    return this.states[e];
  }, r.prototype.ensureState = function(e) {
    var t = this.states;
    return t[e] || (t[e] = {}), t[e];
  }, r.prototype.clearStates = function(e) {
    this.useState(Ho, !1, e);
  }, r.prototype.useState = function(e, t, i, n) {
    var s = e === Ho, a = this.hasState();
    if (!(!a && s)) {
      var o = this.currentStates, l = this.stateTransition;
      if (!(ue(o, e) >= 0 && (t || o.length === 1))) {
        var h;
        if (this.stateProxy && !s && (h = this.stateProxy(e)), h || (h = this.states && this.states[e]), !h && !s) {
          nr("State " + e + " not exists.");
          return;
        }
        s || this.saveCurrentToNormalState(h);
        var u = !!(h && h.hoverLayer || n);
        u && this._toggleHoverLayerFlag(!0), this._applyStateObj(e, h, this._normalState, t, !i && !this.__inHover && l && l.duration > 0, l);
        var d = this._textContent, c = this._textGuide;
        return d && d.useState(e, t, i, u), c && c.useState(e, t, i, u), s ? (this.currentStates = [], this._normalState = {}) : t ? this.currentStates.push(e) : this.currentStates = [e], this._updateAnimationTargets(), this.markRedraw(), !u && this.__inHover && (this._toggleHoverLayerFlag(!1), this.__dirty &= ~nt), h;
      }
    }
  }, r.prototype.useStates = function(e, t, i) {
    if (!e.length)
      this.clearStates();
    else {
      var n = [], s = this.currentStates, a = e.length, o = a === s.length;
      if (o) {
        for (var l = 0; l < a; l++)
          if (e[l] !== s[l]) {
            o = !1;
            break;
          }
      }
      if (o)
        return;
      for (var l = 0; l < a; l++) {
        var h = e[l], u = void 0;
        this.stateProxy && (u = this.stateProxy(h, e)), u || (u = this.states[h]), u && n.push(u);
      }
      var d = n[a - 1], c = !!(d && d.hoverLayer || i);
      c && this._toggleHoverLayerFlag(!0);
      var f = this._mergeStates(n), p = this.stateTransition;
      this.saveCurrentToNormalState(f), this._applyStateObj(e.join(","), f, this._normalState, !1, !t && !this.__inHover && p && p.duration > 0, p);
      var m = this._textContent, g = this._textGuide;
      m && m.useStates(e, t, c), g && g.useStates(e, t, c), this._updateAnimationTargets(), this.currentStates = e.slice(), this.markRedraw(), !c && this.__inHover && (this._toggleHoverLayerFlag(!1), this.__dirty &= ~nt);
    }
  }, r.prototype.isSilent = function() {
    for (var e = this.silent, t = this.parent; !e && t; ) {
      if (t.silent) {
        e = !0;
        break;
      }
      t = t.parent;
    }
    return e;
  }, r.prototype._updateAnimationTargets = function() {
    for (var e = 0; e < this.animators.length; e++) {
      var t = this.animators[e];
      t.targetName && t.changeTarget(this[t.targetName]);
    }
  }, r.prototype.removeState = function(e) {
    var t = ue(this.currentStates, e);
    if (t >= 0) {
      var i = this.currentStates.slice();
      i.splice(t, 1), this.useStates(i);
    }
  }, r.prototype.replaceState = function(e, t, i) {
    var n = this.currentStates.slice(), s = ue(n, e), a = ue(n, t) >= 0;
    s >= 0 ? a ? n.splice(s, 1) : n[s] = t : i && !a && n.push(t), this.useStates(n);
  }, r.prototype.toggleState = function(e, t) {
    t ? this.useState(e, !0) : this.removeState(e);
  }, r.prototype._mergeStates = function(e) {
    for (var t = {}, i, n = 0; n < e.length; n++) {
      var s = e[n];
      P(t, s), s.textConfig && (i = i || {}, P(i, s.textConfig));
    }
    return i && (t.textConfig = i), t;
  }, r.prototype._applyStateObj = function(e, t, i, n, s, a) {
    var o = !(t && n);
    t && t.textConfig ? (this.textConfig = P({}, n ? this.textConfig : i.textConfig), P(this.textConfig, t.textConfig)) : o && i.textConfig && (this.textConfig = i.textConfig);
    for (var l = {}, h = !1, u = 0; u < No.length; u++) {
      var d = No[u], c = s && vC[d];
      t && t[d] != null ? c ? (h = !0, l[d] = t[d]) : this[d] = t[d] : o && i[d] != null && (c ? (h = !0, l[d] = i[d]) : this[d] = i[d]);
    }
    if (!s)
      for (var u = 0; u < this.animators.length; u++) {
        var f = this.animators[u], p = f.targetName;
        f.getLoop() || f.__changeFinalValue(p ? (t || i)[p] : t || i);
      }
    h && this._transitionState(e, l, a);
  }, r.prototype._attachComponent = function(e) {
    if (e.__zr && !e.__hostTarget) {
      if (process.env.NODE_ENV !== "production")
        throw new Error("Text element has been added to zrender.");
      return;
    }
    if (e === this) {
      if (process.env.NODE_ENV !== "production")
        throw new Error("Recursive component attachment.");
      return;
    }
    var t = this.__zr;
    t && e.addSelfToZr(t), e.__zr = t, e.__hostTarget = this;
  }, r.prototype._detachComponent = function(e) {
    e.__zr && e.removeSelfFromZr(e.__zr), e.__zr = null, e.__hostTarget = null;
  }, r.prototype.getClipPath = function() {
    return this._clipPath;
  }, r.prototype.setClipPath = function(e) {
    this._clipPath && this._clipPath !== e && this.removeClipPath(), this._attachComponent(e), this._clipPath = e, this.markRedraw();
  }, r.prototype.removeClipPath = function() {
    var e = this._clipPath;
    e && (this._detachComponent(e), this._clipPath = null, this.markRedraw());
  }, r.prototype.getTextContent = function() {
    return this._textContent;
  }, r.prototype.setTextContent = function(e) {
    var t = this._textContent;
    if (t !== e) {
      if (t && t !== e && this.removeTextContent(), process.env.NODE_ENV !== "production" && e.__zr && !e.__hostTarget)
        throw new Error("Text element has been added to zrender.");
      e.innerTransformable = new gu(), this._attachComponent(e), this._textContent = e, this.markRedraw();
    }
  }, r.prototype.setTextConfig = function(e) {
    this.textConfig || (this.textConfig = {}), P(this.textConfig, e), this.markRedraw();
  }, r.prototype.removeTextConfig = function() {
    this.textConfig = null, this.markRedraw();
  }, r.prototype.removeTextContent = function() {
    var e = this._textContent;
    e && (e.innerTransformable = null, this._detachComponent(e), this._textContent = null, this._innerTextDefaultStyle = null, this.markRedraw());
  }, r.prototype.getTextGuideLine = function() {
    return this._textGuide;
  }, r.prototype.setTextGuideLine = function(e) {
    this._textGuide && this._textGuide !== e && this.removeTextGuideLine(), this._attachComponent(e), this._textGuide = e, this.markRedraw();
  }, r.prototype.removeTextGuideLine = function() {
    var e = this._textGuide;
    e && (this._detachComponent(e), this._textGuide = null, this.markRedraw());
  }, r.prototype.markRedraw = function() {
    this.__dirty |= nt;
    var e = this.__zr;
    e && (this.__inHover ? e.refreshHover() : e.refresh()), this.__hostTarget && this.__hostTarget.markRedraw();
  }, r.prototype.dirty = function() {
    this.markRedraw();
  }, r.prototype._toggleHoverLayerFlag = function(e) {
    this.__inHover = e;
    var t = this._textContent, i = this._textGuide;
    t && (t.__inHover = e), i && (i.__inHover = e);
  }, r.prototype.addSelfToZr = function(e) {
    if (this.__zr !== e) {
      this.__zr = e;
      var t = this.animators;
      if (t)
        for (var i = 0; i < t.length; i++)
          e.animation.addAnimator(t[i]);
      this._clipPath && this._clipPath.addSelfToZr(e), this._textContent && this._textContent.addSelfToZr(e), this._textGuide && this._textGuide.addSelfToZr(e);
    }
  }, r.prototype.removeSelfFromZr = function(e) {
    if (this.__zr) {
      this.__zr = null;
      var t = this.animators;
      if (t)
        for (var i = 0; i < t.length; i++)
          e.animation.removeAnimator(t[i]);
      this._clipPath && this._clipPath.removeSelfFromZr(e), this._textContent && this._textContent.removeSelfFromZr(e), this._textGuide && this._textGuide.removeSelfFromZr(e);
    }
  }, r.prototype.animate = function(e, t, i) {
    var n = e ? this[e] : this;
    if (process.env.NODE_ENV !== "production" && !n) {
      nr('Property "' + e + '" is not existed in element ' + this.id);
      return;
    }
    var s = new pu(n, t, i);
    return e && (s.targetName = e), this.addAnimator(s, e), s;
  }, r.prototype.addAnimator = function(e, t) {
    var i = this.__zr, n = this;
    e.during(function() {
      n.updateDuringAnimation(t);
    }).done(function() {
      var s = n.animators, a = ue(s, e);
      a >= 0 && s.splice(a, 1);
    }), this.animators.push(e), i && i.animation.addAnimator(e), i && i.wakeUp();
  }, r.prototype.updateDuringAnimation = function(e) {
    this.markRedraw();
  }, r.prototype.stopAnimation = function(e, t) {
    for (var i = this.animators, n = i.length, s = [], a = 0; a < n; a++) {
      var o = i[a];
      !e || e === o.scope ? o.stop(t) : s.push(o);
    }
    return this.animators = s, this;
  }, r.prototype.animateTo = function(e, t, i) {
    Bo(this, e, t, i);
  }, r.prototype.animateFrom = function(e, t, i) {
    Bo(this, e, t, i, !0);
  }, r.prototype._transitionState = function(e, t, i, n) {
    for (var s = Bo(this, t, i, n), a = 0; a < s.length; a++)
      s[a].__fromStateTransition = e;
  }, r.prototype.getBoundingRect = function() {
    return null;
  }, r.prototype.getPaintRect = function() {
    return null;
  }, r.initDefaultProps = function() {
    var e = r.prototype;
    e.type = "element", e.name = "", e.ignore = e.silent = e.isGroup = e.draggable = e.dragging = e.ignoreClip = e.__inHover = !1, e.__dirty = nt;
    var t = {};
    function i(s, a, o) {
      t[s + a + o] || (console.warn("DEPRECATED: '" + s + "' has been deprecated. use '" + a + "', '" + o + "' instead"), t[s + a + o] = !0);
    }
    function n(s, a, o, l) {
      Object.defineProperty(e, s, {
        get: function() {
          if (process.env.NODE_ENV !== "production" && i(s, o, l), !this[a]) {
            var u = this[a] = [];
            h(this, u);
          }
          return this[a];
        },
        set: function(u) {
          process.env.NODE_ENV !== "production" && i(s, o, l), this[o] = u[0], this[l] = u[1], this[a] = u, h(this, u);
        }
      });
      function h(u, d) {
        Object.defineProperty(d, 0, {
          get: function() {
            return u[o];
          },
          set: function(c) {
            u[o] = c;
          }
        }), Object.defineProperty(d, 1, {
          get: function() {
            return u[l];
          },
          set: function(c) {
            u[l] = c;
          }
        });
      }
    }
    Object.defineProperty && (n("position", "_legacyPos", "x", "y"), n("scale", "_legacyScale", "scaleX", "scaleY"), n("origin", "_legacyOrigin", "originX", "originY"));
  }(), r;
}();
ii(Qa, Mt);
ii(Qa, gu);
function Bo(r, e, t, i, n) {
  t = t || {};
  var s = [];
  Rg(r, "", r, e, t, i, s, n);
  var a = s.length, o = !1, l = t.done, h = t.aborted, u = function() {
    o = !0, a--, a <= 0 && (o ? l && l() : h && h());
  }, d = function() {
    a--, a <= 0 && (o ? l && l() : h && h());
  };
  a || l && l(), s.length > 0 && t.during && s[0].during(function(p, m) {
    t.during(m);
  });
  for (var c = 0; c < s.length; c++) {
    var f = s[c];
    u && f.done(u), d && f.aborted(d), t.force && f.duration(t.duration), f.start(t.easing);
  }
  return s;
}
function Vo(r, e, t) {
  for (var i = 0; i < t; i++)
    r[i] = e[i];
}
function bC(r) {
  return Je(r[0]);
}
function yC(r, e, t) {
  if (Je(e[t]))
    if (Je(r[t]) || (r[t] = []), Ge(e[t])) {
      var i = e[t].length;
      r[t].length !== i && (r[t] = new e[t].constructor(i), Vo(r[t], e[t], i));
    } else {
      var n = e[t], s = r[t], a = n.length;
      if (bC(n))
        for (var o = n[0].length, l = 0; l < a; l++)
          s[l] ? Vo(s[l], n[l], o) : s[l] = Array.prototype.slice.call(n[l]);
      else
        Vo(s, n, a);
      s.length = n.length;
    }
  else
    r[t] = e[t];
}
function wC(r, e) {
  return r === e || Je(r) && Je(e) && CC(r, e);
}
function CC(r, e) {
  var t = r.length;
  if (t !== e.length)
    return !1;
  for (var i = 0; i < t; i++)
    if (r[i] !== e[i])
      return !1;
  return !0;
}
function Rg(r, e, t, i, n, s, a, o) {
  for (var l = me(i), h = n.duration, u = n.delay, d = n.additive, c = n.setToFinal, f = !B(s), p = r.animators, m = [], g = 0; g < l.length; g++) {
    var v = l[g], b = i[v];
    if (b != null && t[v] != null && (f || s[v]))
      if (B(b) && !Je(b) && !Ka(b)) {
        if (e) {
          o || (t[v] = b, r.updateDuringAnimation(e));
          continue;
        }
        Rg(r, v, t[v], b, n, s && s[v], a, o);
      } else
        m.push(v);
    else o || (t[v] = b, r.updateDuringAnimation(e), m.push(v));
  }
  var y = m.length;
  if (!d && y)
    for (var w = 0; w < p.length; w++) {
      var _ = p[w];
      if (_.targetName === e) {
        var E = _.stopTracks(m);
        if (E) {
          var x = ue(p, _);
          p.splice(x, 1);
        }
      }
    }
  if (n.force || (m = bt(m, function(R) {
    return !wC(i[R], t[R]);
  }), y = m.length), y > 0 || n.force && !a.length) {
    var T = void 0, C = void 0, S = void 0;
    if (o) {
      C = {}, c && (T = {});
      for (var w = 0; w < y; w++) {
        var v = m[w];
        C[v] = t[v], c ? T[v] = i[v] : t[v] = i[v];
      }
    } else if (c) {
      S = {};
      for (var w = 0; w < y; w++) {
        var v = m[w];
        S[v] = ra(t[v]), yC(t, i, v);
      }
    }
    var _ = new pu(t, !1, !1, d ? bt(p, function(D) {
      return D.targetName === e;
    }) : null);
    _.targetName = e, n.scope && (_.scope = n.scope), c && T && _.whenWithKeys(0, T, m), S && _.whenWithKeys(0, S, m), _.whenWithKeys(h ?? 500, o ? C : i, m).delay(u || 0), r.addAnimator(_, e), a.push(_);
  }
}
var lt = function(r) {
  oe(e, r);
  function e(t) {
    var i = r.call(this) || this;
    return i.isGroup = !0, i._children = [], i.attr(t), i;
  }
  return e.prototype.childrenRef = function() {
    return this._children;
  }, e.prototype.children = function() {
    return this._children.slice();
  }, e.prototype.childAt = function(t) {
    return this._children[t];
  }, e.prototype.childOfName = function(t) {
    for (var i = this._children, n = 0; n < i.length; n++)
      if (i[n].name === t)
        return i[n];
  }, e.prototype.childCount = function() {
    return this._children.length;
  }, e.prototype.add = function(t) {
    if (t && (t !== this && t.parent !== this && (this._children.push(t), this._doAdd(t)), process.env.NODE_ENV !== "production" && t.__hostTarget))
      throw "This elemenet has been used as an attachment";
    return this;
  }, e.prototype.addBefore = function(t, i) {
    if (t && t !== this && t.parent !== this && i && i.parent === this) {
      var n = this._children, s = n.indexOf(i);
      s >= 0 && (n.splice(s, 0, t), this._doAdd(t));
    }
    return this;
  }, e.prototype.replace = function(t, i) {
    var n = ue(this._children, t);
    return n >= 0 && this.replaceAt(i, n), this;
  }, e.prototype.replaceAt = function(t, i) {
    var n = this._children, s = n[i];
    if (t && t !== this && t.parent !== this && t !== s) {
      n[i] = t, s.parent = null;
      var a = this.__zr;
      a && s.removeSelfFromZr(a), this._doAdd(t);
    }
    return this;
  }, e.prototype._doAdd = function(t) {
    t.parent && t.parent.remove(t), t.parent = this;
    var i = this.__zr;
    i && i !== t.__zr && t.addSelfToZr(i), i && i.refresh();
  }, e.prototype.remove = function(t) {
    var i = this.__zr, n = this._children, s = ue(n, t);
    return s < 0 ? this : (n.splice(s, 1), t.parent = null, i && t.removeSelfFromZr(i), i && i.refresh(), this);
  }, e.prototype.removeAll = function() {
    for (var t = this._children, i = this.__zr, n = 0; n < t.length; n++) {
      var s = t[n];
      i && s.removeSelfFromZr(i), s.parent = null;
    }
    return t.length = 0, this;
  }, e.prototype.eachChild = function(t, i) {
    for (var n = this._children, s = 0; s < n.length; s++) {
      var a = n[s];
      t.call(i, a, s);
    }
    return this;
  }, e.prototype.traverse = function(t, i) {
    for (var n = 0; n < this._children.length; n++) {
      var s = this._children[n], a = t.call(i, s);
      s.isGroup && !a && s.traverse(t, i);
    }
    return this;
  }, e.prototype.addSelfToZr = function(t) {
    r.prototype.addSelfToZr.call(this, t);
    for (var i = 0; i < this._children.length; i++) {
      var n = this._children[i];
      n.addSelfToZr(t);
    }
  }, e.prototype.removeSelfFromZr = function(t) {
    r.prototype.removeSelfFromZr.call(this, t);
    for (var i = 0; i < this._children.length; i++) {
      var n = this._children[i];
      n.removeSelfFromZr(t);
    }
  }, e.prototype.getBoundingRect = function(t) {
    for (var i = new re(0, 0, 0, 0), n = t || this._children, s = [], a = null, o = 0; o < n.length; o++) {
      var l = n[o];
      if (!(l.ignore || l.invisible)) {
        var h = l.getBoundingRect(), u = l.getLocalTransform(s);
        u ? (re.applyTransform(i, h, u), a = a || i.clone(), a.union(i)) : (a = a || h.clone(), a.union(h));
      }
    }
    return a || i;
  }, e;
}(Qa);
lt.prototype.type = "group";
/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/
var zn = {}, Mg = {};
function _C(r) {
  delete Mg[r];
}
function EC(r) {
  if (!r)
    return !1;
  if (typeof r == "string")
    return _a(r, 1) < Eh;
  if (r.colorStops) {
    for (var e = r.colorStops, t = 0, i = e.length, n = 0; n < i; n++)
      t += _a(e[n].color, 1);
    return t /= i, t < Eh;
  }
  return !1;
}
var TC = function() {
  function r(e, t, i) {
    var n = this;
    this._sleepAfterStill = 10, this._stillFrameAccum = 0, this._needsRefresh = !0, this._needsRefreshHover = !0, this._darkMode = !1, i = i || {}, this.dom = t, this.id = e;
    var s = new W0(), a = i.renderer || "canvas";
    if (zn[a] || (a = me(zn)[0]), process.env.NODE_ENV !== "production" && !zn[a])
      throw new Error("Renderer '" + a + "' is not imported. Please import it first.");
    i.useDirtyRect = i.useDirtyRect == null ? !1 : i.useDirtyRect;
    var o = new zn[a](t, s, i, e), l = i.ssr || o.ssrOnly;
    this.storage = s, this.painter = o;
    var h = !W.node && !W.worker && !l ? new fC(o.getViewportRoot(), o.root) : null, u = i.useCoarsePointer, d = u == null || u === "auto" ? W.touchEventsSupported : !!u, c = 44, f;
    d && (f = j(i.pointerSize, c)), this.handler = new ug(s, o, h, o.root, f), this.animation = new aC({
      stage: {
        update: l ? null : function() {
          return n._flush(!0);
        }
      }
    }), l || this.animation.start();
  }
  return r.prototype.add = function(e) {
    this._disposed || !e || (this.storage.addRoot(e), e.addSelfToZr(this), this.refresh());
  }, r.prototype.remove = function(e) {
    this._disposed || !e || (this.storage.delRoot(e), e.removeSelfFromZr(this), this.refresh());
  }, r.prototype.configLayer = function(e, t) {
    this._disposed || (this.painter.configLayer && this.painter.configLayer(e, t), this.refresh());
  }, r.prototype.setBackgroundColor = function(e) {
    this._disposed || (this.painter.setBackgroundColor && this.painter.setBackgroundColor(e), this.refresh(), this._backgroundColor = e, this._darkMode = EC(e));
  }, r.prototype.getBackgroundColor = function() {
    return this._backgroundColor;
  }, r.prototype.setDarkMode = function(e) {
    this._darkMode = e;
  }, r.prototype.isDarkMode = function() {
    return this._darkMode;
  }, r.prototype.refreshImmediately = function(e) {
    this._disposed || (e || this.animation.update(!0), this._needsRefresh = !1, this.painter.refresh(), this._needsRefresh = !1);
  }, r.prototype.refresh = function() {
    this._disposed || (this._needsRefresh = !0, this.animation.start());
  }, r.prototype.flush = function() {
    this._disposed || this._flush(!1);
  }, r.prototype._flush = function(e) {
    var t, i = Or();
    this._needsRefresh && (t = !0, this.refreshImmediately(e)), this._needsRefreshHover && (t = !0, this.refreshHoverImmediately());
    var n = Or();
    t ? (this._stillFrameAccum = 0, this.trigger("rendered", {
      elapsedTime: n - i
    })) : this._sleepAfterStill > 0 && (this._stillFrameAccum++, this._stillFrameAccum > this._sleepAfterStill && this.animation.stop());
  }, r.prototype.setSleepAfterStill = function(e) {
    this._sleepAfterStill = e;
  }, r.prototype.wakeUp = function() {
    this._disposed || (this.animation.start(), this._stillFrameAccum = 0);
  }, r.prototype.refreshHover = function() {
    this._needsRefreshHover = !0;
  }, r.prototype.refreshHoverImmediately = function() {
    this._disposed || (this._needsRefreshHover = !1, this.painter.refreshHover && this.painter.getType() === "canvas" && this.painter.refreshHover());
  }, r.prototype.resize = function(e) {
    this._disposed || (e = e || {}, this.painter.resize(e.width, e.height), this.handler.resize());
  }, r.prototype.clearAnimation = function() {
    this._disposed || this.animation.clear();
  }, r.prototype.getWidth = function() {
    if (!this._disposed)
      return this.painter.getWidth();
  }, r.prototype.getHeight = function() {
    if (!this._disposed)
      return this.painter.getHeight();
  }, r.prototype.setCursorStyle = function(e) {
    this._disposed || this.handler.setCursorStyle(e);
  }, r.prototype.findHover = function(e, t) {
    if (!this._disposed)
      return this.handler.findHover(e, t);
  }, r.prototype.on = function(e, t, i) {
    return this._disposed || this.handler.on(e, t, i), this;
  }, r.prototype.off = function(e, t) {
    this._disposed || this.handler.off(e, t);
  }, r.prototype.trigger = function(e, t) {
    this._disposed || this.handler.trigger(e, t);
  }, r.prototype.clear = function() {
    if (!this._disposed) {
      for (var e = this.storage.getRoots(), t = 0; t < e.length; t++)
        e[t] instanceof lt && e[t].removeSelfFromZr(this);
      this.storage.delAllRoots(), this.painter.clear();
    }
  }, r.prototype.dispose = function() {
    this._disposed || (this.animation.stop(), this.clear(), this.storage.dispose(), this.painter.dispose(), this.handler.dispose(), this.animation = this.storage = this.painter = this.handler = null, this._disposed = !0, _C(this.id));
  }, r;
}();
function Hd(r, e) {
  var t = new TC(tg(), r, e);
  return Mg[t.id] = t, t;
}
function xC(r, e) {
  zn[r] = e;
}
var Nd = 1e-4, Dg = 20;
function SC(r) {
  return r.replace(/^\s+|\s+$/g, "");
}
function os(r, e, t, i) {
  var n = e[0], s = e[1], a = t[0], o = t[1], l = s - n, h = o - a;
  if (l === 0)
    return h === 0 ? a : (a + o) / 2;
  if (l > 0) {
    if (r <= n)
      return a;
    if (r >= s)
      return o;
  } else {
    if (r >= n)
      return a;
    if (r <= s)
      return o;
  }
  return (r - n) / l * h + a;
}
function Fe(r, e) {
  switch (r) {
    case "center":
    case "middle":
      r = "50%";
      break;
    case "left":
    case "top":
      r = "0%";
      break;
    case "right":
    case "bottom":
      r = "100%";
      break;
  }
  return V(r) ? SC(r).match(/%$/) ? parseFloat(r) / 100 * e : parseFloat(r) : r == null ? NaN : +r;
}
function RC(r, e, t) {
  return e == null && (e = 10), e = Math.min(Math.max(0, e), Dg), r = (+r).toFixed(e), t ? r : +r;
}
function Bd(r) {
  if (r = +r, isNaN(r))
    return 0;
  if (r > 1e-14) {
    for (var e = 1, t = 0; t < 15; t++, e *= 10)
      if (Math.round(r * e) / e === r)
        return t;
  }
  return MC(r);
}
function MC(r) {
  var e = r.toString().toLowerCase(), t = e.indexOf("e"), i = t > 0 ? +e.slice(t + 1) : 0, n = t > 0 ? t : e.length, s = e.indexOf("."), a = s < 0 ? 0 : n - 1 - s;
  return Math.max(0, a - i);
}
function DC(r, e) {
  var t = Math.max(Bd(r), Bd(e)), i = r + e;
  return t > Dg ? i : RC(i, t);
}
var Vd = 9007199254740991;
function Lg(r) {
  var e = Math.PI * 2;
  return (r % e + e) % e;
}
function Ta(r) {
  return r > -Nd && r < Nd;
}
var LC = /^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;
function eo(r) {
  if (r instanceof Date)
    return r;
  if (V(r)) {
    var e = LC.exec(r);
    if (!e)
      return /* @__PURE__ */ new Date(NaN);
    if (e[8]) {
      var t = +e[4] || 0;
      return e[8].toUpperCase() !== "Z" && (t -= +e[8].slice(0, 3)), new Date(Date.UTC(+e[1], +(e[2] || 1) - 1, +e[3] || 1, t, +(e[5] || 0), +e[6] || 0, e[7] ? +e[7].substring(0, 3) : 0));
    } else
      return new Date(+e[1], +(e[2] || 1) - 1, +e[3] || 1, +e[4] || 0, +(e[5] || 0), +e[6] || 0, e[7] ? +e[7].substring(0, 3) : 0);
  } else if (r == null)
    return /* @__PURE__ */ new Date(NaN);
  return new Date(Math.round(r));
}
function xa(r) {
  var e = parseFloat(r);
  return e == r && (e !== 0 || !V(r) || r.indexOf("x") <= 0) ? e : NaN;
}
function kg(r) {
  return !isNaN(xa(r));
}
function Ag() {
  return Math.round(Math.random() * 9);
}
function Pg(r, e) {
  return e === 0 ? r : Pg(e, r % e);
}
function Wd(r, e) {
  return r == null ? e : e == null ? r : r * e / Pg(r, e);
}
var kC = "[ECharts] ", Gd = {}, AC = typeof console < "u" && console.warn && console.log;
function to(r, e, t) {
  if (AC) {
    if (t) {
      if (Gd[e])
        return;
      Gd[e] = !0;
    }
    console[r](kC + e);
  }
}
function PC(r, e) {
  to("log", r, e);
}
function wt(r, e) {
  to("warn", r, e);
}
function Ne(r, e) {
  to("error", r, e);
}
function Nt(r) {
  process.env.NODE_ENV !== "production" && to("warn", "DEPRECATED: " + r, !0);
}
function Se(r, e, t) {
  process.env.NODE_ENV !== "production" && Nt((t ? "[" + t + "]" : "") + (r + " is deprecated, use " + e + " instead."));
}
function Sa() {
  for (var r = [], e = 0; e < arguments.length; e++)
    r[e] = arguments[e];
  var t = "";
  if (process.env.NODE_ENV !== "production") {
    var i = function(n) {
      return n === void 0 ? "undefined" : n === 1 / 0 ? "Infinity" : n === -1 / 0 ? "-Infinity" : ig(n) ? "NaN" : n instanceof Date ? "Date(" + n.toISOString() + ")" : q(n) ? "function () { ... }" : a0(n) ? n + "" : null;
    };
    t = J(r, function(n) {
      if (V(n))
        return n;
      var s = i(n);
      if (s != null)
        return s;
      if (typeof JSON < "u" && JSON.stringify)
        try {
          return JSON.stringify(n, function(a, o) {
            var l = i(o);
            return l ?? o;
          });
        } catch {
          return "?";
        }
      else
        return "?";
    }).join(" ");
  }
  return t;
}
function Ke(r) {
  throw new Error(r);
}
var Og = "series\0", OC = "\0_ec_\0";
function Me(r) {
  return r instanceof Array ? r : r == null ? [] : [r];
}
function Ud(r, e, t) {
  if (r) {
    r[e] = r[e] || {}, r.emphasis = r.emphasis || {}, r.emphasis[e] = r.emphasis[e] || {};
    for (var i = 0, n = t.length; i < n; i++) {
      var s = t[i];
      !r.emphasis[e].hasOwnProperty(s) && r[e].hasOwnProperty(s) && (r.emphasis[e][s] = r[e][s]);
    }
  }
}
var jd = ["fontStyle", "fontWeight", "fontSize", "fontFamily", "rich", "tag", "color", "textBorderColor", "textBorderWidth", "width", "height", "lineHeight", "align", "verticalAlign", "baseline", "shadowColor", "shadowBlur", "shadowOffsetX", "shadowOffsetY", "textShadowColor", "textShadowBlur", "textShadowOffsetX", "textShadowOffsetY", "backgroundColor", "borderColor", "borderWidth", "borderRadius", "padding"];
function io(r) {
  return B(r) && !F(r) && !(r instanceof Date) ? r.value : r;
}
function IC(r) {
  return B(r) && !(r instanceof Array);
}
function zC(r, e, t) {
  var i = t === "normalMerge", n = t === "replaceMerge", s = t === "replaceAll";
  r = r || [], e = (e || []).slice();
  var a = Z();
  M(e, function(l, h) {
    if (!B(l)) {
      e[h] = null;
      return;
    }
    process.env.NODE_ENV !== "production" && (l.id != null && !Xd(l.id) && Yd(l.id), l.name != null && !Xd(l.name) && Yd(l.name));
  });
  var o = FC(r, a, t);
  return (i || n) && HC(o, r, a, e), i && NC(o, e), i || n ? BC(o, e, n) : s && VC(o, e), WC(o), o;
}
function FC(r, e, t) {
  var i = [];
  if (t === "replaceAll")
    return i;
  for (var n = 0; n < r.length; n++) {
    var s = r[n];
    s && s.id != null && e.set(s.id, n), i.push({
      existing: t === "replaceMerge" || qr(s) ? null : s,
      newOption: null,
      keyInfo: null,
      brandNew: null
    });
  }
  return i;
}
function HC(r, e, t, i) {
  M(i, function(n, s) {
    if (!(!n || n.id == null)) {
      var a = jn(n.id), o = t.get(a);
      if (o != null) {
        var l = r[o];
        Y(!l.newOption, 'Duplicated option on id "' + a + '".'), l.newOption = n, l.existing = e[o], i[s] = null;
      }
    }
  });
}
function NC(r, e) {
  M(e, function(t, i) {
    if (!(!t || t.name == null))
      for (var n = 0; n < r.length; n++) {
        var s = r[n].existing;
        if (!r[n].newOption && s && (s.id == null || t.id == null) && !qr(t) && !qr(s) && Ig("name", s, t)) {
          r[n].newOption = t, e[i] = null;
          return;
        }
      }
  });
}
function BC(r, e, t) {
  M(e, function(i) {
    if (i) {
      for (
        var n, s = 0;
        // Be `!resultItem` only when `nextIdx >= result.length`.
        (n = r[s]) && (n.newOption || qr(n.existing) || // In mode "replaceMerge", here no not-mapped-non-internal-existing.
        n.existing && i.id != null && !Ig("id", i, n.existing));
      )
        s++;
      n ? (n.newOption = i, n.brandNew = t) : r.push({
        newOption: i,
        brandNew: t,
        existing: null,
        keyInfo: null
      }), s++;
    }
  });
}
function VC(r, e) {
  M(e, function(t) {
    r.push({
      newOption: t,
      brandNew: !0,
      existing: null,
      keyInfo: null
    });
  });
}
function WC(r) {
  var e = Z();
  M(r, function(t) {
    var i = t.existing;
    i && e.set(i.id, t);
  }), M(r, function(t) {
    var i = t.newOption;
    Y(!i || i.id == null || !e.get(i.id) || e.get(i.id) === t, "id duplicates: " + (i && i.id)), i && i.id != null && e.set(i.id, t), !t.keyInfo && (t.keyInfo = {});
  }), M(r, function(t, i) {
    var n = t.existing, s = t.newOption, a = t.keyInfo;
    if (B(s)) {
      if (a.name = s.name != null ? jn(s.name) : n ? n.name : Og + i, n)
        a.id = jn(n.id);
      else if (s.id != null)
        a.id = jn(s.id);
      else {
        var o = 0;
        do
          a.id = "\0" + a.name + "\0" + o++;
        while (e.get(a.id));
      }
      e.set(a.id, t);
    }
  });
}
function Ig(r, e, t) {
  var i = at(e[r], null), n = at(t[r], null);
  return i != null && n != null && i === n;
}
function jn(r) {
  if (process.env.NODE_ENV !== "production" && r == null)
    throw new Error();
  return at(r, "");
}
function at(r, e) {
  return r == null ? e : V(r) ? r : Re(r) || va(r) ? r + "" : e;
}
function Yd(r) {
  process.env.NODE_ENV !== "production" && wt("`" + r + "` is invalid id or name. Must be a string or number.");
}
function Xd(r) {
  return va(r) || kg(r);
}
function zg(r) {
  var e = r.name;
  return !!(e && e.indexOf(Og));
}
function qr(r) {
  return r && r.id != null && jn(r.id).indexOf(OC) === 0;
}
function GC(r, e, t) {
  M(r, function(i) {
    var n = i.newOption;
    B(n) && (i.keyInfo.mainType = e, i.keyInfo.subType = UC(e, n, i.existing, t));
  });
}
function UC(r, e, t, i) {
  var n = e.type ? e.type : t ? t.subType : i.determineSubType(r, e);
  return n;
}
function ms(r, e) {
  if (e.dataIndexInside != null)
    return e.dataIndexInside;
  if (e.dataIndex != null)
    return F(e.dataIndex) ? J(e.dataIndex, function(t) {
      return r.indexOfRawIndex(t);
    }) : r.indexOfRawIndex(e.dataIndex);
  if (e.name != null)
    return F(e.name) ? J(e.name, function(t) {
      return r.indexOfName(t);
    }) : r.indexOfName(e.name);
}
function Te() {
  var r = "__ec_inner_" + jC++;
  return function(e) {
    return e[r] || (e[r] = {});
  };
}
var jC = Ag();
function Wo(r, e, t) {
  var i = mu(e, t), n = i.mainTypeSpecified, s = i.queryOptionMap, a = i.others, o = a, l = t ? t.defaultMainType : null;
  return !n && l && s.set(l, {}), s.each(function(h, u) {
    var d = bs(r, u, h, {
      useDefault: l === u,
      enableAll: t && t.enableAll != null ? t.enableAll : !0,
      enableNone: t && t.enableNone != null ? t.enableNone : !0
    });
    o[u + "Models"] = d.models, o[u + "Model"] = d.models[0];
  }), o;
}
function mu(r, e) {
  var t;
  if (V(r)) {
    var i = {};
    i[r + "Index"] = 0, t = i;
  } else
    t = r;
  var n = Z(), s = {}, a = !1;
  return M(t, function(o, l) {
    if (l === "dataIndex" || l === "dataIndexInside") {
      s[l] = o;
      return;
    }
    var h = l.match(/^(\w+)(Index|Id|Name)$/) || [], u = h[1], d = (h[2] || "").toLowerCase();
    if (!(!u || !d || e && e.includeMainTypes && ue(e.includeMainTypes, u) < 0)) {
      a = a || !!u;
      var c = n.get(u) || n.set(u, {});
      c[d] = o;
    }
  }), {
    mainTypeSpecified: a,
    queryOptionMap: n,
    others: s
  };
}
var bu = {
  useDefault: !0,
  enableAll: !1,
  enableNone: !1
};
function bs(r, e, t, i) {
  i = i || bu;
  var n = t.index, s = t.id, a = t.name, o = {
    models: null,
    specified: n != null || s != null || a != null
  };
  if (!o.specified) {
    var l = void 0;
    return o.models = i.useDefault && (l = r.getComponent(e)) ? [l] : [], o;
  }
  return n === "none" || n === !1 ? (Y(i.enableNone, '`"none"` or `false` is not a valid value on index option.'), o.models = [], o) : (n === "all" && (Y(i.enableAll, '`"all"` is not a valid value on index option.'), n = s = a = null), o.models = r.queryComponents({
    mainType: e,
    index: n,
    id: s,
    name: a
  }), o);
}
function Fg(r, e, t) {
  r.setAttribute ? r.setAttribute(e, t) : r[e] = t;
}
function YC(r, e) {
  return r.getAttribute ? r.getAttribute(e) : r[e];
}
function XC(r) {
  return r === "auto" ? W.domSupported ? "html" : "richText" : r || "html";
}
var $C = ".", Pi = "___EC__COMPONENT__CONTAINER___", Hg = "___EC__EXTENDED_CLASS___";
function Ft(r) {
  var e = {
    main: "",
    sub: ""
  };
  if (r) {
    var t = r.split($C);
    e.main = t[0] || "", e.sub = t[1] || "";
  }
  return e;
}
function qC(r) {
  Y(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(r), 'componentType "' + r + '" illegal');
}
function KC(r) {
  return !!(r && r[Hg]);
}
function yu(r, e) {
  r.$constructor = r, r.extend = function(t) {
    process.env.NODE_ENV !== "production" && M(e, function(s) {
      t[s] || console.warn("Method `" + s + "` should be implemented" + (t.type ? " in " + t.type : "") + ".");
    });
    var i = this, n;
    return ZC(i) ? n = /** @class */
    function(s) {
      De(a, s);
      function a() {
        return s.apply(this, arguments) || this;
      }
      return a;
    }(i) : (n = function() {
      (t.$constructor || i).apply(this, arguments);
    }, r0(n, this)), P(n.prototype, t), n[Hg] = !0, n.extend = this.extend, n.superCall = e_, n.superApply = t_, n.superClass = i, n;
  };
}
function ZC(r) {
  return q(r) && /^class\s/.test(Function.prototype.toString.call(r));
}
function Ng(r, e) {
  r.extend = e.extend;
}
var JC = Math.round(Math.random() * 10);
function QC(r) {
  var e = ["__\0is_clz", JC++].join("_");
  r.prototype[e] = !0, process.env.NODE_ENV !== "production" && Y(!r.isInstance, 'The method "is" can not be defined.'), r.isInstance = function(t) {
    return !!(t && t[e]);
  };
}
function e_(r, e) {
  for (var t = [], i = 2; i < arguments.length; i++)
    t[i - 2] = arguments[i];
  return this.superClass.prototype[e].apply(r, t);
}
function t_(r, e, t) {
  return this.superClass.prototype[e].apply(r, t);
}
function wu(r) {
  var e = {};
  r.registerClass = function(i) {
    var n = i.type || i.prototype.type;
    if (n) {
      qC(n), i.prototype.type = n;
      var s = Ft(n);
      if (!s.sub)
        process.env.NODE_ENV !== "production" && e[s.main] && console.warn(s.main + " exists."), e[s.main] = i;
      else if (s.sub !== Pi) {
        var a = t(s);
        a[s.sub] = i;
      }
    }
    return i;
  }, r.getClass = function(i, n, s) {
    var a = e[i];
    if (a && a[Pi] && (a = n ? a[n] : null), s && !a)
      throw new Error(n ? "Component " + i + "." + (n || "") + " is used but not imported." : i + ".type should be specified.");
    return a;
  }, r.getClassesByMainType = function(i) {
    var n = Ft(i), s = [], a = e[n.main];
    return a && a[Pi] ? M(a, function(o, l) {
      l !== Pi && s.push(o);
    }) : s.push(a), s;
  }, r.hasClass = function(i) {
    var n = Ft(i);
    return !!e[n.main];
  }, r.getAllClassMainTypes = function() {
    var i = [];
    return M(e, function(n, s) {
      i.push(s);
    }), i;
  }, r.hasSubTypes = function(i) {
    var n = Ft(i), s = e[n.main];
    return s && s[Pi];
  };
  function t(i) {
    var n = e[i.main];
    return (!n || !n[Pi]) && (n = e[i.main] = {}, n[Pi] = !0), n;
  }
}
function Kr(r, e) {
  for (var t = 0; t < r.length; t++)
    r[t][1] || (r[t][1] = r[t][0]);
  return e = e || !1, function(i, n, s) {
    for (var a = {}, o = 0; o < r.length; o++) {
      var l = r[o][1];
      if (!(n && ue(n, l) >= 0 || s && ue(s, l) < 0)) {
        var h = i.getShallow(l, e);
        h != null && (a[r[o][0]] = h);
      }
    }
    return a;
  };
}
var i_ = [
  ["fill", "color"],
  ["shadowBlur"],
  ["shadowOffsetX"],
  ["shadowOffsetY"],
  ["opacity"],
  ["shadowColor"]
  // Option decal is in `DecalObject` but style.decal is in `PatternObject`.
  // So do not transfer decal directly.
], r_ = Kr(i_), n_ = (
  /** @class */
  function() {
    function r() {
    }
    return r.prototype.getAreaStyle = function(e, t) {
      return r_(this, e, t);
    }, r;
  }()
), Sh = new vs(50);
function s_(r) {
  if (typeof r == "string") {
    var e = Sh.get(r);
    return e && e.image;
  } else
    return r;
}
function Bg(r, e, t, i, n) {
  if (r)
    if (typeof r == "string") {
      if (e && e.__zrImageSrc === r || !t)
        return e;
      var s = Sh.get(r), a = { hostEl: t, cb: i, cbPayload: n };
      return s ? (e = s.image, !ro(e) && s.pending.push(a)) : (e = Qr.loadImage(r, $d, $d), e.__zrImageSrc = r, Sh.put(r, e.__cachedImgObj = {
        image: e,
        pending: [a]
      })), e;
    } else
      return r;
  else return e;
}
function $d() {
  var r = this.__cachedImgObj;
  this.onload = this.onerror = this.__cachedImgObj = null;
  for (var e = 0; e < r.pending.length; e++) {
    var t = r.pending[e], i = t.cb;
    i && i(this, t.cbPayload), t.hostEl.dirty();
  }
  r.pending.length = 0;
}
function ro(r) {
  return r && r.width && r.height;
}
var Go = /\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;
function a_(r, e, t, i, n, s) {
  if (!t) {
    r.text = "", r.isTruncated = !1;
    return;
  }
  var a = (e + "").split(`
`);
  s = Vg(t, i, n, s);
  for (var o = !1, l = {}, h = 0, u = a.length; h < u; h++)
    Wg(l, a[h], s), a[h] = l.textLine, o = o || l.isTruncated;
  r.text = a.join(`
`), r.isTruncated = o;
}
function Vg(r, e, t, i) {
  i = i || {};
  var n = P({}, i);
  n.font = e, t = j(t, "..."), n.maxIterations = j(i.maxIterations, 2);
  var s = n.minChar = j(i.minChar, 0);
  n.cnCharWidth = st("å›½", e);
  var a = n.ascCharWidth = st("a", e);
  n.placeholder = j(i.placeholder, "");
  for (var o = r = Math.max(0, r - 1), l = 0; l < s && o >= a; l++)
    o -= a;
  var h = st(t, e);
  return h > o && (t = "", h = 0), o = r - h, n.ellipsis = t, n.ellipsisWidth = h, n.contentWidth = o, n.containerWidth = r, n;
}
function Wg(r, e, t) {
  var i = t.containerWidth, n = t.font, s = t.contentWidth;
  if (!i) {
    r.textLine = "", r.isTruncated = !1;
    return;
  }
  var a = st(e, n);
  if (a <= i) {
    r.textLine = e, r.isTruncated = !1;
    return;
  }
  for (var o = 0; ; o++) {
    if (a <= s || o >= t.maxIterations) {
      e += t.ellipsis;
      break;
    }
    var l = o === 0 ? o_(e, s, t.ascCharWidth, t.cnCharWidth) : a > 0 ? Math.floor(e.length * s / a) : 0;
    e = e.substr(0, l), a = st(e, n);
  }
  e === "" && (e = t.placeholder), r.textLine = e, r.isTruncated = !0;
}
function o_(r, e, t, i) {
  for (var n = 0, s = 0, a = r.length; s < a && n < e; s++) {
    var o = r.charCodeAt(s);
    n += 0 <= o && o <= 127 ? t : i;
  }
  return s;
}
function l_(r, e) {
  r != null && (r += "");
  var t = e.overflow, i = e.padding, n = e.font, s = t === "truncate", a = vu(n), o = j(e.lineHeight, a), l = !!e.backgroundColor, h = e.lineOverflow === "truncate", u = !1, d = e.width, c;
  d != null && (t === "break" || t === "breakAll") ? c = r ? Gg(r, e.font, d, t === "breakAll", 0).lines : [] : c = r ? r.split(`
`) : [];
  var f = c.length * o, p = j(e.height, f);
  if (f > p && h) {
    var m = Math.floor(p / o);
    u = u || c.length > m, c = c.slice(0, m);
  }
  if (r && s && d != null)
    for (var g = Vg(d, n, e.ellipsis, {
      minChar: e.truncateMinChar,
      placeholder: e.placeholder
    }), v = {}, b = 0; b < c.length; b++)
      Wg(v, c[b], g), c[b] = v.textLine, u = u || v.isTruncated;
  for (var y = p, w = 0, b = 0; b < c.length; b++)
    w = Math.max(st(c[b], n), w);
  d == null && (d = w);
  var _ = w;
  return i && (y += i[0] + i[2], _ += i[1] + i[3], d += i[1] + i[3]), l && (_ = d), {
    lines: c,
    height: p,
    outerWidth: _,
    outerHeight: y,
    lineHeight: o,
    calculatedLineHeight: a,
    contentWidth: w,
    contentHeight: f,
    width: d,
    isTruncated: u
  };
}
var h_ = /* @__PURE__ */ function() {
  function r() {
  }
  return r;
}(), qd = /* @__PURE__ */ function() {
  function r(e) {
    this.tokens = [], e && (this.tokens = e);
  }
  return r;
}(), u_ = /* @__PURE__ */ function() {
  function r() {
    this.width = 0, this.height = 0, this.contentWidth = 0, this.contentHeight = 0, this.outerWidth = 0, this.outerHeight = 0, this.lines = [], this.isTruncated = !1;
  }
  return r;
}();
function d_(r, e) {
  var t = new u_();
  if (r != null && (r += ""), !r)
    return t;
  for (var i = e.width, n = e.height, s = e.overflow, a = (s === "break" || s === "breakAll") && i != null ? { width: i, accumWidth: 0, breakAll: s === "breakAll" } : null, o = Go.lastIndex = 0, l; (l = Go.exec(r)) != null; ) {
    var h = l.index;
    h > o && Uo(t, r.substring(o, h), e, a), Uo(t, l[2], e, a, l[1]), o = Go.lastIndex;
  }
  o < r.length && Uo(t, r.substring(o, r.length), e, a);
  var u = [], d = 0, c = 0, f = e.padding, p = s === "truncate", m = e.lineOverflow === "truncate", g = {};
  function v(ve, be, ie) {
    ve.width = be, ve.lineHeight = ie, d += ie, c = Math.max(c, be);
  }
  e: for (var b = 0; b < t.lines.length; b++) {
    for (var y = t.lines[b], w = 0, _ = 0, E = 0; E < y.tokens.length; E++) {
      var x = y.tokens[E], T = x.styleName && e.rich[x.styleName] || {}, C = x.textPadding = T.padding, S = C ? C[1] + C[3] : 0, R = x.font = T.font || e.font;
      x.contentHeight = vu(R);
      var D = j(T.height, x.contentHeight);
      if (x.innerHeight = D, C && (D += C[0] + C[2]), x.height = D, x.lineHeight = ta(T.lineHeight, e.lineHeight, D), x.align = T && T.align || e.align, x.verticalAlign = T && T.verticalAlign || "middle", m && n != null && d + x.lineHeight > n) {
        var k = t.lines.length;
        E > 0 ? (y.tokens = y.tokens.slice(0, E), v(y, _, w), t.lines = t.lines.slice(0, b + 1)) : t.lines = t.lines.slice(0, b), t.isTruncated = t.isTruncated || t.lines.length < k;
        break e;
      }
      var L = T.width, O = L == null || L === "auto";
      if (typeof L == "string" && L.charAt(L.length - 1) === "%")
        x.percentWidth = L, u.push(x), x.contentWidth = st(x.text, R);
      else {
        if (O) {
          var I = T.backgroundColor, G = I && I.image;
          G && (G = s_(G), ro(G) && (x.width = Math.max(x.width, G.width * D / G.height)));
        }
        var ee = p && i != null ? i - _ : null;
        ee != null && ee < x.width ? !O || ee < S ? (x.text = "", x.width = x.contentWidth = 0) : (a_(g, x.text, ee - S, R, e.ellipsis, { minChar: e.truncateMinChar }), x.text = g.text, t.isTruncated = t.isTruncated || g.isTruncated, x.width = x.contentWidth = st(x.text, R)) : x.contentWidth = st(x.text, R);
      }
      x.width += S, _ += x.width, T && (w = Math.max(w, x.lineHeight));
    }
    v(y, _, w);
  }
  t.outerWidth = t.width = j(i, c), t.outerHeight = t.height = j(n, d), t.contentHeight = d, t.contentWidth = c, f && (t.outerWidth += f[1] + f[3], t.outerHeight += f[0] + f[2]);
  for (var b = 0; b < u.length; b++) {
    var x = u[b], te = x.percentWidth;
    x.width = parseInt(te, 10) / 100 * t.width;
  }
  return t;
}
function Uo(r, e, t, i, n) {
  var s = e === "", a = n && t.rich[n] || {}, o = r.lines, l = a.font || t.font, h = !1, u, d;
  if (i) {
    var c = a.padding, f = c ? c[1] + c[3] : 0;
    if (a.width != null && a.width !== "auto") {
      var p = as(a.width, i.width) + f;
      o.length > 0 && p + i.accumWidth > i.width && (u = e.split(`
`), h = !0), i.accumWidth = p;
    } else {
      var m = Gg(e, l, i.width, i.breakAll, i.accumWidth);
      i.accumWidth = m.accumWidth + f, d = m.linesWidths, u = m.lines;
    }
  } else
    u = e.split(`
`);
  for (var g = 0; g < u.length; g++) {
    var v = u[g], b = new h_();
    if (b.styleName = n, b.text = v, b.isLineHolder = !v && !s, typeof a.width == "number" ? b.width = a.width : b.width = d ? d[g] : st(v, l), !g && !h) {
      var y = (o[o.length - 1] || (o[0] = new qd())).tokens, w = y.length;
      w === 1 && y[0].isLineHolder ? y[0] = b : (v || !w || s) && y.push(b);
    } else
      o.push(new qd([b]));
  }
}
function c_(r) {
  var e = r.charCodeAt(0);
  return e >= 32 && e <= 591 || e >= 880 && e <= 4351 || e >= 4608 && e <= 5119 || e >= 7680 && e <= 8303;
}
var f_ = tn(",&?/;] ".split(""), function(r, e) {
  return r[e] = !0, r;
}, {});
function p_(r) {
  return c_(r) ? !!f_[r] : !0;
}
function Gg(r, e, t, i, n) {
  for (var s = [], a = [], o = "", l = "", h = 0, u = 0, d = 0; d < r.length; d++) {
    var c = r.charAt(d);
    if (c === `
`) {
      l && (o += l, u += h), s.push(o), a.push(u), o = "", l = "", h = 0, u = 0;
      continue;
    }
    var f = st(c, e), p = i ? !1 : !p_(c);
    if (s.length ? u + f > t : n + u + f > t) {
      u ? (o || l) && (p ? (o || (o = l, l = "", h = 0, u = h), s.push(o), a.push(u - h), l += c, h += f, o = "", u = h) : (l && (o += l, l = "", h = 0), s.push(o), a.push(u), o = c, u = f)) : p ? (s.push(l), a.push(h), l = c, h = f) : (s.push(c), a.push(f));
      continue;
    }
    u += f, p ? (l += c, h += f) : (l && (o += l, l = "", h = 0), o += c);
  }
  return !s.length && !o && (o = r, l = "", h = 0), l && (o += l), o && (s.push(o), a.push(u)), s.length === 1 && (u += n), {
    accumWidth: u,
    lines: s,
    linesWidths: a
  };
}
var Rh = "__zr_style_" + Math.round(Math.random() * 10), lr = {
  shadowBlur: 0,
  shadowOffsetX: 0,
  shadowOffsetY: 0,
  shadowColor: "#000",
  opacity: 1,
  blend: "source-over"
}, no = {
  style: {
    shadowBlur: !0,
    shadowOffsetX: !0,
    shadowOffsetY: !0,
    shadowColor: !0,
    opacity: !0
  }
};
lr[Rh] = !0;
var Kd = ["z", "z2", "invisible"], g_ = ["invisible"], nn = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype._init = function(t) {
    for (var i = me(t), n = 0; n < i.length; n++) {
      var s = i[n];
      s === "style" ? this.useStyle(t[s]) : r.prototype.attrKV.call(this, s, t[s]);
    }
    this.style || this.useStyle({});
  }, e.prototype.beforeBrush = function() {
  }, e.prototype.afterBrush = function() {
  }, e.prototype.innerBeforeBrush = function() {
  }, e.prototype.innerAfterBrush = function() {
  }, e.prototype.shouldBePainted = function(t, i, n, s) {
    var a = this.transform;
    if (this.ignore || this.invisible || this.style.opacity === 0 || this.culling && v_(this, t, i) || a && !a[0] && !a[3])
      return !1;
    if (n && this.__clipPaths) {
      for (var o = 0; o < this.__clipPaths.length; ++o)
        if (this.__clipPaths[o].isZeroArea())
          return !1;
    }
    if (s && this.parent)
      for (var l = this.parent; l; ) {
        if (l.ignore)
          return !1;
        l = l.parent;
      }
    return !0;
  }, e.prototype.contain = function(t, i) {
    return this.rectContain(t, i);
  }, e.prototype.traverse = function(t, i) {
    t.call(i, this);
  }, e.prototype.rectContain = function(t, i) {
    var n = this.transformCoordToLocal(t, i), s = this.getBoundingRect();
    return s.contain(n[0], n[1]);
  }, e.prototype.getPaintRect = function() {
    var t = this._paintRect;
    if (!this._paintRect || this.__dirty) {
      var i = this.transform, n = this.getBoundingRect(), s = this.style, a = s.shadowBlur || 0, o = s.shadowOffsetX || 0, l = s.shadowOffsetY || 0;
      t = this._paintRect || (this._paintRect = new re(0, 0, 0, 0)), i ? re.applyTransform(t, n, i) : t.copy(n), (a || o || l) && (t.width += a * 2 + Math.abs(o), t.height += a * 2 + Math.abs(l), t.x = Math.min(t.x, t.x + o - a), t.y = Math.min(t.y, t.y + l - a));
      var h = this.dirtyRectTolerance;
      t.isZero() || (t.x = Math.floor(t.x - h), t.y = Math.floor(t.y - h), t.width = Math.ceil(t.width + 1 + h * 2), t.height = Math.ceil(t.height + 1 + h * 2));
    }
    return t;
  }, e.prototype.setPrevPaintRect = function(t) {
    t ? (this._prevPaintRect = this._prevPaintRect || new re(0, 0, 0, 0), this._prevPaintRect.copy(t)) : this._prevPaintRect = null;
  }, e.prototype.getPrevPaintRect = function() {
    return this._prevPaintRect;
  }, e.prototype.animateStyle = function(t) {
    return this.animate("style", t);
  }, e.prototype.updateDuringAnimation = function(t) {
    t === "style" ? this.dirtyStyle() : this.markRedraw();
  }, e.prototype.attrKV = function(t, i) {
    t !== "style" ? r.prototype.attrKV.call(this, t, i) : this.style ? this.setStyle(i) : this.useStyle(i);
  }, e.prototype.setStyle = function(t, i) {
    return typeof t == "string" ? this.style[t] = i : P(this.style, t), this.dirtyStyle(), this;
  }, e.prototype.dirtyStyle = function(t) {
    t || this.markRedraw(), this.__dirty |= Pn, this._rect && (this._rect = null);
  }, e.prototype.dirty = function() {
    this.dirtyStyle();
  }, e.prototype.styleChanged = function() {
    return !!(this.__dirty & Pn);
  }, e.prototype.styleUpdated = function() {
    this.__dirty &= ~Pn;
  }, e.prototype.createStyle = function(t) {
    return Za(lr, t);
  }, e.prototype.useStyle = function(t) {
    t[Rh] || (t = this.createStyle(t)), this.__inHover ? this.__hoverStyle = t : this.style = t, this.dirtyStyle();
  }, e.prototype.isStyleObject = function(t) {
    return t[Rh];
  }, e.prototype._innerSaveToNormal = function(t) {
    r.prototype._innerSaveToNormal.call(this, t);
    var i = this._normalState;
    t.style && !i.style && (i.style = this._mergeStyle(this.createStyle(), this.style)), this._savePrimaryToNormal(t, i, Kd);
  }, e.prototype._applyStateObj = function(t, i, n, s, a, o) {
    r.prototype._applyStateObj.call(this, t, i, n, s, a, o);
    var l = !(i && s), h;
    if (i && i.style ? a ? s ? h = i.style : (h = this._mergeStyle(this.createStyle(), n.style), this._mergeStyle(h, i.style)) : (h = this._mergeStyle(this.createStyle(), s ? this.style : n.style), this._mergeStyle(h, i.style)) : l && (h = n.style), h)
      if (a) {
        var u = this.style;
        if (this.style = this.createStyle(l ? {} : u), l)
          for (var d = me(u), c = 0; c < d.length; c++) {
            var f = d[c];
            f in h && (h[f] = h[f], this.style[f] = u[f]);
          }
        for (var p = me(h), c = 0; c < p.length; c++) {
          var f = p[c];
          this.style[f] = this.style[f];
        }
        this._transitionState(t, {
          style: h
        }, o, this.getAnimationStyleProps());
      } else
        this.useStyle(h);
    for (var m = this.__inHover ? g_ : Kd, c = 0; c < m.length; c++) {
      var f = m[c];
      i && i[f] != null ? this[f] = i[f] : l && n[f] != null && (this[f] = n[f]);
    }
  }, e.prototype._mergeStates = function(t) {
    for (var i = r.prototype._mergeStates.call(this, t), n, s = 0; s < t.length; s++) {
      var a = t[s];
      a.style && (n = n || {}, this._mergeStyle(n, a.style));
    }
    return n && (i.style = n), i;
  }, e.prototype._mergeStyle = function(t, i) {
    return P(t, i), t;
  }, e.prototype.getAnimationStyleProps = function() {
    return no;
  }, e.initDefaultProps = function() {
    var t = e.prototype;
    t.type = "displayable", t.invisible = !1, t.z = 0, t.z2 = 0, t.zlevel = 0, t.culling = !1, t.cursor = "pointer", t.rectHover = !1, t.incremental = !1, t._rect = null, t.dirtyRectTolerance = 0, t.__dirty = nt | Pn;
  }(), e;
}(Qa), jo = new re(0, 0, 0, 0), Yo = new re(0, 0, 0, 0);
function v_(r, e, t) {
  return jo.copy(r.getBoundingRect()), r.transform && jo.applyTransform(r.transform), Yo.width = e, Yo.height = t, !jo.intersect(Yo);
}
var Ct = Math.min, _t = Math.max, Xo = Math.sin, $o = Math.cos, Oi = Math.PI * 2, ks = rn(), As = rn(), Ps = rn();
function Zd(r, e, t, i, n, s) {
  n[0] = Ct(r, t), n[1] = Ct(e, i), s[0] = _t(r, t), s[1] = _t(e, i);
}
var Jd = [], Qd = [];
function m_(r, e, t, i, n, s, a, o, l, h) {
  var u = vg, d = We, c = u(r, t, n, a, Jd);
  l[0] = 1 / 0, l[1] = 1 / 0, h[0] = -1 / 0, h[1] = -1 / 0;
  for (var f = 0; f < c; f++) {
    var p = d(r, t, n, a, Jd[f]);
    l[0] = Ct(p, l[0]), h[0] = _t(p, h[0]);
  }
  c = u(e, i, s, o, Qd);
  for (var f = 0; f < c; f++) {
    var m = d(e, i, s, o, Qd[f]);
    l[1] = Ct(m, l[1]), h[1] = _t(m, h[1]);
  }
  l[0] = Ct(r, l[0]), h[0] = _t(r, h[0]), l[0] = Ct(a, l[0]), h[0] = _t(a, h[0]), l[1] = Ct(e, l[1]), h[1] = _t(e, h[1]), l[1] = Ct(o, l[1]), h[1] = _t(o, h[1]);
}
function b_(r, e, t, i, n, s, a, o) {
  var l = mg, h = qe, u = _t(Ct(l(r, t, n), 1), 0), d = _t(Ct(l(e, i, s), 1), 0), c = h(r, t, n, u), f = h(e, i, s, d);
  a[0] = Ct(r, n, c), a[1] = Ct(e, s, f), o[0] = _t(r, n, c), o[1] = _t(e, s, f);
}
function y_(r, e, t, i, n, s, a, o, l) {
  var h = Ar, u = Pr, d = Math.abs(n - s);
  if (d % Oi < 1e-4 && d > 1e-4) {
    o[0] = r - t, o[1] = e - i, l[0] = r + t, l[1] = e + i;
    return;
  }
  if (ks[0] = $o(n) * t + r, ks[1] = Xo(n) * i + e, As[0] = $o(s) * t + r, As[1] = Xo(s) * i + e, h(o, ks, As), u(l, ks, As), n = n % Oi, n < 0 && (n = n + Oi), s = s % Oi, s < 0 && (s = s + Oi), n > s && !a ? s += Oi : n < s && a && (n += Oi), a) {
    var c = s;
    s = n, n = c;
  }
  for (var f = 0; f < s; f += Math.PI / 2)
    f > n && (Ps[0] = $o(f) * t + r, Ps[1] = Xo(f) * i + e, h(o, Ps, o), u(l, Ps, l));
}
var ne = {
  M: 1,
  L: 2,
  C: 3,
  Q: 4,
  A: 5,
  Z: 6,
  R: 7
}, Ii = [], zi = [], Lt = [], si = [], kt = [], At = [], qo = Math.min, Ko = Math.max, Fi = Math.cos, Hi = Math.sin, jt = Math.abs, Mh = Math.PI, di = Mh * 2, Zo = typeof Float32Array < "u", vn = [];
function Jo(r) {
  var e = Math.round(r / Mh * 1e8) / 1e8;
  return e % 2 * Mh;
}
function w_(r, e) {
  var t = Jo(r[0]);
  t < 0 && (t += di);
  var i = t - r[0], n = r[1];
  n += i, !e && n - t >= di ? n = t + di : e && t - n >= di ? n = t - di : !e && t > n ? n = t + (di - Jo(t - n)) : e && t < n && (n = t - (di - Jo(n - t))), r[0] = t, r[1] = n;
}
var Zr = function() {
  function r(e) {
    this.dpr = 1, this._xi = 0, this._yi = 0, this._x0 = 0, this._y0 = 0, this._len = 0, e && (this._saveData = !1), this._saveData && (this.data = []);
  }
  return r.prototype.increaseVersion = function() {
    this._version++;
  }, r.prototype.getVersion = function() {
    return this._version;
  }, r.prototype.setScale = function(e, t, i) {
    i = i || 0, i > 0 && (this._ux = jt(i / Ea / e) || 0, this._uy = jt(i / Ea / t) || 0);
  }, r.prototype.setDPR = function(e) {
    this.dpr = e;
  }, r.prototype.setContext = function(e) {
    this._ctx = e;
  }, r.prototype.getContext = function() {
    return this._ctx;
  }, r.prototype.beginPath = function() {
    return this._ctx && this._ctx.beginPath(), this.reset(), this;
  }, r.prototype.reset = function() {
    this._saveData && (this._len = 0), this._pathSegLen && (this._pathSegLen = null, this._pathLen = 0), this._version++;
  }, r.prototype.moveTo = function(e, t) {
    return this._drawPendingPt(), this.addData(ne.M, e, t), this._ctx && this._ctx.moveTo(e, t), this._x0 = e, this._y0 = t, this._xi = e, this._yi = t, this;
  }, r.prototype.lineTo = function(e, t) {
    var i = jt(e - this._xi), n = jt(t - this._yi), s = i > this._ux || n > this._uy;
    if (this.addData(ne.L, e, t), this._ctx && s && this._ctx.lineTo(e, t), s)
      this._xi = e, this._yi = t, this._pendingPtDist = 0;
    else {
      var a = i * i + n * n;
      a > this._pendingPtDist && (this._pendingPtX = e, this._pendingPtY = t, this._pendingPtDist = a);
    }
    return this;
  }, r.prototype.bezierCurveTo = function(e, t, i, n, s, a) {
    return this._drawPendingPt(), this.addData(ne.C, e, t, i, n, s, a), this._ctx && this._ctx.bezierCurveTo(e, t, i, n, s, a), this._xi = s, this._yi = a, this;
  }, r.prototype.quadraticCurveTo = function(e, t, i, n) {
    return this._drawPendingPt(), this.addData(ne.Q, e, t, i, n), this._ctx && this._ctx.quadraticCurveTo(e, t, i, n), this._xi = i, this._yi = n, this;
  }, r.prototype.arc = function(e, t, i, n, s, a) {
    this._drawPendingPt(), vn[0] = n, vn[1] = s, w_(vn, a), n = vn[0], s = vn[1];
    var o = s - n;
    return this.addData(ne.A, e, t, i, i, n, o, 0, a ? 0 : 1), this._ctx && this._ctx.arc(e, t, i, n, s, a), this._xi = Fi(s) * i + e, this._yi = Hi(s) * i + t, this;
  }, r.prototype.arcTo = function(e, t, i, n, s) {
    return this._drawPendingPt(), this._ctx && this._ctx.arcTo(e, t, i, n, s), this;
  }, r.prototype.rect = function(e, t, i, n) {
    return this._drawPendingPt(), this._ctx && this._ctx.rect(e, t, i, n), this.addData(ne.R, e, t, i, n), this;
  }, r.prototype.closePath = function() {
    this._drawPendingPt(), this.addData(ne.Z);
    var e = this._ctx, t = this._x0, i = this._y0;
    return e && e.closePath(), this._xi = t, this._yi = i, this;
  }, r.prototype.fill = function(e) {
    e && e.fill(), this.toStatic();
  }, r.prototype.stroke = function(e) {
    e && e.stroke(), this.toStatic();
  }, r.prototype.len = function() {
    return this._len;
  }, r.prototype.setData = function(e) {
    var t = e.length;
    !(this.data && this.data.length === t) && Zo && (this.data = new Float32Array(t));
    for (var i = 0; i < t; i++)
      this.data[i] = e[i];
    this._len = t;
  }, r.prototype.appendPath = function(e) {
    e instanceof Array || (e = [e]);
    for (var t = e.length, i = 0, n = this._len, s = 0; s < t; s++)
      i += e[s].len();
    Zo && this.data instanceof Float32Array && (this.data = new Float32Array(n + i));
    for (var s = 0; s < t; s++)
      for (var a = e[s].data, o = 0; o < a.length; o++)
        this.data[n++] = a[o];
    this._len = n;
  }, r.prototype.addData = function(e, t, i, n, s, a, o, l, h) {
    if (this._saveData) {
      var u = this.data;
      this._len + arguments.length > u.length && (this._expandData(), u = this.data);
      for (var d = 0; d < arguments.length; d++)
        u[this._len++] = arguments[d];
    }
  }, r.prototype._drawPendingPt = function() {
    this._pendingPtDist > 0 && (this._ctx && this._ctx.lineTo(this._pendingPtX, this._pendingPtY), this._pendingPtDist = 0);
  }, r.prototype._expandData = function() {
    if (!(this.data instanceof Array)) {
      for (var e = [], t = 0; t < this._len; t++)
        e[t] = this.data[t];
      this.data = e;
    }
  }, r.prototype.toStatic = function() {
    if (this._saveData) {
      this._drawPendingPt();
      var e = this.data;
      e instanceof Array && (e.length = this._len, Zo && this._len > 11 && (this.data = new Float32Array(e)));
    }
  }, r.prototype.getBoundingRect = function() {
    Lt[0] = Lt[1] = kt[0] = kt[1] = Number.MAX_VALUE, si[0] = si[1] = At[0] = At[1] = -Number.MAX_VALUE;
    var e = this.data, t = 0, i = 0, n = 0, s = 0, a;
    for (a = 0; a < this._len; ) {
      var o = e[a++], l = a === 1;
      switch (l && (t = e[a], i = e[a + 1], n = t, s = i), o) {
        case ne.M:
          t = n = e[a++], i = s = e[a++], kt[0] = n, kt[1] = s, At[0] = n, At[1] = s;
          break;
        case ne.L:
          Zd(t, i, e[a], e[a + 1], kt, At), t = e[a++], i = e[a++];
          break;
        case ne.C:
          m_(t, i, e[a++], e[a++], e[a++], e[a++], e[a], e[a + 1], kt, At), t = e[a++], i = e[a++];
          break;
        case ne.Q:
          b_(t, i, e[a++], e[a++], e[a], e[a + 1], kt, At), t = e[a++], i = e[a++];
          break;
        case ne.A:
          var h = e[a++], u = e[a++], d = e[a++], c = e[a++], f = e[a++], p = e[a++] + f;
          a += 1;
          var m = !e[a++];
          l && (n = Fi(f) * d + h, s = Hi(f) * c + u), y_(h, u, d, c, f, p, m, kt, At), t = Fi(p) * d + h, i = Hi(p) * c + u;
          break;
        case ne.R:
          n = t = e[a++], s = i = e[a++];
          var g = e[a++], v = e[a++];
          Zd(n, s, n + g, s + v, kt, At);
          break;
        case ne.Z:
          t = n, i = s;
          break;
      }
      Ar(Lt, Lt, kt), Pr(si, si, At);
    }
    return a === 0 && (Lt[0] = Lt[1] = si[0] = si[1] = 0), new re(Lt[0], Lt[1], si[0] - Lt[0], si[1] - Lt[1]);
  }, r.prototype._calculateLength = function() {
    var e = this.data, t = this._len, i = this._ux, n = this._uy, s = 0, a = 0, o = 0, l = 0;
    this._pathSegLen || (this._pathSegLen = []);
    for (var h = this._pathSegLen, u = 0, d = 0, c = 0; c < t; ) {
      var f = e[c++], p = c === 1;
      p && (s = e[c], a = e[c + 1], o = s, l = a);
      var m = -1;
      switch (f) {
        case ne.M:
          s = o = e[c++], a = l = e[c++];
          break;
        case ne.L: {
          var g = e[c++], v = e[c++], b = g - s, y = v - a;
          (jt(b) > i || jt(y) > n || c === t - 1) && (m = Math.sqrt(b * b + y * y), s = g, a = v);
          break;
        }
        case ne.C: {
          var w = e[c++], _ = e[c++], g = e[c++], v = e[c++], E = e[c++], x = e[c++];
          m = U0(s, a, w, _, g, v, E, x, 10), s = E, a = x;
          break;
        }
        case ne.Q: {
          var w = e[c++], _ = e[c++], g = e[c++], v = e[c++];
          m = X0(s, a, w, _, g, v, 10), s = g, a = v;
          break;
        }
        case ne.A:
          var T = e[c++], C = e[c++], S = e[c++], R = e[c++], D = e[c++], k = e[c++], L = k + D;
          c += 1, p && (o = Fi(D) * S + T, l = Hi(D) * R + C), m = Ko(S, R) * qo(di, Math.abs(k)), s = Fi(L) * S + T, a = Hi(L) * R + C;
          break;
        case ne.R: {
          o = s = e[c++], l = a = e[c++];
          var O = e[c++], I = e[c++];
          m = O * 2 + I * 2;
          break;
        }
        case ne.Z: {
          var b = o - s, y = l - a;
          m = Math.sqrt(b * b + y * y), s = o, a = l;
          break;
        }
      }
      m >= 0 && (h[d++] = m, u += m);
    }
    return this._pathLen = u, u;
  }, r.prototype.rebuildPath = function(e, t) {
    var i = this.data, n = this._ux, s = this._uy, a = this._len, o, l, h, u, d, c, f = t < 1, p, m, g = 0, v = 0, b, y = 0, w, _;
    if (!(f && (this._pathSegLen || this._calculateLength(), p = this._pathSegLen, m = this._pathLen, b = t * m, !b)))
      e: for (var E = 0; E < a; ) {
        var x = i[E++], T = E === 1;
        switch (T && (h = i[E], u = i[E + 1], o = h, l = u), x !== ne.L && y > 0 && (e.lineTo(w, _), y = 0), x) {
          case ne.M:
            o = h = i[E++], l = u = i[E++], e.moveTo(h, u);
            break;
          case ne.L: {
            d = i[E++], c = i[E++];
            var C = jt(d - h), S = jt(c - u);
            if (C > n || S > s) {
              if (f) {
                var R = p[v++];
                if (g + R > b) {
                  var D = (b - g) / R;
                  e.lineTo(h * (1 - D) + d * D, u * (1 - D) + c * D);
                  break e;
                }
                g += R;
              }
              e.lineTo(d, c), h = d, u = c, y = 0;
            } else {
              var k = C * C + S * S;
              k > y && (w = d, _ = c, y = k);
            }
            break;
          }
          case ne.C: {
            var L = i[E++], O = i[E++], I = i[E++], G = i[E++], ee = i[E++], te = i[E++];
            if (f) {
              var R = p[v++];
              if (g + R > b) {
                var D = (b - g) / R;
                ya(h, L, I, ee, D, Ii), ya(u, O, G, te, D, zi), e.bezierCurveTo(Ii[1], zi[1], Ii[2], zi[2], Ii[3], zi[3]);
                break e;
              }
              g += R;
            }
            e.bezierCurveTo(L, O, I, G, ee, te), h = ee, u = te;
            break;
          }
          case ne.Q: {
            var L = i[E++], O = i[E++], I = i[E++], G = i[E++];
            if (f) {
              var R = p[v++];
              if (g + R > b) {
                var D = (b - g) / R;
                wa(h, L, I, D, Ii), wa(u, O, G, D, zi), e.quadraticCurveTo(Ii[1], zi[1], Ii[2], zi[2]);
                break e;
              }
              g += R;
            }
            e.quadraticCurveTo(L, O, I, G), h = I, u = G;
            break;
          }
          case ne.A:
            var ve = i[E++], be = i[E++], ie = i[E++], xe = i[E++], Be = i[E++], ut = i[E++], Wt = i[E++], Gt = !i[E++], Q = ie > xe ? ie : xe, N = jt(ie - xe) > 1e-3, X = Be + ut, z = !1;
            if (f) {
              var R = p[v++];
              g + R > b && (X = Be + ut * (b - g) / R, z = !0), g += R;
            }
            if (N && e.ellipse ? e.ellipse(ve, be, ie, xe, Wt, Be, X, Gt) : e.arc(ve, be, Q, Be, X, Gt), z)
              break e;
            T && (o = Fi(Be) * ie + ve, l = Hi(Be) * xe + be), h = Fi(X) * ie + ve, u = Hi(X) * xe + be;
            break;
          case ne.R:
            o = h = i[E], l = u = i[E + 1], d = i[E++], c = i[E++];
            var H = i[E++], ye = i[E++];
            if (f) {
              var R = p[v++];
              if (g + R > b) {
                var le = b - g;
                e.moveTo(d, c), e.lineTo(d + qo(le, H), c), le -= H, le > 0 && e.lineTo(d + H, c + qo(le, ye)), le -= ye, le > 0 && e.lineTo(d + Ko(H - le, 0), c + ye), le -= H, le > 0 && e.lineTo(d, c + Ko(ye - le, 0));
                break e;
              }
              g += R;
            }
            e.rect(d, c, H, ye);
            break;
          case ne.Z:
            if (f) {
              var R = p[v++];
              if (g + R > b) {
                var D = (b - g) / R;
                e.lineTo(h * (1 - D) + o * D, u * (1 - D) + l * D);
                break e;
              }
              g += R;
            }
            e.closePath(), h = o, u = l;
        }
      }
  }, r.prototype.clone = function() {
    var e = new r(), t = this.data;
    return e.data = t.slice ? t.slice() : Array.prototype.slice.call(t), e._len = this._len, e;
  }, r.CMD = ne, r.initDefaultProps = function() {
    var e = r.prototype;
    e._saveData = !0, e._ux = 0, e._uy = 0, e._pendingPtDist = 0, e._version = 0;
  }(), r;
}();
function wr(r, e, t, i, n, s, a) {
  if (n === 0)
    return !1;
  var o = n, l = 0, h = r;
  if (a > e + o && a > i + o || a < e - o && a < i - o || s > r + o && s > t + o || s < r - o && s < t - o)
    return !1;
  if (r !== t)
    l = (e - i) / (r - t), h = (r * i - t * e) / (r - t);
  else
    return Math.abs(s - r) <= o / 2;
  var u = l * s - a + h, d = u * u / (l * l + 1);
  return d <= o / 2 * o / 2;
}
function C_(r, e, t, i, n, s, a, o, l, h, u) {
  if (l === 0)
    return !1;
  var d = l;
  if (u > e + d && u > i + d && u > s + d && u > o + d || u < e - d && u < i - d && u < s - d && u < o - d || h > r + d && h > t + d && h > n + d && h > a + d || h < r - d && h < t - d && h < n - d && h < a - d)
    return !1;
  var c = G0(r, e, t, i, n, s, a, o, h, u);
  return c <= d / 2;
}
function __(r, e, t, i, n, s, a, o, l) {
  if (a === 0)
    return !1;
  var h = a;
  if (l > e + h && l > i + h && l > s + h || l < e - h && l < i - h && l < s - h || o > r + h && o > t + h && o > n + h || o < r - h && o < t - h && o < n - h)
    return !1;
  var u = Y0(r, e, t, i, n, s, o, l);
  return u <= h / 2;
}
var ec = Math.PI * 2;
function Os(r) {
  return r %= ec, r < 0 && (r += ec), r;
}
var mn = Math.PI * 2;
function E_(r, e, t, i, n, s, a, o, l) {
  if (a === 0)
    return !1;
  var h = a;
  o -= r, l -= e;
  var u = Math.sqrt(o * o + l * l);
  if (u - h > t || u + h < t)
    return !1;
  if (Math.abs(i - n) % mn < 1e-4)
    return !0;
  if (s) {
    var d = i;
    i = Os(n), n = Os(d);
  } else
    i = Os(i), n = Os(n);
  i > n && (n += mn);
  var c = Math.atan2(l, o);
  return c < 0 && (c += mn), c >= i && c <= n || c + mn >= i && c + mn <= n;
}
function Ni(r, e, t, i, n, s) {
  if (s > e && s > i || s < e && s < i || i === e)
    return 0;
  var a = (s - e) / (i - e), o = i < e ? 1 : -1;
  (a === 1 || a === 0) && (o = i < e ? 0.5 : -0.5);
  var l = a * (t - r) + r;
  return l === n ? 1 / 0 : l > n ? o : 0;
}
var ai = Zr.CMD, Bi = Math.PI * 2, T_ = 1e-4;
function x_(r, e) {
  return Math.abs(r - e) < T_;
}
var Ve = [-1, -1, -1], mt = [-1, -1];
function S_() {
  var r = mt[0];
  mt[0] = mt[1], mt[1] = r;
}
function R_(r, e, t, i, n, s, a, o, l, h) {
  if (h > e && h > i && h > s && h > o || h < e && h < i && h < s && h < o)
    return 0;
  var u = gg(e, i, s, o, h, Ve);
  if (u === 0)
    return 0;
  for (var d = 0, c = -1, f = void 0, p = void 0, m = 0; m < u; m++) {
    var g = Ve[m], v = g === 0 || g === 1 ? 0.5 : 1, b = We(r, t, n, a, g);
    b < l || (c < 0 && (c = vg(e, i, s, o, mt), mt[1] < mt[0] && c > 1 && S_(), f = We(e, i, s, o, mt[0]), c > 1 && (p = We(e, i, s, o, mt[1]))), c === 2 ? g < mt[0] ? d += f < e ? v : -v : g < mt[1] ? d += p < f ? v : -v : d += o < p ? v : -v : g < mt[0] ? d += f < e ? v : -v : d += o < f ? v : -v);
  }
  return d;
}
function M_(r, e, t, i, n, s, a, o) {
  if (o > e && o > i && o > s || o < e && o < i && o < s)
    return 0;
  var l = j0(e, i, s, o, Ve);
  if (l === 0)
    return 0;
  var h = mg(e, i, s);
  if (h >= 0 && h <= 1) {
    for (var u = 0, d = qe(e, i, s, h), c = 0; c < l; c++) {
      var f = Ve[c] === 0 || Ve[c] === 1 ? 0.5 : 1, p = qe(r, t, n, Ve[c]);
      p < a || (Ve[c] < h ? u += d < e ? f : -f : u += s < d ? f : -f);
    }
    return u;
  } else {
    var f = Ve[0] === 0 || Ve[0] === 1 ? 0.5 : 1, p = qe(r, t, n, Ve[0]);
    return p < a ? 0 : s < e ? f : -f;
  }
}
function D_(r, e, t, i, n, s, a, o) {
  if (o -= e, o > t || o < -t)
    return 0;
  var l = Math.sqrt(t * t - o * o);
  Ve[0] = -l, Ve[1] = l;
  var h = Math.abs(i - n);
  if (h < 1e-4)
    return 0;
  if (h >= Bi - 1e-4) {
    i = 0, n = Bi;
    var u = s ? 1 : -1;
    return a >= Ve[0] + r && a <= Ve[1] + r ? u : 0;
  }
  if (i > n) {
    var d = i;
    i = n, n = d;
  }
  i < 0 && (i += Bi, n += Bi);
  for (var c = 0, f = 0; f < 2; f++) {
    var p = Ve[f];
    if (p + r > a) {
      var m = Math.atan2(o, p), u = s ? 1 : -1;
      m < 0 && (m = Bi + m), (m >= i && m <= n || m + Bi >= i && m + Bi <= n) && (m > Math.PI / 2 && m < Math.PI * 1.5 && (u = -u), c += u);
    }
  }
  return c;
}
function Ug(r, e, t, i, n) {
  for (var s = r.data, a = r.len(), o = 0, l = 0, h = 0, u = 0, d = 0, c, f, p = 0; p < a; ) {
    var m = s[p++], g = p === 1;
    switch (m === ai.M && p > 1 && (t || (o += Ni(l, h, u, d, i, n))), g && (l = s[p], h = s[p + 1], u = l, d = h), m) {
      case ai.M:
        u = s[p++], d = s[p++], l = u, h = d;
        break;
      case ai.L:
        if (t) {
          if (wr(l, h, s[p], s[p + 1], e, i, n))
            return !0;
        } else
          o += Ni(l, h, s[p], s[p + 1], i, n) || 0;
        l = s[p++], h = s[p++];
        break;
      case ai.C:
        if (t) {
          if (C_(l, h, s[p++], s[p++], s[p++], s[p++], s[p], s[p + 1], e, i, n))
            return !0;
        } else
          o += R_(l, h, s[p++], s[p++], s[p++], s[p++], s[p], s[p + 1], i, n) || 0;
        l = s[p++], h = s[p++];
        break;
      case ai.Q:
        if (t) {
          if (__(l, h, s[p++], s[p++], s[p], s[p + 1], e, i, n))
            return !0;
        } else
          o += M_(l, h, s[p++], s[p++], s[p], s[p + 1], i, n) || 0;
        l = s[p++], h = s[p++];
        break;
      case ai.A:
        var v = s[p++], b = s[p++], y = s[p++], w = s[p++], _ = s[p++], E = s[p++];
        p += 1;
        var x = !!(1 - s[p++]);
        c = Math.cos(_) * y + v, f = Math.sin(_) * w + b, g ? (u = c, d = f) : o += Ni(l, h, c, f, i, n);
        var T = (i - v) * w / y + v;
        if (t) {
          if (E_(v, b, w, _, _ + E, x, e, T, n))
            return !0;
        } else
          o += D_(v, b, w, _, _ + E, x, T, n);
        l = Math.cos(_ + E) * y + v, h = Math.sin(_ + E) * w + b;
        break;
      case ai.R:
        u = l = s[p++], d = h = s[p++];
        var C = s[p++], S = s[p++];
        if (c = u + C, f = d + S, t) {
          if (wr(u, d, c, d, e, i, n) || wr(c, d, c, f, e, i, n) || wr(c, f, u, f, e, i, n) || wr(u, f, u, d, e, i, n))
            return !0;
        } else
          o += Ni(c, d, c, f, i, n), o += Ni(u, f, u, d, i, n);
        break;
      case ai.Z:
        if (t) {
          if (wr(l, h, u, d, e, i, n))
            return !0;
        } else
          o += Ni(l, h, u, d, i, n);
        l = u, h = d;
        break;
    }
  }
  return !t && !x_(h, d) && (o += Ni(l, h, u, d, i, n) || 0), o !== 0;
}
function L_(r, e, t) {
  return Ug(r, 0, !1, e, t);
}
function k_(r, e, t, i) {
  return Ug(r, e, !0, t, i);
}
var jg = ge({
  fill: "#000",
  stroke: null,
  strokePercent: 1,
  fillOpacity: 1,
  strokeOpacity: 1,
  lineDashOffset: 0,
  lineWidth: 1,
  lineCap: "butt",
  miterLimit: 10,
  strokeNoScale: !1,
  strokeFirst: !1
}, lr), A_ = {
  style: ge({
    fill: !0,
    stroke: !0,
    strokePercent: !0,
    fillOpacity: !0,
    strokeOpacity: !0,
    lineDashOffset: !0,
    lineWidth: !0,
    miterLimit: !0
  }, no.style)
}, Qo = ss.concat([
  "invisible",
  "culling",
  "z",
  "z2",
  "zlevel",
  "parent"
]), fe = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.update = function() {
    var t = this;
    r.prototype.update.call(this);
    var i = this.style;
    if (i.decal) {
      var n = this._decalEl = this._decalEl || new e();
      n.buildPath === e.prototype.buildPath && (n.buildPath = function(l) {
        t.buildPath(l, t.shape);
      }), n.silent = !0;
      var s = n.style;
      for (var a in i)
        s[a] !== i[a] && (s[a] = i[a]);
      s.fill = i.fill ? i.decal : null, s.decal = null, s.shadowColor = null, i.strokeFirst && (s.stroke = null);
      for (var o = 0; o < Qo.length; ++o)
        n[Qo[o]] = this[Qo[o]];
      n.__dirty |= nt;
    } else this._decalEl && (this._decalEl = null);
  }, e.prototype.getDecalElement = function() {
    return this._decalEl;
  }, e.prototype._init = function(t) {
    var i = me(t);
    this.shape = this.getDefaultShape();
    var n = this.getDefaultStyle();
    n && this.useStyle(n);
    for (var s = 0; s < i.length; s++) {
      var a = i[s], o = t[a];
      a === "style" ? this.style ? P(this.style, o) : this.useStyle(o) : a === "shape" ? P(this.shape, o) : r.prototype.attrKV.call(this, a, o);
    }
    this.style || this.useStyle({});
  }, e.prototype.getDefaultStyle = function() {
    return null;
  }, e.prototype.getDefaultShape = function() {
    return {};
  }, e.prototype.canBeInsideText = function() {
    return this.hasFill();
  }, e.prototype.getInsideTextFill = function() {
    var t = this.style.fill;
    if (t !== "none") {
      if (V(t)) {
        var i = _a(t, 0);
        return i > 0.5 ? Th : i > 0.2 ? pC : xh;
      } else if (t)
        return xh;
    }
    return Th;
  }, e.prototype.getInsideTextStroke = function(t) {
    var i = this.style.fill;
    if (V(i)) {
      var n = this.__zr, s = !!(n && n.isDarkMode()), a = _a(t, 0) < Eh;
      if (s === a)
        return i;
    }
  }, e.prototype.buildPath = function(t, i, n) {
  }, e.prototype.pathUpdated = function() {
    this.__dirty &= ~Lr;
  }, e.prototype.getUpdatedPathProxy = function(t) {
    return !this.path && this.createPathProxy(), this.path.beginPath(), this.buildPath(this.path, this.shape, t), this.path;
  }, e.prototype.createPathProxy = function() {
    this.path = new Zr(!1);
  }, e.prototype.hasStroke = function() {
    var t = this.style, i = t.stroke;
    return !(i == null || i === "none" || !(t.lineWidth > 0));
  }, e.prototype.hasFill = function() {
    var t = this.style, i = t.fill;
    return i != null && i !== "none";
  }, e.prototype.getBoundingRect = function() {
    var t = this._rect, i = this.style, n = !t;
    if (n) {
      var s = !1;
      this.path || (s = !0, this.createPathProxy());
      var a = this.path;
      (s || this.__dirty & Lr) && (a.beginPath(), this.buildPath(a, this.shape, !1), this.pathUpdated()), t = a.getBoundingRect();
    }
    if (this._rect = t, this.hasStroke() && this.path && this.path.len() > 0) {
      var o = this._rectStroke || (this._rectStroke = t.clone());
      if (this.__dirty || n) {
        o.copy(t);
        var l = i.strokeNoScale ? this.getLineScale() : 1, h = i.lineWidth;
        if (!this.hasFill()) {
          var u = this.strokeContainThreshold;
          h = Math.max(h, u ?? 4);
        }
        l > 1e-10 && (o.width += h / l, o.height += h / l, o.x -= h / l / 2, o.y -= h / l / 2);
      }
      return o;
    }
    return t;
  }, e.prototype.contain = function(t, i) {
    var n = this.transformCoordToLocal(t, i), s = this.getBoundingRect(), a = this.style;
    if (t = n[0], i = n[1], s.contain(t, i)) {
      var o = this.path;
      if (this.hasStroke()) {
        var l = a.lineWidth, h = a.strokeNoScale ? this.getLineScale() : 1;
        if (h > 1e-10 && (this.hasFill() || (l = Math.max(l, this.strokeContainThreshold)), k_(o, l / h, t, i)))
          return !0;
      }
      if (this.hasFill())
        return L_(o, t, i);
    }
    return !1;
  }, e.prototype.dirtyShape = function() {
    this.__dirty |= Lr, this._rect && (this._rect = null), this._decalEl && this._decalEl.dirtyShape(), this.markRedraw();
  }, e.prototype.dirty = function() {
    this.dirtyStyle(), this.dirtyShape();
  }, e.prototype.animateShape = function(t) {
    return this.animate("shape", t);
  }, e.prototype.updateDuringAnimation = function(t) {
    t === "style" ? this.dirtyStyle() : t === "shape" ? this.dirtyShape() : this.markRedraw();
  }, e.prototype.attrKV = function(t, i) {
    t === "shape" ? this.setShape(i) : r.prototype.attrKV.call(this, t, i);
  }, e.prototype.setShape = function(t, i) {
    var n = this.shape;
    return n || (n = this.shape = {}), typeof t == "string" ? n[t] = i : P(n, t), this.dirtyShape(), this;
  }, e.prototype.shapeChanged = function() {
    return !!(this.__dirty & Lr);
  }, e.prototype.createStyle = function(t) {
    return Za(jg, t);
  }, e.prototype._innerSaveToNormal = function(t) {
    r.prototype._innerSaveToNormal.call(this, t);
    var i = this._normalState;
    t.shape && !i.shape && (i.shape = P({}, this.shape));
  }, e.prototype._applyStateObj = function(t, i, n, s, a, o) {
    r.prototype._applyStateObj.call(this, t, i, n, s, a, o);
    var l = !(i && s), h;
    if (i && i.shape ? a ? s ? h = i.shape : (h = P({}, n.shape), P(h, i.shape)) : (h = P({}, s ? this.shape : n.shape), P(h, i.shape)) : l && (h = n.shape), h)
      if (a) {
        this.shape = P({}, this.shape);
        for (var u = {}, d = me(h), c = 0; c < d.length; c++) {
          var f = d[c];
          typeof h[f] == "object" ? this.shape[f] = h[f] : u[f] = h[f];
        }
        this._transitionState(t, {
          shape: u
        }, o);
      } else
        this.shape = h, this.dirtyShape();
  }, e.prototype._mergeStates = function(t) {
    for (var i = r.prototype._mergeStates.call(this, t), n, s = 0; s < t.length; s++) {
      var a = t[s];
      a.shape && (n = n || {}, this._mergeStyle(n, a.shape));
    }
    return n && (i.shape = n), i;
  }, e.prototype.getAnimationStyleProps = function() {
    return A_;
  }, e.prototype.isZeroArea = function() {
    return !1;
  }, e.extend = function(t) {
    var i = function(s) {
      oe(a, s);
      function a(o) {
        var l = s.call(this, o) || this;
        return t.init && t.init.call(l, o), l;
      }
      return a.prototype.getDefaultStyle = function() {
        return $(t.style);
      }, a.prototype.getDefaultShape = function() {
        return $(t.shape);
      }, a;
    }(e);
    for (var n in t)
      typeof t[n] == "function" && (i.prototype[n] = t[n]);
    return i;
  }, e.initDefaultProps = function() {
    var t = e.prototype;
    t.type = "path", t.strokeContainThreshold = 5, t.segmentIgnoreThreshold = 0, t.subPixelOptimize = !1, t.autoBatch = !1, t.__dirty = nt | Pn | Lr;
  }(), e;
}(nn), P_ = ge({
  strokeFirst: !0,
  font: dr,
  x: 0,
  y: 0,
  textAlign: "left",
  textBaseline: "top",
  miterLimit: 2
}, jg), Ra = function(r) {
  oe(e, r);
  function e() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return e.prototype.hasStroke = function() {
    var t = this.style, i = t.stroke;
    return i != null && i !== "none" && t.lineWidth > 0;
  }, e.prototype.hasFill = function() {
    var t = this.style, i = t.fill;
    return i != null && i !== "none";
  }, e.prototype.createStyle = function(t) {
    return Za(P_, t);
  }, e.prototype.setBoundingRect = function(t) {
    this._rect = t;
  }, e.prototype.getBoundingRect = function() {
    var t = this.style;
    if (!this._rect) {
      var i = t.text;
      i != null ? i += "" : i = "";
      var n = xg(i, t.font, t.textAlign, t.textBaseline);
      if (n.x += t.x || 0, n.y += t.y || 0, this.hasStroke()) {
        var s = t.lineWidth;
        n.x -= s / 2, n.y -= s / 2, n.width += s, n.height += s;
      }
      this._rect = n;
    }
    return this._rect;
  }, e.initDefaultProps = function() {
    var t = e.prototype;
    t.dirtyRectTolerance = 10;
  }(), e;
}(nn);
Ra.prototype.type = "tspan";
var O_ = ge({
  x: 0,
  y: 0
}, lr), I_ = {
  style: ge({
    x: !0,
    y: !0,
    width: !0,
    height: !0,
    sx: !0,
    sy: !0,
    sWidth: !0,
    sHeight: !0
  }, no.style)
};
function z_(r) {
  return !!(r && typeof r != "string" && r.width && r.height);
}
var cr = function(r) {
  oe(e, r);
  function e() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return e.prototype.createStyle = function(t) {
    return Za(O_, t);
  }, e.prototype._getSize = function(t) {
    var i = this.style, n = i[t];
    if (n != null)
      return n;
    var s = z_(i.image) ? i.image : this.__image;
    if (!s)
      return 0;
    var a = t === "width" ? "height" : "width", o = i[a];
    return o == null ? s[t] : s[t] / s[a] * o;
  }, e.prototype.getWidth = function() {
    return this._getSize("width");
  }, e.prototype.getHeight = function() {
    return this._getSize("height");
  }, e.prototype.getAnimationStyleProps = function() {
    return I_;
  }, e.prototype.getBoundingRect = function() {
    var t = this.style;
    return this._rect || (this._rect = new re(t.x || 0, t.y || 0, this.getWidth(), this.getHeight())), this._rect;
  }, e;
}(nn);
cr.prototype.type = "image";
function F_(r, e) {
  var t = e.x, i = e.y, n = e.width, s = e.height, a = e.r, o, l, h, u;
  n < 0 && (t = t + n, n = -n), s < 0 && (i = i + s, s = -s), typeof a == "number" ? o = l = h = u = a : a instanceof Array ? a.length === 1 ? o = l = h = u = a[0] : a.length === 2 ? (o = h = a[0], l = u = a[1]) : a.length === 3 ? (o = a[0], l = u = a[1], h = a[2]) : (o = a[0], l = a[1], h = a[2], u = a[3]) : o = l = h = u = 0;
  var d;
  o + l > n && (d = o + l, o *= n / d, l *= n / d), h + u > n && (d = h + u, h *= n / d, u *= n / d), l + h > s && (d = l + h, l *= s / d, h *= s / d), o + u > s && (d = o + u, o *= s / d, u *= s / d), r.moveTo(t + o, i), r.lineTo(t + n - l, i), l !== 0 && r.arc(t + n - l, i + l, l, -Math.PI / 2, 0), r.lineTo(t + n, i + s - h), h !== 0 && r.arc(t + n - h, i + s - h, h, 0, Math.PI / 2), r.lineTo(t + u, i + s), u !== 0 && r.arc(t + u, i + s - u, u, Math.PI / 2, Math.PI), r.lineTo(t, i + o), o !== 0 && r.arc(t + o, i + o, o, Math.PI, Math.PI * 1.5);
}
var Ir = Math.round;
function Yg(r, e, t) {
  if (e) {
    var i = e.x1, n = e.x2, s = e.y1, a = e.y2;
    r.x1 = i, r.x2 = n, r.y1 = s, r.y2 = a;
    var o = t && t.lineWidth;
    return o && (Ir(i * 2) === Ir(n * 2) && (r.x1 = r.x2 = er(i, o, !0)), Ir(s * 2) === Ir(a * 2) && (r.y1 = r.y2 = er(s, o, !0))), r;
  }
}
function Xg(r, e, t) {
  if (e) {
    var i = e.x, n = e.y, s = e.width, a = e.height;
    r.x = i, r.y = n, r.width = s, r.height = a;
    var o = t && t.lineWidth;
    return o && (r.x = er(i, o, !0), r.y = er(n, o, !0), r.width = Math.max(er(i + s, o, !1) - r.x, s === 0 ? 0 : 1), r.height = Math.max(er(n + a, o, !1) - r.y, a === 0 ? 0 : 1)), r;
  }
}
function er(r, e, t) {
  if (!e)
    return r;
  var i = Ir(r * 2);
  return (i + Ir(e)) % 2 === 0 ? i / 2 : (i + (t ? 1 : -1)) / 2;
}
var H_ = /* @__PURE__ */ function() {
  function r() {
    this.x = 0, this.y = 0, this.width = 0, this.height = 0;
  }
  return r;
}(), N_ = {}, ot = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.getDefaultShape = function() {
    return new H_();
  }, e.prototype.buildPath = function(t, i) {
    var n, s, a, o;
    if (this.subPixelOptimize) {
      var l = Xg(N_, i, this.style);
      n = l.x, s = l.y, a = l.width, o = l.height, l.r = i.r, i = l;
    } else
      n = i.x, s = i.y, a = i.width, o = i.height;
    i.r ? F_(t, i) : t.rect(n, s, a, o);
  }, e.prototype.isZeroArea = function() {
    return !this.shape.width || !this.shape.height;
  }, e;
}(fe);
ot.prototype.type = "rect";
var tc = {
  fill: "#000"
}, ic = 2, B_ = {
  style: ge({
    fill: !0,
    stroke: !0,
    fillOpacity: !0,
    strokeOpacity: !0,
    lineWidth: !0,
    fontSize: !0,
    lineHeight: !0,
    width: !0,
    height: !0,
    textShadowColor: !0,
    textShadowBlur: !0,
    textShadowOffsetX: !0,
    textShadowOffsetY: !0,
    backgroundColor: !0,
    padding: !0,
    borderColor: !0,
    borderWidth: !0,
    borderRadius: !0
  }, no.style)
}, ht = function(r) {
  oe(e, r);
  function e(t) {
    var i = r.call(this) || this;
    return i.type = "text", i._children = [], i._defaultStyle = tc, i.attr(t), i;
  }
  return e.prototype.childrenRef = function() {
    return this._children;
  }, e.prototype.update = function() {
    r.prototype.update.call(this), this.styleChanged() && this._updateSubTexts();
    for (var t = 0; t < this._children.length; t++) {
      var i = this._children[t];
      i.zlevel = this.zlevel, i.z = this.z, i.z2 = this.z2, i.culling = this.culling, i.cursor = this.cursor, i.invisible = this.invisible;
    }
  }, e.prototype.updateTransform = function() {
    var t = this.innerTransformable;
    t ? (t.updateTransform(), t.transform && (this.transform = t.transform)) : r.prototype.updateTransform.call(this);
  }, e.prototype.getLocalTransform = function(t) {
    var i = this.innerTransformable;
    return i ? i.getLocalTransform(t) : r.prototype.getLocalTransform.call(this, t);
  }, e.prototype.getComputedTransform = function() {
    return this.__hostTarget && (this.__hostTarget.getComputedTransform(), this.__hostTarget.updateInnerText(!0)), r.prototype.getComputedTransform.call(this);
  }, e.prototype._updateSubTexts = function() {
    this._childCursor = 0, j_(this.style), this.style.rich ? this._updateRichTexts() : this._updatePlainTexts(), this._children.length = this._childCursor, this.styleUpdated();
  }, e.prototype.addSelfToZr = function(t) {
    r.prototype.addSelfToZr.call(this, t);
    for (var i = 0; i < this._children.length; i++)
      this._children[i].__zr = t;
  }, e.prototype.removeSelfFromZr = function(t) {
    r.prototype.removeSelfFromZr.call(this, t);
    for (var i = 0; i < this._children.length; i++)
      this._children[i].__zr = null;
  }, e.prototype.getBoundingRect = function() {
    if (this.styleChanged() && this._updateSubTexts(), !this._rect) {
      for (var t = new re(0, 0, 0, 0), i = this._children, n = [], s = null, a = 0; a < i.length; a++) {
        var o = i[a], l = o.getBoundingRect(), h = o.getLocalTransform(n);
        h ? (t.copy(l), t.applyTransform(h), s = s || t.clone(), s.union(t)) : (s = s || l.clone(), s.union(l));
      }
      this._rect = s || t;
    }
    return this._rect;
  }, e.prototype.setDefaultTextStyle = function(t) {
    this._defaultStyle = t || tc;
  }, e.prototype.setTextContent = function(t) {
    if (process.env.NODE_ENV !== "production")
      throw new Error("Can't attach text on another text");
  }, e.prototype._mergeStyle = function(t, i) {
    if (!i)
      return t;
    var n = i.rich, s = t.rich || n && {};
    return P(t, i), n && s ? (this._mergeRich(s, n), t.rich = s) : s && (t.rich = s), t;
  }, e.prototype._mergeRich = function(t, i) {
    for (var n = me(i), s = 0; s < n.length; s++) {
      var a = n[s];
      t[a] = t[a] || {}, P(t[a], i[a]);
    }
  }, e.prototype.getAnimationStyleProps = function() {
    return B_;
  }, e.prototype._getOrCreateChild = function(t) {
    var i = this._children[this._childCursor];
    return (!i || !(i instanceof t)) && (i = new t()), this._children[this._childCursor++] = i, i.__zr = this.__zr, i.parent = this, i;
  }, e.prototype._updatePlainTexts = function() {
    var t = this.style, i = t.font || dr, n = t.padding, s = hc(t), a = l_(s, t), o = el(t), l = !!t.backgroundColor, h = a.outerHeight, u = a.outerWidth, d = a.contentWidth, c = a.lines, f = a.lineHeight, p = this._defaultStyle;
    this.isTruncated = !!a.isTruncated;
    var m = t.x || 0, g = t.y || 0, v = t.align || p.align || "left", b = t.verticalAlign || p.verticalAlign || "top", y = m, w = kr(g, a.contentHeight, b);
    if (o || n) {
      var _ = In(m, u, v), E = kr(g, h, b);
      o && this._renderBackground(t, t, _, E, u, h);
    }
    w += f / 2, n && (y = lc(m, v, n), b === "top" ? w += n[0] : b === "bottom" && (w -= n[2]));
    for (var x = 0, T = !1, C = oc("fill" in t ? t.fill : (T = !0, p.fill)), S = ac("stroke" in t ? t.stroke : !l && (!p.autoStroke || T) ? (x = ic, p.stroke) : null), R = t.textShadowBlur > 0, D = t.width != null && (t.overflow === "truncate" || t.overflow === "break" || t.overflow === "breakAll"), k = a.calculatedLineHeight, L = 0; L < c.length; L++) {
      var O = this._getOrCreateChild(Ra), I = O.createStyle();
      O.useStyle(I), I.text = c[L], I.x = y, I.y = w, I.textAlign = v, I.textBaseline = "middle", I.opacity = t.opacity, I.strokeFirst = !0, R && (I.shadowBlur = t.textShadowBlur || 0, I.shadowColor = t.textShadowColor || "transparent", I.shadowOffsetX = t.textShadowOffsetX || 0, I.shadowOffsetY = t.textShadowOffsetY || 0), I.stroke = S, I.fill = C, S && (I.lineWidth = t.lineWidth || x, I.lineDash = t.lineDash, I.lineDashOffset = t.lineDashOffset || 0), I.font = i, nc(I, t), w += f, D && O.setBoundingRect(new re(In(I.x, d, I.textAlign), kr(I.y, k, I.textBaseline), d, k));
    }
  }, e.prototype._updateRichTexts = function() {
    var t = this.style, i = hc(t), n = d_(i, t), s = n.width, a = n.outerWidth, o = n.outerHeight, l = t.padding, h = t.x || 0, u = t.y || 0, d = this._defaultStyle, c = t.align || d.align, f = t.verticalAlign || d.verticalAlign;
    this.isTruncated = !!n.isTruncated;
    var p = In(h, a, c), m = kr(u, o, f), g = p, v = m;
    l && (g += l[3], v += l[0]);
    var b = g + s;
    el(t) && this._renderBackground(t, t, p, m, a, o);
    for (var y = !!t.backgroundColor, w = 0; w < n.lines.length; w++) {
      for (var _ = n.lines[w], E = _.tokens, x = E.length, T = _.lineHeight, C = _.width, S = 0, R = g, D = b, k = x - 1, L = void 0; S < x && (L = E[S], !L.align || L.align === "left"); )
        this._placeToken(L, t, T, v, R, "left", y), C -= L.width, R += L.width, S++;
      for (; k >= 0 && (L = E[k], L.align === "right"); )
        this._placeToken(L, t, T, v, D, "right", y), C -= L.width, D -= L.width, k--;
      for (R += (s - (R - g) - (b - D) - C) / 2; S <= k; )
        L = E[S], this._placeToken(L, t, T, v, R + L.width / 2, "center", y), R += L.width, S++;
      v += T;
    }
  }, e.prototype._placeToken = function(t, i, n, s, a, o, l) {
    var h = i.rich[t.styleName] || {};
    h.text = t.text;
    var u = t.verticalAlign, d = s + n / 2;
    u === "top" ? d = s + t.height / 2 : u === "bottom" && (d = s + n - t.height / 2);
    var c = !t.isLineHolder && el(h);
    c && this._renderBackground(h, i, o === "right" ? a - t.width : o === "center" ? a - t.width / 2 : a, d - t.height / 2, t.width, t.height);
    var f = !!h.backgroundColor, p = t.textPadding;
    p && (a = lc(a, o, p), d -= t.height / 2 - p[0] - t.innerHeight / 2);
    var m = this._getOrCreateChild(Ra), g = m.createStyle();
    m.useStyle(g);
    var v = this._defaultStyle, b = !1, y = 0, w = oc("fill" in h ? h.fill : "fill" in i ? i.fill : (b = !0, v.fill)), _ = ac("stroke" in h ? h.stroke : "stroke" in i ? i.stroke : !f && !l && (!v.autoStroke || b) ? (y = ic, v.stroke) : null), E = h.textShadowBlur > 0 || i.textShadowBlur > 0;
    g.text = t.text, g.x = a, g.y = d, E && (g.shadowBlur = h.textShadowBlur || i.textShadowBlur || 0, g.shadowColor = h.textShadowColor || i.textShadowColor || "transparent", g.shadowOffsetX = h.textShadowOffsetX || i.textShadowOffsetX || 0, g.shadowOffsetY = h.textShadowOffsetY || i.textShadowOffsetY || 0), g.textAlign = o, g.textBaseline = "middle", g.font = t.font || dr, g.opacity = ta(h.opacity, i.opacity, 1), nc(g, h), _ && (g.lineWidth = ta(h.lineWidth, i.lineWidth, y), g.lineDash = j(h.lineDash, i.lineDash), g.lineDashOffset = i.lineDashOffset || 0, g.stroke = _), w && (g.fill = w);
    var x = t.contentWidth, T = t.contentHeight;
    m.setBoundingRect(new re(In(g.x, x, g.textAlign), kr(g.y, T, g.textBaseline), x, T));
  }, e.prototype._renderBackground = function(t, i, n, s, a, o) {
    var l = t.backgroundColor, h = t.borderWidth, u = t.borderColor, d = l && l.image, c = l && !d, f = t.borderRadius, p = this, m, g;
    if (c || t.lineHeight || h && u) {
      m = this._getOrCreateChild(ot), m.useStyle(m.createStyle()), m.style.fill = null;
      var v = m.shape;
      v.x = n, v.y = s, v.width = a, v.height = o, v.r = f, m.dirtyShape();
    }
    if (c) {
      var b = m.style;
      b.fill = l || null, b.fillOpacity = j(t.fillOpacity, 1);
    } else if (d) {
      g = this._getOrCreateChild(cr), g.onload = function() {
        p.dirtyStyle();
      };
      var y = g.style;
      y.image = l.image, y.x = n, y.y = s, y.width = a, y.height = o;
    }
    if (h && u) {
      var b = m.style;
      b.lineWidth = h, b.stroke = u, b.strokeOpacity = j(t.strokeOpacity, 1), b.lineDash = t.borderDash, b.lineDashOffset = t.borderDashOffset || 0, m.strokeContainThreshold = 0, m.hasFill() && m.hasStroke() && (b.strokeFirst = !0, b.lineWidth *= 2);
    }
    var w = (m || g).style;
    w.shadowBlur = t.shadowBlur || 0, w.shadowColor = t.shadowColor || "transparent", w.shadowOffsetX = t.shadowOffsetX || 0, w.shadowOffsetY = t.shadowOffsetY || 0, w.opacity = ta(t.opacity, i.opacity, 1);
  }, e.makeFont = function(t) {
    var i = "";
    return U_(t) && (i = [
      t.fontStyle,
      t.fontWeight,
      G_(t.fontSize),
      t.fontFamily || "sans-serif"
    ].join(" ")), i && zt(i) || t.textFont || t.font;
  }, e;
}(nn), V_ = { left: !0, right: 1, center: 1 }, W_ = { top: 1, bottom: 1, middle: 1 }, rc = ["fontStyle", "fontWeight", "fontSize", "fontFamily"];
function G_(r) {
  return typeof r == "string" && (r.indexOf("px") !== -1 || r.indexOf("rem") !== -1 || r.indexOf("em") !== -1) ? r : isNaN(+r) ? au + "px" : r + "px";
}
function nc(r, e) {
  for (var t = 0; t < rc.length; t++) {
    var i = rc[t], n = e[i];
    n != null && (r[i] = n);
  }
}
function U_(r) {
  return r.fontSize != null || r.fontFamily || r.fontWeight;
}
function j_(r) {
  return sc(r), M(r.rich, sc), r;
}
function sc(r) {
  if (r) {
    r.font = ht.makeFont(r);
    var e = r.align;
    e === "middle" && (e = "center"), r.align = e == null || V_[e] ? e : "left";
    var t = r.verticalAlign;
    t === "center" && (t = "middle"), r.verticalAlign = t == null || W_[t] ? t : "top";
    var i = r.padding;
    i && (r.padding = uu(r.padding));
  }
}
function ac(r, e) {
  return r == null || e <= 0 || r === "transparent" || r === "none" ? null : r.image || r.colorStops ? "#000" : r;
}
function oc(r) {
  return r == null || r === "none" ? null : r.image || r.colorStops ? "#000" : r;
}
function lc(r, e, t) {
  return e === "right" ? r - t[1] : e === "center" ? r + t[3] / 2 - t[1] / 2 : r + t[3];
}
function hc(r) {
  var e = r.text;
  return e != null && (e += ""), e;
}
function el(r) {
  return !!(r.backgroundColor || r.lineHeight || r.borderWidth && r.borderColor);
}
var ce = Te(), Y_ = function(r, e, t, i) {
  if (i) {
    var n = ce(i);
    n.dataIndex = t, n.dataType = e, n.seriesIndex = r, n.ssrType = "chart", i.type === "group" && i.traverse(function(s) {
      var a = ce(s);
      a.seriesIndex = r, a.dataIndex = t, a.dataType = e, a.ssrType = "chart";
    });
  }
}, uc = 1, dc = {}, $g = Te(), Cu = Te(), qg = 0, _u = 1, Eu = 2, Ti = ["emphasis", "blur", "select"], cc = ["normal", "emphasis", "blur", "select"], ys = 10, X_ = 9, hr = "highlight", oa = "downplay", Yn = "select", la = "unselect", Xn = "toggleSelect";
function Cr(r) {
  return r != null && r !== "none";
}
function so(r, e, t) {
  r.onHoverStateChange && (r.hoverState || 0) !== t && r.onHoverStateChange(e), r.hoverState = t;
}
function Kg(r) {
  so(r, "emphasis", Eu);
}
function Zg(r) {
  r.hoverState === Eu && so(r, "normal", qg);
}
function Tu(r) {
  so(r, "blur", _u);
}
function Jg(r) {
  r.hoverState === _u && so(r, "normal", qg);
}
function $_(r) {
  r.selected = !0;
}
function q_(r) {
  r.selected = !1;
}
function fc(r, e, t) {
  e(r, t);
}
function ri(r, e, t) {
  fc(r, e, t), r.isGroup && r.traverse(function(i) {
    fc(i, e, t);
  });
}
function K_(r, e, t, i) {
  for (var n = r.style, s = {}, a = 0; a < e.length; a++) {
    var o = e[a], l = n[o];
    s[o] = l ?? (i && i[o]);
  }
  for (var a = 0; a < r.animators.length; a++) {
    var h = r.animators[a];
    h.__fromStateTransition && h.__fromStateTransition.indexOf(t) < 0 && h.targetName === "style" && h.saveTo(s, e);
  }
  return s;
}
function Z_(r, e, t, i) {
  var n = t && ue(t, "select") >= 0, s = !1;
  if (r instanceof fe) {
    var a = $g(r), o = n && a.selectFill || a.normalFill, l = n && a.selectStroke || a.normalStroke;
    if (Cr(o) || Cr(l)) {
      i = i || {};
      var h = i.style || {};
      h.fill === "inherit" ? (s = !0, i = P({}, i), h = P({}, h), h.fill = o) : !Cr(h.fill) && Cr(o) ? (s = !0, i = P({}, i), h = P({}, h), h.fill = Rd(o)) : !Cr(h.stroke) && Cr(l) && (s || (i = P({}, i), h = P({}, h)), h.stroke = Rd(l)), i.style = h;
    }
  }
  if (i && i.z2 == null) {
    s || (i = P({}, i));
    var u = r.z2EmphasisLift;
    i.z2 = r.z2 + (u ?? ys);
  }
  return i;
}
function J_(r, e, t) {
  if (t && t.z2 == null) {
    t = P({}, t);
    var i = r.z2SelectLift;
    t.z2 = r.z2 + (i ?? X_);
  }
  return t;
}
function Q_(r, e, t) {
  var i = ue(r.currentStates, e) >= 0, n = r.style.opacity, s = i ? null : K_(r, ["opacity"], e, {
    opacity: 1
  });
  t = t || {};
  var a = t.style || {};
  return a.opacity == null && (t = P({}, t), a = P({
    // Already being applied 'emphasis'. DON'T mul opacity multiple times.
    opacity: i ? n : s.opacity * 0.1
  }, a), t.style = a), t;
}
function tl(r, e) {
  var t = this.states[r];
  if (this.style) {
    if (r === "emphasis")
      return Z_(this, r, e, t);
    if (r === "blur")
      return Q_(this, r, t);
    if (r === "select")
      return J_(this, r, t);
  }
  return t;
}
function Dh(r) {
  r.stateProxy = tl;
  var e = r.getTextContent(), t = r.getTextGuideLine();
  e && (e.stateProxy = tl), t && (t.stateProxy = tl);
}
function pc(r, e) {
  !iv(r, e) && !r.__highByOuter && ri(r, Kg);
}
function gc(r, e) {
  !iv(r, e) && !r.__highByOuter && ri(r, Zg);
}
function Lh(r, e) {
  r.__highByOuter |= 1 << (e || 0), ri(r, Kg);
}
function kh(r, e) {
  !(r.__highByOuter &= ~(1 << (e || 0))) && ri(r, Zg);
}
function eE(r) {
  ri(r, Tu);
}
function Qg(r) {
  ri(r, Jg);
}
function ev(r) {
  ri(r, $_);
}
function tv(r) {
  ri(r, q_);
}
function iv(r, e) {
  return r.__highDownSilentOnTouch && e.zrByTouch;
}
function rv(r) {
  var e = r.getModel(), t = [], i = [];
  e.eachComponent(function(n, s) {
    var a = Cu(s), o = n === "series", l = o ? r.getViewOfSeriesModel(s) : r.getViewOfComponentModel(s);
    !o && i.push(l), a.isBlured && (l.group.traverse(function(h) {
      Jg(h);
    }), o && t.push(s)), a.isBlured = !1;
  }), M(i, function(n) {
    n && n.toggleBlurSeries && n.toggleBlurSeries(t, !1, e);
  });
}
function Ah(r, e, t, i) {
  var n = i.getModel();
  t = t || "coordinateSystem";
  function s(h, u) {
    for (var d = 0; d < u.length; d++) {
      var c = h.getItemGraphicEl(u[d]);
      c && Qg(c);
    }
  }
  if (r != null && !(!e || e === "none")) {
    var a = n.getSeriesByIndex(r), o = a.coordinateSystem;
    o && o.master && (o = o.master);
    var l = [];
    n.eachSeries(function(h) {
      var u = a === h, d = h.coordinateSystem;
      d && d.master && (d = d.master);
      var c = d && o ? d === o : u;
      if (!// Not blur other series if blurScope series
      (t === "series" && !u || t === "coordinateSystem" && !c || e === "series" && u)) {
        var f = i.getViewOfSeriesModel(h);
        if (f.group.traverse(function(g) {
          g.__highByOuter && u && e === "self" || Tu(g);
        }), Je(e))
          s(h.getData(), e);
        else if (B(e))
          for (var p = me(e), m = 0; m < p.length; m++)
            s(h.getData(p[m]), e[p[m]]);
        l.push(h), Cu(h).isBlured = !0;
      }
    }), n.eachComponent(function(h, u) {
      if (h !== "series") {
        var d = i.getViewOfComponentModel(u);
        d && d.toggleBlurSeries && d.toggleBlurSeries(l, !0, n);
      }
    });
  }
}
function Ph(r, e, t) {
  if (!(r == null || e == null)) {
    var i = t.getModel().getComponent(r, e);
    if (i) {
      Cu(i).isBlured = !0;
      var n = t.getViewOfComponentModel(i);
      !n || !n.focusBlurEnabled || n.group.traverse(function(s) {
        Tu(s);
      });
    }
  }
}
function tE(r, e, t) {
  var i = r.seriesIndex, n = r.getData(e.dataType);
  if (!n) {
    process.env.NODE_ENV !== "production" && Ne("Unknown dataType " + e.dataType);
    return;
  }
  var s = ms(n, e);
  s = (F(s) ? s[0] : s) || 0;
  var a = n.getItemGraphicEl(s);
  if (!a)
    for (var o = n.count(), l = 0; !a && l < o; )
      a = n.getItemGraphicEl(l++);
  if (a) {
    var h = ce(a);
    Ah(i, h.focus, h.blurScope, t);
  } else {
    var u = r.get(["emphasis", "focus"]), d = r.get(["emphasis", "blurScope"]);
    u != null && Ah(i, u, d, t);
  }
}
function xu(r, e, t, i) {
  var n = {
    focusSelf: !1,
    dispatchers: null
  };
  if (r == null || r === "series" || e == null || t == null)
    return n;
  var s = i.getModel().getComponent(r, e);
  if (!s)
    return n;
  var a = i.getViewOfComponentModel(s);
  if (!a || !a.findHighDownDispatchers)
    return n;
  for (var o = a.findHighDownDispatchers(t), l, h = 0; h < o.length; h++)
    if (process.env.NODE_ENV !== "production" && !xi(o[h]) && Ne("param should be highDownDispatcher"), ce(o[h]).focus === "self") {
      l = !0;
      break;
    }
  return {
    focusSelf: l,
    dispatchers: o
  };
}
function iE(r, e, t) {
  process.env.NODE_ENV !== "production" && !xi(r) && Ne("param should be highDownDispatcher");
  var i = ce(r), n = xu(i.componentMainType, i.componentIndex, i.componentHighDownName, t), s = n.dispatchers, a = n.focusSelf;
  s ? (a && Ph(i.componentMainType, i.componentIndex, t), M(s, function(o) {
    return pc(o, e);
  })) : (Ah(i.seriesIndex, i.focus, i.blurScope, t), i.focus === "self" && Ph(i.componentMainType, i.componentIndex, t), pc(r, e));
}
function rE(r, e, t) {
  process.env.NODE_ENV !== "production" && !xi(r) && Ne("param should be highDownDispatcher"), rv(t);
  var i = ce(r), n = xu(i.componentMainType, i.componentIndex, i.componentHighDownName, t).dispatchers;
  n ? M(n, function(s) {
    return gc(s, e);
  }) : gc(r, e);
}
function nE(r, e, t) {
  if (Ih(e)) {
    var i = e.dataType, n = r.getData(i), s = ms(n, e);
    F(s) || (s = [s]), r[e.type === Xn ? "toggleSelect" : e.type === Yn ? "select" : "unselect"](s, i);
  }
}
function vc(r) {
  var e = r.getAllData();
  M(e, function(t) {
    var i = t.data, n = t.type;
    i.eachItemGraphicEl(function(s, a) {
      r.isSelected(a, n) ? ev(s) : tv(s);
    });
  });
}
function sE(r) {
  var e = [];
  return r.eachSeries(function(t) {
    var i = t.getAllData();
    M(i, function(n) {
      n.data;
      var s = n.type, a = t.getSelectedDataIndices();
      if (a.length > 0) {
        var o = {
          dataIndex: a,
          seriesIndex: t.seriesIndex
        };
        s != null && (o.dataType = s), e.push(o);
      }
    });
  }), e;
}
function aE(r, e, t) {
  zr(r, !0), ri(r, Dh), Oh(r, e, t);
}
function oE(r) {
  zr(r, !1);
}
function lE(r, e, t, i) {
  i ? oE(r) : aE(r, e, t);
}
function Oh(r, e, t) {
  var i = ce(r);
  e != null ? (i.focus = e, i.blurScope = t) : i.focus && (i.focus = null);
}
function zr(r, e) {
  var t = e === !1, i = r;
  r.highDownSilentOnTouch && (i.__highDownSilentOnTouch = r.highDownSilentOnTouch), (!t || i.__highDownDispatcher) && (i.__highByOuter = i.__highByOuter || 0, i.__highDownDispatcher = !t);
}
function xi(r) {
  return !!(r && r.__highDownDispatcher);
}
function hE(r) {
  var e = dc[r];
  return e == null && uc <= 32 && (e = dc[r] = uc++), e;
}
function Ih(r) {
  var e = r.type;
  return e === Yn || e === la || e === Xn;
}
function mc(r) {
  var e = r.type;
  return e === hr || e === oa;
}
function uE(r) {
  var e = $g(r);
  e.normalFill = r.style.fill, e.normalStroke = r.style.stroke;
  var t = r.states.select || {};
  e.selectFill = t.style && t.style.fill || null, e.selectStroke = t.style && t.style.stroke || null;
}
var _r = Zr.CMD, dE = [[], [], []], bc = Math.sqrt, cE = Math.atan2;
function fE(r, e) {
  if (e) {
    var t = r.data, i = r.len(), n, s, a, o, l, h, u = _r.M, d = _r.C, c = _r.L, f = _r.R, p = _r.A, m = _r.Q;
    for (a = 0, o = 0; a < i; ) {
      switch (n = t[a++], o = a, s = 0, n) {
        case u:
          s = 1;
          break;
        case c:
          s = 1;
          break;
        case d:
          s = 3;
          break;
        case m:
          s = 2;
          break;
        case p:
          var g = e[4], v = e[5], b = bc(e[0] * e[0] + e[1] * e[1]), y = bc(e[2] * e[2] + e[3] * e[3]), w = cE(-e[1] / y, e[0] / b);
          t[a] *= b, t[a++] += g, t[a] *= y, t[a++] += v, t[a++] *= b, t[a++] *= y, t[a++] += w, t[a++] += w, a += 2, o = a;
          break;
        case f:
          h[0] = t[a++], h[1] = t[a++], Ht(h, h, e), t[o++] = h[0], t[o++] = h[1], h[0] += t[a++], h[1] += t[a++], Ht(h, h, e), t[o++] = h[0], t[o++] = h[1];
      }
      for (l = 0; l < s; l++) {
        var _ = dE[l];
        _[0] = t[a++], _[1] = t[a++], Ht(_, _, e), t[o++] = _[0], t[o++] = _[1];
      }
    }
    r.increaseVersion();
  }
}
var il = Math.sqrt, Is = Math.sin, zs = Math.cos, bn = Math.PI;
function yc(r) {
  return Math.sqrt(r[0] * r[0] + r[1] * r[1]);
}
function zh(r, e) {
  return (r[0] * e[0] + r[1] * e[1]) / (yc(r) * yc(e));
}
function wc(r, e) {
  return (r[0] * e[1] < r[1] * e[0] ? -1 : 1) * Math.acos(zh(r, e));
}
function Cc(r, e, t, i, n, s, a, o, l, h, u) {
  var d = l * (bn / 180), c = zs(d) * (r - t) / 2 + Is(d) * (e - i) / 2, f = -1 * Is(d) * (r - t) / 2 + zs(d) * (e - i) / 2, p = c * c / (a * a) + f * f / (o * o);
  p > 1 && (a *= il(p), o *= il(p));
  var m = (n === s ? -1 : 1) * il((a * a * (o * o) - a * a * (f * f) - o * o * (c * c)) / (a * a * (f * f) + o * o * (c * c))) || 0, g = m * a * f / o, v = m * -o * c / a, b = (r + t) / 2 + zs(d) * g - Is(d) * v, y = (e + i) / 2 + Is(d) * g + zs(d) * v, w = wc([1, 0], [(c - g) / a, (f - v) / o]), _ = [(c - g) / a, (f - v) / o], E = [(-1 * c - g) / a, (-1 * f - v) / o], x = wc(_, E);
  if (zh(_, E) <= -1 && (x = bn), zh(_, E) >= 1 && (x = 0), x < 0) {
    var T = Math.round(x / bn * 1e6) / 1e6;
    x = bn * 2 + T % 2 * bn;
  }
  u.addData(h, b, y, a, o, w, x, d, s);
}
var pE = /([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig, gE = /-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;
function vE(r) {
  var e = new Zr();
  if (!r)
    return e;
  var t = 0, i = 0, n = t, s = i, a, o = Zr.CMD, l = r.match(pE);
  if (!l)
    return e;
  for (var h = 0; h < l.length; h++) {
    for (var u = l[h], d = u.charAt(0), c = void 0, f = u.match(gE) || [], p = f.length, m = 0; m < p; m++)
      f[m] = parseFloat(f[m]);
    for (var g = 0; g < p; ) {
      var v = void 0, b = void 0, y = void 0, w = void 0, _ = void 0, E = void 0, x = void 0, T = t, C = i, S = void 0, R = void 0;
      switch (d) {
        case "l":
          t += f[g++], i += f[g++], c = o.L, e.addData(c, t, i);
          break;
        case "L":
          t = f[g++], i = f[g++], c = o.L, e.addData(c, t, i);
          break;
        case "m":
          t += f[g++], i += f[g++], c = o.M, e.addData(c, t, i), n = t, s = i, d = "l";
          break;
        case "M":
          t = f[g++], i = f[g++], c = o.M, e.addData(c, t, i), n = t, s = i, d = "L";
          break;
        case "h":
          t += f[g++], c = o.L, e.addData(c, t, i);
          break;
        case "H":
          t = f[g++], c = o.L, e.addData(c, t, i);
          break;
        case "v":
          i += f[g++], c = o.L, e.addData(c, t, i);
          break;
        case "V":
          i = f[g++], c = o.L, e.addData(c, t, i);
          break;
        case "C":
          c = o.C, e.addData(c, f[g++], f[g++], f[g++], f[g++], f[g++], f[g++]), t = f[g - 2], i = f[g - 1];
          break;
        case "c":
          c = o.C, e.addData(c, f[g++] + t, f[g++] + i, f[g++] + t, f[g++] + i, f[g++] + t, f[g++] + i), t += f[g - 2], i += f[g - 1];
          break;
        case "S":
          v = t, b = i, S = e.len(), R = e.data, a === o.C && (v += t - R[S - 4], b += i - R[S - 3]), c = o.C, T = f[g++], C = f[g++], t = f[g++], i = f[g++], e.addData(c, v, b, T, C, t, i);
          break;
        case "s":
          v = t, b = i, S = e.len(), R = e.data, a === o.C && (v += t - R[S - 4], b += i - R[S - 3]), c = o.C, T = t + f[g++], C = i + f[g++], t += f[g++], i += f[g++], e.addData(c, v, b, T, C, t, i);
          break;
        case "Q":
          T = f[g++], C = f[g++], t = f[g++], i = f[g++], c = o.Q, e.addData(c, T, C, t, i);
          break;
        case "q":
          T = f[g++] + t, C = f[g++] + i, t += f[g++], i += f[g++], c = o.Q, e.addData(c, T, C, t, i);
          break;
        case "T":
          v = t, b = i, S = e.len(), R = e.data, a === o.Q && (v += t - R[S - 4], b += i - R[S - 3]), t = f[g++], i = f[g++], c = o.Q, e.addData(c, v, b, t, i);
          break;
        case "t":
          v = t, b = i, S = e.len(), R = e.data, a === o.Q && (v += t - R[S - 4], b += i - R[S - 3]), t += f[g++], i += f[g++], c = o.Q, e.addData(c, v, b, t, i);
          break;
        case "A":
          y = f[g++], w = f[g++], _ = f[g++], E = f[g++], x = f[g++], T = t, C = i, t = f[g++], i = f[g++], c = o.A, Cc(T, C, t, i, E, x, y, w, _, c, e);
          break;
        case "a":
          y = f[g++], w = f[g++], _ = f[g++], E = f[g++], x = f[g++], T = t, C = i, t += f[g++], i += f[g++], c = o.A, Cc(T, C, t, i, E, x, y, w, _, c, e);
          break;
      }
    }
    (d === "z" || d === "Z") && (c = o.Z, e.addData(c), t = n, i = s), a = c;
  }
  return e.toStatic(), e;
}
var nv = function(r) {
  oe(e, r);
  function e() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return e.prototype.applyTransform = function(t) {
  }, e;
}(fe);
function sv(r) {
  return r.setData != null;
}
function av(r, e) {
  var t = vE(r), i = P({}, e);
  return i.buildPath = function(n) {
    if (sv(n)) {
      n.setData(t.data);
      var s = n.getContext();
      s && n.rebuildPath(s, 1);
    } else {
      var s = n;
      t.rebuildPath(s, 1);
    }
  }, i.applyTransform = function(n) {
    fE(t, n), this.dirtyShape();
  }, i;
}
function mE(r, e) {
  return new nv(av(r, e));
}
function bE(r, e) {
  var t = av(r, e), i = function(n) {
    oe(s, n);
    function s(a) {
      var o = n.call(this, a) || this;
      return o.applyTransform = t.applyTransform, o.buildPath = t.buildPath, o;
    }
    return s;
  }(nv);
  return i;
}
function yE(r, e) {
  for (var t = [], i = r.length, n = 0; n < i; n++) {
    var s = r[n];
    t.push(s.getUpdatedPathProxy(!0));
  }
  var a = new fe(e);
  return a.createPathProxy(), a.buildPath = function(o) {
    if (sv(o)) {
      o.appendPath(t);
      var l = o.getContext();
      l && o.rebuildPath(l, 1);
    }
  }, a;
}
var wE = /* @__PURE__ */ function() {
  function r() {
    this.cx = 0, this.cy = 0, this.r = 0;
  }
  return r;
}(), ao = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.getDefaultShape = function() {
    return new wE();
  }, e.prototype.buildPath = function(t, i) {
    t.moveTo(i.cx + i.r, i.cy), t.arc(i.cx, i.cy, i.r, 0, Math.PI * 2);
  }, e;
}(fe);
ao.prototype.type = "circle";
var CE = /* @__PURE__ */ function() {
  function r() {
    this.cx = 0, this.cy = 0, this.rx = 0, this.ry = 0;
  }
  return r;
}(), Su = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.getDefaultShape = function() {
    return new CE();
  }, e.prototype.buildPath = function(t, i) {
    var n = 0.5522848, s = i.cx, a = i.cy, o = i.rx, l = i.ry, h = o * n, u = l * n;
    t.moveTo(s - o, a), t.bezierCurveTo(s - o, a - u, s - h, a - l, s, a - l), t.bezierCurveTo(s + h, a - l, s + o, a - u, s + o, a), t.bezierCurveTo(s + o, a + u, s + h, a + l, s, a + l), t.bezierCurveTo(s - h, a + l, s - o, a + u, s - o, a), t.closePath();
  }, e;
}(fe);
Su.prototype.type = "ellipse";
var ov = Math.PI, rl = ov * 2, Vi = Math.sin, Er = Math.cos, _E = Math.acos, Ae = Math.atan2, _c = Math.abs, $n = Math.sqrt, Fn = Math.max, Pt = Math.min, Tt = 1e-4;
function EE(r, e, t, i, n, s, a, o) {
  var l = t - r, h = i - e, u = a - n, d = o - s, c = d * l - u * h;
  if (!(c * c < Tt))
    return c = (u * (e - s) - d * (r - n)) / c, [r + c * l, e + c * h];
}
function Fs(r, e, t, i, n, s, a) {
  var o = r - t, l = e - i, h = (a ? s : -s) / $n(o * o + l * l), u = h * l, d = -h * o, c = r + u, f = e + d, p = t + u, m = i + d, g = (c + p) / 2, v = (f + m) / 2, b = p - c, y = m - f, w = b * b + y * y, _ = n - s, E = c * m - p * f, x = (y < 0 ? -1 : 1) * $n(Fn(0, _ * _ * w - E * E)), T = (E * y - b * x) / w, C = (-E * b - y * x) / w, S = (E * y + b * x) / w, R = (-E * b + y * x) / w, D = T - g, k = C - v, L = S - g, O = R - v;
  return D * D + k * k > L * L + O * O && (T = S, C = R), {
    cx: T,
    cy: C,
    x0: -u,
    y0: -d,
    x1: T * (n / _ - 1),
    y1: C * (n / _ - 1)
  };
}
function TE(r) {
  var e;
  if (F(r)) {
    var t = r.length;
    if (!t)
      return r;
    t === 1 ? e = [r[0], r[0], 0, 0] : t === 2 ? e = [r[0], r[0], r[1], r[1]] : t === 3 ? e = r.concat(r[2]) : e = r;
  } else
    e = [r, r, r, r];
  return e;
}
function xE(r, e) {
  var t, i = Fn(e.r, 0), n = Fn(e.r0 || 0, 0), s = i > 0, a = n > 0;
  if (!(!s && !a)) {
    if (s || (i = n, n = 0), n > i) {
      var o = i;
      i = n, n = o;
    }
    var l = e.startAngle, h = e.endAngle;
    if (!(isNaN(l) || isNaN(h))) {
      var u = e.cx, d = e.cy, c = !!e.clockwise, f = _c(h - l), p = f > rl && f % rl;
      if (p > Tt && (f = p), !(i > Tt))
        r.moveTo(u, d);
      else if (f > rl - Tt)
        r.moveTo(u + i * Er(l), d + i * Vi(l)), r.arc(u, d, i, l, h, !c), n > Tt && (r.moveTo(u + n * Er(h), d + n * Vi(h)), r.arc(u, d, n, h, l, c));
      else {
        var m = void 0, g = void 0, v = void 0, b = void 0, y = void 0, w = void 0, _ = void 0, E = void 0, x = void 0, T = void 0, C = void 0, S = void 0, R = void 0, D = void 0, k = void 0, L = void 0, O = i * Er(l), I = i * Vi(l), G = n * Er(h), ee = n * Vi(h), te = f > Tt;
        if (te) {
          var ve = e.cornerRadius;
          ve && (t = TE(ve), m = t[0], g = t[1], v = t[2], b = t[3]);
          var be = _c(i - n) / 2;
          if (y = Pt(be, v), w = Pt(be, b), _ = Pt(be, m), E = Pt(be, g), C = x = Fn(y, w), S = T = Fn(_, E), (x > Tt || T > Tt) && (R = i * Er(h), D = i * Vi(h), k = n * Er(l), L = n * Vi(l), f < ov)) {
            var ie = EE(O, I, k, L, R, D, G, ee);
            if (ie) {
              var xe = O - ie[0], Be = I - ie[1], ut = R - ie[0], Wt = D - ie[1], Gt = 1 / Vi(_E((xe * ut + Be * Wt) / ($n(xe * xe + Be * Be) * $n(ut * ut + Wt * Wt))) / 2), Q = $n(ie[0] * ie[0] + ie[1] * ie[1]);
              C = Pt(x, (i - Q) / (Gt + 1)), S = Pt(T, (n - Q) / (Gt - 1));
            }
          }
        }
        if (!te)
          r.moveTo(u + O, d + I);
        else if (C > Tt) {
          var N = Pt(v, C), X = Pt(b, C), z = Fs(k, L, O, I, i, N, c), H = Fs(R, D, G, ee, i, X, c);
          r.moveTo(u + z.cx + z.x0, d + z.cy + z.y0), C < x && N === X ? r.arc(u + z.cx, d + z.cy, C, Ae(z.y0, z.x0), Ae(H.y0, H.x0), !c) : (N > 0 && r.arc(u + z.cx, d + z.cy, N, Ae(z.y0, z.x0), Ae(z.y1, z.x1), !c), r.arc(u, d, i, Ae(z.cy + z.y1, z.cx + z.x1), Ae(H.cy + H.y1, H.cx + H.x1), !c), X > 0 && r.arc(u + H.cx, d + H.cy, X, Ae(H.y1, H.x1), Ae(H.y0, H.x0), !c));
        } else
          r.moveTo(u + O, d + I), r.arc(u, d, i, l, h, !c);
        if (!(n > Tt) || !te)
          r.lineTo(u + G, d + ee);
        else if (S > Tt) {
          var N = Pt(m, S), X = Pt(g, S), z = Fs(G, ee, R, D, n, -X, c), H = Fs(O, I, k, L, n, -N, c);
          r.lineTo(u + z.cx + z.x0, d + z.cy + z.y0), S < T && N === X ? r.arc(u + z.cx, d + z.cy, S, Ae(z.y0, z.x0), Ae(H.y0, H.x0), !c) : (X > 0 && r.arc(u + z.cx, d + z.cy, X, Ae(z.y0, z.x0), Ae(z.y1, z.x1), !c), r.arc(u, d, n, Ae(z.cy + z.y1, z.cx + z.x1), Ae(H.cy + H.y1, H.cx + H.x1), c), N > 0 && r.arc(u + H.cx, d + H.cy, N, Ae(H.y1, H.x1), Ae(H.y0, H.x0), !c));
        } else
          r.lineTo(u + G, d + ee), r.arc(u, d, n, h, l, c);
      }
      r.closePath();
    }
  }
}
var SE = /* @__PURE__ */ function() {
  function r() {
    this.cx = 0, this.cy = 0, this.r0 = 0, this.r = 0, this.startAngle = 0, this.endAngle = Math.PI * 2, this.clockwise = !0, this.cornerRadius = 0;
  }
  return r;
}(), Ru = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.getDefaultShape = function() {
    return new SE();
  }, e.prototype.buildPath = function(t, i) {
    xE(t, i);
  }, e.prototype.isZeroArea = function() {
    return this.shape.startAngle === this.shape.endAngle || this.shape.r === this.shape.r0;
  }, e;
}(fe);
Ru.prototype.type = "sector";
var RE = /* @__PURE__ */ function() {
  function r() {
    this.cx = 0, this.cy = 0, this.r = 0, this.r0 = 0;
  }
  return r;
}(), Mu = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.getDefaultShape = function() {
    return new RE();
  }, e.prototype.buildPath = function(t, i) {
    var n = i.cx, s = i.cy, a = Math.PI * 2;
    t.moveTo(n + i.r, s), t.arc(n, s, i.r, 0, a, !1), t.moveTo(n + i.r0, s), t.arc(n, s, i.r0, 0, a, !0);
  }, e;
}(fe);
Mu.prototype.type = "ring";
function ME(r, e, t, i) {
  var n = [], s = [], a = [], o = [], l, h, u, d;
  if (i) {
    u = [1 / 0, 1 / 0], d = [-1 / 0, -1 / 0];
    for (var c = 0, f = r.length; c < f; c++)
      Ar(u, u, r[c]), Pr(d, d, r[c]);
    Ar(u, u, i[0]), Pr(d, d, i[1]);
  }
  for (var c = 0, f = r.length; c < f; c++) {
    var p = r[c];
    if (t)
      l = r[c ? c - 1 : f - 1], h = r[(c + 1) % f];
    else if (c === 0 || c === f - 1) {
      n.push(c0(r[c]));
      continue;
    } else
      l = r[c - 1], h = r[c + 1];
    f0(s, h, l), wo(s, s, e);
    var m = ch(p, l), g = ch(p, h), v = m + g;
    v !== 0 && (m /= v, g /= v), wo(a, s, -m), wo(o, s, g);
    var b = ud([], p, a), y = ud([], p, o);
    i && (Pr(b, b, u), Ar(b, b, d), Pr(y, y, u), Ar(y, y, d)), n.push(b), n.push(y);
  }
  return t && n.push(n.shift()), n;
}
function lv(r, e, t) {
  var i = e.smooth, n = e.points;
  if (n && n.length >= 2) {
    if (i) {
      var s = ME(n, i, t, e.smoothConstraint);
      r.moveTo(n[0][0], n[0][1]);
      for (var a = n.length, o = 0; o < (t ? a : a - 1); o++) {
        var l = s[o * 2], h = s[o * 2 + 1], u = n[(o + 1) % a];
        r.bezierCurveTo(l[0], l[1], h[0], h[1], u[0], u[1]);
      }
    } else {
      r.moveTo(n[0][0], n[0][1]);
      for (var o = 1, d = n.length; o < d; o++)
        r.lineTo(n[o][0], n[o][1]);
    }
    t && r.closePath();
  }
}
var DE = /* @__PURE__ */ function() {
  function r() {
    this.points = null, this.smooth = 0, this.smoothConstraint = null;
  }
  return r;
}(), oo = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.getDefaultShape = function() {
    return new DE();
  }, e.prototype.buildPath = function(t, i) {
    lv(t, i, !0);
  }, e;
}(fe);
oo.prototype.type = "polygon";
var LE = /* @__PURE__ */ function() {
  function r() {
    this.points = null, this.percent = 1, this.smooth = 0, this.smoothConstraint = null;
  }
  return r;
}(), Du = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.getDefaultStyle = function() {
    return {
      stroke: "#000",
      fill: null
    };
  }, e.prototype.getDefaultShape = function() {
    return new LE();
  }, e.prototype.buildPath = function(t, i) {
    lv(t, i, !1);
  }, e;
}(fe);
Du.prototype.type = "polyline";
var kE = {}, AE = /* @__PURE__ */ function() {
  function r() {
    this.x1 = 0, this.y1 = 0, this.x2 = 0, this.y2 = 0, this.percent = 1;
  }
  return r;
}(), sn = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.getDefaultStyle = function() {
    return {
      stroke: "#000",
      fill: null
    };
  }, e.prototype.getDefaultShape = function() {
    return new AE();
  }, e.prototype.buildPath = function(t, i) {
    var n, s, a, o;
    if (this.subPixelOptimize) {
      var l = Yg(kE, i, this.style);
      n = l.x1, s = l.y1, a = l.x2, o = l.y2;
    } else
      n = i.x1, s = i.y1, a = i.x2, o = i.y2;
    var h = i.percent;
    h !== 0 && (t.moveTo(n, s), h < 1 && (a = n * (1 - h) + a * h, o = s * (1 - h) + o * h), t.lineTo(a, o));
  }, e.prototype.pointAt = function(t) {
    var i = this.shape;
    return [
      i.x1 * (1 - t) + i.x2 * t,
      i.y1 * (1 - t) + i.y2 * t
    ];
  }, e;
}(fe);
sn.prototype.type = "line";
var je = [], PE = /* @__PURE__ */ function() {
  function r() {
    this.x1 = 0, this.y1 = 0, this.x2 = 0, this.y2 = 0, this.cpx1 = 0, this.cpy1 = 0, this.percent = 1;
  }
  return r;
}();
function Ec(r, e, t) {
  var i = r.cpx2, n = r.cpy2;
  return i != null || n != null ? [
    (t ? _d : We)(r.x1, r.cpx1, r.cpx2, r.x2, e),
    (t ? _d : We)(r.y1, r.cpy1, r.cpy2, r.y2, e)
  ] : [
    (t ? Ed : qe)(r.x1, r.cpx1, r.x2, e),
    (t ? Ed : qe)(r.y1, r.cpy1, r.y2, e)
  ];
}
var Lu = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.getDefaultStyle = function() {
    return {
      stroke: "#000",
      fill: null
    };
  }, e.prototype.getDefaultShape = function() {
    return new PE();
  }, e.prototype.buildPath = function(t, i) {
    var n = i.x1, s = i.y1, a = i.x2, o = i.y2, l = i.cpx1, h = i.cpy1, u = i.cpx2, d = i.cpy2, c = i.percent;
    c !== 0 && (t.moveTo(n, s), u == null || d == null ? (c < 1 && (wa(n, l, a, c, je), l = je[1], a = je[2], wa(s, h, o, c, je), h = je[1], o = je[2]), t.quadraticCurveTo(l, h, a, o)) : (c < 1 && (ya(n, l, u, a, c, je), l = je[1], u = je[2], a = je[3], ya(s, h, d, o, c, je), h = je[1], d = je[2], o = je[3]), t.bezierCurveTo(l, h, u, d, a, o)));
  }, e.prototype.pointAt = function(t) {
    return Ec(this.shape, t, !1);
  }, e.prototype.tangentAt = function(t) {
    var i = Ec(this.shape, t, !0);
    return v0(i, i);
  }, e;
}(fe);
Lu.prototype.type = "bezier-curve";
var OE = /* @__PURE__ */ function() {
  function r() {
    this.cx = 0, this.cy = 0, this.r = 0, this.startAngle = 0, this.endAngle = Math.PI * 2, this.clockwise = !0;
  }
  return r;
}(), lo = function(r) {
  oe(e, r);
  function e(t) {
    return r.call(this, t) || this;
  }
  return e.prototype.getDefaultStyle = function() {
    return {
      stroke: "#000",
      fill: null
    };
  }, e.prototype.getDefaultShape = function() {
    return new OE();
  }, e.prototype.buildPath = function(t, i) {
    var n = i.cx, s = i.cy, a = Math.max(i.r, 0), o = i.startAngle, l = i.endAngle, h = i.clockwise, u = Math.cos(o), d = Math.sin(o);
    t.moveTo(u * a + n, d * a + s), t.arc(n, s, a, o, l, !h);
  }, e;
}(fe);
lo.prototype.type = "arc";
var IE = function(r) {
  oe(e, r);
  function e() {
    var t = r !== null && r.apply(this, arguments) || this;
    return t.type = "compound", t;
  }
  return e.prototype._updatePathDirty = function() {
    for (var t = this.shape.paths, i = this.shapeChanged(), n = 0; n < t.length; n++)
      i = i || t[n].shapeChanged();
    i && this.dirtyShape();
  }, e.prototype.beforeBrush = function() {
    this._updatePathDirty();
    for (var t = this.shape.paths || [], i = this.getGlobalScale(), n = 0; n < t.length; n++)
      t[n].path || t[n].createPathProxy(), t[n].path.setScale(i[0], i[1], t[n].segmentIgnoreThreshold);
  }, e.prototype.buildPath = function(t, i) {
    for (var n = i.paths || [], s = 0; s < n.length; s++)
      n[s].buildPath(t, n[s].shape, !0);
  }, e.prototype.afterBrush = function() {
    for (var t = this.shape.paths || [], i = 0; i < t.length; i++)
      t[i].pathUpdated();
  }, e.prototype.getBoundingRect = function() {
    return this._updatePathDirty.call(this), fe.prototype.getBoundingRect.call(this);
  }, e;
}(fe), hv = function() {
  function r(e) {
    this.colorStops = e || [];
  }
  return r.prototype.addColorStop = function(e, t) {
    this.colorStops.push({
      offset: e,
      color: t
    });
  }, r;
}(), zE = function(r) {
  oe(e, r);
  function e(t, i, n, s, a, o) {
    var l = r.call(this, a) || this;
    return l.x = t ?? 0, l.y = i ?? 0, l.x2 = n ?? 1, l.y2 = s ?? 0, l.type = "linear", l.global = o || !1, l;
  }
  return e;
}(hv), FE = function(r) {
  oe(e, r);
  function e(t, i, n, s, a) {
    var o = r.call(this, s) || this;
    return o.x = t ?? 0.5, o.y = i ?? 0.5, o.r = n ?? 0.5, o.type = "radial", o.global = a || !1, o;
  }
  return e;
}(hv), Wi = [0, 0], Gi = [0, 0], Hs = new he(), Ns = new he(), Ma = function() {
  function r(e, t) {
    this._corners = [], this._axes = [], this._origin = [0, 0];
    for (var i = 0; i < 4; i++)
      this._corners[i] = new he();
    for (var i = 0; i < 2; i++)
      this._axes[i] = new he();
    e && this.fromBoundingRect(e, t);
  }
  return r.prototype.fromBoundingRect = function(e, t) {
    var i = this._corners, n = this._axes, s = e.x, a = e.y, o = s + e.width, l = a + e.height;
    if (i[0].set(s, a), i[1].set(o, a), i[2].set(o, l), i[3].set(s, l), t)
      for (var h = 0; h < 4; h++)
        i[h].transform(t);
    he.sub(n[0], i[1], i[0]), he.sub(n[1], i[3], i[0]), n[0].normalize(), n[1].normalize();
    for (var h = 0; h < 2; h++)
      this._origin[h] = n[h].dot(i[0]);
  }, r.prototype.intersect = function(e, t) {
    var i = !0, n = !t;
    return Hs.set(1 / 0, 1 / 0), Ns.set(0, 0), !this._intersectCheckOneSide(this, e, Hs, Ns, n, 1) && (i = !1, n) || !this._intersectCheckOneSide(e, this, Hs, Ns, n, -1) && (i = !1, n) || n || he.copy(t, i ? Hs : Ns), i;
  }, r.prototype._intersectCheckOneSide = function(e, t, i, n, s, a) {
    for (var o = !0, l = 0; l < 2; l++) {
      var h = this._axes[l];
      if (this._getProjMinMaxOnAxis(l, e._corners, Wi), this._getProjMinMaxOnAxis(l, t._corners, Gi), Wi[1] < Gi[0] || Wi[0] > Gi[1]) {
        if (o = !1, s)
          return o;
        var u = Math.abs(Gi[0] - Wi[1]), d = Math.abs(Wi[0] - Gi[1]);
        Math.min(u, d) > n.len() && (u < d ? he.scale(n, h, -u * a) : he.scale(n, h, d * a));
      } else if (i) {
        var u = Math.abs(Gi[0] - Wi[1]), d = Math.abs(Wi[0] - Gi[1]);
        Math.min(u, d) < i.len() && (u < d ? he.scale(i, h, u * a) : he.scale(i, h, -d * a));
      }
    }
    return o;
  }, r.prototype._getProjMinMaxOnAxis = function(e, t, i) {
    for (var n = this._axes[e], s = this._origin, a = t[0].dot(n) + s[e], o = a, l = a, h = 1; h < t.length; h++) {
      var u = t[h].dot(n) + s[e];
      o = Math.min(u, o), l = Math.max(u, l);
    }
    i[0] = o, i[1] = l;
  }, r;
}(), HE = [], NE = function(r) {
  oe(e, r);
  function e() {
    var t = r !== null && r.apply(this, arguments) || this;
    return t.notClear = !0, t.incremental = !0, t._displayables = [], t._temporaryDisplayables = [], t._cursor = 0, t;
  }
  return e.prototype.traverse = function(t, i) {
    t.call(i, this);
  }, e.prototype.useStyle = function() {
    this.style = {};
  }, e.prototype.getCursor = function() {
    return this._cursor;
  }, e.prototype.innerAfterBrush = function() {
    this._cursor = this._displayables.length;
  }, e.prototype.clearDisplaybles = function() {
    this._displayables = [], this._temporaryDisplayables = [], this._cursor = 0, this.markRedraw(), this.notClear = !1;
  }, e.prototype.clearTemporalDisplayables = function() {
    this._temporaryDisplayables = [];
  }, e.prototype.addDisplayable = function(t, i) {
    i ? this._temporaryDisplayables.push(t) : this._displayables.push(t), this.markRedraw();
  }, e.prototype.addDisplayables = function(t, i) {
    i = i || !1;
    for (var n = 0; n < t.length; n++)
      this.addDisplayable(t[n], i);
  }, e.prototype.getDisplayables = function() {
    return this._displayables;
  }, e.prototype.getTemporalDisplayables = function() {
    return this._temporaryDisplayables;
  }, e.prototype.eachPendingDisplayable = function(t) {
    for (var i = this._cursor; i < this._displayables.length; i++)
      t && t(this._displayables[i]);
    for (var i = 0; i < this._temporaryDisplayables.length; i++)
      t && t(this._temporaryDisplayables[i]);
  }, e.prototype.update = function() {
    this.updateTransform();
    for (var t = this._cursor; t < this._displayables.length; t++) {
      var i = this._displayables[t];
      i.parent = this, i.update(), i.parent = null;
    }
    for (var t = 0; t < this._temporaryDisplayables.length; t++) {
      var i = this._temporaryDisplayables[t];
      i.parent = this, i.update(), i.parent = null;
    }
  }, e.prototype.getBoundingRect = function() {
    if (!this._rect) {
      for (var t = new re(1 / 0, 1 / 0, -1 / 0, -1 / 0), i = 0; i < this._displayables.length; i++) {
        var n = this._displayables[i], s = n.getBoundingRect().clone();
        n.needLocalTransform() && s.applyTransform(n.getLocalTransform(HE)), t.union(s);
      }
      this._rect = t;
    }
    return this._rect;
  }, e.prototype.contain = function(t, i) {
    var n = this.transformCoordToLocal(t, i), s = this.getBoundingRect();
    if (s.contain(n[0], n[1]))
      for (var a = 0; a < this._displayables.length; a++) {
        var o = this._displayables[a];
        if (o.contain(t, i))
          return !0;
      }
    return !1;
  }, e;
}(nn);
Te();
function BE(r, e, t, i, n) {
  var s;
  if (e && e.ecModel) {
    var a = e.ecModel.getUpdatePayload();
    s = a && a.animation;
  }
  var o = e && e.isAnimationEnabled(), l = r === "update";
  if (o) {
    var h = void 0, u = void 0, d = void 0;
    i ? (h = j(i.duration, 200), u = j(i.easing, "cubicOut"), d = 0) : (h = e.getShallow(l ? "animationDurationUpdate" : "animationDuration"), u = e.getShallow(l ? "animationEasingUpdate" : "animationEasing"), d = e.getShallow(l ? "animationDelayUpdate" : "animationDelay")), s && (s.duration != null && (h = s.duration), s.easing != null && (u = s.easing), s.delay != null && (d = s.delay)), q(d) && (d = d(t, n)), q(h) && (h = h(t));
    var c = {
      duration: h || 0,
      delay: d,
      easing: u
    };
    return c;
  } else
    return null;
}
function ku(r, e, t, i, n, s, a) {
  var o = !1, l;
  q(n) ? (a = s, s = n, n = null) : B(n) && (s = n.cb, a = n.during, o = n.isFrom, l = n.removeOpt, n = n.dataIndex);
  var h = r === "leave";
  h || e.stopAnimation("leave");
  var u = BE(r, i, n, h ? l || {} : null, i && i.getAnimationDelayParams ? i.getAnimationDelayParams(e, n) : null);
  if (u && u.duration > 0) {
    var d = u.duration, c = u.delay, f = u.easing, p = {
      duration: d,
      delay: c || 0,
      easing: f,
      done: s,
      force: !!s || !!a,
      // Set to final state in update/init animation.
      // So the post processing based on the path shape can be done correctly.
      setToFinal: !h,
      scope: r,
      during: a
    };
    o ? e.animateFrom(t, p) : e.animateTo(t, p);
  } else
    e.stopAnimation(), !o && e.attr(t), a && a(1), s && s();
}
function Au(r, e, t, i, n, s) {
  ku("update", r, e, t, i, n, s);
}
function VE(r, e, t, i, n, s) {
  ku("enter", r, e, t, i, n, s);
}
function qn(r) {
  if (!r.__zr)
    return !0;
  for (var e = 0; e < r.animators.length; e++) {
    var t = r.animators[e];
    if (t.scope === "leave")
      return !0;
  }
  return !1;
}
function uv(r, e, t, i, n, s) {
  qn(r) || ku("leave", r, e, t, i, n, s);
}
function Tc(r, e, t, i) {
  r.removeTextContent(), r.removeTextGuideLine(), uv(r, {
    style: {
      opacity: 0
    }
  }, e, t, i);
}
function WE(r, e, t) {
  function i() {
    r.parent && r.parent.remove(r);
  }
  r.isGroup ? r.traverse(function(n) {
    n.isGroup || Tc(n, e, t, i);
  }) : Tc(r, e, t, i);
}
var Da = Math.max, La = Math.min, Fh = {};
function GE(r) {
  return fe.extend(r);
}
var UE = bE;
function jE(r, e) {
  return UE(r, e);
}
function Dt(r, e) {
  Fh[r] = e;
}
function YE(r) {
  if (Fh.hasOwnProperty(r))
    return Fh[r];
}
function Pu(r, e, t, i) {
  var n = mE(r, e);
  return t && (i === "center" && (t = cv(t, n.getBoundingRect())), fv(n, t)), n;
}
function dv(r, e, t) {
  var i = new cr({
    style: {
      image: r,
      x: e.x,
      y: e.y,
      width: e.width,
      height: e.height
    },
    onload: function(n) {
      if (t === "center") {
        var s = {
          width: n.width,
          height: n.height
        };
        i.setStyle(cv(e, s));
      }
    }
  });
  return i;
}
function cv(r, e) {
  var t = e.width / e.height, i = r.height * t, n;
  i <= r.width ? n = r.height : (i = r.width, n = i / t);
  var s = r.x + r.width / 2, a = r.y + r.height / 2;
  return {
    x: s - i / 2,
    y: a - n / 2,
    width: i,
    height: n
  };
}
var XE = yE;
function fv(r, e) {
  if (r.applyTransform) {
    var t = r.getBoundingRect(), i = t.calculateTransform(e);
    r.applyTransform(i);
  }
}
function Ou(r, e) {
  return Yg(r, r, {
    lineWidth: e
  }), r;
}
function $E(r) {
  return Xg(r.shape, r.shape, r.style), r;
}
var qE = er;
function KE(r, e) {
  for (var t = cu([]); r && r !== e; )
    Gr(t, r.getLocalTransform(), t), r = r.parent;
  return t;
}
function Iu(r, e, t) {
  return e && !Je(e) && (e = gu.getLocalTransform(e)), t && (e = lg([], e)), Ht([], r, e);
}
function ZE(r, e, t) {
  var i = e[4] === 0 || e[5] === 0 || e[0] === 0 ? 1 : Math.abs(2 * e[4] / e[0]), n = e[4] === 0 || e[5] === 0 || e[2] === 0 ? 1 : Math.abs(2 * e[4] / e[2]), s = [r === "left" ? -i : r === "right" ? i : 0, r === "top" ? -n : r === "bottom" ? n : 0];
  return s = Iu(s, e, t), Math.abs(s[0]) > Math.abs(s[1]) ? s[0] > 0 ? "right" : "left" : s[1] > 0 ? "bottom" : "top";
}
function xc(r) {
  return !r.isGroup;
}
function JE(r) {
  return r.shape != null;
}
function QE(r, e, t) {
  if (!r || !e)
    return;
  function i(a) {
    var o = {};
    return a.traverse(function(l) {
      xc(l) && l.anid && (o[l.anid] = l);
    }), o;
  }
  function n(a) {
    var o = {
      x: a.x,
      y: a.y,
      rotation: a.rotation
    };
    return JE(a) && (o.shape = P({}, a.shape)), o;
  }
  var s = i(r);
  e.traverse(function(a) {
    if (xc(a) && a.anid) {
      var o = s[a.anid];
      if (o) {
        var l = n(a);
        a.attr(n(o)), Au(a, l, t, ce(a).dataIndex);
      }
    }
  });
}
function eT(r, e) {
  return J(r, function(t) {
    var i = t[0];
    i = Da(i, e.x), i = La(i, e.x + e.width);
    var n = t[1];
    return n = Da(n, e.y), n = La(n, e.y + e.height), [i, n];
  });
}
function tT(r, e) {
  var t = Da(r.x, e.x), i = La(r.x + r.width, e.x + e.width), n = Da(r.y, e.y), s = La(r.y + r.height, e.y + e.height);
  if (i >= t && s >= n)
    return {
      x: t,
      y: n,
      width: i - t,
      height: s - n
    };
}
function pv(r, e, t) {
  var i = P({
    rectHover: !0
  }, e), n = i.style = {
    strokeNoScale: !0
  };
  if (t = t || {
    x: -1,
    y: -1,
    width: 2,
    height: 2
  }, r)
    return r.indexOf("image://") === 0 ? (n.image = r.slice(8), ge(n, t), new cr(i)) : Pu(r.replace("path://", ""), i, t, "center");
}
function iT(r, e, t, i, n) {
  for (var s = 0, a = n[n.length - 1]; s < n.length; s++) {
    var o = n[s];
    if (gv(r, e, t, i, o[0], o[1], a[0], a[1]))
      return !0;
    a = o;
  }
}
function gv(r, e, t, i, n, s, a, o) {
  var l = t - r, h = i - e, u = a - n, d = o - s, c = nl(u, d, l, h);
  if (rT(c))
    return !1;
  var f = r - n, p = e - s, m = nl(f, p, l, h) / c;
  if (m < 0 || m > 1)
    return !1;
  var g = nl(f, p, u, d) / c;
  return !(g < 0 || g > 1);
}
function nl(r, e, t, i) {
  return r * i - t * e;
}
function rT(r) {
  return r <= 1e-6 && r >= -1e-6;
}
function zu(r) {
  var e = r.itemTooltipOption, t = r.componentModel, i = r.itemName, n = V(e) ? {
    formatter: e
  } : e, s = t.mainType, a = t.componentIndex, o = {
    componentType: s,
    name: i,
    $vars: ["name"]
  };
  o[s + "Index"] = a;
  var l = r.formatterParamsExtra;
  l && M(me(l), function(u) {
    $r(o, u) || (o[u] = l[u], o.$vars.push(u));
  });
  var h = ce(r.el);
  h.componentMainType = s, h.componentIndex = a, h.tooltipConfig = {
    name: i,
    option: ge({
      content: i,
      encodeHTMLContent: !0,
      formatterParams: o
    }, n)
  };
}
function Sc(r, e) {
  var t;
  r.isGroup && (t = e(r)), t || r.traverse(e);
}
function vv(r, e) {
  if (r)
    if (F(r))
      for (var t = 0; t < r.length; t++)
        Sc(r[t], e);
    else
      Sc(r, e);
}
Dt("circle", ao);
Dt("ellipse", Su);
Dt("sector", Ru);
Dt("ring", Mu);
Dt("polygon", oo);
Dt("polyline", Du);
Dt("rect", ot);
Dt("line", sn);
Dt("bezierCurve", Lu);
Dt("arc", lo);
const nT = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Arc: lo,
  BezierCurve: Lu,
  BoundingRect: re,
  Circle: ao,
  CompoundPath: IE,
  Ellipse: Su,
  Group: lt,
  Image: cr,
  IncrementalDisplayable: NE,
  Line: sn,
  LinearGradient: zE,
  OrientedBoundingRect: Ma,
  Path: fe,
  Point: he,
  Polygon: oo,
  Polyline: Du,
  RadialGradient: FE,
  Rect: ot,
  Ring: Mu,
  Sector: Ru,
  Text: ht,
  applyTransform: Iu,
  clipPointsByRect: eT,
  clipRectByRect: tT,
  createIcon: pv,
  extendPath: jE,
  extendShape: GE,
  getShapeClass: YE,
  getTransform: KE,
  groupTransition: QE,
  initProps: VE,
  isElementRemoved: qn,
  lineLineIntersect: gv,
  linePolygonIntersect: iT,
  makeImage: dv,
  makePath: Pu,
  mergePath: XE,
  registerShape: Dt,
  removeElement: uv,
  removeElementWithFadeOut: WE,
  resizePath: fv,
  setTooltipConfig: zu,
  subPixelOptimize: qE,
  subPixelOptimizeLine: Ou,
  subPixelOptimizeRect: $E,
  transformDirection: ZE,
  traverseElements: vv,
  updateProps: Au
}, Symbol.toStringTag, { value: "Module" }));
var ho = {};
function sT(r, e) {
  for (var t = 0; t < Ti.length; t++) {
    var i = Ti[t], n = e[i], s = r.ensureState(i);
    s.style = s.style || {}, s.style.text = n;
  }
  var a = r.currentStates.slice();
  r.clearStates(!0), r.setStyle({
    text: e.normal
  }), r.useStates(a, !0);
}
function Rc(r, e, t) {
  var i = r.labelFetcher, n = r.labelDataIndex, s = r.labelDimIndex, a = e.normal, o;
  i && (o = i.getFormattedLabel(n, "normal", null, s, a && a.get("formatter"), t != null ? {
    interpolatedValue: t
  } : null)), o == null && (o = q(r.defaultText) ? r.defaultText(n, r, t) : r.defaultText);
  for (var l = {
    normal: o
  }, h = 0; h < Ti.length; h++) {
    var u = Ti[h], d = e[u];
    l[u] = j(i ? i.getFormattedLabel(n, u, null, s, d && d.get("formatter")) : null, o);
  }
  return l;
}
function aT(r, e, t, i) {
  t = t || ho;
  for (var n = r instanceof ht, s = !1, a = 0; a < cc.length; a++) {
    var o = e[cc[a]];
    if (o && o.getShallow("show")) {
      s = !0;
      break;
    }
  }
  var l = n ? r : r.getTextContent();
  if (s) {
    n || (l || (l = new ht(), r.setTextContent(l)), r.stateProxy && (l.stateProxy = r.stateProxy));
    var h = Rc(t, e), u = e.normal, d = !!u.getShallow("show"), c = ei(u, i, t, !1, !n);
    c.text = h.normal, n || r.setTextConfig(Mc(u, t, !1));
    for (var a = 0; a < Ti.length; a++) {
      var f = Ti[a], o = e[f];
      if (o) {
        var p = l.ensureState(f), m = !!j(o.getShallow("show"), d);
        if (m !== d && (p.ignore = !m), p.style = ei(o, i, t, !0, !n), p.style.text = h[f], !n) {
          var g = r.ensureState(f);
          g.textConfig = Mc(o, t, !0);
        }
      }
    }
    l.silent = !!u.getShallow("silent"), l.style.x != null && (c.x = l.style.x), l.style.y != null && (c.y = l.style.y), l.ignore = !d, l.useStyle(c), l.dirty(), t.enableTextSetter && (dT(l).setLabelText = function(v) {
      var b = Rc(t, e, v);
      sT(l, b);
    });
  } else l && (l.ignore = !0);
  r.dirty();
}
function oT(r, e) {
  e = e || "label";
  for (var t = {
    normal: r.getModel(e)
  }, i = 0; i < Ti.length; i++) {
    var n = Ti[i];
    t[n] = r.getModel([n, e]);
  }
  return t;
}
function ei(r, e, t, i, n) {
  var s = {};
  return lT(s, r, t, i, n), e && P(s, e), s;
}
function Mc(r, e, t) {
  e = e || {};
  var i = {}, n, s = r.getShallow("rotate"), a = j(r.getShallow("distance"), t ? null : 5), o = r.getShallow("offset");
  return n = r.getShallow("position") || (t ? null : "inside"), n === "outside" && (n = e.defaultOutsidePosition || "top"), n != null && (i.position = n), o != null && (i.offset = o), s != null && (s *= Math.PI / 180, i.rotation = s), a != null && (i.distance = a), i.outsideFill = r.get("color") === "inherit" ? e.inheritColor || null : "auto", i;
}
function lT(r, e, t, i, n) {
  t = t || ho;
  var s = e.ecModel, a = s && s.option.textStyle, o = hT(e), l;
  if (o) {
    l = {};
    for (var h in o)
      if (o.hasOwnProperty(h)) {
        var u = e.getModel(["rich", h]);
        Ac(l[h] = {}, u, a, t, i, n, !1, !0);
      }
  }
  l && (r.rich = l);
  var d = e.get("overflow");
  d && (r.overflow = d);
  var c = e.get("minMargin");
  c != null && (r.margin = c), Ac(r, e, a, t, i, n, !0, !1);
}
function hT(r) {
  for (var e; r && r !== r.ecModel; ) {
    var t = (r.option || ho).rich;
    if (t) {
      e = e || {};
      for (var i = me(t), n = 0; n < i.length; n++) {
        var s = i[n];
        e[s] = 1;
      }
    }
    r = r.parentModel;
  }
  return e;
}
var Dc = ["fontStyle", "fontWeight", "fontSize", "fontFamily", "textShadowColor", "textShadowBlur", "textShadowOffsetX", "textShadowOffsetY"], Lc = ["align", "lineHeight", "width", "height", "tag", "verticalAlign", "ellipsis"], kc = ["padding", "borderWidth", "borderRadius", "borderDashOffset", "backgroundColor", "borderColor", "shadowColor", "shadowBlur", "shadowOffsetX", "shadowOffsetY"];
function Ac(r, e, t, i, n, s, a, o) {
  t = !n && t || ho;
  var l = i && i.inheritColor, h = e.getShallow("color"), u = e.getShallow("textBorderColor"), d = j(e.getShallow("opacity"), t.opacity);
  (h === "inherit" || h === "auto") && (process.env.NODE_ENV !== "production" && h === "auto" && Se("color: 'auto'", "color: 'inherit'"), l ? h = l : h = null), (u === "inherit" || u === "auto") && (process.env.NODE_ENV !== "production" && u === "auto" && Se("color: 'auto'", "color: 'inherit'"), l ? u = l : u = null), s || (h = h || t.color, u = u || t.textBorderColor), h != null && (r.fill = h), u != null && (r.stroke = u);
  var c = j(e.getShallow("textBorderWidth"), t.textBorderWidth);
  c != null && (r.lineWidth = c);
  var f = j(e.getShallow("textBorderType"), t.textBorderType);
  f != null && (r.lineDash = f);
  var p = j(e.getShallow("textBorderDashOffset"), t.textBorderDashOffset);
  p != null && (r.lineDashOffset = p), !n && d == null && !o && (d = i && i.defaultOpacity), d != null && (r.opacity = d), !n && !s && r.fill == null && i.inheritColor && (r.fill = i.inheritColor);
  for (var m = 0; m < Dc.length; m++) {
    var g = Dc[m], v = j(e.getShallow(g), t[g]);
    v != null && (r[g] = v);
  }
  for (var m = 0; m < Lc.length; m++) {
    var g = Lc[m], v = e.getShallow(g);
    v != null && (r[g] = v);
  }
  if (r.verticalAlign == null) {
    var b = e.getShallow("baseline");
    b != null && (r.verticalAlign = b);
  }
  if (!a || !i.disableBox) {
    for (var m = 0; m < kc.length; m++) {
      var g = kc[m], v = e.getShallow(g);
      v != null && (r[g] = v);
    }
    var y = e.getShallow("borderType");
    y != null && (r.borderDash = y), (r.backgroundColor === "auto" || r.backgroundColor === "inherit") && l && (process.env.NODE_ENV !== "production" && r.backgroundColor === "auto" && Se("backgroundColor: 'auto'", "backgroundColor: 'inherit'"), r.backgroundColor = l), (r.borderColor === "auto" || r.borderColor === "inherit") && l && (process.env.NODE_ENV !== "production" && r.borderColor === "auto" && Se("borderColor: 'auto'", "borderColor: 'inherit'"), r.borderColor = l);
  }
}
function uT(r, e) {
  var t = e && e.getModel("textStyle");
  return zt([
    // FIXME in node-canvas fontWeight is before fontStyle
    r.fontStyle || t && t.getShallow("fontStyle") || "",
    r.fontWeight || t && t.getShallow("fontWeight") || "",
    (r.fontSize || t && t.getShallow("fontSize") || 12) + "px",
    r.fontFamily || t && t.getShallow("fontFamily") || "sans-serif"
  ].join(" "));
}
var dT = Te(), cT = ["textStyle", "color"], sl = ["fontStyle", "fontWeight", "fontSize", "fontFamily", "padding", "lineHeight", "rich", "width", "height", "overflow"], al = new ht(), fT = (
  /** @class */
  function() {
    function r() {
    }
    return r.prototype.getTextColor = function(e) {
      var t = this.ecModel;
      return this.getShallow("color") || (!e && t ? t.get(cT) : null);
    }, r.prototype.getFont = function() {
      return uT({
        fontStyle: this.getShallow("fontStyle"),
        fontWeight: this.getShallow("fontWeight"),
        fontSize: this.getShallow("fontSize"),
        fontFamily: this.getShallow("fontFamily")
      }, this.ecModel);
    }, r.prototype.getTextRect = function(e) {
      for (var t = {
        text: e,
        verticalAlign: this.getShallow("verticalAlign") || this.getShallow("baseline")
      }, i = 0; i < sl.length; i++)
        t[sl[i]] = this.getShallow(sl[i]);
      return al.useStyle(t), al.update(), al.getBoundingRect();
    }, r;
  }()
), mv = [
  ["lineWidth", "width"],
  ["stroke", "color"],
  ["opacity"],
  ["shadowBlur"],
  ["shadowOffsetX"],
  ["shadowOffsetY"],
  ["shadowColor"],
  ["lineDash", "type"],
  ["lineDashOffset", "dashOffset"],
  ["lineCap", "cap"],
  ["lineJoin", "join"],
  ["miterLimit"]
  // Option decal is in `DecalObject` but style.decal is in `PatternObject`.
  // So do not transfer decal directly.
], pT = Kr(mv), gT = (
  /** @class */
  function() {
    function r() {
    }
    return r.prototype.getLineStyle = function(e) {
      return pT(this, e);
    }, r;
  }()
), bv = [
  ["fill", "color"],
  ["stroke", "borderColor"],
  ["lineWidth", "borderWidth"],
  ["opacity"],
  ["shadowBlur"],
  ["shadowOffsetX"],
  ["shadowOffsetY"],
  ["shadowColor"],
  ["lineDash", "borderType"],
  ["lineDashOffset", "borderDashOffset"],
  ["lineCap", "borderCap"],
  ["lineJoin", "borderJoin"],
  ["miterLimit", "borderMiterLimit"]
  // Option decal is in `DecalObject` but style.decal is in `PatternObject`.
  // So do not transfer decal directly.
], vT = Kr(bv), mT = (
  /** @class */
  function() {
    function r() {
    }
    return r.prototype.getItemStyle = function(e, t) {
      return vT(this, e, t);
    }, r;
  }()
), pe = (
  /** @class */
  function() {
    function r(e, t, i) {
      this.parentModel = t, this.ecModel = i, this.option = e;
    }
    return r.prototype.init = function(e, t, i) {
    }, r.prototype.mergeOption = function(e, t) {
      Ee(this.option, e, !0);
    }, r.prototype.get = function(e, t) {
      return e == null ? this.option : this._doGet(this.parsePath(e), !t && this.parentModel);
    }, r.prototype.getShallow = function(e, t) {
      var i = this.option, n = i == null ? i : i[e];
      if (n == null && !t) {
        var s = this.parentModel;
        s && (n = s.getShallow(e));
      }
      return n;
    }, r.prototype.getModel = function(e, t) {
      var i = e != null, n = i ? this.parsePath(e) : null, s = i ? this._doGet(n) : this.option;
      return t = t || this.parentModel && this.parentModel.getModel(this.resolveParentPath(n)), new r(s, t, this.ecModel);
    }, r.prototype.isEmpty = function() {
      return this.option == null;
    }, r.prototype.restoreData = function() {
    }, r.prototype.clone = function() {
      var e = this.constructor;
      return new e($(this.option));
    }, r.prototype.parsePath = function(e) {
      return typeof e == "string" ? e.split(".") : e;
    }, r.prototype.resolveParentPath = function(e) {
      return e;
    }, r.prototype.isAnimationEnabled = function() {
      if (!W.node && this.option) {
        if (this.option.animation != null)
          return !!this.option.animation;
        if (this.parentModel)
          return this.parentModel.isAnimationEnabled();
      }
    }, r.prototype._doGet = function(e, t) {
      var i = this.option;
      if (!e)
        return i;
      for (var n = 0; n < e.length && !(e[n] && (i = i && typeof i == "object" ? i[e[n]] : null, i == null)); n++)
        ;
      return i == null && t && (i = t._doGet(this.resolveParentPath(e), t.parentModel)), i;
    }, r;
  }()
);
yu(pe);
QC(pe);
ii(pe, gT);
ii(pe, mT);
ii(pe, n_);
ii(pe, fT);
var bT = Math.round(Math.random() * 10);
function uo(r) {
  return [r || "", bT++].join("_");
}
function yT(r) {
  var e = {};
  r.registerSubTypeDefaulter = function(t, i) {
    var n = Ft(t);
    e[n.main] = i;
  }, r.determineSubType = function(t, i) {
    var n = i.type;
    if (!n) {
      var s = Ft(t).main;
      r.hasSubTypes(t) && e[s] && (n = e[s](i));
    }
    return n;
  };
}
function wT(r, e) {
  r.topologicalTravel = function(s, a, o, l) {
    if (!s.length)
      return;
    var h = t(a), u = h.graph, d = h.noEntryList, c = {};
    for (M(s, function(b) {
      c[b] = !0;
    }); d.length; ) {
      var f = d.pop(), p = u[f], m = !!c[f];
      m && (o.call(l, f, p.originalDeps.slice()), delete c[f]), M(p.successor, m ? v : g);
    }
    M(c, function() {
      var b = "";
      throw process.env.NODE_ENV !== "production" && (b = Sa("Circular dependency may exists: ", c, s, a)), new Error(b);
    });
    function g(b) {
      u[b].entryCount--, u[b].entryCount === 0 && d.push(b);
    }
    function v(b) {
      c[b] = !0, g(b);
    }
  };
  function t(s) {
    var a = {}, o = [];
    return M(s, function(l) {
      var h = i(a, l), u = h.originalDeps = e(l), d = n(u, s);
      h.entryCount = d.length, h.entryCount === 0 && o.push(l), M(d, function(c) {
        ue(h.predecessor, c) < 0 && h.predecessor.push(c);
        var f = i(a, c);
        ue(f.successor, c) < 0 && f.successor.push(l);
      });
    }), {
      graph: a,
      noEntryList: o
    };
  }
  function i(s, a) {
    return s[a] || (s[a] = {
      predecessor: [],
      successor: []
    }), s[a];
  }
  function n(s, a) {
    var o = [];
    return M(s, function(l) {
      ue(a, l) >= 0 && o.push(l);
    }), o;
  }
}
const CT = {
  time: {
    month: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
    monthAbbr: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
    dayOfWeek: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
    dayOfWeekAbbr: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]
  },
  legend: {
    selector: {
      all: "All",
      inverse: "Inv"
    }
  },
  toolbox: {
    brush: {
      title: {
        rect: "Box Select",
        polygon: "Lasso Select",
        lineX: "Horizontally Select",
        lineY: "Vertically Select",
        keep: "Keep Selections",
        clear: "Clear Selections"
      }
    },
    dataView: {
      title: "Data View",
      lang: ["Data View", "Close", "Refresh"]
    },
    dataZoom: {
      title: {
        zoom: "Zoom",
        back: "Zoom Reset"
      }
    },
    magicType: {
      title: {
        line: "Switch to Line Chart",
        bar: "Switch to Bar Chart",
        stack: "Stack",
        tiled: "Tile"
      }
    },
    restore: {
      title: "Restore"
    },
    saveAsImage: {
      title: "Save as Image",
      lang: ["Right Click to Save Image"]
    }
  },
  series: {
    typeNames: {
      pie: "Pie chart",
      bar: "Bar chart",
      line: "Line chart",
      scatter: "Scatter plot",
      effectScatter: "Ripple scatter plot",
      radar: "Radar chart",
      tree: "Tree",
      treemap: "Treemap",
      boxplot: "Boxplot",
      candlestick: "Candlestick",
      k: "K line chart",
      heatmap: "Heat map",
      map: "Map",
      parallel: "Parallel coordinate map",
      lines: "Line graph",
      graph: "Relationship graph",
      sankey: "Sankey diagram",
      funnel: "Funnel chart",
      gauge: "Gauge",
      pictorialBar: "Pictorial bar",
      themeRiver: "Theme River Map",
      sunburst: "Sunburst",
      custom: "Custom chart",
      chart: "Chart"
    }
  },
  aria: {
    general: {
      withTitle: 'This is a chart about "{title}"',
      withoutTitle: "This is a chart"
    },
    series: {
      single: {
        prefix: "",
        withName: " with type {seriesType} named {seriesName}.",
        withoutName: " with type {seriesType}."
      },
      multiple: {
        prefix: ". It consists of {seriesCount} series count.",
        withName: " The {seriesId} series is a {seriesType} representing {seriesName}.",
        withoutName: " The {seriesId} series is a {seriesType}.",
        separator: {
          middle: "",
          end: ""
        }
      }
    },
    data: {
      allData: "The data is as follows: ",
      partialData: "The first {displayCnt} items are: ",
      withName: "the data for {name} is {value}",
      withoutName: "{value}",
      separator: {
        middle: ", ",
        end: ". "
      }
    }
  }
}, _T = {
  time: {
    month: ["ä¸€æœˆ", "äºŒæœˆ", "ä¸‰æœˆ", "å››æœˆ", "äº”æœˆ", "å…­æœˆ", "ä¸ƒæœˆ", "å…«æœˆ", "ä¹æœˆ", "åæœˆ", "åä¸€æœˆ", "åäºŒæœˆ"],
    monthAbbr: ["1æœˆ", "2æœˆ", "3æœˆ", "4æœˆ", "5æœˆ", "6æœˆ", "7æœˆ", "8æœˆ", "9æœˆ", "10æœˆ", "11æœˆ", "12æœˆ"],
    dayOfWeek: ["æ˜ŸæœŸæ—¥", "æ˜ŸæœŸä¸€", "æ˜ŸæœŸäºŒ", "æ˜ŸæœŸä¸‰", "æ˜ŸæœŸå››", "æ˜ŸæœŸäº”", "æ˜ŸæœŸå…­"],
    dayOfWeekAbbr: ["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"]
  },
  legend: {
    selector: {
      all: "å…¨é€‰",
      inverse: "åé€‰"
    }
  },
  toolbox: {
    brush: {
      title: {
        rect: "çŸ©å½¢é€‰æ‹©",
        polygon: "åœˆé€‰",
        lineX: "æ¨ªå‘é€‰æ‹©",
        lineY: "çºµå‘é€‰æ‹©",
        keep: "ä¿æŒé€‰æ‹©",
        clear: "æ¸…é™¤é€‰æ‹©"
      }
    },
    dataView: {
      title: "æ•°æ®è§†å›¾",
      lang: ["æ•°æ®è§†å›¾", "å…³é—­", "åˆ·æ–°"]
    },
    dataZoom: {
      title: {
        zoom: "åŒºåŸŸç¼©æ”¾",
        back: "åŒºåŸŸç¼©æ”¾è¿˜åŽŸ"
      }
    },
    magicType: {
      title: {
        line: "åˆ‡æ¢ä¸ºæŠ˜çº¿å›¾",
        bar: "åˆ‡æ¢ä¸ºæŸ±çŠ¶å›¾",
        stack: "åˆ‡æ¢ä¸ºå †å ",
        tiled: "åˆ‡æ¢ä¸ºå¹³é“º"
      }
    },
    restore: {
      title: "è¿˜åŽŸ"
    },
    saveAsImage: {
      title: "ä¿å­˜ä¸ºå›¾ç‰‡",
      lang: ["å³é”®å¦å­˜ä¸ºå›¾ç‰‡"]
    }
  },
  series: {
    typeNames: {
      pie: "é¥¼å›¾",
      bar: "æŸ±çŠ¶å›¾",
      line: "æŠ˜çº¿å›¾",
      scatter: "æ•£ç‚¹å›¾",
      effectScatter: "æ¶Ÿæ¼ªæ•£ç‚¹å›¾",
      radar: "é›·è¾¾å›¾",
      tree: "æ ‘å›¾",
      treemap: "çŸ©å½¢æ ‘å›¾",
      boxplot: "ç®±åž‹å›¾",
      candlestick: "Kçº¿å›¾",
      k: "Kçº¿å›¾",
      heatmap: "çƒ­åŠ›å›¾",
      map: "åœ°å›¾",
      parallel: "å¹³è¡Œåæ ‡å›¾",
      lines: "çº¿å›¾",
      graph: "å…³ç³»å›¾",
      sankey: "æ¡‘åŸºå›¾",
      funnel: "æ¼æ–—å›¾",
      gauge: "ä»ªè¡¨ç›˜å›¾",
      pictorialBar: "è±¡å½¢æŸ±å›¾",
      themeRiver: "ä¸»é¢˜æ²³æµå›¾",
      sunburst: "æ—­æ—¥å›¾",
      custom: "è‡ªå®šä¹‰å›¾è¡¨",
      chart: "å›¾è¡¨"
    }
  },
  aria: {
    general: {
      withTitle: "è¿™æ˜¯ä¸€ä¸ªå…³äºŽâ€œ{title}â€çš„å›¾è¡¨ã€‚",
      withoutTitle: "è¿™æ˜¯ä¸€ä¸ªå›¾è¡¨ï¼Œ"
    },
    series: {
      single: {
        prefix: "",
        withName: "å›¾è¡¨ç±»åž‹æ˜¯{seriesType}ï¼Œè¡¨ç¤º{seriesName}ã€‚",
        withoutName: "å›¾è¡¨ç±»åž‹æ˜¯{seriesType}ã€‚"
      },
      multiple: {
        prefix: "å®ƒç”±{seriesCount}ä¸ªå›¾è¡¨ç³»åˆ—ç»„æˆã€‚",
        withName: "ç¬¬{seriesId}ä¸ªç³»åˆ—æ˜¯ä¸€ä¸ªè¡¨ç¤º{seriesName}çš„{seriesType}ï¼Œ",
        withoutName: "ç¬¬{seriesId}ä¸ªç³»åˆ—æ˜¯ä¸€ä¸ª{seriesType}ï¼Œ",
        separator: {
          middle: "ï¼›",
          end: "ã€‚"
        }
      }
    },
    data: {
      allData: "å…¶æ•°æ®æ˜¯â€”â€”",
      partialData: "å…¶ä¸­ï¼Œå‰{displayCnt}é¡¹æ˜¯â€”â€”",
      withName: "{name}çš„æ•°æ®æ˜¯{value}",
      withoutName: "{value}",
      separator: {
        middle: "ï¼Œ",
        end: ""
      }
    }
  }
};
var ka = "ZH", Fu = "EN", jr = Fu, ha = {}, Hu = {}, yv = W.domSupported ? function() {
  var r = (
    /* eslint-disable-next-line */
    (document.documentElement.lang || navigator.language || navigator.browserLanguage || jr).toUpperCase()
  );
  return r.indexOf(ka) > -1 ? ka : jr;
}() : jr;
function wv(r, e) {
  r = r.toUpperCase(), Hu[r] = new pe(e), ha[r] = e;
}
function ET(r) {
  if (V(r)) {
    var e = ha[r.toUpperCase()] || {};
    return r === ka || r === Fu ? $(e) : Ee($(e), $(ha[jr]), !1);
  } else
    return Ee($(r), $(ha[jr]), !1);
}
function TT(r) {
  return Hu[r];
}
function xT() {
  return Hu[jr];
}
wv(Fu, CT);
wv(ka, _T);
function oi(r, e) {
  return r += "", "0000".substr(0, e - r.length) + r;
}
function Cv(r, e, t, i) {
  var n = eo(r), s = n[ST(t)](), a = n[RT(t)]() + 1, o = Math.floor((a - 1) / 3) + 1, l = n[MT(t)](), h = n["get" + (t ? "UTC" : "") + "Day"](), u = n[DT(t)](), d = (u - 1) % 12 + 1, c = n[LT(t)](), f = n[kT(t)](), p = n[AT(t)](), m = u >= 12 ? "pm" : "am", g = m.toUpperCase(), v = i instanceof pe ? i : TT(yv) || xT(), b = v.getModel("time"), y = b.get("month"), w = b.get("monthAbbr"), _ = b.get("dayOfWeek"), E = b.get("dayOfWeekAbbr");
  return (e || "").replace(/{a}/g, m + "").replace(/{A}/g, g + "").replace(/{yyyy}/g, s + "").replace(/{yy}/g, oi(s % 100 + "", 2)).replace(/{Q}/g, o + "").replace(/{MMMM}/g, y[a - 1]).replace(/{MMM}/g, w[a - 1]).replace(/{MM}/g, oi(a, 2)).replace(/{M}/g, a + "").replace(/{dd}/g, oi(l, 2)).replace(/{d}/g, l + "").replace(/{eeee}/g, _[h]).replace(/{ee}/g, E[h]).replace(/{e}/g, h + "").replace(/{HH}/g, oi(u, 2)).replace(/{H}/g, u + "").replace(/{hh}/g, oi(d + "", 2)).replace(/{h}/g, d + "").replace(/{mm}/g, oi(c, 2)).replace(/{m}/g, c + "").replace(/{ss}/g, oi(f, 2)).replace(/{s}/g, f + "").replace(/{SSS}/g, oi(p, 3)).replace(/{S}/g, p + "");
}
function ST(r) {
  return r ? "getUTCFullYear" : "getFullYear";
}
function RT(r) {
  return r ? "getUTCMonth" : "getMonth";
}
function MT(r) {
  return r ? "getUTCDate" : "getDate";
}
function DT(r) {
  return r ? "getUTCHours" : "getHours";
}
function LT(r) {
  return r ? "getUTCMinutes" : "getMinutes";
}
function kT(r) {
  return r ? "getUTCSeconds" : "getSeconds";
}
function AT(r) {
  return r ? "getUTCMilliseconds" : "getMilliseconds";
}
function PT(r) {
  if (!kg(r))
    return V(r) ? r : "-";
  var e = (r + "").split(".");
  return e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g, "$1,") + (e.length > 1 ? "." + e[1] : "");
}
function _v(r, e) {
  return r = (r || "").toLowerCase().replace(/-(.)/g, function(t, i) {
    return i.toUpperCase();
  }), e && r && (r = r.charAt(0).toUpperCase() + r.slice(1)), r;
}
var co = uu;
function Hh(r, e, t) {
  var i = "{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";
  function n(u) {
    return u && zt(u) ? u : "-";
  }
  function s(u) {
    return !!(u != null && !isNaN(u) && isFinite(u));
  }
  var a = e === "time", o = r instanceof Date;
  if (a || o) {
    var l = a ? eo(r) : r;
    if (isNaN(+l)) {
      if (o)
        return "-";
    } else return Cv(l, i, t);
  }
  if (e === "ordinal")
    return va(r) ? n(r) : Re(r) && s(r) ? r + "" : "-";
  var h = xa(r);
  return s(h) ? PT(h) : va(r) ? n(r) : typeof r == "boolean" ? r + "" : "-";
}
var Pc = ["a", "b", "c", "d", "e", "f", "g"], ol = function(r, e) {
  return "{" + r + (e ?? "") + "}";
};
function Ev(r, e, t) {
  F(e) || (e = [e]);
  var i = e.length;
  if (!i)
    return "";
  for (var n = e[0].$vars || [], s = 0; s < n.length; s++) {
    var a = Pc[s];
    r = r.replace(ol(a), ol(a, 0));
  }
  for (var o = 0; o < i; o++)
    for (var l = 0; l < n.length; l++) {
      var h = e[o][n[l]];
      r = r.replace(ol(Pc[l], o), t ? $e(h) : h);
    }
  return r;
}
function OT(r, e) {
  var t = V(r) ? {
    color: r,
    extraCssText: e
  } : r || {}, i = t.color, n = t.type;
  e = t.extraCssText;
  var s = t.renderMode || "html";
  if (!i)
    return "";
  if (s === "html")
    return n === "subItem" ? '<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:' + $e(i) + ";" + (e || "") + '"></span>' : '<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:' + $e(i) + ";" + (e || "") + '"></span>';
  var a = t.markerId || "markerX";
  return {
    renderMode: s,
    content: "{" + a + "|}  ",
    style: n === "subItem" ? {
      width: 4,
      height: 4,
      borderRadius: 2,
      backgroundColor: i
    } : {
      width: 10,
      height: 10,
      borderRadius: 5,
      backgroundColor: i
    }
  };
}
function ls(r, e) {
  return e = e || "transparent", V(r) ? r : B(r) && r.colorStops && (r.colorStops[0] || {}).color || e;
}
function Nh(r, e) {
  if (e === "_blank" || e === "blank") {
    var t = window.open();
    t.opener = null, t.location.href = r;
  } else
    window.open(r, e);
}
var ua = M, IT = ["left", "right", "top", "bottom", "width", "height"], Bs = [["width", "left", "right"], ["height", "top", "bottom"]];
function Tv(r, e, t, i, n) {
  var s = 0, a = 0;
  i == null && (i = 1 / 0), n == null && (n = 1 / 0);
  var o = 0;
  e.eachChild(function(l, h) {
    var u = l.getBoundingRect(), d = e.childAt(h + 1), c = d && d.getBoundingRect(), f, p;
    if (r === "horizontal") {
      var m = u.width + (c ? -c.x + u.x : 0);
      f = s + m, f > i || l.newline ? (s = 0, f = m, a += o + t, o = u.height) : o = Math.max(o, u.height);
    } else {
      var g = u.height + (c ? -c.y + u.y : 0);
      p = a + g, p > n || l.newline ? (s += o + t, a = 0, p = g, o = u.width) : o = Math.max(o, u.width);
    }
    l.newline || (l.x = s, l.y = a, l.markRedraw(), r === "horizontal" ? s = f + t : a = p + t);
  });
}
He(Tv, "vertical");
He(Tv, "horizontal");
function zT(r, e, t) {
  var i = e.width, n = e.height, s = Fe(r.left, i), a = Fe(r.top, n), o = Fe(r.right, i), l = Fe(r.bottom, n);
  return (isNaN(s) || isNaN(parseFloat(r.left))) && (s = 0), (isNaN(o) || isNaN(parseFloat(r.right))) && (o = i), (isNaN(a) || isNaN(parseFloat(r.top))) && (a = 0), (isNaN(l) || isNaN(parseFloat(r.bottom))) && (l = n), t = co(t || 0), {
    width: Math.max(o - s - t[1] - t[3], 0),
    height: Math.max(l - a - t[0] - t[2], 0)
  };
}
function fo(r, e, t) {
  t = co(t || 0);
  var i = e.width, n = e.height, s = Fe(r.left, i), a = Fe(r.top, n), o = Fe(r.right, i), l = Fe(r.bottom, n), h = Fe(r.width, i), u = Fe(r.height, n), d = t[2] + t[0], c = t[1] + t[3], f = r.aspect;
  switch (isNaN(h) && (h = i - o - c - s), isNaN(u) && (u = n - l - d - a), f != null && (isNaN(h) && isNaN(u) && (f > i / n ? h = i * 0.8 : u = n * 0.8), isNaN(h) && (h = f * u), isNaN(u) && (u = h / f)), isNaN(s) && (s = i - o - h - c), isNaN(a) && (a = n - l - u - d), r.left || r.right) {
    case "center":
      s = i / 2 - h / 2 - t[3];
      break;
    case "right":
      s = i - h - c;
      break;
  }
  switch (r.top || r.bottom) {
    case "middle":
    case "center":
      a = n / 2 - u / 2 - t[0];
      break;
    case "bottom":
      a = n - u - d;
      break;
  }
  s = s || 0, a = a || 0, isNaN(h) && (h = i - c - s - (o || 0)), isNaN(u) && (u = n - d - a - (l || 0));
  var p = new re(s + t[3], a + t[0], h, u);
  return p.margin = t, p;
}
function FT(r, e, t, i, n, s) {
  s = s || r, s.x = r.x, s.y = r.y;
  var a;
  if (a = r.getBoundingRect(), r.needLocalTransform()) {
    var o = r.getLocalTransform();
    a = a.clone(), a.applyTransform(o);
  }
  var l = fo(ge({
    width: a.width,
    height: a.height
  }, e), t, i), h = l.x - a.x, u = l.y - a.y;
  return s.x += h, s.y += u, s === r && r.markRedraw(), !0;
}
function Aa(r) {
  var e = r.layoutMode || r.constructor.layoutMode;
  return B(e) ? e : e ? {
    type: e
  } : null;
}
function Pa(r, e, t) {
  var i = t && t.ignoreSize;
  !F(i) && (i = [i, i]);
  var n = a(Bs[0], 0), s = a(Bs[1], 1);
  h(Bs[0], r, n), h(Bs[1], r, s);
  function a(u, d) {
    var c = {}, f = 0, p = {}, m = 0, g = 2;
    if (ua(u, function(y) {
      p[y] = r[y];
    }), ua(u, function(y) {
      o(e, y) && (c[y] = p[y] = e[y]), l(c, y) && f++, l(p, y) && m++;
    }), i[d])
      return l(e, u[1]) ? p[u[2]] = null : l(e, u[2]) && (p[u[1]] = null), p;
    if (m === g || !f)
      return p;
    if (f >= g)
      return c;
    for (var v = 0; v < u.length; v++) {
      var b = u[v];
      if (!o(c, b) && o(r, b)) {
        c[b] = r[b];
        break;
      }
    }
    return c;
  }
  function o(u, d) {
    return u.hasOwnProperty(d);
  }
  function l(u, d) {
    return u[d] != null && u[d] !== "auto";
  }
  function h(u, d, c) {
    ua(u, function(f) {
      d[f] = c[f];
    });
  }
}
function xv(r) {
  return HT({}, r);
}
function HT(r, e) {
  return e && r && ua(IT, function(t) {
    e.hasOwnProperty(t) && (r[t] = e[t]);
  }), r;
}
var NT = Te(), ae = (
  /** @class */
  function(r) {
    De(e, r);
    function e(t, i, n) {
      var s = r.call(this, t, i, n) || this;
      return s.uid = uo("ec_cpt_model"), s;
    }
    return e.prototype.init = function(t, i, n) {
      this.mergeDefaultAndTheme(t, n);
    }, e.prototype.mergeDefaultAndTheme = function(t, i) {
      var n = Aa(this), s = n ? xv(t) : {}, a = i.getTheme();
      Ee(t, a.get(this.mainType)), Ee(t, this.getDefaultOption()), n && Pa(t, s, n);
    }, e.prototype.mergeOption = function(t, i) {
      Ee(this.option, t, !0);
      var n = Aa(this);
      n && Pa(this.option, t, n);
    }, e.prototype.optionUpdated = function(t, i) {
    }, e.prototype.getDefaultOption = function() {
      var t = this.constructor;
      if (!KC(t))
        return t.defaultOption;
      var i = NT(this);
      if (!i.defaultOption) {
        for (var n = [], s = t; s; ) {
          var a = s.prototype.defaultOption;
          a && n.push(a), s = s.superClass;
        }
        for (var o = {}, l = n.length - 1; l >= 0; l--)
          o = Ee(o, n[l], !0);
        i.defaultOption = o;
      }
      return i.defaultOption;
    }, e.prototype.getReferringComponents = function(t, i) {
      var n = t + "Index", s = t + "Id";
      return bs(this.ecModel, t, {
        index: this.get(n, !0),
        id: this.get(s, !0)
      }, i);
    }, e.prototype.getBoxLayoutParams = function() {
      var t = this;
      return {
        left: t.get("left"),
        top: t.get("top"),
        right: t.get("right"),
        bottom: t.get("bottom"),
        width: t.get("width"),
        height: t.get("height")
      };
    }, e.prototype.getZLevelKey = function() {
      return "";
    }, e.prototype.setZLevel = function(t) {
      this.option.zlevel = t;
    }, e.protoInitialize = function() {
      var t = e.prototype;
      t.type = "component", t.id = "", t.name = "", t.mainType = "", t.subType = "", t.componentIndex = 0;
    }(), e;
  }(pe)
);
Ng(ae, pe);
wu(ae);
yT(ae);
wT(ae, BT);
function BT(r) {
  var e = [];
  return M(ae.getClassesByMainType(r), function(t) {
    e = e.concat(t.dependencies || t.prototype.dependencies || []);
  }), e = J(e, function(t) {
    return Ft(t).main;
  }), r !== "dataset" && ue(e, "dataset") <= 0 && e.unshift("dataset"), e;
}
var Sv = "";
typeof navigator < "u" && (Sv = navigator.platform || "");
var Tr = "rgba(0, 0, 0, 0.2)";
const VT = {
  darkMode: "auto",
  // backgroundColor: 'rgba(0,0,0,0)',
  colorBy: "series",
  color: ["#5470c6", "#91cc75", "#fac858", "#ee6666", "#73c0de", "#3ba272", "#fc8452", "#9a60b4", "#ea7ccc"],
  gradientColor: ["#f6efa6", "#d88273", "#bf444c"],
  aria: {
    decal: {
      decals: [{
        color: Tr,
        dashArrayX: [1, 0],
        dashArrayY: [2, 5],
        symbolSize: 1,
        rotation: Math.PI / 6
      }, {
        color: Tr,
        symbol: "circle",
        dashArrayX: [[8, 8], [0, 8, 8, 0]],
        dashArrayY: [6, 0],
        symbolSize: 0.8
      }, {
        color: Tr,
        dashArrayX: [1, 0],
        dashArrayY: [4, 3],
        rotation: -Math.PI / 4
      }, {
        color: Tr,
        dashArrayX: [[6, 6], [0, 6, 6, 0]],
        dashArrayY: [6, 0]
      }, {
        color: Tr,
        dashArrayX: [[1, 0], [1, 6]],
        dashArrayY: [1, 0, 6, 0],
        rotation: Math.PI / 4
      }, {
        color: Tr,
        symbol: "triangle",
        dashArrayX: [[9, 9], [0, 9, 9, 0]],
        dashArrayY: [7, 2],
        symbolSize: 0.75
      }]
    }
  },
  // If xAxis and yAxis declared, grid is created by default.
  // grid: {},
  textStyle: {
    // color: '#000',
    // decoration: 'none',
    // PENDING
    fontFamily: Sv.match(/^Win/) ? "Microsoft YaHei" : "sans-serif",
    // fontFamily: 'Arial, Verdana, sans-serif',
    fontSize: 12,
    fontStyle: "normal",
    fontWeight: "normal"
  },
  // http://blogs.adobe.com/webplatform/2014/02/24/using-blend-modes-in-html-canvas/
  // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation
  // Default is source-over
  blendMode: null,
  stateAnimation: {
    duration: 300,
    easing: "cubicOut"
  },
  animation: "auto",
  animationDuration: 1e3,
  animationDurationUpdate: 500,
  animationEasing: "cubicInOut",
  animationEasingUpdate: "cubicInOut",
  animationThreshold: 2e3,
  // Configuration for progressive/incremental rendering
  progressiveThreshold: 3e3,
  progressive: 400,
  // Threshold of if use single hover layer to optimize.
  // It is recommended that `hoverLayerThreshold` is equivalent to or less than
  // `progressiveThreshold`, otherwise hover will cause restart of progressive,
  // which is unexpected.
  // see example <echarts/test/heatmap-large.html>.
  hoverLayerThreshold: 3e3,
  // See: module:echarts/scale/Time
  useUTC: !1
};
var Bh = Z(["tooltip", "label", "itemName", "itemId", "itemGroupId", "itemChildGroupId", "seriesName"]), Bt = "original", Qe = "arrayRows", Vt = "objectRows", ni = "keyedColumns", Jt = "typedArray", Rv = "unknown", Qt = "column", an = "row", tt = {
  Must: 1,
  Might: 2,
  Not: 3
  // Other cases
}, WT = Te();
function GT(r) {
  WT(r).datasetMap = Z();
}
function UT(r) {
  var e = r.get("data", !0);
  if (!e)
    return bs(r.ecModel, "dataset", {
      index: r.get("datasetIndex", !0),
      id: r.get("datasetId", !0)
    }, bu).models[0];
}
function jT(r) {
  return !r.get("transform", !0) && !r.get("fromTransformResult", !0) ? [] : bs(r.ecModel, "dataset", {
    index: r.get("fromDatasetIndex", !0),
    id: r.get("fromDatasetId", !0)
  }, bu).models;
}
function Mv(r, e) {
  return YT(r.data, r.sourceFormat, r.seriesLayoutBy, r.dimensionsDefine, r.startIndex, e);
}
function YT(r, e, t, i, n, s) {
  var a, o = 5;
  if (Ge(r))
    return tt.Not;
  var l, h;
  if (i) {
    var u = i[s];
    B(u) ? (l = u.name, h = u.type) : V(u) && (l = u);
  }
  if (h != null)
    return h === "ordinal" ? tt.Must : tt.Not;
  if (e === Qe) {
    var d = r;
    if (t === an) {
      for (var c = d[s], f = 0; f < (c || []).length && f < o; f++)
        if ((a = w(c[n + f])) != null)
          return a;
    } else
      for (var f = 0; f < d.length && f < o; f++) {
        var p = d[n + f];
        if (p && (a = w(p[s])) != null)
          return a;
      }
  } else if (e === Vt) {
    var m = r;
    if (!l)
      return tt.Not;
    for (var f = 0; f < m.length && f < o; f++) {
      var g = m[f];
      if (g && (a = w(g[l])) != null)
        return a;
    }
  } else if (e === ni) {
    var v = r;
    if (!l)
      return tt.Not;
    var c = v[l];
    if (!c || Ge(c))
      return tt.Not;
    for (var f = 0; f < c.length && f < o; f++)
      if ((a = w(c[f])) != null)
        return a;
  } else if (e === Bt)
    for (var b = r, f = 0; f < b.length && f < o; f++) {
      var g = b[f], y = io(g);
      if (!F(y))
        return tt.Not;
      if ((a = w(y[s])) != null)
        return a;
    }
  function w(_) {
    var E = V(_);
    if (_ != null && Number.isFinite(Number(_)) && _ !== "")
      return E ? tt.Might : tt.Not;
    if (E && _ !== "-")
      return tt.Must;
  }
  return tt.Not;
}
var XT = Z();
function $T(r, e, t) {
  var i = XT.get(e);
  if (!i)
    return t;
  var n = i(r);
  if (!n)
    return t;
  if (process.env.NODE_ENV !== "production")
    for (var s = 0; s < n.length; s++)
      Y(qr(n[s]));
  return t.concat(n);
}
var Oc = Te(), qT = Te(), Nu = (
  /** @class */
  function() {
    function r() {
    }
    return r.prototype.getColorFromPalette = function(e, t, i) {
      var n = Me(this.get("color", !0)), s = this.get("colorLayer", !0);
      return Dv(this, Oc, n, s, e, t, i);
    }, r.prototype.clearColorPalette = function() {
      JT(this, Oc);
    }, r;
  }()
);
function KT(r, e, t, i) {
  var n = Me(r.get(["aria", "decal", "decals"]));
  return Dv(r, qT, n, null, e, t, i);
}
function ZT(r, e) {
  for (var t = r.length, i = 0; i < t; i++)
    if (r[i].length > e)
      return r[i];
  return r[t - 1];
}
function Dv(r, e, t, i, n, s, a) {
  s = s || r;
  var o = e(s), l = o.paletteIdx || 0, h = o.paletteNameMap = o.paletteNameMap || {};
  if (h.hasOwnProperty(n))
    return h[n];
  var u = a == null || !i ? t : ZT(i, a);
  if (u = u || t, !(!u || !u.length)) {
    var d = u[l];
    return n && (h[n] = d), o.paletteIdx = (l + 1) % u.length, d;
  }
}
function JT(r, e) {
  e(r).paletteIdx = 0, e(r).paletteNameMap = {};
}
var Vs, yn, Ic, ll = "\0_ec_inner", zc = 1, QT = {
  grid: "GridComponent",
  polar: "PolarComponent",
  geo: "GeoComponent",
  singleAxis: "SingleAxisComponent",
  parallel: "ParallelComponent",
  calendar: "CalendarComponent",
  graphic: "GraphicComponent",
  toolbox: "ToolboxComponent",
  tooltip: "TooltipComponent",
  axisPointer: "AxisPointerComponent",
  brush: "BrushComponent",
  title: "TitleComponent",
  timeline: "TimelineComponent",
  markPoint: "MarkPointComponent",
  markLine: "MarkLineComponent",
  markArea: "MarkAreaComponent",
  legend: "LegendComponent",
  dataZoom: "DataZoomComponent",
  visualMap: "VisualMapComponent",
  // aria: 'AriaComponent',
  // dataset: 'DatasetComponent',
  // Dependencies
  xAxis: "GridComponent",
  yAxis: "GridComponent",
  angleAxis: "PolarComponent",
  radiusAxis: "PolarComponent"
}, ex = {
  line: "LineChart",
  bar: "BarChart",
  pie: "PieChart",
  scatter: "ScatterChart",
  radar: "RadarChart",
  map: "MapChart",
  tree: "TreeChart",
  treemap: "TreemapChart",
  graph: "GraphChart",
  gauge: "GaugeChart",
  funnel: "FunnelChart",
  parallel: "ParallelChart",
  sankey: "SankeyChart",
  boxplot: "BoxplotChart",
  candlestick: "CandlestickChart",
  effectScatter: "EffectScatterChart",
  lines: "LinesChart",
  heatmap: "HeatmapChart",
  pictorialBar: "PictorialBarChart",
  themeRiver: "ThemeRiverChart",
  sunburst: "SunburstChart",
  custom: "CustomChart"
}, Oa = {};
function tx(r) {
  M(r, function(e, t) {
    if (!ae.hasClass(t)) {
      var i = QT[t];
      i && !Oa[i] && (Ne("Component " + t + ` is used but not imported.
import { ` + i + ` } from 'echarts/components';
echarts.use([` + i + "]);"), Oa[i] = !0);
    }
  });
}
var Bu = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      return r !== null && r.apply(this, arguments) || this;
    }
    return e.prototype.init = function(t, i, n, s, a, o) {
      s = s || {}, this.option = null, this._theme = new pe(s), this._locale = new pe(a), this._optionManager = o;
    }, e.prototype.setOption = function(t, i, n) {
      process.env.NODE_ENV !== "production" && (Y(t != null, "option is null/undefined"), Y(t[ll] !== zc, "please use chart.getOption()"));
      var s = Nc(i);
      this._optionManager.setOption(t, n, s), this._resetOption(null, s);
    }, e.prototype.resetOption = function(t, i) {
      return this._resetOption(t, Nc(i));
    }, e.prototype._resetOption = function(t, i) {
      var n = !1, s = this._optionManager;
      if (!t || t === "recreate") {
        var a = s.mountOption(t === "recreate");
        process.env.NODE_ENV !== "production" && tx(a), !this.option || t === "recreate" ? Ic(this, a) : (this.restoreData(), this._mergeOption(a, i)), n = !0;
      }
      if ((t === "timeline" || t === "media") && this.restoreData(), !t || t === "recreate" || t === "timeline") {
        var o = s.getTimelineOption(this);
        o && (n = !0, this._mergeOption(o, i));
      }
      if (!t || t === "recreate" || t === "media") {
        var l = s.getMediaOption(this);
        l.length && M(l, function(h) {
          n = !0, this._mergeOption(h, i);
        }, this);
      }
      return n;
    }, e.prototype.mergeOption = function(t) {
      this._mergeOption(t, null);
    }, e.prototype._mergeOption = function(t, i) {
      var n = this.option, s = this._componentsMap, a = this._componentsCount, o = [], l = Z(), h = i && i.replaceMergeMainTypeMap;
      GT(this), M(t, function(d, c) {
        d != null && (ae.hasClass(c) ? c && (o.push(c), l.set(c, !0)) : n[c] = n[c] == null ? $(d) : Ee(n[c], d, !0));
      }), h && h.each(function(d, c) {
        ae.hasClass(c) && !l.get(c) && (o.push(c), l.set(c, !0));
      }), ae.topologicalTravel(o, ae.getAllClassMainTypes(), u, this);
      function u(d) {
        var c = $T(this, d, Me(t[d])), f = s.get(d), p = (
          // `!oldCmptList` means init. See the comment in `mappingToExists`
          f ? h && h.get(d) ? "replaceMerge" : "normalMerge" : "replaceAll"
        ), m = zC(f, c, p);
        GC(m, d, ae), n[d] = null, s.set(d, null), a.set(d, 0);
        var g = [], v = [], b = 0, y, w;
        M(m, function(_, E) {
          var x = _.existing, T = _.newOption;
          if (!T)
            x && (x.mergeOption({}, this), x.optionUpdated({}, !1));
          else {
            var C = d === "series", S = ae.getClass(
              d,
              _.keyInfo.subType,
              !C
              // Give a more detailed warn later if series don't exists
            );
            if (!S) {
              if (process.env.NODE_ENV !== "production") {
                var R = _.keyInfo.subType, D = ex[R];
                Oa[R] || (Oa[R] = !0, Ne(D ? "Series " + R + ` is used but not imported.
import { ` + D + ` } from 'echarts/charts';
echarts.use([` + D + "]);" : "Unknown series " + R));
              }
              return;
            }
            if (d === "tooltip") {
              if (y) {
                process.env.NODE_ENV !== "production" && (w || (wt("Currently only one tooltip component is allowed."), w = !0));
                return;
              }
              y = !0;
            }
            if (x && x.constructor === S)
              x.name = _.keyInfo.name, x.mergeOption(T, this), x.optionUpdated(T, !1);
            else {
              var k = P({
                componentIndex: E
              }, _.keyInfo);
              x = new S(T, this, this, k), P(x, k), _.brandNew && (x.__requireNewView = !0), x.init(T, this, this), x.optionUpdated(null, !0);
            }
          }
          x ? (g.push(x.option), v.push(x), b++) : (g.push(void 0), v.push(void 0));
        }, this), n[d] = g, s.set(d, v), a.set(d, b), d === "series" && Vs(this);
      }
      this._seriesIndices || Vs(this);
    }, e.prototype.getOption = function() {
      var t = $(this.option);
      return M(t, function(i, n) {
        if (ae.hasClass(n)) {
          for (var s = Me(i), a = s.length, o = !1, l = a - 1; l >= 0; l--)
            s[l] && !qr(s[l]) ? o = !0 : (s[l] = null, !o && a--);
          s.length = a, t[n] = s;
        }
      }), delete t[ll], t;
    }, e.prototype.getTheme = function() {
      return this._theme;
    }, e.prototype.getLocaleModel = function() {
      return this._locale;
    }, e.prototype.setUpdatePayload = function(t) {
      this._payload = t;
    }, e.prototype.getUpdatePayload = function() {
      return this._payload;
    }, e.prototype.getComponent = function(t, i) {
      var n = this._componentsMap.get(t);
      if (n) {
        var s = n[i || 0];
        if (s)
          return s;
        if (i == null) {
          for (var a = 0; a < n.length; a++)
            if (n[a])
              return n[a];
        }
      }
    }, e.prototype.queryComponents = function(t) {
      var i = t.mainType;
      if (!i)
        return [];
      var n = t.index, s = t.id, a = t.name, o = this._componentsMap.get(i);
      if (!o || !o.length)
        return [];
      var l;
      return n != null ? (l = [], M(Me(n), function(h) {
        o[h] && l.push(o[h]);
      })) : s != null ? l = Fc("id", s, o) : a != null ? l = Fc("name", a, o) : l = bt(o, function(h) {
        return !!h;
      }), Hc(l, t);
    }, e.prototype.findComponents = function(t) {
      var i = t.query, n = t.mainType, s = o(i), a = s ? this.queryComponents(s) : bt(this._componentsMap.get(n), function(h) {
        return !!h;
      });
      return l(Hc(a, t));
      function o(h) {
        var u = n + "Index", d = n + "Id", c = n + "Name";
        return h && (h[u] != null || h[d] != null || h[c] != null) ? {
          mainType: n,
          // subType will be filtered finally.
          index: h[u],
          id: h[d],
          name: h[c]
        } : null;
      }
      function l(h) {
        return t.filter ? bt(h, t.filter) : h;
      }
    }, e.prototype.eachComponent = function(t, i, n) {
      var s = this._componentsMap;
      if (q(t)) {
        var a = i, o = t;
        s.each(function(d, c) {
          for (var f = 0; d && f < d.length; f++) {
            var p = d[f];
            p && o.call(a, c, p, p.componentIndex);
          }
        });
      } else
        for (var l = V(t) ? s.get(t) : B(t) ? this.findComponents(t) : null, h = 0; l && h < l.length; h++) {
          var u = l[h];
          u && i.call(n, u, u.componentIndex);
        }
    }, e.prototype.getSeriesByName = function(t) {
      var i = at(t, null);
      return bt(this._componentsMap.get("series"), function(n) {
        return !!n && i != null && n.name === i;
      });
    }, e.prototype.getSeriesByIndex = function(t) {
      return this._componentsMap.get("series")[t];
    }, e.prototype.getSeriesByType = function(t) {
      return bt(this._componentsMap.get("series"), function(i) {
        return !!i && i.subType === t;
      });
    }, e.prototype.getSeries = function() {
      return bt(this._componentsMap.get("series"), function(t) {
        return !!t;
      });
    }, e.prototype.getSeriesCount = function() {
      return this._componentsCount.get("series");
    }, e.prototype.eachSeries = function(t, i) {
      yn(this), M(this._seriesIndices, function(n) {
        var s = this._componentsMap.get("series")[n];
        t.call(i, s, n);
      }, this);
    }, e.prototype.eachRawSeries = function(t, i) {
      M(this._componentsMap.get("series"), function(n) {
        n && t.call(i, n, n.componentIndex);
      });
    }, e.prototype.eachSeriesByType = function(t, i, n) {
      yn(this), M(this._seriesIndices, function(s) {
        var a = this._componentsMap.get("series")[s];
        a.subType === t && i.call(n, a, s);
      }, this);
    }, e.prototype.eachRawSeriesByType = function(t, i, n) {
      return M(this.getSeriesByType(t), i, n);
    }, e.prototype.isSeriesFiltered = function(t) {
      return yn(this), this._seriesIndicesMap.get(t.componentIndex) == null;
    }, e.prototype.getCurrentSeriesIndices = function() {
      return (this._seriesIndices || []).slice();
    }, e.prototype.filterSeries = function(t, i) {
      yn(this);
      var n = [];
      M(this._seriesIndices, function(s) {
        var a = this._componentsMap.get("series")[s];
        t.call(i, a, s) && n.push(s);
      }, this), this._seriesIndices = n, this._seriesIndicesMap = Z(n);
    }, e.prototype.restoreData = function(t) {
      Vs(this);
      var i = this._componentsMap, n = [];
      i.each(function(s, a) {
        ae.hasClass(a) && n.push(a);
      }), ae.topologicalTravel(n, ae.getAllClassMainTypes(), function(s) {
        M(i.get(s), function(a) {
          a && (s !== "series" || !ix(a, t)) && a.restoreData();
        });
      });
    }, e.internalField = function() {
      Vs = function(t) {
        var i = t._seriesIndices = [];
        M(t._componentsMap.get("series"), function(n) {
          n && i.push(n.componentIndex);
        }), t._seriesIndicesMap = Z(i);
      }, yn = function(t) {
        if (process.env.NODE_ENV !== "production" && !t._seriesIndices)
          throw new Error("Option should contains series.");
      }, Ic = function(t, i) {
        t.option = {}, t.option[ll] = zc, t._componentsMap = Z({
          series: []
        }), t._componentsCount = Z();
        var n = i.aria;
        B(n) && n.enabled == null && (n.enabled = !0), rx(i, t._theme.option), Ee(i, VT, !1), t._mergeOption(i, null);
      };
    }(), e;
  }(pe)
);
function ix(r, e) {
  if (e) {
    var t = e.seriesIndex, i = e.seriesId, n = e.seriesName;
    return t != null && r.componentIndex !== t || i != null && r.id !== i || n != null && r.name !== n;
  }
}
function rx(r, e) {
  var t = r.color && !r.colorLayer;
  M(e, function(i, n) {
    n === "colorLayer" && t || ae.hasClass(n) || (typeof i == "object" ? r[n] = r[n] ? Ee(r[n], i, !1) : $(i) : r[n] == null && (r[n] = i));
  });
}
function Fc(r, e, t) {
  if (F(e)) {
    var i = Z();
    return M(e, function(s) {
      if (s != null) {
        var a = at(s, null);
        a != null && i.set(s, !0);
      }
    }), bt(t, function(s) {
      return s && i.get(s[r]);
    });
  } else {
    var n = at(e, null);
    return bt(t, function(s) {
      return s && n != null && s[r] === n;
    });
  }
}
function Hc(r, e) {
  return e.hasOwnProperty("subType") ? bt(r, function(t) {
    return t && t.subType === e.subType;
  }) : r;
}
function Nc(r) {
  var e = Z();
  return r && M(Me(r.replaceMerge), function(t) {
    process.env.NODE_ENV !== "production" && Y(ae.hasClass(t), '"' + t + '" is not valid component main type in "replaceMerge"'), e.set(t, !0);
  }), {
    replaceMergeMainTypeMap: e
  };
}
ii(Bu, Nu);
var nx = [
  "getDom",
  "getZr",
  "getWidth",
  "getHeight",
  "getDevicePixelRatio",
  "dispatchAction",
  "isSSR",
  "isDisposed",
  "on",
  "off",
  "getDataURL",
  "getConnectedDataURL",
  // 'getModel',
  "getOption",
  // 'getViewOfComponentModel',
  // 'getViewOfSeriesModel',
  "getId",
  "updateLabelLayout"
], Lv = (
  /** @class */
  /* @__PURE__ */ function() {
    function r(e) {
      M(nx, function(t) {
        this[t] = K(e[t], e);
      }, this);
    }
    return r;
  }()
), hl = {}, kv = (
  /** @class */
  function() {
    function r() {
      this._coordinateSystems = [];
    }
    return r.prototype.create = function(e, t) {
      var i = [];
      M(hl, function(n, s) {
        var a = n.create(e, t);
        i = i.concat(a || []);
      }), this._coordinateSystems = i;
    }, r.prototype.update = function(e, t) {
      M(this._coordinateSystems, function(i) {
        i.update && i.update(e, t);
      });
    }, r.prototype.getCoordinateSystems = function() {
      return this._coordinateSystems.slice();
    }, r.register = function(e, t) {
      hl[e] = t;
    }, r.get = function(e) {
      return hl[e];
    }, r;
  }()
), sx = /^(min|max)?(.+)$/, ax = (
  /** @class */
  function() {
    function r(e) {
      this._timelineOptions = [], this._mediaList = [], this._currentMediaIndices = [], this._api = e;
    }
    return r.prototype.setOption = function(e, t, i) {
      e && (M(Me(e.series), function(a) {
        a && a.data && Ge(a.data) && uh(a.data);
      }), M(Me(e.dataset), function(a) {
        a && a.source && Ge(a.source) && uh(a.source);
      })), e = $(e);
      var n = this._optionBackup, s = ox(e, t, !n);
      this._newBaseOption = s.baseOption, n ? (s.timelineOptions.length && (n.timelineOptions = s.timelineOptions), s.mediaList.length && (n.mediaList = s.mediaList), s.mediaDefault && (n.mediaDefault = s.mediaDefault)) : this._optionBackup = s;
    }, r.prototype.mountOption = function(e) {
      var t = this._optionBackup;
      return this._timelineOptions = t.timelineOptions, this._mediaList = t.mediaList, this._mediaDefault = t.mediaDefault, this._currentMediaIndices = [], $(e ? t.baseOption : this._newBaseOption);
    }, r.prototype.getTimelineOption = function(e) {
      var t, i = this._timelineOptions;
      if (i.length) {
        var n = e.getComponent("timeline");
        n && (t = $(
          // FIXME:TS as TimelineModel or quivlant interface
          i[n.getCurrentIndex()]
        ));
      }
      return t;
    }, r.prototype.getMediaOption = function(e) {
      var t = this._api.getWidth(), i = this._api.getHeight(), n = this._mediaList, s = this._mediaDefault, a = [], o = [];
      if (!n.length && !s)
        return o;
      for (var l = 0, h = n.length; l < h; l++)
        lx(n[l].query, t, i) && a.push(l);
      return !a.length && s && (a = [-1]), a.length && !ux(a, this._currentMediaIndices) && (o = J(a, function(u) {
        return $(u === -1 ? s.option : n[u].option);
      })), this._currentMediaIndices = a, o;
    }, r;
  }()
);
function ox(r, e, t) {
  var i = [], n, s, a = r.baseOption, o = r.timeline, l = r.options, h = r.media, u = !!r.media, d = !!(l || o || a && a.timeline);
  a ? (s = a, s.timeline || (s.timeline = o)) : ((d || u) && (r.options = r.media = null), s = r), u && (F(h) ? M(h, function(f) {
    process.env.NODE_ENV !== "production" && f && !f.option && B(f.query) && B(f.query.option) && Ne("Illegal media option. Must be like { media: [ { query: {}, option: {} } ] }"), f && f.option && (f.query ? i.push(f) : n || (n = f));
  }) : process.env.NODE_ENV !== "production" && Ne("Illegal media option. Must be an array. Like { media: [ {...}, {...} ] }")), c(s), M(l, function(f) {
    return c(f);
  }), M(i, function(f) {
    return c(f.option);
  });
  function c(f) {
    M(e, function(p) {
      p(f, t);
    });
  }
  return {
    baseOption: s,
    timelineOptions: l || [],
    mediaDefault: n,
    mediaList: i
  };
}
function lx(r, e, t) {
  var i = {
    width: e,
    height: t,
    aspectratio: e / t
    // lower case for convenience.
  }, n = !0;
  return M(r, function(s, a) {
    var o = a.match(sx);
    if (!(!o || !o[1] || !o[2])) {
      var l = o[1], h = o[2].toLowerCase();
      hx(i[h], s, l) || (n = !1);
    }
  }), n;
}
function hx(r, e, t) {
  return t === "min" ? r >= e : t === "max" ? r <= e : r === e;
}
function ux(r, e) {
  return r.join(",") === e.join(",");
}
var dt = M, hs = B, Bc = ["areaStyle", "lineStyle", "nodeStyle", "linkStyle", "chordStyle", "label", "labelLine"];
function ul(r) {
  var e = r && r.itemStyle;
  if (e)
    for (var t = 0, i = Bc.length; t < i; t++) {
      var n = Bc[t], s = e.normal, a = e.emphasis;
      s && s[n] && (process.env.NODE_ENV !== "production" && Se("itemStyle.normal." + n, n), r[n] = r[n] || {}, r[n].normal ? Ee(r[n].normal, s[n]) : r[n].normal = s[n], s[n] = null), a && a[n] && (process.env.NODE_ENV !== "production" && Se("itemStyle.emphasis." + n, "emphasis." + n), r[n] = r[n] || {}, r[n].emphasis ? Ee(r[n].emphasis, a[n]) : r[n].emphasis = a[n], a[n] = null);
    }
}
function Ie(r, e, t) {
  if (r && r[e] && (r[e].normal || r[e].emphasis)) {
    var i = r[e].normal, n = r[e].emphasis;
    i && (process.env.NODE_ENV !== "production" && Nt("'normal' hierarchy in " + e + " has been removed since 4.0. All style properties are configured in " + e + " directly now."), t ? (r[e].normal = r[e].emphasis = null, ge(r[e], i)) : r[e] = i), n && (process.env.NODE_ENV !== "production" && Nt(e + ".emphasis has been changed to emphasis." + e + " since 4.0"), r.emphasis = r.emphasis || {}, r.emphasis[e] = n, n.focus && (r.emphasis.focus = n.focus), n.blurScope && (r.emphasis.blurScope = n.blurScope));
  }
}
function Hn(r) {
  Ie(r, "itemStyle"), Ie(r, "lineStyle"), Ie(r, "areaStyle"), Ie(r, "label"), Ie(r, "labelLine"), Ie(r, "upperLabel"), Ie(r, "edgeLabel");
}
function _e(r, e) {
  var t = hs(r) && r[e], i = hs(t) && t.textStyle;
  if (i) {
    process.env.NODE_ENV !== "production" && Nt("textStyle hierarchy in " + e + " has been removed since 4.0. All textStyle properties are configured in " + e + " directly now.");
    for (var n = 0, s = jd.length; n < s; n++) {
      var a = jd[n];
      i.hasOwnProperty(a) && (t[a] = i[a]);
    }
  }
}
function vt(r) {
  r && (Hn(r), _e(r, "label"), r.emphasis && _e(r.emphasis, "label"));
}
function dx(r) {
  if (hs(r)) {
    ul(r), Hn(r), _e(r, "label"), _e(r, "upperLabel"), _e(r, "edgeLabel"), r.emphasis && (_e(r.emphasis, "label"), _e(r.emphasis, "upperLabel"), _e(r.emphasis, "edgeLabel"));
    var e = r.markPoint;
    e && (ul(e), vt(e));
    var t = r.markLine;
    t && (ul(t), vt(t));
    var i = r.markArea;
    i && vt(i);
    var n = r.data;
    if (r.type === "graph") {
      n = n || r.nodes;
      var s = r.links || r.edges;
      if (s && !Ge(s))
        for (var a = 0; a < s.length; a++)
          vt(s[a]);
      M(r.categories, function(h) {
        Hn(h);
      });
    }
    if (n && !Ge(n))
      for (var a = 0; a < n.length; a++)
        vt(n[a]);
    if (e = r.markPoint, e && e.data)
      for (var o = e.data, a = 0; a < o.length; a++)
        vt(o[a]);
    if (t = r.markLine, t && t.data)
      for (var l = t.data, a = 0; a < l.length; a++)
        F(l[a]) ? (vt(l[a][0]), vt(l[a][1])) : vt(l[a]);
    r.type === "gauge" ? (_e(r, "axisLabel"), _e(r, "title"), _e(r, "detail")) : r.type === "treemap" ? (Ie(r.breadcrumb, "itemStyle"), M(r.levels, function(h) {
      Hn(h);
    })) : r.type === "tree" && Hn(r.leaves);
  }
}
function Yt(r) {
  return F(r) ? r : r ? [r] : [];
}
function Vc(r) {
  return (F(r) ? r[0] : r) || {};
}
function cx(r, e) {
  dt(Yt(r.series), function(i) {
    hs(i) && dx(i);
  });
  var t = ["xAxis", "yAxis", "radiusAxis", "angleAxis", "singleAxis", "parallelAxis", "radar"];
  e && t.push("valueAxis", "categoryAxis", "logAxis", "timeAxis"), dt(t, function(i) {
    dt(Yt(r[i]), function(n) {
      n && (_e(n, "axisLabel"), _e(n.axisPointer, "label"));
    });
  }), dt(Yt(r.parallel), function(i) {
    var n = i && i.parallelAxisDefault;
    _e(n, "axisLabel"), _e(n && n.axisPointer, "label");
  }), dt(Yt(r.calendar), function(i) {
    Ie(i, "itemStyle"), _e(i, "dayLabel"), _e(i, "monthLabel"), _e(i, "yearLabel");
  }), dt(Yt(r.radar), function(i) {
    _e(i, "name"), i.name && i.axisName == null && (i.axisName = i.name, delete i.name, process.env.NODE_ENV !== "production" && Nt("name property in radar component has been changed to axisName")), i.nameGap != null && i.axisNameGap == null && (i.axisNameGap = i.nameGap, delete i.nameGap, process.env.NODE_ENV !== "production" && Nt("nameGap property in radar component has been changed to axisNameGap")), process.env.NODE_ENV !== "production" && dt(i.indicator, function(n) {
      n.text && Se("text", "name", "radar.indicator");
    });
  }), dt(Yt(r.geo), function(i) {
    hs(i) && (vt(i), dt(Yt(i.regions), function(n) {
      vt(n);
    }));
  }), dt(Yt(r.timeline), function(i) {
    vt(i), Ie(i, "label"), Ie(i, "itemStyle"), Ie(i, "controlStyle", !0);
    var n = i.data;
    F(n) && M(n, function(s) {
      B(s) && (Ie(s, "label"), Ie(s, "itemStyle"));
    });
  }), dt(Yt(r.toolbox), function(i) {
    Ie(i, "iconStyle"), dt(i.feature, function(n) {
      Ie(n, "iconStyle");
    });
  }), _e(Vc(r.axisPointer), "label"), _e(Vc(r.tooltip).axisPointer, "label");
}
function fx(r, e) {
  for (var t = e.split(","), i = r, n = 0; n < t.length && (i = i && i[t[n]], i != null); n++)
    ;
  return i;
}
function px(r, e, t, i) {
  for (var n = e.split(","), s = r, a, o = 0; o < n.length - 1; o++)
    a = n[o], s[a] == null && (s[a] = {}), s = s[a];
  s[n[o]] == null && (s[n[o]] = t);
}
function Wc(r) {
  r && M(gx, function(e) {
    e[0] in r && !(e[1] in r) && (r[e[1]] = r[e[0]]);
  });
}
var gx = [["x", "left"], ["y", "top"], ["x2", "right"], ["y2", "bottom"]], vx = ["grid", "geo", "parallel", "legend", "toolbox", "title", "visualMap", "dataZoom", "timeline"], dl = [["borderRadius", "barBorderRadius"], ["borderColor", "barBorderColor"], ["borderWidth", "barBorderWidth"]];
function wn(r) {
  var e = r && r.itemStyle;
  if (e)
    for (var t = 0; t < dl.length; t++) {
      var i = dl[t][1], n = dl[t][0];
      e[i] != null && (e[n] = e[i], process.env.NODE_ENV !== "production" && Se(i, n));
    }
}
function Gc(r) {
  r && r.alignTo === "edge" && r.margin != null && r.edgeDistance == null && (process.env.NODE_ENV !== "production" && Se("label.margin", "label.edgeDistance", "pie"), r.edgeDistance = r.margin);
}
function Uc(r) {
  r && r.downplay && !r.blur && (r.blur = r.downplay, process.env.NODE_ENV !== "production" && Se("downplay", "blur", "sunburst"));
}
function mx(r) {
  r && r.focusNodeAdjacency != null && (r.emphasis = r.emphasis || {}, r.emphasis.focus == null && (process.env.NODE_ENV !== "production" && Se("focusNodeAdjacency", "emphasis: { focus: 'adjacency'}", "graph/sankey"), r.emphasis.focus = "adjacency"));
}
function Av(r, e) {
  if (r)
    for (var t = 0; t < r.length; t++)
      e(r[t]), r[t] && Av(r[t].children, e);
}
function Pv(r, e) {
  cx(r, e), r.series = Me(r.series), M(r.series, function(t) {
    if (B(t)) {
      var i = t.type;
      if (i === "line")
        t.clipOverflow != null && (t.clip = t.clipOverflow, process.env.NODE_ENV !== "production" && Se("clipOverflow", "clip", "line"));
      else if (i === "pie" || i === "gauge") {
        t.clockWise != null && (t.clockwise = t.clockWise, process.env.NODE_ENV !== "production" && Se("clockWise", "clockwise")), Gc(t.label);
        var n = t.data;
        if (n && !Ge(n))
          for (var s = 0; s < n.length; s++)
            Gc(n[s]);
        t.hoverOffset != null && (t.emphasis = t.emphasis || {}, (t.emphasis.scaleSize = null) && (process.env.NODE_ENV !== "production" && Se("hoverOffset", "emphasis.scaleSize"), t.emphasis.scaleSize = t.hoverOffset));
      } else if (i === "gauge") {
        var a = fx(t, "pointer.color");
        a != null && px(t, "itemStyle.color", a);
      } else if (i === "bar") {
        wn(t), wn(t.backgroundStyle), wn(t.emphasis);
        var n = t.data;
        if (n && !Ge(n))
          for (var s = 0; s < n.length; s++)
            typeof n[s] == "object" && (wn(n[s]), wn(n[s] && n[s].emphasis));
      } else if (i === "sunburst") {
        var o = t.highlightPolicy;
        o && (t.emphasis = t.emphasis || {}, t.emphasis.focus || (t.emphasis.focus = o, process.env.NODE_ENV !== "production" && Se("highlightPolicy", "emphasis.focus", "sunburst"))), Uc(t), Av(t.data, Uc);
      } else i === "graph" || i === "sankey" ? mx(t) : i === "map" && (t.mapType && !t.map && (process.env.NODE_ENV !== "production" && Se("mapType", "map", "map"), t.map = t.mapType), t.mapLocation && (process.env.NODE_ENV !== "production" && Nt("`mapLocation` is not used anymore."), ge(t, t.mapLocation)));
      t.hoverAnimation != null && (t.emphasis = t.emphasis || {}, t.emphasis && t.emphasis.scale == null && (process.env.NODE_ENV !== "production" && Se("hoverAnimation", "emphasis.scale"), t.emphasis.scale = t.hoverAnimation)), Wc(t);
    }
  }), r.dataRange && (r.visualMap = r.dataRange), M(vx, function(t) {
    var i = r[t];
    i && (F(i) || (i = [i]), M(i, function(n) {
      Wc(n);
    }));
  });
}
function bx(r) {
  var e = Z();
  r.eachSeries(function(t) {
    var i = t.get("stack");
    if (i) {
      var n = e.get(i) || e.set(i, []), s = t.getData(), a = {
        // Used for calculate axis extent automatically.
        // TODO: Type getCalculationInfo return more specific type?
        stackResultDimension: s.getCalculationInfo("stackResultDimension"),
        stackedOverDimension: s.getCalculationInfo("stackedOverDimension"),
        stackedDimension: s.getCalculationInfo("stackedDimension"),
        stackedByDimension: s.getCalculationInfo("stackedByDimension"),
        isStackedByIndex: s.getCalculationInfo("isStackedByIndex"),
        data: s,
        seriesModel: t
      };
      if (!a.stackedDimension || !(a.isStackedByIndex || a.stackedByDimension))
        return;
      n.length && s.setCalculationInfo("stackedOnSeries", n[n.length - 1].seriesModel), n.push(a);
    }
  }), e.each(yx);
}
function yx(r) {
  M(r, function(e, t) {
    var i = [], n = [NaN, NaN], s = [e.stackResultDimension, e.stackedOverDimension], a = e.data, o = e.isStackedByIndex, l = e.seriesModel.get("stackStrategy") || "samesign";
    a.modify(s, function(h, u, d) {
      var c = a.get(e.stackedDimension, d);
      if (isNaN(c))
        return n;
      var f, p;
      o ? p = a.getRawIndex(d) : f = a.get(e.stackedByDimension, d);
      for (var m = NaN, g = t - 1; g >= 0; g--) {
        var v = r[g];
        if (o || (p = v.data.rawIndexOf(v.stackedByDimension, f)), p >= 0) {
          var b = v.data.getByRawIndex(v.stackResultDimension, p);
          if (l === "all" || l === "positive" && b > 0 || l === "negative" && b < 0 || l === "samesign" && c >= 0 && b > 0 || l === "samesign" && c <= 0 && b < 0) {
            c = DC(c, b), m = b;
            break;
          }
        }
      }
      return i[0] = c, i[1] = m, i;
    });
  });
}
var po = (
  /** @class */
  /* @__PURE__ */ function() {
    function r(e) {
      this.data = e.data || (e.sourceFormat === ni ? {} : []), this.sourceFormat = e.sourceFormat || Rv, this.seriesLayoutBy = e.seriesLayoutBy || Qt, this.startIndex = e.startIndex || 0, this.dimensionsDetectedCount = e.dimensionsDetectedCount, this.metaRawOption = e.metaRawOption;
      var t = this.dimensionsDefine = e.dimensionsDefine;
      if (t)
        for (var i = 0; i < t.length; i++) {
          var n = t[i];
          n.type == null && Mv(this, i) === tt.Must && (n.type = "ordinal");
        }
    }
    return r;
  }()
);
function Vu(r) {
  return r instanceof po;
}
function Vh(r, e, t) {
  t = t || Iv(r);
  var i = e.seriesLayoutBy, n = _x(r, t, i, e.sourceHeader, e.dimensions), s = new po({
    data: r,
    sourceFormat: t,
    seriesLayoutBy: i,
    dimensionsDefine: n.dimensionsDefine,
    startIndex: n.startIndex,
    dimensionsDetectedCount: n.dimensionsDetectedCount,
    metaRawOption: $(e)
  });
  return s;
}
function Ov(r) {
  return new po({
    data: r,
    sourceFormat: Ge(r) ? Jt : Bt
  });
}
function Cx(r) {
  return new po({
    data: r.data,
    sourceFormat: r.sourceFormat,
    seriesLayoutBy: r.seriesLayoutBy,
    dimensionsDefine: $(r.dimensionsDefine),
    startIndex: r.startIndex,
    dimensionsDetectedCount: r.dimensionsDetectedCount
  });
}
function Iv(r) {
  var e = Rv;
  if (Ge(r))
    e = Jt;
  else if (F(r)) {
    r.length === 0 && (e = Qe);
    for (var t = 0, i = r.length; t < i; t++) {
      var n = r[t];
      if (n != null) {
        if (F(n) || Ge(n)) {
          e = Qe;
          break;
        } else if (B(n)) {
          e = Vt;
          break;
        }
      }
    }
  } else if (B(r)) {
    for (var s in r)
      if ($r(r, s) && Je(r[s])) {
        e = ni;
        break;
      }
  }
  return e;
}
function _x(r, e, t, i, n) {
  var s, a;
  if (!r)
    return {
      dimensionsDefine: jc(n),
      startIndex: a,
      dimensionsDetectedCount: s
    };
  if (e === Qe) {
    var o = r;
    i === "auto" || i == null ? Yc(function(h) {
      h != null && h !== "-" && (V(h) ? a == null && (a = 1) : a = 0);
    }, t, o, 10) : a = Re(i) ? i : i ? 1 : 0, !n && a === 1 && (n = [], Yc(function(h, u) {
      n[u] = h != null ? h + "" : "";
    }, t, o, 1 / 0)), s = n ? n.length : t === an ? o.length : o[0] ? o[0].length : null;
  } else if (e === Vt)
    n || (n = Ex(r));
  else if (e === ni)
    n || (n = [], M(r, function(h, u) {
      n.push(u);
    }));
  else if (e === Bt) {
    var l = io(r[0]);
    s = F(l) && l.length || 1;
  } else e === Jt && process.env.NODE_ENV !== "production" && Y(!!n, "dimensions must be given if data is TypedArray.");
  return {
    startIndex: a,
    dimensionsDefine: jc(n),
    dimensionsDetectedCount: s
  };
}
function Ex(r) {
  for (var e = 0, t; e < r.length && !(t = r[e++]); )
    ;
  if (t)
    return me(t);
}
function jc(r) {
  if (r) {
    var e = Z();
    return J(r, function(t, i) {
      t = B(t) ? t : {
        name: t
      };
      var n = {
        name: t.name,
        displayName: t.displayName,
        type: t.type
      };
      if (n.name == null)
        return n;
      n.name += "", n.displayName == null && (n.displayName = n.name);
      var s = e.get(n.name);
      return s ? n.name += "-" + s.count++ : e.set(n.name, {
        count: 1
      }), n;
    });
  }
}
function Yc(r, e, t, i) {
  if (e === an)
    for (var n = 0; n < t.length && n < i; n++)
      r(t[n] ? t[n][0] : null, n);
  else
    for (var s = t[0] || [], n = 0; n < s.length && n < i; n++)
      r(s[n], n);
}
function zv(r) {
  var e = r.sourceFormat;
  return e === Vt || e === ni;
}
var Ui, ji, Yi, Xc, $c, Fv = (
  /** @class */
  function() {
    function r(e, t) {
      var i = Vu(e) ? e : Ov(e);
      this._source = i;
      var n = this._data = i.data;
      if (i.sourceFormat === Jt) {
        if (process.env.NODE_ENV !== "production" && t == null)
          throw new Error("Typed array data must specify dimension size");
        this._offset = 0, this._dimSize = t, this._data = n;
      }
      $c(this, n, i);
    }
    return r.prototype.getSource = function() {
      return this._source;
    }, r.prototype.count = function() {
      return 0;
    }, r.prototype.getItem = function(e, t) {
    }, r.prototype.appendData = function(e) {
    }, r.prototype.clean = function() {
    }, r.protoInitialize = function() {
      var e = r.prototype;
      e.pure = !1, e.persistent = !0;
    }(), r.internalField = function() {
      var e;
      $c = function(a, o, l) {
        var h = l.sourceFormat, u = l.seriesLayoutBy, d = l.startIndex, c = l.dimensionsDefine, f = Xc[Wu(h, u)];
        if (process.env.NODE_ENV !== "production" && Y(f, "Invalide sourceFormat: " + h), P(a, f), h === Jt)
          a.getItem = t, a.count = n, a.fillStorage = i;
        else {
          var p = Hv(h, u);
          a.getItem = K(p, null, o, d, c);
          var m = Nv(h, u);
          a.count = K(m, null, o, d, c);
        }
      };
      var t = function(a, o) {
        a = a - this._offset, o = o || [];
        for (var l = this._data, h = this._dimSize, u = h * a, d = 0; d < h; d++)
          o[d] = l[u + d];
        return o;
      }, i = function(a, o, l, h) {
        for (var u = this._data, d = this._dimSize, c = 0; c < d; c++) {
          for (var f = h[c], p = f[0] == null ? 1 / 0 : f[0], m = f[1] == null ? -1 / 0 : f[1], g = o - a, v = l[c], b = 0; b < g; b++) {
            var y = u[b * d + c];
            v[a + b] = y, y < p && (p = y), y > m && (m = y);
          }
          f[0] = p, f[1] = m;
        }
      }, n = function() {
        return this._data ? this._data.length / this._dimSize : 0;
      };
      Xc = (e = {}, e[Qe + "_" + Qt] = {
        pure: !0,
        appendData: s
      }, e[Qe + "_" + an] = {
        pure: !0,
        appendData: function() {
          throw new Error('Do not support appendData when set seriesLayoutBy: "row".');
        }
      }, e[Vt] = {
        pure: !0,
        appendData: s
      }, e[ni] = {
        pure: !0,
        appendData: function(a) {
          var o = this._data;
          M(a, function(l, h) {
            for (var u = o[h] || (o[h] = []), d = 0; d < (l || []).length; d++)
              u.push(l[d]);
          });
        }
      }, e[Bt] = {
        appendData: s
      }, e[Jt] = {
        persistent: !1,
        pure: !0,
        appendData: function(a) {
          process.env.NODE_ENV !== "production" && Y(Ge(a), "Added data must be TypedArray if data in initialization is TypedArray"), this._data = a;
        },
        // Clean self if data is already used.
        clean: function() {
          this._offset += this.count(), this._data = null;
        }
      }, e);
      function s(a) {
        for (var o = 0; o < a.length; o++)
          this._data.push(a[o]);
      }
    }(), r;
  }()
), qc = function(r, e, t, i) {
  return r[i];
}, Tx = (Ui = {}, Ui[Qe + "_" + Qt] = function(r, e, t, i) {
  return r[i + e];
}, Ui[Qe + "_" + an] = function(r, e, t, i, n) {
  i += e;
  for (var s = n || [], a = r, o = 0; o < a.length; o++) {
    var l = a[o];
    s[o] = l ? l[i] : null;
  }
  return s;
}, Ui[Vt] = qc, Ui[ni] = function(r, e, t, i, n) {
  for (var s = n || [], a = 0; a < t.length; a++) {
    var o = t[a].name;
    if (process.env.NODE_ENV !== "production" && o == null)
      throw new Error();
    var l = r[o];
    s[a] = l ? l[i] : null;
  }
  return s;
}, Ui[Bt] = qc, Ui);
function Hv(r, e) {
  var t = Tx[Wu(r, e)];
  return process.env.NODE_ENV !== "production" && Y(t, 'Do not support get item on "' + r + '", "' + e + '".'), t;
}
var Kc = function(r, e, t) {
  return r.length;
}, xx = (ji = {}, ji[Qe + "_" + Qt] = function(r, e, t) {
  return Math.max(0, r.length - e);
}, ji[Qe + "_" + an] = function(r, e, t) {
  var i = r[0];
  return i ? Math.max(0, i.length - e) : 0;
}, ji[Vt] = Kc, ji[ni] = function(r, e, t) {
  var i = t[0].name;
  if (process.env.NODE_ENV !== "production" && i == null)
    throw new Error();
  var n = r[i];
  return n ? n.length : 0;
}, ji[Bt] = Kc, ji);
function Nv(r, e) {
  var t = xx[Wu(r, e)];
  return process.env.NODE_ENV !== "production" && Y(t, 'Do not support count on "' + r + '", "' + e + '".'), t;
}
var cl = function(r, e, t) {
  return r[e];
}, Sx = (Yi = {}, Yi[Qe] = cl, Yi[Vt] = function(r, e, t) {
  return r[t];
}, Yi[ni] = cl, Yi[Bt] = function(r, e, t) {
  var i = io(r);
  return i instanceof Array ? i[e] : i;
}, Yi[Jt] = cl, Yi);
function Bv(r) {
  var e = Sx[r];
  return process.env.NODE_ENV !== "production" && Y(e, 'Do not support get value on "' + r + '".'), e;
}
function Wu(r, e) {
  return r === Qe ? r + "_" + e : r;
}
function Ia(r, e, t) {
  if (r) {
    var i = r.getRawDataItem(e);
    if (i != null) {
      var n = r.getStore(), s = n.getSource().sourceFormat;
      if (t != null) {
        var a = r.getDimensionIndex(t), o = n.getDimensionProperty(a);
        return Bv(s)(i, a, o);
      } else {
        var l = i;
        return s === Bt && (l = io(i)), l;
      }
    }
  }
}
var Rx = /\{@(.+?)\}/g, Mx = (
  /** @class */
  function() {
    function r() {
    }
    return r.prototype.getDataParams = function(e, t) {
      var i = this.getData(t), n = this.getRawValue(e, t), s = i.getRawIndex(e), a = i.getName(e), o = i.getRawDataItem(e), l = i.getItemVisual(e, "style"), h = l && l[i.getItemVisual(e, "drawType") || "fill"], u = l && l.stroke, d = this.mainType, c = d === "series", f = i.userOutput && i.userOutput.get();
      return {
        componentType: d,
        componentSubType: this.subType,
        componentIndex: this.componentIndex,
        seriesType: c ? this.subType : null,
        seriesIndex: this.seriesIndex,
        seriesId: c ? this.id : null,
        seriesName: c ? this.name : null,
        name: a,
        dataIndex: s,
        data: o,
        dataType: t,
        value: n,
        color: h,
        borderColor: u,
        dimensionNames: f ? f.fullDimensions : null,
        encode: f ? f.encode : null,
        // Param name list for mapping `a`, `b`, `c`, `d`, `e`
        $vars: ["seriesName", "name", "value"]
      };
    }, r.prototype.getFormattedLabel = function(e, t, i, n, s, a) {
      t = t || "normal";
      var o = this.getData(i), l = this.getDataParams(e, i);
      if (a && (l.value = a.interpolatedValue), n != null && F(l.value) && (l.value = l.value[n]), !s) {
        var h = o.getItemModel(e);
        s = h.get(t === "normal" ? ["label", "formatter"] : [t, "label", "formatter"]);
      }
      if (q(s))
        return l.status = t, l.dimensionIndex = n, s(l);
      if (V(s)) {
        var u = Ev(s, l);
        return u.replace(Rx, function(d, c) {
          var f = c.length, p = c;
          p.charAt(0) === "[" && p.charAt(f - 1) === "]" && (p = +p.slice(1, f - 1), process.env.NODE_ENV !== "production" && isNaN(p) && Ne("Invalide label formatter: @" + c + ", only support @[0], @[1], @[2], ..."));
          var m = Ia(o, e, p);
          if (a && F(a.interpolatedValue)) {
            var g = o.getDimensionIndex(p);
            g >= 0 && (m = a.interpolatedValue[g]);
          }
          return m != null ? m + "" : "";
        });
      }
    }, r.prototype.getRawValue = function(e, t) {
      return Ia(this.getData(t), e);
    }, r.prototype.formatTooltip = function(e, t, i) {
    }, r;
  }()
);
function Zc(r) {
  var e, t;
  return B(r) ? r.type ? t = r : process.env.NODE_ENV !== "production" && console.warn("The return type of `formatTooltip` is not supported: " + Sa(r)) : e = r, {
    text: e,
    // markers: markers || markersExisting,
    frag: t
  };
}
function Kn(r) {
  return new Dx(r);
}
var Dx = (
  /** @class */
  function() {
    function r(e) {
      e = e || {}, this._reset = e.reset, this._plan = e.plan, this._count = e.count, this._onDirty = e.onDirty, this._dirty = !0;
    }
    return r.prototype.perform = function(e) {
      var t = this._upstream, i = e && e.skip;
      if (this._dirty && t) {
        var n = this.context;
        n.data = n.outputData = t.context.outputData;
      }
      this.__pipeline && (this.__pipeline.currentTask = this);
      var s;
      this._plan && !i && (s = this._plan(this.context));
      var a = u(this._modBy), o = this._modDataCount || 0, l = u(e && e.modBy), h = e && e.modDataCount || 0;
      (a !== l || o !== h) && (s = "reset");
      function u(b) {
        return !(b >= 1) && (b = 1), b;
      }
      var d;
      (this._dirty || s === "reset") && (this._dirty = !1, d = this._doReset(i)), this._modBy = l, this._modDataCount = h;
      var c = e && e.step;
      if (t ? (process.env.NODE_ENV !== "production" && Y(t._outputDueEnd != null), this._dueEnd = t._outputDueEnd) : (process.env.NODE_ENV !== "production" && Y(!this._progress || this._count), this._dueEnd = this._count ? this._count(this.context) : 1 / 0), this._progress) {
        var f = this._dueIndex, p = Math.min(c != null ? this._dueIndex + c : 1 / 0, this._dueEnd);
        if (!i && (d || f < p)) {
          var m = this._progress;
          if (F(m))
            for (var g = 0; g < m.length; g++)
              this._doProgress(m[g], f, p, l, h);
          else
            this._doProgress(m, f, p, l, h);
        }
        this._dueIndex = p;
        var v = this._settedOutputEnd != null ? this._settedOutputEnd : p;
        process.env.NODE_ENV !== "production" && Y(v >= this._outputDueEnd), this._outputDueEnd = v;
      } else
        this._dueIndex = this._outputDueEnd = this._settedOutputEnd != null ? this._settedOutputEnd : this._dueEnd;
      return this.unfinished();
    }, r.prototype.dirty = function() {
      this._dirty = !0, this._onDirty && this._onDirty(this.context);
    }, r.prototype._doProgress = function(e, t, i, n, s) {
      Jc.reset(t, i, n, s), this._callingProgress = e, this._callingProgress({
        start: t,
        end: i,
        count: i - t,
        next: Jc.next
      }, this.context);
    }, r.prototype._doReset = function(e) {
      this._dueIndex = this._outputDueEnd = this._dueEnd = 0, this._settedOutputEnd = null;
      var t, i;
      !e && this._reset && (t = this._reset(this.context), t && t.progress && (i = t.forceFirstProgress, t = t.progress), F(t) && !t.length && (t = null)), this._progress = t, this._modBy = this._modDataCount = null;
      var n = this._downstream;
      return n && n.dirty(), i;
    }, r.prototype.unfinished = function() {
      return this._progress && this._dueIndex < this._dueEnd;
    }, r.prototype.pipe = function(e) {
      process.env.NODE_ENV !== "production" && Y(e && !e._disposed && e !== this), (this._downstream !== e || this._dirty) && (this._downstream = e, e._upstream = this, e.dirty());
    }, r.prototype.dispose = function() {
      this._disposed || (this._upstream && (this._upstream._downstream = null), this._downstream && (this._downstream._upstream = null), this._dirty = !1, this._disposed = !0);
    }, r.prototype.getUpstream = function() {
      return this._upstream;
    }, r.prototype.getDownstream = function() {
      return this._downstream;
    }, r.prototype.setOutputEnd = function(e) {
      this._outputDueEnd = this._settedOutputEnd = e;
    }, r;
  }()
), Jc = /* @__PURE__ */ function() {
  var r, e, t, i, n, s = {
    reset: function(l, h, u, d) {
      e = l, r = h, t = u, i = d, n = Math.ceil(i / t), s.next = t > 1 && i > 0 ? o : a;
    }
  };
  return s;
  function a() {
    return e < r ? e++ : null;
  }
  function o() {
    var l = e % n * t + Math.ceil(e / n), h = e >= r ? null : l < i ? l : e;
    return e++, h;
  }
}();
function da(r, e) {
  var t = e && e.type;
  return t === "ordinal" ? r : (t === "time" && !Re(r) && r != null && r !== "-" && (r = +eo(r)), r == null || r === "" ? NaN : Number(r));
}
Z({
  number: function(r) {
    return parseFloat(r);
  },
  time: function(r) {
    return +eo(r);
  },
  trim: function(r) {
    return V(r) ? zt(r) : r;
  }
});
var Lx = (
  /** @class */
  function() {
    function r(e, t) {
      var i = e === "desc";
      this._resultLT = i ? 1 : -1, t == null && (t = i ? "min" : "max"), this._incomparable = t === "min" ? -1 / 0 : 1 / 0;
    }
    return r.prototype.evaluate = function(e, t) {
      var i = Re(e) ? e : xa(e), n = Re(t) ? t : xa(t), s = isNaN(i), a = isNaN(n);
      if (s && (i = this._incomparable), a && (n = this._incomparable), s && a) {
        var o = V(e), l = V(t);
        o && (i = l ? e : 0), l && (n = o ? t : 0);
      }
      return i < n ? this._resultLT : i > n ? -this._resultLT : 0;
    }, r;
  }()
), kx = (
  /** @class */
  function() {
    function r() {
    }
    return r.prototype.getRawData = function() {
      throw new Error("not supported");
    }, r.prototype.getRawDataItem = function(e) {
      throw new Error("not supported");
    }, r.prototype.cloneRawData = function() {
    }, r.prototype.getDimensionInfo = function(e) {
    }, r.prototype.cloneAllDimensionInfo = function() {
    }, r.prototype.count = function() {
    }, r.prototype.retrieveValue = function(e, t) {
    }, r.prototype.retrieveValueFromItem = function(e, t) {
    }, r.prototype.convertValue = function(e, t) {
      return da(e, t);
    }, r;
  }()
);
function Ax(r, e) {
  var t = new kx(), i = r.data, n = t.sourceFormat = r.sourceFormat, s = r.startIndex, a = "";
  r.seriesLayoutBy !== Qt && (process.env.NODE_ENV !== "production" && (a = '`seriesLayoutBy` of upstream dataset can only be "column" in data transform.'), Ke(a));
  var o = [], l = {}, h = r.dimensionsDefine;
  if (h)
    M(h, function(m, g) {
      var v = m.name, b = {
        index: g,
        name: v,
        displayName: m.displayName
      };
      if (o.push(b), v != null) {
        var y = "";
        $r(l, v) && (process.env.NODE_ENV !== "production" && (y = 'dimension name "' + v + '" duplicated.'), Ke(y)), l[v] = b;
      }
    });
  else
    for (var u = 0; u < r.dimensionsDetectedCount; u++)
      o.push({
        index: u
      });
  var d = Hv(n, Qt);
  e.__isBuiltIn && (t.getRawDataItem = function(m) {
    return d(i, s, o, m);
  }, t.getRawData = K(Px, null, r)), t.cloneRawData = K(Ox, null, r);
  var c = Nv(n, Qt);
  t.count = K(c, null, i, s, o);
  var f = Bv(n);
  t.retrieveValue = function(m, g) {
    var v = d(i, s, o, m);
    return p(v, g);
  };
  var p = t.retrieveValueFromItem = function(m, g) {
    if (m != null) {
      var v = o[g];
      if (v)
        return f(m, g, v.name);
    }
  };
  return t.getDimensionInfo = K(Ix, null, o, l), t.cloneAllDimensionInfo = K(zx, null, o), t;
}
function Px(r) {
  var e = r.sourceFormat;
  if (!Gu(e)) {
    var t = "";
    process.env.NODE_ENV !== "production" && (t = "`getRawData` is not supported in source format " + e), Ke(t);
  }
  return r.data;
}
function Ox(r) {
  var e = r.sourceFormat, t = r.data;
  if (!Gu(e)) {
    var i = "";
    process.env.NODE_ENV !== "production" && (i = "`cloneRawData` is not supported in source format " + e), Ke(i);
  }
  if (e === Qe) {
    for (var n = [], s = 0, a = t.length; s < a; s++)
      n.push(t[s].slice());
    return n;
  } else if (e === Vt) {
    for (var n = [], s = 0, a = t.length; s < a; s++)
      n.push(P({}, t[s]));
    return n;
  }
}
function Ix(r, e, t) {
  if (t != null) {
    if (Re(t) || !isNaN(t) && !$r(e, t))
      return r[t];
    if ($r(e, t))
      return e[t];
  }
}
function zx(r) {
  return $(r);
}
var Vv = Z();
function Fx(r) {
  r = $(r);
  var e = r.type, t = "";
  e || (process.env.NODE_ENV !== "production" && (t = "Must have a `type` when `registerTransform`."), Ke(t));
  var i = e.split(":");
  i.length !== 2 && (process.env.NODE_ENV !== "production" && (t = 'Name must include namespace like "ns:regression".'), Ke(t));
  var n = !1;
  i[0] === "echarts" && (e = i[1], n = !0), r.__isBuiltIn = n, Vv.set(e, r);
}
function Hx(r, e, t) {
  var i = Me(r), n = i.length, s = "";
  n || (process.env.NODE_ENV !== "production" && (s = "If `transform` declared, it should at least contain one transform."), Ke(s));
  for (var a = 0, o = n; a < o; a++) {
    var l = i[a];
    e = Nx(l, e, t, n === 1 ? null : a), a !== o - 1 && (e.length = Math.max(e.length, 1));
  }
  return e;
}
function Nx(r, e, t, i) {
  var n = "";
  e.length || (process.env.NODE_ENV !== "production" && (n = "Must have at least one upstream dataset."), Ke(n)), B(r) || (process.env.NODE_ENV !== "production" && (n = "transform declaration must be an object rather than " + typeof r + "."), Ke(n));
  var s = r.type, a = Vv.get(s);
  a || (process.env.NODE_ENV !== "production" && (n = 'Can not find transform on type "' + s + '".'), Ke(n));
  var o = J(e, function(u) {
    return Ax(u, a);
  }), l = Me(a.transform({
    upstream: o[0],
    upstreamList: o,
    config: $(r.config)
  }));
  if (process.env.NODE_ENV !== "production" && r.print) {
    var h = J(l, function(u) {
      var d = i != null ? " === pipe index: " + i : "";
      return ["=== dataset index: " + t.datasetIndex + d + " ===", "- transform result data:", Sa(u.data), "- transform result dimensions:", Sa(u.dimensions)].join(`
`);
    }).join(`
`);
    PC(h);
  }
  return J(l, function(u, d) {
    var c = "";
    B(u) || (process.env.NODE_ENV !== "production" && (c = "A transform should not return some empty results."), Ke(c)), u.data || (process.env.NODE_ENV !== "production" && (c = "Transform result data should be not be null or undefined"), Ke(c));
    var f = Iv(u.data);
    Gu(f) || (process.env.NODE_ENV !== "production" && (c = "Transform result data should be array rows or object rows."), Ke(c));
    var p, m = e[0];
    if (m && d === 0 && !u.dimensions) {
      var g = m.startIndex;
      g && (u.data = m.data.slice(0, g).concat(u.data)), p = {
        seriesLayoutBy: Qt,
        sourceHeader: g,
        dimensions: m.metaRawOption.dimensions
      };
    } else
      p = {
        seriesLayoutBy: Qt,
        sourceHeader: 0,
        dimensions: u.dimensions
      };
    return Vh(u.data, p, null);
  });
}
function Gu(r) {
  return r === Qe || r === Vt;
}
var go = "undefined", Bx = typeof Uint32Array === go ? Array : Uint32Array, Vx = typeof Uint16Array === go ? Array : Uint16Array, Wv = typeof Int32Array === go ? Array : Int32Array, Qc = typeof Float64Array === go ? Array : Float64Array, Gv = {
  float: Qc,
  int: Wv,
  // Ordinal data type can be string or int
  ordinal: Array,
  number: Array,
  time: Qc
}, fl;
function xr(r) {
  return r > 65535 ? Bx : Vx;
}
function Sr() {
  return [1 / 0, -1 / 0];
}
function Wx(r) {
  var e = r.constructor;
  return e === Array ? r.slice() : new e(r);
}
function ef(r, e, t, i, n) {
  var s = Gv[t || "float"];
  if (n) {
    var a = r[e], o = a && a.length;
    if (o !== i) {
      for (var l = new s(i), h = 0; h < o; h++)
        l[h] = a[h];
      r[e] = l;
    }
  } else
    r[e] = new s(i);
}
var Wh = (
  /** @class */
  function() {
    function r() {
      this._chunks = [], this._rawExtent = [], this._extent = [], this._count = 0, this._rawCount = 0, this._calcDimNameToIdx = Z();
    }
    return r.prototype.initData = function(e, t, i) {
      process.env.NODE_ENV !== "production" && Y(q(e.getItem) && q(e.count), "Invalid data provider."), this._provider = e, this._chunks = [], this._indices = null, this.getRawIndex = this._getRawIdxIdentity;
      var n = e.getSource(), s = this.defaultDimValueGetter = fl[n.sourceFormat];
      this._dimValueGetter = i || s, this._rawExtent = [];
      var a = zv(n);
      this._dimensions = J(t, function(o) {
        return process.env.NODE_ENV !== "production" && a && Y(o.property != null), {
          // Only pick these two props. Not leak other properties like orderMeta.
          type: o.type,
          property: o.property
        };
      }), this._initDataFromProvider(0, e.count());
    }, r.prototype.getProvider = function() {
      return this._provider;
    }, r.prototype.getSource = function() {
      return this._provider.getSource();
    }, r.prototype.ensureCalculationDimension = function(e, t) {
      var i = this._calcDimNameToIdx, n = this._dimensions, s = i.get(e);
      if (s != null) {
        if (n[s].type === t)
          return s;
      } else
        s = n.length;
      return n[s] = {
        type: t
      }, i.set(e, s), this._chunks[s] = new Gv[t || "float"](this._rawCount), this._rawExtent[s] = Sr(), s;
    }, r.prototype.collectOrdinalMeta = function(e, t) {
      var i = this._chunks[e], n = this._dimensions[e], s = this._rawExtent, a = n.ordinalOffset || 0, o = i.length;
      a === 0 && (s[e] = Sr());
      for (var l = s[e], h = a; h < o; h++) {
        var u = i[h] = t.parseAndCollect(i[h]);
        isNaN(u) || (l[0] = Math.min(u, l[0]), l[1] = Math.max(u, l[1]));
      }
      n.ordinalMeta = t, n.ordinalOffset = o, n.type = "ordinal";
    }, r.prototype.getOrdinalMeta = function(e) {
      var t = this._dimensions[e], i = t.ordinalMeta;
      return i;
    }, r.prototype.getDimensionProperty = function(e) {
      var t = this._dimensions[e];
      return t && t.property;
    }, r.prototype.appendData = function(e) {
      process.env.NODE_ENV !== "production" && Y(!this._indices, "appendData can only be called on raw data.");
      var t = this._provider, i = this.count();
      t.appendData(e);
      var n = t.count();
      return t.persistent || (n += i), i < n && this._initDataFromProvider(i, n, !0), [i, n];
    }, r.prototype.appendValues = function(e, t) {
      for (var i = this._chunks, n = this._dimensions, s = n.length, a = this._rawExtent, o = this.count(), l = o + Math.max(e.length, t || 0), h = 0; h < s; h++) {
        var u = n[h];
        ef(i, h, u.type, l, !0);
      }
      for (var d = [], c = o; c < l; c++)
        for (var f = c - o, p = 0; p < s; p++) {
          var u = n[p], m = fl.arrayRows.call(this, e[f] || d, u.property, f, p);
          i[p][c] = m;
          var g = a[p];
          m < g[0] && (g[0] = m), m > g[1] && (g[1] = m);
        }
      return this._rawCount = this._count = l, {
        start: o,
        end: l
      };
    }, r.prototype._initDataFromProvider = function(e, t, i) {
      for (var n = this._provider, s = this._chunks, a = this._dimensions, o = a.length, l = this._rawExtent, h = J(a, function(b) {
        return b.property;
      }), u = 0; u < o; u++) {
        var d = a[u];
        l[u] || (l[u] = Sr()), ef(s, u, d.type, t, i);
      }
      if (n.fillStorage)
        n.fillStorage(e, t, s, l);
      else
        for (var c = [], f = e; f < t; f++) {
          c = n.getItem(f, c);
          for (var p = 0; p < o; p++) {
            var m = s[p], g = this._dimValueGetter(c, h[p], f, p);
            m[f] = g;
            var v = l[p];
            g < v[0] && (v[0] = g), g > v[1] && (v[1] = g);
          }
        }
      !n.persistent && n.clean && n.clean(), this._rawCount = this._count = t, this._extent = [];
    }, r.prototype.count = function() {
      return this._count;
    }, r.prototype.get = function(e, t) {
      if (!(t >= 0 && t < this._count))
        return NaN;
      var i = this._chunks[e];
      return i ? i[this.getRawIndex(t)] : NaN;
    }, r.prototype.getValues = function(e, t) {
      var i = [], n = [];
      if (t == null) {
        t = e, e = [];
        for (var s = 0; s < this._dimensions.length; s++)
          n.push(s);
      } else
        n = e;
      for (var s = 0, a = n.length; s < a; s++)
        i.push(this.get(n[s], t));
      return i;
    }, r.prototype.getByRawIndex = function(e, t) {
      if (!(t >= 0 && t < this._rawCount))
        return NaN;
      var i = this._chunks[e];
      return i ? i[t] : NaN;
    }, r.prototype.getSum = function(e) {
      var t = this._chunks[e], i = 0;
      if (t)
        for (var n = 0, s = this.count(); n < s; n++) {
          var a = this.get(e, n);
          isNaN(a) || (i += a);
        }
      return i;
    }, r.prototype.getMedian = function(e) {
      var t = [];
      this.each([e], function(s) {
        isNaN(s) || t.push(s);
      });
      var i = t.sort(function(s, a) {
        return s - a;
      }), n = this.count();
      return n === 0 ? 0 : n % 2 === 1 ? i[(n - 1) / 2] : (i[n / 2] + i[n / 2 - 1]) / 2;
    }, r.prototype.indexOfRawIndex = function(e) {
      if (e >= this._rawCount || e < 0)
        return -1;
      if (!this._indices)
        return e;
      var t = this._indices, i = t[e];
      if (i != null && i < this._count && i === e)
        return e;
      for (var n = 0, s = this._count - 1; n <= s; ) {
        var a = (n + s) / 2 | 0;
        if (t[a] < e)
          n = a + 1;
        else if (t[a] > e)
          s = a - 1;
        else
          return a;
      }
      return -1;
    }, r.prototype.indicesOfNearest = function(e, t, i) {
      var n = this._chunks, s = n[e], a = [];
      if (!s)
        return a;
      i == null && (i = 1 / 0);
      for (var o = 1 / 0, l = -1, h = 0, u = 0, d = this.count(); u < d; u++) {
        var c = this.getRawIndex(u), f = t - s[c], p = Math.abs(f);
        p <= i && ((p < o || p === o && f >= 0 && l < 0) && (o = p, l = f, h = 0), f === l && (a[h++] = u));
      }
      return a.length = h, a;
    }, r.prototype.getIndices = function() {
      var e, t = this._indices;
      if (t) {
        var i = t.constructor, n = this._count;
        if (i === Array) {
          e = new i(n);
          for (var s = 0; s < n; s++)
            e[s] = t[s];
        } else
          e = new i(t.buffer, 0, n);
      } else {
        var i = xr(this._rawCount);
        e = new i(this.count());
        for (var s = 0; s < e.length; s++)
          e[s] = s;
      }
      return e;
    }, r.prototype.filter = function(e, t) {
      if (!this._count)
        return this;
      for (var i = this.clone(), n = i.count(), s = xr(i._rawCount), a = new s(n), o = [], l = e.length, h = 0, u = e[0], d = i._chunks, c = 0; c < n; c++) {
        var f = void 0, p = i.getRawIndex(c);
        if (l === 0)
          f = t(c);
        else if (l === 1) {
          var m = d[u][p];
          f = t(m, c);
        } else {
          for (var g = 0; g < l; g++)
            o[g] = d[e[g]][p];
          o[g] = c, f = t.apply(null, o);
        }
        f && (a[h++] = p);
      }
      return h < n && (i._indices = a), i._count = h, i._extent = [], i._updateGetRawIdx(), i;
    }, r.prototype.selectRange = function(e) {
      var t = this.clone(), i = t._count;
      if (!i)
        return this;
      var n = me(e), s = n.length;
      if (!s)
        return this;
      var a = t.count(), o = xr(t._rawCount), l = new o(a), h = 0, u = n[0], d = e[u][0], c = e[u][1], f = t._chunks, p = !1;
      if (!t._indices) {
        var m = 0;
        if (s === 1) {
          for (var g = f[n[0]], v = 0; v < i; v++) {
            var b = g[v];
            (b >= d && b <= c || isNaN(b)) && (l[h++] = m), m++;
          }
          p = !0;
        } else if (s === 2) {
          for (var g = f[n[0]], y = f[n[1]], w = e[n[1]][0], _ = e[n[1]][1], v = 0; v < i; v++) {
            var b = g[v], E = y[v];
            (b >= d && b <= c || isNaN(b)) && (E >= w && E <= _ || isNaN(E)) && (l[h++] = m), m++;
          }
          p = !0;
        }
      }
      if (!p)
        if (s === 1)
          for (var v = 0; v < a; v++) {
            var x = t.getRawIndex(v), b = f[n[0]][x];
            (b >= d && b <= c || isNaN(b)) && (l[h++] = x);
          }
        else
          for (var v = 0; v < a; v++) {
            for (var T = !0, x = t.getRawIndex(v), C = 0; C < s; C++) {
              var S = n[C], b = f[S][x];
              (b < e[S][0] || b > e[S][1]) && (T = !1);
            }
            T && (l[h++] = t.getRawIndex(v));
          }
      return h < a && (t._indices = l), t._count = h, t._extent = [], t._updateGetRawIdx(), t;
    }, r.prototype.map = function(e, t) {
      var i = this.clone(e);
      return this._updateDims(i, e, t), i;
    }, r.prototype.modify = function(e, t) {
      this._updateDims(this, e, t);
    }, r.prototype._updateDims = function(e, t, i) {
      for (var n = e._chunks, s = [], a = t.length, o = e.count(), l = [], h = e._rawExtent, u = 0; u < t.length; u++)
        h[t[u]] = Sr();
      for (var d = 0; d < o; d++) {
        for (var c = e.getRawIndex(d), f = 0; f < a; f++)
          l[f] = n[t[f]][c];
        l[a] = d;
        var p = i && i.apply(null, l);
        if (p != null) {
          typeof p != "object" && (s[0] = p, p = s);
          for (var u = 0; u < p.length; u++) {
            var m = t[u], g = p[u], v = h[m], b = n[m];
            b && (b[c] = g), g < v[0] && (v[0] = g), g > v[1] && (v[1] = g);
          }
        }
      }
    }, r.prototype.lttbDownSample = function(e, t) {
      var i = this.clone([e], !0), n = i._chunks, s = n[e], a = this.count(), o = 0, l = Math.floor(1 / t), h = this.getRawIndex(0), u, d, c, f = new (xr(this._rawCount))(Math.min((Math.ceil(a / l) + 2) * 2, a));
      f[o++] = h;
      for (var p = 1; p < a - 1; p += l) {
        for (var m = Math.min(p + l, a - 1), g = Math.min(p + l * 2, a), v = (g + m) / 2, b = 0, y = m; y < g; y++) {
          var w = this.getRawIndex(y), _ = s[w];
          isNaN(_) || (b += _);
        }
        b /= g - m;
        var E = p, x = Math.min(p + l, a), T = p - 1, C = s[h];
        u = -1, c = E;
        for (var S = -1, R = 0, y = E; y < x; y++) {
          var w = this.getRawIndex(y), _ = s[w];
          if (isNaN(_)) {
            R++, S < 0 && (S = w);
            continue;
          }
          d = Math.abs((T - v) * (_ - C) - (T - y) * (b - C)), d > u && (u = d, c = w);
        }
        R > 0 && R < x - E && (f[o++] = Math.min(S, c), c = Math.max(S, c)), f[o++] = c, h = c;
      }
      return f[o++] = this.getRawIndex(a - 1), i._count = o, i._indices = f, i.getRawIndex = this._getRawIdx, i;
    }, r.prototype.minmaxDownSample = function(e, t) {
      for (var i = this.clone([e], !0), n = i._chunks, s = Math.floor(1 / t), a = n[e], o = this.count(), l = new (xr(this._rawCount))(Math.ceil(o / s) * 2), h = 0, u = 0; u < o; u += s) {
        var d = u, c = a[this.getRawIndex(d)], f = u, p = a[this.getRawIndex(f)], m = s;
        u + s > o && (m = o - u);
        for (var g = 0; g < m; g++) {
          var v = this.getRawIndex(u + g), b = a[v];
          b < c && (c = b, d = u + g), b > p && (p = b, f = u + g);
        }
        var y = this.getRawIndex(d), w = this.getRawIndex(f);
        d < f ? (l[h++] = y, l[h++] = w) : (l[h++] = w, l[h++] = y);
      }
      return i._count = h, i._indices = l, i._updateGetRawIdx(), i;
    }, r.prototype.downSample = function(e, t, i, n) {
      for (var s = this.clone([e], !0), a = s._chunks, o = [], l = Math.floor(1 / t), h = a[e], u = this.count(), d = s._rawExtent[e] = Sr(), c = new (xr(this._rawCount))(Math.ceil(u / l)), f = 0, p = 0; p < u; p += l) {
        l > u - p && (l = u - p, o.length = l);
        for (var m = 0; m < l; m++) {
          var g = this.getRawIndex(p + m);
          o[m] = h[g];
        }
        var v = i(o), b = this.getRawIndex(Math.min(p + n(o, v) || 0, u - 1));
        h[b] = v, v < d[0] && (d[0] = v), v > d[1] && (d[1] = v), c[f++] = b;
      }
      return s._count = f, s._indices = c, s._updateGetRawIdx(), s;
    }, r.prototype.each = function(e, t) {
      if (this._count)
        for (var i = e.length, n = this._chunks, s = 0, a = this.count(); s < a; s++) {
          var o = this.getRawIndex(s);
          switch (i) {
            case 0:
              t(s);
              break;
            case 1:
              t(n[e[0]][o], s);
              break;
            case 2:
              t(n[e[0]][o], n[e[1]][o], s);
              break;
            default:
              for (var l = 0, h = []; l < i; l++)
                h[l] = n[e[l]][o];
              h[l] = s, t.apply(null, h);
          }
        }
    }, r.prototype.getDataExtent = function(e) {
      var t = this._chunks[e], i = Sr();
      if (!t)
        return i;
      var n = this.count(), s = !this._indices, a;
      if (s)
        return this._rawExtent[e].slice();
      if (a = this._extent[e], a)
        return a.slice();
      a = i;
      for (var o = a[0], l = a[1], h = 0; h < n; h++) {
        var u = this.getRawIndex(h), d = t[u];
        d < o && (o = d), d > l && (l = d);
      }
      return a = [o, l], this._extent[e] = a, a;
    }, r.prototype.getRawDataItem = function(e) {
      var t = this.getRawIndex(e);
      if (this._provider.persistent)
        return this._provider.getItem(t);
      for (var i = [], n = this._chunks, s = 0; s < n.length; s++)
        i.push(n[s][t]);
      return i;
    }, r.prototype.clone = function(e, t) {
      var i = new r(), n = this._chunks, s = e && tn(e, function(o, l) {
        return o[l] = !0, o;
      }, {});
      if (s)
        for (var a = 0; a < n.length; a++)
          i._chunks[a] = s[a] ? Wx(n[a]) : n[a];
      else
        i._chunks = n;
      return this._copyCommonProps(i), t || (i._indices = this._cloneIndices()), i._updateGetRawIdx(), i;
    }, r.prototype._copyCommonProps = function(e) {
      e._count = this._count, e._rawCount = this._rawCount, e._provider = this._provider, e._dimensions = this._dimensions, e._extent = $(this._extent), e._rawExtent = $(this._rawExtent);
    }, r.prototype._cloneIndices = function() {
      if (this._indices) {
        var e = this._indices.constructor, t = void 0;
        if (e === Array) {
          var i = this._indices.length;
          t = new e(i);
          for (var n = 0; n < i; n++)
            t[n] = this._indices[n];
        } else
          t = new e(this._indices);
        return t;
      }
      return null;
    }, r.prototype._getRawIdxIdentity = function(e) {
      return e;
    }, r.prototype._getRawIdx = function(e) {
      return e < this._count && e >= 0 ? this._indices[e] : -1;
    }, r.prototype._updateGetRawIdx = function() {
      this.getRawIndex = this._indices ? this._getRawIdx : this._getRawIdxIdentity;
    }, r.internalField = function() {
      function e(t, i, n, s) {
        return da(t[s], this._dimensions[s]);
      }
      fl = {
        arrayRows: e,
        objectRows: function(t, i, n, s) {
          return da(t[i], this._dimensions[s]);
        },
        keyedColumns: e,
        original: function(t, i, n, s) {
          var a = t && (t.value == null ? t : t.value);
          return da(a instanceof Array ? a[s] : a, this._dimensions[s]);
        },
        typedArray: function(t, i, n, s) {
          return t[s];
        }
      };
    }(), r;
  }()
), Gx = (
  /** @class */
  function() {
    function r(e) {
      this._sourceList = [], this._storeList = [], this._upstreamSignList = [], this._versionSignBase = 0, this._dirty = !0, this._sourceHost = e;
    }
    return r.prototype.dirty = function() {
      this._setLocalSource([], []), this._storeList = [], this._dirty = !0;
    }, r.prototype._setLocalSource = function(e, t) {
      this._sourceList = e, this._upstreamSignList = t, this._versionSignBase++, this._versionSignBase > 9e10 && (this._versionSignBase = 0);
    }, r.prototype._getVersionSign = function() {
      return this._sourceHost.uid + "_" + this._versionSignBase;
    }, r.prototype.prepareSource = function() {
      this._isDirty() && (this._createSource(), this._dirty = !1);
    }, r.prototype._createSource = function() {
      this._setLocalSource([], []);
      var e = this._sourceHost, t = this._getUpstreamSourceManagers(), i = !!t.length, n, s;
      if (Cn(e)) {
        var a = e, o = void 0, l = void 0, h = void 0;
        if (i) {
          var u = t[0];
          u.prepareSource(), h = u.getSource(), o = h.data, l = h.sourceFormat, s = [u._getVersionSign()];
        } else
          o = a.get("data", !0), l = Ge(o) ? Jt : Bt, s = [];
        var d = this._getSourceMetaRawOption() || {}, c = h && h.metaRawOption || {}, f = j(d.seriesLayoutBy, c.seriesLayoutBy) || null, p = j(d.sourceHeader, c.sourceHeader), m = j(d.dimensions, c.dimensions), g = f !== c.seriesLayoutBy || !!p != !!c.sourceHeader || m;
        n = g ? [Vh(o, {
          seriesLayoutBy: f,
          sourceHeader: p,
          dimensions: m
        }, l)] : [];
      } else {
        var v = e;
        if (i) {
          var b = this._applyTransform(t);
          n = b.sourceList, s = b.upstreamSignList;
        } else {
          var y = v.get("source", !0);
          n = [Vh(y, this._getSourceMetaRawOption(), null)], s = [];
        }
      }
      process.env.NODE_ENV !== "production" && Y(n && s), this._setLocalSource(n, s);
    }, r.prototype._applyTransform = function(e) {
      var t = this._sourceHost, i = t.get("transform", !0), n = t.get("fromTransformResult", !0);
      if (process.env.NODE_ENV !== "production" && Y(n != null || i != null), n != null) {
        var s = "";
        e.length !== 1 && (process.env.NODE_ENV !== "production" && (s = "When using `fromTransformResult`, there should be only one upstream dataset"), tf(s));
      }
      var a, o = [], l = [];
      return M(e, function(h) {
        h.prepareSource();
        var u = h.getSource(n || 0), d = "";
        n != null && !u && (process.env.NODE_ENV !== "production" && (d = "Can not retrieve result by `fromTransformResult`: " + n), tf(d)), o.push(u), l.push(h._getVersionSign());
      }), i ? a = Hx(i, o, {
        datasetIndex: t.componentIndex
      }) : n != null && (a = [Cx(o[0])]), {
        sourceList: a,
        upstreamSignList: l
      };
    }, r.prototype._isDirty = function() {
      if (this._dirty)
        return !0;
      for (var e = this._getUpstreamSourceManagers(), t = 0; t < e.length; t++) {
        var i = e[t];
        if (
          // Consider the case that there is ancestor diry, call it recursively.
          // The performance is probably not an issue because usually the chain is not long.
          i._isDirty() || this._upstreamSignList[t] !== i._getVersionSign()
        )
          return !0;
      }
    }, r.prototype.getSource = function(e) {
      e = e || 0;
      var t = this._sourceList[e];
      if (!t) {
        var i = this._getUpstreamSourceManagers();
        return i[0] && i[0].getSource(e);
      }
      return t;
    }, r.prototype.getSharedDataStore = function(e) {
      process.env.NODE_ENV !== "production" && Y(Cn(this._sourceHost), "Can only call getDataStore on series source manager.");
      var t = e.makeStoreSchema();
      return this._innerGetDataStore(t.dimensions, e.source, t.hash);
    }, r.prototype._innerGetDataStore = function(e, t, i) {
      var n = 0, s = this._storeList, a = s[n];
      a || (a = s[n] = {});
      var o = a[i];
      if (!o) {
        var l = this._getUpstreamSourceManagers()[0];
        Cn(this._sourceHost) && l ? o = l._innerGetDataStore(e, t, i) : (o = new Wh(), o.initData(new Fv(t, e.length), e)), a[i] = o;
      }
      return o;
    }, r.prototype._getUpstreamSourceManagers = function() {
      var e = this._sourceHost;
      if (Cn(e)) {
        var t = UT(e);
        return t ? [t.getSourceManager()] : [];
      } else
        return J(jT(e), function(i) {
          return i.getSourceManager();
        });
    }, r.prototype._getSourceMetaRawOption = function() {
      var e = this._sourceHost, t, i, n;
      if (Cn(e))
        t = e.get("seriesLayoutBy", !0), i = e.get("sourceHeader", !0), n = e.get("dimensions", !0);
      else if (!this._getUpstreamSourceManagers().length) {
        var s = e;
        t = s.get("seriesLayoutBy", !0), i = s.get("sourceHeader", !0), n = s.get("dimensions", !0);
      }
      return {
        seriesLayoutBy: t,
        sourceHeader: i,
        dimensions: n
      };
    }, r;
  }()
);
function Cn(r) {
  return r.mainType === "series";
}
function tf(r) {
  throw new Error(r);
}
var Ux = "line-height:1";
function Uv(r) {
  var e = r.lineHeight;
  return e == null ? Ux : "line-height:" + $e(e + "") + "px";
}
function jv(r, e) {
  var t = r.color || "#6e7079", i = r.fontSize || 12, n = r.fontWeight || "400", s = r.color || "#464646", a = r.fontSize || 14, o = r.fontWeight || "900";
  return e === "html" ? {
    // eslint-disable-next-line max-len
    nameStyle: "font-size:" + $e(i + "") + "px;color:" + $e(t) + ";font-weight:" + $e(n + ""),
    // eslint-disable-next-line max-len
    valueStyle: "font-size:" + $e(a + "") + "px;color:" + $e(s) + ";font-weight:" + $e(o + "")
  } : {
    nameStyle: {
      fontSize: i,
      fill: t,
      fontWeight: n
    },
    valueStyle: {
      fontSize: a,
      fill: s,
      fontWeight: o
    }
  };
}
var jx = [0, 10, 20, 30], Yx = ["", `
`, `

`, `


`];
function Jr(r, e) {
  return e.type = r, e;
}
function Gh(r) {
  return r.type === "section";
}
function Yv(r) {
  return Gh(r) ? Xx : $x;
}
function Xv(r) {
  if (Gh(r)) {
    var e = 0, t = r.blocks.length, i = t > 1 || t > 0 && !r.noHeader;
    return M(r.blocks, function(n) {
      var s = Xv(n);
      s >= e && (e = s + +(i && // 0 always can not be readable gap level.
      (!s || Gh(n) && !n.noHeader)));
    }), e;
  }
  return 0;
}
function Xx(r, e, t, i) {
  var n = e.noHeader, s = qx(Xv(e)), a = [], o = e.blocks || [];
  Y(!o || F(o)), o = o || [];
  var l = r.orderMode;
  if (e.sortBlocks && l) {
    o = o.slice();
    var h = {
      valueAsc: "asc",
      valueDesc: "desc"
    };
    if ($r(h, l)) {
      var u = new Lx(h[l], null);
      o.sort(function(m, g) {
        return u.evaluate(m.sortParam, g.sortParam);
      });
    } else l === "seriesDesc" && o.reverse();
  }
  M(o, function(m, g) {
    var v = e.valueFormatter, b = Yv(m)(
      // Inherit valueFormatter
      v ? P(P({}, r), {
        valueFormatter: v
      }) : r,
      m,
      g > 0 ? s.html : 0,
      i
    );
    b != null && a.push(b);
  });
  var d = r.renderMode === "richText" ? a.join(s.richText) : Uh(i, a.join(""), n ? t : s.html);
  if (n)
    return d;
  var c = Hh(e.header, "ordinal", r.useUTC), f = jv(i, r.renderMode).nameStyle, p = Uv(i);
  return r.renderMode === "richText" ? $v(r, c, f) + s.richText + d : Uh(i, '<div style="' + f + ";" + p + ';">' + $e(c) + "</div>" + d, t);
}
function $x(r, e, t, i) {
  var n = r.renderMode, s = e.noName, a = e.noValue, o = !e.markerType, l = e.name, h = r.useUTC, u = e.valueFormatter || r.valueFormatter || function(w) {
    return w = F(w) ? w : [w], J(w, function(_, E) {
      return Hh(_, F(f) ? f[E] : f, h);
    });
  };
  if (!(s && a)) {
    var d = o ? "" : r.markupStyleCreator.makeTooltipMarker(e.markerType, e.markerColor || "#333", n), c = s ? "" : Hh(l, "ordinal", h), f = e.valueType, p = a ? [] : u(e.value, e.dataIndex), m = !o || !s, g = !o && s, v = jv(i, n), b = v.nameStyle, y = v.valueStyle;
    return n === "richText" ? (o ? "" : d) + (s ? "" : $v(r, c, b)) + (a ? "" : Jx(r, p, m, g, y)) : Uh(i, (o ? "" : d) + (s ? "" : Kx(c, !o, b)) + (a ? "" : Zx(p, m, g, y)), t);
  }
}
function rf(r, e, t, i, n, s) {
  if (r) {
    var a = Yv(r), o = {
      useUTC: n,
      renderMode: t,
      orderMode: i,
      markupStyleCreator: e,
      valueFormatter: r.valueFormatter
    };
    return a(o, r, 0, s);
  }
}
function qx(r) {
  return {
    html: jx[r],
    richText: Yx[r]
  };
}
function Uh(r, e, t) {
  var i = '<div style="clear:both"></div>', n = "margin: " + t + "px 0 0", s = Uv(r);
  return '<div style="' + n + ";" + s + ';">' + e + i + "</div>";
}
function Kx(r, e, t) {
  var i = e ? "margin-left:2px" : "";
  return '<span style="' + t + ";" + i + '">' + $e(r) + "</span>";
}
function Zx(r, e, t, i) {
  var n = t ? "10px" : "20px", s = e ? "float:right;margin-left:" + n : "";
  return r = F(r) ? r : [r], '<span style="' + s + ";" + i + '">' + J(r, function(a) {
    return $e(a);
  }).join("&nbsp;&nbsp;") + "</span>";
}
function $v(r, e, t) {
  return r.markupStyleCreator.wrapRichTextStyle(e, t);
}
function Jx(r, e, t, i, n) {
  var s = [n], a = i ? 10 : 20;
  return t && s.push({
    padding: [0, 0, 0, a],
    align: "right"
  }), r.markupStyleCreator.wrapRichTextStyle(F(e) ? e.join("  ") : e, s);
}
function Qx(r, e) {
  var t = r.getData().getItemVisual(e, "style"), i = t[r.visualDrawType];
  return ls(i);
}
function qv(r, e) {
  var t = r.get("padding");
  return t ?? (e === "richText" ? [8, 10] : 10);
}
var pl = (
  /** @class */
  function() {
    function r() {
      this.richTextStyles = {}, this._nextStyleNameId = Ag();
    }
    return r.prototype._generateStyleName = function() {
      return "__EC_aUTo_" + this._nextStyleNameId++;
    }, r.prototype.makeTooltipMarker = function(e, t, i) {
      var n = i === "richText" ? this._generateStyleName() : null, s = OT({
        color: t,
        type: e,
        renderMode: i,
        markerId: n
      });
      return V(s) ? s : (process.env.NODE_ENV !== "production" && Y(n), this.richTextStyles[n] = s.style, s.content);
    }, r.prototype.wrapRichTextStyle = function(e, t) {
      var i = {};
      F(t) ? M(t, function(s) {
        return P(i, s);
      }) : P(i, t);
      var n = this._generateStyleName();
      return this.richTextStyles[n] = i, "{" + n + "|" + e + "}";
    }, r;
  }()
);
function e1(r) {
  var e = r.series, t = r.dataIndex, i = r.multipleSeries, n = e.getData(), s = n.mapDimensionsAll("defaultedTooltip"), a = s.length, o = e.getRawValue(t), l = F(o), h = Qx(e, t), u, d, c, f;
  if (a > 1 || l && !a) {
    var p = t1(o, e, t, s, h);
    u = p.inlineValues, d = p.inlineValueTypes, c = p.blocks, f = p.inlineValues[0];
  } else if (a) {
    var m = n.getDimensionInfo(s[0]);
    f = u = Ia(n, t, s[0]), d = m.type;
  } else
    f = u = l ? o[0] : o;
  var g = zg(e), v = g && e.name || "", b = n.getName(t), y = i ? v : b;
  return Jr("section", {
    header: v,
    // When series name is not specified, do not show a header line with only '-'.
    // This case always happens in tooltip.trigger: 'item'.
    noHeader: i || !g,
    sortParam: f,
    blocks: [Jr("nameValue", {
      markerType: "item",
      markerColor: h,
      // Do not mix display seriesName and itemName in one tooltip,
      // which might confuses users.
      name: y,
      // name dimension might be auto assigned, where the name might
      // be not readable. So we check trim here.
      noName: !zt(y),
      value: u,
      valueType: d,
      dataIndex: t
    })].concat(c || [])
  });
}
function t1(r, e, t, i, n) {
  var s = e.getData(), a = tn(r, function(d, c, f) {
    var p = s.getDimensionInfo(f);
    return d = d || p && p.tooltip !== !1 && p.displayName != null;
  }, !1), o = [], l = [], h = [];
  i.length ? M(i, function(d) {
    u(Ia(s, t, d), d);
  }) : M(r, u);
  function u(d, c) {
    var f = s.getDimensionInfo(c);
    !f || f.otherDims.tooltip === !1 || (a ? h.push(Jr("nameValue", {
      markerType: "subItem",
      markerColor: n,
      name: f.displayName,
      value: d,
      valueType: f.type
    })) : (o.push(d), l.push(f.type)));
  }
  return {
    inlineValues: o,
    inlineValueTypes: l,
    blocks: h
  };
}
var li = Te();
function Ws(r, e) {
  return r.getName(e) || r.getId(e);
}
var i1 = "__universalTransitionEnabled", Si = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      var t = r !== null && r.apply(this, arguments) || this;
      return t._selectedDataIndicesMap = {}, t;
    }
    return e.prototype.init = function(t, i, n) {
      this.seriesIndex = this.componentIndex, this.dataTask = Kn({
        count: n1,
        reset: s1
      }), this.dataTask.context = {
        model: this
      }, this.mergeDefaultAndTheme(t, n);
      var s = li(this).sourceManager = new Gx(this);
      s.prepareSource();
      var a = this.getInitialData(t, n);
      sf(a, this), this.dataTask.context.data = a, process.env.NODE_ENV !== "production" && Y(a, "getInitialData returned invalid data."), li(this).dataBeforeProcessed = a, nf(this), this._initSelectedMapFromData(a);
    }, e.prototype.mergeDefaultAndTheme = function(t, i) {
      var n = Aa(this), s = n ? xv(t) : {}, a = this.subType;
      ae.hasClass(a) && (a += "Series"), Ee(t, i.getTheme().get(this.subType)), Ee(t, this.getDefaultOption()), Ud(t, "label", ["show"]), this.fillDataTextStyle(t.data), n && Pa(t, s, n);
    }, e.prototype.mergeOption = function(t, i) {
      t = Ee(this.option, t, !0), this.fillDataTextStyle(t.data);
      var n = Aa(this);
      n && Pa(this.option, t, n);
      var s = li(this).sourceManager;
      s.dirty(), s.prepareSource();
      var a = this.getInitialData(t, i);
      sf(a, this), this.dataTask.dirty(), this.dataTask.context.data = a, li(this).dataBeforeProcessed = a, nf(this), this._initSelectedMapFromData(a);
    }, e.prototype.fillDataTextStyle = function(t) {
      if (t && !Ge(t))
        for (var i = ["show"], n = 0; n < t.length; n++)
          t[n] && t[n].label && Ud(t[n], "label", i);
    }, e.prototype.getInitialData = function(t, i) {
    }, e.prototype.appendData = function(t) {
      var i = this.getRawData();
      i.appendData(t.data);
    }, e.prototype.getData = function(t) {
      var i = jh(this);
      if (i) {
        var n = i.context.data;
        return t == null || !n.getLinkedData ? n : n.getLinkedData(t);
      } else
        return li(this).data;
    }, e.prototype.getAllData = function() {
      var t = this.getData();
      return t && t.getLinkedDataAll ? t.getLinkedDataAll() : [{
        data: t
      }];
    }, e.prototype.setData = function(t) {
      var i = jh(this);
      if (i) {
        var n = i.context;
        n.outputData = t, i !== this.dataTask && (n.data = t);
      }
      li(this).data = t;
    }, e.prototype.getEncode = function() {
      var t = this.get("encode", !0);
      if (t)
        return Z(t);
    }, e.prototype.getSourceManager = function() {
      return li(this).sourceManager;
    }, e.prototype.getSource = function() {
      return this.getSourceManager().getSource();
    }, e.prototype.getRawData = function() {
      return li(this).dataBeforeProcessed;
    }, e.prototype.getColorBy = function() {
      var t = this.get("colorBy");
      return t || "series";
    }, e.prototype.isColorBySeries = function() {
      return this.getColorBy() === "series";
    }, e.prototype.getBaseAxis = function() {
      var t = this.coordinateSystem;
      return t && t.getBaseAxis && t.getBaseAxis();
    }, e.prototype.formatTooltip = function(t, i, n) {
      return e1({
        series: this,
        dataIndex: t,
        multipleSeries: i
      });
    }, e.prototype.isAnimationEnabled = function() {
      var t = this.ecModel;
      if (W.node && !(t && t.ssr))
        return !1;
      var i = this.getShallow("animation");
      return i && this.getData().count() > this.getShallow("animationThreshold") && (i = !1), !!i;
    }, e.prototype.restoreData = function() {
      this.dataTask.dirty();
    }, e.prototype.getColorFromPalette = function(t, i, n) {
      var s = this.ecModel, a = Nu.prototype.getColorFromPalette.call(this, t, i, n);
      return a || (a = s.getColorFromPalette(t, i, n)), a;
    }, e.prototype.coordDimToDataDim = function(t) {
      return this.getRawData().mapDimensionsAll(t);
    }, e.prototype.getProgressive = function() {
      return this.get("progressive");
    }, e.prototype.getProgressiveThreshold = function() {
      return this.get("progressiveThreshold");
    }, e.prototype.select = function(t, i) {
      this._innerSelect(this.getData(i), t);
    }, e.prototype.unselect = function(t, i) {
      var n = this.option.selectedMap;
      if (n) {
        var s = this.option.selectedMode, a = this.getData(i);
        if (s === "series" || n === "all") {
          this.option.selectedMap = {}, this._selectedDataIndicesMap = {};
          return;
        }
        for (var o = 0; o < t.length; o++) {
          var l = t[o], h = Ws(a, l);
          n[h] = !1, this._selectedDataIndicesMap[h] = -1;
        }
      }
    }, e.prototype.toggleSelect = function(t, i) {
      for (var n = [], s = 0; s < t.length; s++)
        n[0] = t[s], this.isSelected(t[s], i) ? this.unselect(n, i) : this.select(n, i);
    }, e.prototype.getSelectedDataIndices = function() {
      if (this.option.selectedMap === "all")
        return [].slice.call(this.getData().getIndices());
      for (var t = this._selectedDataIndicesMap, i = me(t), n = [], s = 0; s < i.length; s++) {
        var a = t[i[s]];
        a >= 0 && n.push(a);
      }
      return n;
    }, e.prototype.isSelected = function(t, i) {
      var n = this.option.selectedMap;
      if (!n)
        return !1;
      var s = this.getData(i);
      return (n === "all" || n[Ws(s, t)]) && !s.getItemModel(t).get(["select", "disabled"]);
    }, e.prototype.isUniversalTransitionEnabled = function() {
      if (this[i1])
        return !0;
      var t = this.option.universalTransition;
      return t ? t === !0 ? !0 : t && t.enabled : !1;
    }, e.prototype._innerSelect = function(t, i) {
      var n, s, a = this.option, o = a.selectedMode, l = i.length;
      if (!(!o || !l)) {
        if (o === "series")
          a.selectedMap = "all";
        else if (o === "multiple") {
          B(a.selectedMap) || (a.selectedMap = {});
          for (var h = a.selectedMap, u = 0; u < l; u++) {
            var d = i[u], c = Ws(t, d);
            h[c] = !0, this._selectedDataIndicesMap[c] = t.getRawIndex(d);
          }
        } else if (o === "single" || o === !0) {
          var f = i[l - 1], c = Ws(t, f);
          a.selectedMap = (n = {}, n[c] = !0, n), this._selectedDataIndicesMap = (s = {}, s[c] = t.getRawIndex(f), s);
        }
      }
    }, e.prototype._initSelectedMapFromData = function(t) {
      if (!this.option.selectedMap) {
        var i = [];
        t.hasItemOption && t.each(function(n) {
          var s = t.getRawDataItem(n);
          s && s.selected && i.push(n);
        }), i.length > 0 && this._innerSelect(t, i);
      }
    }, e.registerClass = function(t) {
      return ae.registerClass(t);
    }, e.protoInitialize = function() {
      var t = e.prototype;
      t.type = "series.__base__", t.seriesIndex = 0, t.ignoreStyleOnData = !1, t.hasSymbolVisual = !1, t.defaultSymbol = "circle", t.visualStyleAccessPath = "itemStyle", t.visualDrawType = "fill";
    }(), e;
  }(ae)
);
ii(Si, Mx);
ii(Si, Nu);
Ng(Si, ae);
function nf(r) {
  var e = r.name;
  zg(r) || (r.name = r1(r) || e);
}
function r1(r) {
  var e = r.getRawData(), t = e.mapDimensionsAll("seriesName"), i = [];
  return M(t, function(n) {
    var s = e.getDimensionInfo(n);
    s.displayName && i.push(s.displayName);
  }), i.join(" ");
}
function n1(r) {
  return r.model.getRawData().count();
}
function s1(r) {
  var e = r.model;
  return e.setData(e.getRawData().cloneShallow()), a1;
}
function a1(r, e) {
  e.outputData && r.end > e.outputData.count() && e.model.getRawData().cloneShallow(e.outputData);
}
function sf(r, e) {
  M(u0(r.CHANGABLE_METHODS, r.DOWNSAMPLE_METHODS), function(t) {
    r.wrapMethod(t, He(o1, e));
  });
}
function o1(r, e) {
  var t = jh(r);
  return t && t.setOutputEnd((e || this).count()), e;
}
function jh(r) {
  var e = (r.ecModel || {}).scheduler, t = e && e.getPipeline(r.uid);
  if (t) {
    var i = t.currentTask;
    if (i) {
      var n = i.agentStubMap;
      n && (i = n.get(r.uid));
    }
    return i;
  }
}
var ti = (
  /** @class */
  function() {
    function r() {
      this.group = new lt(), this.uid = uo("viewComponent");
    }
    return r.prototype.init = function(e, t) {
    }, r.prototype.render = function(e, t, i, n) {
    }, r.prototype.dispose = function(e, t) {
    }, r.prototype.updateView = function(e, t, i, n) {
    }, r.prototype.updateLayout = function(e, t, i, n) {
    }, r.prototype.updateVisual = function(e, t, i, n) {
    }, r.prototype.toggleBlurSeries = function(e, t, i) {
    }, r.prototype.eachRendered = function(e) {
      var t = this.group;
      t && t.traverse(e);
    }, r;
  }()
);
yu(ti);
wu(ti);
function l1() {
  var r = Te();
  return function(e) {
    var t = r(e), i = e.pipelineContext, n = !!t.large, s = !!t.progressiveRender, a = t.large = !!(i && i.large), o = t.progressiveRender = !!(i && i.progressiveRender);
    return (n !== a || s !== o) && "reset";
  };
}
var Kv = Te(), h1 = l1(), Ei = (
  /** @class */
  function() {
    function r() {
      this.group = new lt(), this.uid = uo("viewChart"), this.renderTask = Kn({
        plan: u1,
        reset: d1
      }), this.renderTask.context = {
        view: this
      };
    }
    return r.prototype.init = function(e, t) {
    }, r.prototype.render = function(e, t, i, n) {
      if (process.env.NODE_ENV !== "production")
        throw new Error("render method must been implemented");
    }, r.prototype.highlight = function(e, t, i, n) {
      var s = e.getData(n && n.dataType);
      if (!s) {
        process.env.NODE_ENV !== "production" && Ne("Unknown dataType " + n.dataType);
        return;
      }
      of(s, n, "emphasis");
    }, r.prototype.downplay = function(e, t, i, n) {
      var s = e.getData(n && n.dataType);
      if (!s) {
        process.env.NODE_ENV !== "production" && Ne("Unknown dataType " + n.dataType);
        return;
      }
      of(s, n, "normal");
    }, r.prototype.remove = function(e, t) {
      this.group.removeAll();
    }, r.prototype.dispose = function(e, t) {
    }, r.prototype.updateView = function(e, t, i, n) {
      this.render(e, t, i, n);
    }, r.prototype.updateLayout = function(e, t, i, n) {
      this.render(e, t, i, n);
    }, r.prototype.updateVisual = function(e, t, i, n) {
      this.render(e, t, i, n);
    }, r.prototype.eachRendered = function(e) {
      vv(this.group, e);
    }, r.markUpdateMethod = function(e, t) {
      Kv(e).updateMethod = t;
    }, r.protoInitialize = function() {
      var e = r.prototype;
      e.type = "chart";
    }(), r;
  }()
);
function af(r, e, t) {
  r && xi(r) && (e === "emphasis" ? Lh : kh)(r, t);
}
function of(r, e, t) {
  var i = ms(r, e), n = e && e.highlightKey != null ? hE(e.highlightKey) : null;
  i != null ? M(Me(i), function(s) {
    af(r.getItemGraphicEl(s), t, n);
  }) : r.eachItemGraphicEl(function(s) {
    af(s, t, n);
  });
}
yu(Ei, ["dispose"]);
wu(Ei);
function u1(r) {
  return h1(r.model);
}
function d1(r) {
  var e = r.model, t = r.ecModel, i = r.api, n = r.payload, s = e.pipelineContext.progressiveRender, a = r.view, o = n && Kv(n).updateMethod, l = s ? "incrementalPrepareRender" : o && a[o] ? o : "render";
  return l !== "render" && a[l](e, t, i, n), c1[l];
}
var c1 = {
  incrementalPrepareRender: {
    progress: function(r, e) {
      e.view.incrementalRender(r, e.model, e.ecModel, e.api, e.payload);
    }
  },
  render: {
    // Put view.render in `progress` to support appendData. But in this case
    // view.render should not be called in reset, otherwise it will be called
    // twise. Use `forceFirstProgress` to make sure that view.render is called
    // in any cases.
    forceFirstProgress: !0,
    progress: function(r, e) {
      e.view.render(e.model, e.ecModel, e.api, e.payload);
    }
  }
}, za = "\0__throttleOriginMethod", lf = "\0__throttleRate", hf = "\0__throttleType";
function Uu(r, e, t) {
  var i, n = 0, s = 0, a = null, o, l, h, u;
  e = e || 0;
  function d() {
    s = (/* @__PURE__ */ new Date()).getTime(), a = null, r.apply(l, h || []);
  }
  var c = function() {
    for (var f = [], p = 0; p < arguments.length; p++)
      f[p] = arguments[p];
    i = (/* @__PURE__ */ new Date()).getTime(), l = this, h = f;
    var m = u || e, g = u || t;
    u = null, o = i - (g ? n : s) - m, clearTimeout(a), g ? a = setTimeout(d, m) : o >= 0 ? d() : a = setTimeout(d, -o), n = i;
  };
  return c.clear = function() {
    a && (clearTimeout(a), a = null);
  }, c.debounceNextCall = function(f) {
    u = f;
  }, c;
}
function Zv(r, e, t, i) {
  var n = r[e];
  if (n) {
    var s = n[za] || n, a = n[hf], o = n[lf];
    if (o !== t || a !== i) {
      if (t == null || !i)
        return r[e] = s;
      n = r[e] = Uu(s, t, i === "debounce"), n[za] = s, n[hf] = i, n[lf] = t;
    }
    return n;
  }
}
function Yh(r, e) {
  var t = r[e];
  t && t[za] && (t.clear && t.clear(), r[e] = t[za]);
}
var uf = Te(), df = {
  itemStyle: Kr(bv, !0),
  lineStyle: Kr(mv, !0)
}, f1 = {
  lineStyle: "stroke",
  itemStyle: "fill"
};
function Jv(r, e) {
  var t = r.visualStyleMapper || df[e];
  return t || (console.warn("Unknown style type '" + e + "'."), df.itemStyle);
}
function Qv(r, e) {
  var t = r.visualDrawType || f1[e];
  return t || (console.warn("Unknown style type '" + e + "'."), "fill");
}
var p1 = {
  createOnAllSeries: !0,
  performRawSeries: !0,
  reset: function(r, e) {
    var t = r.getData(), i = r.visualStyleAccessPath || "itemStyle", n = r.getModel(i), s = Jv(r, i), a = s(n), o = n.getShallow("decal");
    o && (t.setVisual("decal", o), o.dirty = !0);
    var l = Qv(r, i), h = a[l], u = q(h) ? h : null, d = a.fill === "auto" || a.stroke === "auto";
    if (!a[l] || u || d) {
      var c = r.getColorFromPalette(
        // TODO series count changed.
        r.name,
        null,
        e.getSeriesCount()
      );
      a[l] || (a[l] = c, t.setVisual("colorFromPalette", !0)), a.fill = a.fill === "auto" || q(a.fill) ? c : a.fill, a.stroke = a.stroke === "auto" || q(a.stroke) ? c : a.stroke;
    }
    if (t.setVisual("style", a), t.setVisual("drawType", l), !e.isSeriesFiltered(r) && u)
      return t.setVisual("colorFromPalette", !1), {
        dataEach: function(f, p) {
          var m = r.getDataParams(p), g = P({}, a);
          g[l] = u(m), f.setItemVisual(p, "style", g);
        }
      };
  }
}, _n = new pe(), g1 = {
  createOnAllSeries: !0,
  performRawSeries: !0,
  reset: function(r, e) {
    if (!(r.ignoreStyleOnData || e.isSeriesFiltered(r))) {
      var t = r.getData(), i = r.visualStyleAccessPath || "itemStyle", n = Jv(r, i), s = t.getVisual("drawType");
      return {
        dataEach: t.hasItemOption ? function(a, o) {
          var l = a.getRawDataItem(o);
          if (l && l[i]) {
            _n.option = l[i];
            var h = n(_n), u = a.ensureUniqueItemVisual(o, "style");
            P(u, h), _n.option.decal && (a.setItemVisual(o, "decal", _n.option.decal), _n.option.decal.dirty = !0), s in h && a.setItemVisual(o, "colorFromPalette", !1);
          }
        } : null
      };
    }
  }
}, v1 = {
  performRawSeries: !0,
  overallReset: function(r) {
    var e = Z();
    r.eachSeries(function(t) {
      var i = t.getColorBy();
      if (!t.isColorBySeries()) {
        var n = t.type + "-" + i, s = e.get(n);
        s || (s = {}, e.set(n, s)), uf(t).scope = s;
      }
    }), r.eachSeries(function(t) {
      if (!(t.isColorBySeries() || r.isSeriesFiltered(t))) {
        var i = t.getRawData(), n = {}, s = t.getData(), a = uf(t).scope, o = t.visualStyleAccessPath || "itemStyle", l = Qv(t, o);
        s.each(function(h) {
          var u = s.getRawIndex(h);
          n[u] = h;
        }), i.each(function(h) {
          var u = n[h], d = s.getItemVisual(u, "colorFromPalette");
          if (d) {
            var c = s.ensureUniqueItemVisual(u, "style"), f = i.getName(h) || h + "", p = i.count();
            c[l] = t.getColorFromPalette(f, a, p);
          }
        });
      }
    });
  }
}, Gs = Math.PI;
function m1(r, e) {
  e = e || {}, ge(e, {
    text: "loading",
    textColor: "#000",
    fontSize: 12,
    fontWeight: "normal",
    fontStyle: "normal",
    fontFamily: "sans-serif",
    maskColor: "rgba(255, 255, 255, 0.8)",
    showSpinner: !0,
    color: "#5470c6",
    spinnerRadius: 10,
    lineWidth: 5,
    zlevel: 0
  });
  var t = new lt(), i = new ot({
    style: {
      fill: e.maskColor
    },
    zlevel: e.zlevel,
    z: 1e4
  });
  t.add(i);
  var n = new ht({
    style: {
      text: e.text,
      fill: e.textColor,
      fontSize: e.fontSize,
      fontWeight: e.fontWeight,
      fontStyle: e.fontStyle,
      fontFamily: e.fontFamily
    },
    zlevel: e.zlevel,
    z: 10001
  }), s = new ot({
    style: {
      fill: "none"
    },
    textContent: n,
    textConfig: {
      position: "right",
      distance: 10
    },
    zlevel: e.zlevel,
    z: 10001
  });
  t.add(s);
  var a;
  return e.showSpinner && (a = new lo({
    shape: {
      startAngle: -Gs / 2,
      endAngle: -Gs / 2 + 0.1,
      r: e.spinnerRadius
    },
    style: {
      stroke: e.color,
      lineCap: "round",
      lineWidth: e.lineWidth
    },
    zlevel: e.zlevel,
    z: 10001
  }), a.animateShape(!0).when(1e3, {
    endAngle: Gs * 3 / 2
  }).start("circularInOut"), a.animateShape(!0).when(1e3, {
    startAngle: Gs * 3 / 2
  }).delay(300).start("circularInOut"), t.add(a)), t.resize = function() {
    var o = n.getBoundingRect().width, l = e.showSpinner ? e.spinnerRadius : 0, h = (r.getWidth() - l * 2 - (e.showSpinner && o ? 10 : 0) - o) / 2 - (e.showSpinner && o ? 0 : 5 + o / 2) + (e.showSpinner ? 0 : o / 2) + (o ? 0 : l), u = r.getHeight() / 2;
    e.showSpinner && a.setShape({
      cx: h,
      cy: u
    }), s.setShape({
      x: h - l,
      y: u - l,
      width: l * 2,
      height: l * 2
    }), i.setShape({
      x: 0,
      y: 0,
      width: r.getWidth(),
      height: r.getHeight()
    });
  }, t.resize(), t;
}
var em = (
  /** @class */
  function() {
    function r(e, t, i, n) {
      this._stageTaskMap = Z(), this.ecInstance = e, this.api = t, i = this._dataProcessorHandlers = i.slice(), n = this._visualHandlers = n.slice(), this._allHandlers = i.concat(n);
    }
    return r.prototype.restoreData = function(e, t) {
      e.restoreData(t), this._stageTaskMap.each(function(i) {
        var n = i.overallTask;
        n && n.dirty();
      });
    }, r.prototype.getPerformArgs = function(e, t) {
      if (e.__pipeline) {
        var i = this._pipelineMap.get(e.__pipeline.id), n = i.context, s = !t && i.progressiveEnabled && (!n || n.progressiveRender) && e.__idxInPipeline > i.blockIndex, a = s ? i.step : null, o = n && n.modDataCount, l = o != null ? Math.ceil(o / a) : null;
        return {
          step: a,
          modBy: l,
          modDataCount: o
        };
      }
    }, r.prototype.getPipeline = function(e) {
      return this._pipelineMap.get(e);
    }, r.prototype.updateStreamModes = function(e, t) {
      var i = this._pipelineMap.get(e.uid), n = e.getData(), s = n.count(), a = i.progressiveEnabled && t.incrementalPrepareRender && s >= i.threshold, o = e.get("large") && s >= e.get("largeThreshold"), l = e.get("progressiveChunkMode") === "mod" ? s : null;
      e.pipelineContext = i.context = {
        progressiveRender: a,
        modDataCount: l,
        large: o
      };
    }, r.prototype.restorePipelines = function(e) {
      var t = this, i = t._pipelineMap = Z();
      e.eachSeries(function(n) {
        var s = n.getProgressive(), a = n.uid;
        i.set(a, {
          id: a,
          head: null,
          tail: null,
          threshold: n.getProgressiveThreshold(),
          progressiveEnabled: s && !(n.preventIncremental && n.preventIncremental()),
          blockIndex: -1,
          step: Math.round(s || 700),
          count: 0
        }), t._pipe(n, n.dataTask);
      });
    }, r.prototype.prepareStageTasks = function() {
      var e = this._stageTaskMap, t = this.api.getModel(), i = this.api;
      M(this._allHandlers, function(n) {
        var s = e.get(n.uid) || e.set(n.uid, {}), a = "";
        process.env.NODE_ENV !== "production" && (a = '"reset" and "overallReset" must not be both specified.'), Y(!(n.reset && n.overallReset), a), n.reset && this._createSeriesStageTask(n, s, t, i), n.overallReset && this._createOverallStageTask(n, s, t, i);
      }, this);
    }, r.prototype.prepareView = function(e, t, i, n) {
      var s = e.renderTask, a = s.context;
      a.model = t, a.ecModel = i, a.api = n, s.__block = !e.incrementalPrepareRender, this._pipe(t, s);
    }, r.prototype.performDataProcessorTasks = function(e, t) {
      this._performStageTasks(this._dataProcessorHandlers, e, t, {
        block: !0
      });
    }, r.prototype.performVisualTasks = function(e, t, i) {
      this._performStageTasks(this._visualHandlers, e, t, i);
    }, r.prototype._performStageTasks = function(e, t, i, n) {
      n = n || {};
      var s = !1, a = this;
      M(e, function(l, h) {
        if (!(n.visualType && n.visualType !== l.visualType)) {
          var u = a._stageTaskMap.get(l.uid), d = u.seriesTaskMap, c = u.overallTask;
          if (c) {
            var f, p = c.agentStubMap;
            p.each(function(g) {
              o(n, g) && (g.dirty(), f = !0);
            }), f && c.dirty(), a.updatePayload(c, i);
            var m = a.getPerformArgs(c, n.block);
            p.each(function(g) {
              g.perform(m);
            }), c.perform(m) && (s = !0);
          } else d && d.each(function(g, v) {
            o(n, g) && g.dirty();
            var b = a.getPerformArgs(g, n.block);
            b.skip = !l.performRawSeries && t.isSeriesFiltered(g.context.model), a.updatePayload(g, i), g.perform(b) && (s = !0);
          });
        }
      });
      function o(l, h) {
        return l.setDirty && (!l.dirtyMap || l.dirtyMap.get(h.__pipeline.id));
      }
      this.unfinished = s || this.unfinished;
    }, r.prototype.performSeriesTasks = function(e) {
      var t;
      e.eachSeries(function(i) {
        t = i.dataTask.perform() || t;
      }), this.unfinished = t || this.unfinished;
    }, r.prototype.plan = function() {
      this._pipelineMap.each(function(e) {
        var t = e.tail;
        do {
          if (t.__block) {
            e.blockIndex = t.__idxInPipeline;
            break;
          }
          t = t.getUpstream();
        } while (t);
      });
    }, r.prototype.updatePayload = function(e, t) {
      t !== "remain" && (e.context.payload = t);
    }, r.prototype._createSeriesStageTask = function(e, t, i, n) {
      var s = this, a = t.seriesTaskMap, o = t.seriesTaskMap = Z(), l = e.seriesType, h = e.getTargetSeries;
      e.createOnAllSeries ? i.eachRawSeries(u) : l ? i.eachRawSeriesByType(l, u) : h && h(i, n).each(u);
      function u(d) {
        var c = d.uid, f = o.set(c, a && a.get(c) || Kn({
          plan: _1,
          reset: E1,
          count: x1
        }));
        f.context = {
          model: d,
          ecModel: i,
          api: n,
          // PENDING: `useClearVisual` not used?
          useClearVisual: e.isVisual && !e.isLayout,
          plan: e.plan,
          reset: e.reset,
          scheduler: s
        }, s._pipe(d, f);
      }
    }, r.prototype._createOverallStageTask = function(e, t, i, n) {
      var s = this, a = t.overallTask = t.overallTask || Kn({
        reset: b1
      });
      a.context = {
        ecModel: i,
        api: n,
        overallReset: e.overallReset,
        scheduler: s
      };
      var o = a.agentStubMap, l = a.agentStubMap = Z(), h = e.seriesType, u = e.getTargetSeries, d = !0, c = !1, f = "";
      process.env.NODE_ENV !== "production" && (f = '"createOnAllSeries" is not supported for "overallReset", because it will block all streams.'), Y(!e.createOnAllSeries, f), h ? i.eachRawSeriesByType(h, p) : u ? u(i, n).each(p) : (d = !1, M(i.getSeries(), p));
      function p(m) {
        var g = m.uid, v = l.set(g, o && o.get(g) || // When the result of `getTargetSeries` changed, the overallTask
        // should be set as dirty and re-performed.
        (c = !0, Kn({
          reset: y1,
          onDirty: C1
        })));
        v.context = {
          model: m,
          overallProgress: d
          // FIXME:TS never used, so comment it
          // modifyOutputEnd: modifyOutputEnd
        }, v.agent = a, v.__block = d, s._pipe(m, v);
      }
      c && a.dirty();
    }, r.prototype._pipe = function(e, t) {
      var i = e.uid, n = this._pipelineMap.get(i);
      !n.head && (n.head = t), n.tail && n.tail.pipe(t), n.tail = t, t.__idxInPipeline = n.count++, t.__pipeline = n;
    }, r.wrapStageHandler = function(e, t) {
      return q(e) && (e = {
        overallReset: e,
        seriesType: S1(e)
      }), e.uid = uo("stageHandler"), t && (e.visualType = t), e;
    }, r;
  }()
);
function b1(r) {
  r.overallReset(r.ecModel, r.api, r.payload);
}
function y1(r) {
  return r.overallProgress && w1;
}
function w1() {
  this.agent.dirty(), this.getDownstream().dirty();
}
function C1() {
  this.agent && this.agent.dirty();
}
function _1(r) {
  return r.plan ? r.plan(r.model, r.ecModel, r.api, r.payload) : null;
}
function E1(r) {
  r.useClearVisual && r.data.clearAllVisual();
  var e = r.resetDefines = Me(r.reset(r.model, r.ecModel, r.api, r.payload));
  return e.length > 1 ? J(e, function(t, i) {
    return tm(i);
  }) : T1;
}
var T1 = tm(0);
function tm(r) {
  return function(e, t) {
    var i = t.data, n = t.resetDefines[r];
    if (n && n.dataEach)
      for (var s = e.start; s < e.end; s++)
        n.dataEach(i, s);
    else n && n.progress && n.progress(e, i);
  };
}
function x1(r) {
  return r.data.count();
}
function S1(r) {
  Fa = null;
  try {
    r(us, im);
  } catch {
  }
  return Fa;
}
var us = {}, im = {}, Fa;
rm(us, Bu);
rm(im, Lv);
us.eachSeriesByType = us.eachRawSeriesByType = function(r) {
  Fa = r;
};
us.eachComponent = function(r) {
  r.mainType === "series" && r.subType && (Fa = r.subType);
};
function rm(r, e) {
  for (var t in e.prototype)
    r[t] = Le;
}
var cf = ["#37A2DA", "#32C5E9", "#67E0E3", "#9FE6B8", "#FFDB5C", "#ff9f7f", "#fb7293", "#E062AE", "#E690D1", "#e7bcf3", "#9d96f5", "#8378EA", "#96BFFF"];
const R1 = {
  color: cf,
  colorLayer: [["#37A2DA", "#ffd85c", "#fd7b5f"], ["#37A2DA", "#67E0E3", "#FFDB5C", "#ff9f7f", "#E062AE", "#9d96f5"], ["#37A2DA", "#32C5E9", "#9FE6B8", "#FFDB5C", "#ff9f7f", "#fb7293", "#e7bcf3", "#8378EA", "#96BFFF"], cf]
};
var Oe = "#B9B8CE", ff = "#100C2A", Us = function() {
  return {
    axisLine: {
      lineStyle: {
        color: Oe
      }
    },
    splitLine: {
      lineStyle: {
        color: "#484753"
      }
    },
    splitArea: {
      areaStyle: {
        color: ["rgba(255,255,255,0.02)", "rgba(255,255,255,0.05)"]
      }
    },
    minorSplitLine: {
      lineStyle: {
        color: "#20203B"
      }
    }
  };
}, pf = ["#4992ff", "#7cffb2", "#fddd60", "#ff6e76", "#58d9f9", "#05c091", "#ff8a45", "#8d48e3", "#dd79ff"], nm = {
  darkMode: !0,
  color: pf,
  backgroundColor: ff,
  axisPointer: {
    lineStyle: {
      color: "#817f91"
    },
    crossStyle: {
      color: "#817f91"
    },
    label: {
      // TODO Contrast of label backgorundColor
      color: "#fff"
    }
  },
  legend: {
    textStyle: {
      color: Oe
    },
    pageTextStyle: {
      color: Oe
    }
  },
  textStyle: {
    color: Oe
  },
  title: {
    textStyle: {
      color: "#EEF1FA"
    },
    subtextStyle: {
      color: "#B9B8CE"
    }
  },
  toolbox: {
    iconStyle: {
      borderColor: Oe
    }
  },
  dataZoom: {
    borderColor: "#71708A",
    textStyle: {
      color: Oe
    },
    brushStyle: {
      color: "rgba(135,163,206,0.3)"
    },
    handleStyle: {
      color: "#353450",
      borderColor: "#C5CBE3"
    },
    moveHandleStyle: {
      color: "#B0B6C3",
      opacity: 0.3
    },
    fillerColor: "rgba(135,163,206,0.2)",
    emphasis: {
      handleStyle: {
        borderColor: "#91B7F2",
        color: "#4D587D"
      },
      moveHandleStyle: {
        color: "#636D9A",
        opacity: 0.7
      }
    },
    dataBackground: {
      lineStyle: {
        color: "#71708A",
        width: 1
      },
      areaStyle: {
        color: "#71708A"
      }
    },
    selectedDataBackground: {
      lineStyle: {
        color: "#87A3CE"
      },
      areaStyle: {
        color: "#87A3CE"
      }
    }
  },
  visualMap: {
    textStyle: {
      color: Oe
    }
  },
  timeline: {
    lineStyle: {
      color: Oe
    },
    label: {
      color: Oe
    },
    controlStyle: {
      color: Oe,
      borderColor: Oe
    }
  },
  calendar: {
    itemStyle: {
      color: ff
    },
    dayLabel: {
      color: Oe
    },
    monthLabel: {
      color: Oe
    },
    yearLabel: {
      color: Oe
    }
  },
  timeAxis: Us(),
  logAxis: Us(),
  valueAxis: Us(),
  categoryAxis: Us(),
  line: {
    symbol: "circle"
  },
  graph: {
    color: pf
  },
  gauge: {
    title: {
      color: Oe
    },
    axisLine: {
      lineStyle: {
        color: [[1, "rgba(207,212,219,0.2)"]]
      }
    },
    axisLabel: {
      color: Oe
    },
    detail: {
      color: "#EEF1FA"
    }
  },
  candlestick: {
    itemStyle: {
      color: "#f64e56",
      color0: "#54ea92",
      borderColor: "#f64e56",
      borderColor0: "#54ea92"
      // borderColor: '#ca2824',
      // borderColor0: '#09a443'
    }
  }
};
nm.categoryAxis.splitLine.show = !1;
var M1 = (
  /** @class */
  function() {
    function r() {
    }
    return r.prototype.normalizeQuery = function(e) {
      var t = {}, i = {}, n = {};
      if (V(e)) {
        var s = Ft(e);
        t.mainType = s.main || null, t.subType = s.sub || null;
      } else {
        var a = ["Index", "Name", "Id"], o = {
          name: 1,
          dataIndex: 1,
          dataType: 1
        };
        M(e, function(l, h) {
          for (var u = !1, d = 0; d < a.length; d++) {
            var c = a[d], f = h.lastIndexOf(c);
            if (f > 0 && f === h.length - c.length) {
              var p = h.slice(0, f);
              p !== "data" && (t.mainType = p, t[c.toLowerCase()] = l, u = !0);
            }
          }
          o.hasOwnProperty(h) && (i[h] = l, u = !0), u || (n[h] = l);
        });
      }
      return {
        cptQuery: t,
        dataQuery: i,
        otherQuery: n
      };
    }, r.prototype.filter = function(e, t) {
      var i = this.eventInfo;
      if (!i)
        return !0;
      var n = i.targetEl, s = i.packedEvent, a = i.model, o = i.view;
      if (!a || !o)
        return !0;
      var l = t.cptQuery, h = t.dataQuery;
      return u(l, a, "mainType") && u(l, a, "subType") && u(l, a, "index", "componentIndex") && u(l, a, "name") && u(l, a, "id") && u(h, s, "name") && u(h, s, "dataIndex") && u(h, s, "dataType") && (!o.filterForExposedEvent || o.filterForExposedEvent(e, t.otherQuery, n, s));
      function u(d, c, f, p) {
        return d[f] == null || c[p || f] === d[f];
      }
    }, r.prototype.afterTrigger = function() {
      this.eventInfo = null;
    }, r;
  }()
), Xh = ["symbol", "symbolSize", "symbolRotate", "symbolOffset"], gf = Xh.concat(["symbolKeepAspect"]), D1 = {
  createOnAllSeries: !0,
  // For legend.
  performRawSeries: !0,
  reset: function(r, e) {
    var t = r.getData();
    if (r.legendIcon && t.setVisual("legendIcon", r.legendIcon), !r.hasSymbolVisual)
      return;
    for (var i = {}, n = {}, s = !1, a = 0; a < Xh.length; a++) {
      var o = Xh[a], l = r.get(o);
      q(l) ? (s = !0, n[o] = l) : i[o] = l;
    }
    if (i.symbol = i.symbol || r.defaultSymbol, t.setVisual(P({
      legendIcon: r.legendIcon || i.symbol,
      symbolKeepAspect: r.get("symbolKeepAspect")
    }, i)), e.isSeriesFiltered(r))
      return;
    var h = me(n);
    function u(d, c) {
      for (var f = r.getRawValue(c), p = r.getDataParams(c), m = 0; m < h.length; m++) {
        var g = h[m];
        d.setItemVisual(c, g, n[g](f, p));
      }
    }
    return {
      dataEach: s ? u : null
    };
  }
}, L1 = {
  createOnAllSeries: !0,
  // For legend.
  performRawSeries: !0,
  reset: function(r, e) {
    if (!r.hasSymbolVisual || e.isSeriesFiltered(r))
      return;
    var t = r.getData();
    function i(n, s) {
      for (var a = n.getItemModel(s), o = 0; o < gf.length; o++) {
        var l = gf[o], h = a.getShallow(l, !0);
        h != null && n.setItemVisual(s, l, h);
      }
    }
    return {
      dataEach: t.hasItemOption ? i : null
    };
  }
};
function k1(r, e, t) {
  switch (t) {
    case "color":
      var i = r.getItemVisual(e, "style");
      return i[r.getVisual("drawType")];
    case "opacity":
      return r.getItemVisual(e, "style").opacity;
    case "symbol":
    case "symbolSize":
    case "liftZ":
      return r.getItemVisual(e, t);
    default:
      process.env.NODE_ENV !== "production" && console.warn("Unknown visual type " + t);
  }
}
function A1(r, e) {
  switch (e) {
    case "color":
      var t = r.getVisual("style");
      return t[r.getVisual("drawType")];
    case "opacity":
      return r.getVisual("style").opacity;
    case "symbol":
    case "symbolSize":
    case "liftZ":
      return r.getVisual(e);
    default:
      process.env.NODE_ENV !== "production" && console.warn("Unknown visual type " + e);
  }
}
function Rr(r, e, t, i, n) {
  var s = r + e;
  t.isSilent(s) || (process.env.NODE_ENV !== "production" && Nt("event " + s + " is deprecated."), i.eachComponent({
    mainType: "series",
    subType: "pie"
  }, function(a) {
    for (var o = a.seriesIndex, l = a.option.selectedMap, h = n.selected, u = 0; u < h.length; u++)
      if (h[u].seriesIndex === o) {
        var d = a.getData(), c = ms(d, n.fromActionPayload);
        t.trigger(s, {
          type: s,
          seriesId: a.id,
          name: F(c) ? d.getName(c[0]) : d.getName(c),
          selected: V(l) ? l : P({}, l)
        });
      }
  }));
}
function P1(r, e, t) {
  r.on("selectchanged", function(i) {
    var n = t.getModel();
    i.isFromClick ? (Rr("map", "selectchanged", e, n, i), Rr("pie", "selectchanged", e, n, i)) : i.fromAction === "select" ? (Rr("map", "selected", e, n, i), Rr("pie", "selected", e, n, i)) : i.fromAction === "unselect" && (Rr("map", "unselected", e, n, i), Rr("pie", "unselected", e, n, i));
  });
}
function Nn(r, e, t) {
  for (var i; r && !(e(r) && (i = r, t)); )
    r = r.__hostTarget || r.parent;
  return i;
}
var O1 = Math.round(Math.random() * 9), I1 = typeof Object.defineProperty == "function", z1 = function() {
  function r() {
    this._id = "__ec_inner_" + O1++;
  }
  return r.prototype.get = function(e) {
    return this._guard(e)[this._id];
  }, r.prototype.set = function(e, t) {
    var i = this._guard(e);
    return I1 ? Object.defineProperty(i, this._id, {
      value: t,
      enumerable: !1,
      configurable: !0
    }) : i[this._id] = t, this;
  }, r.prototype.delete = function(e) {
    return this.has(e) ? (delete this._guard(e)[this._id], !0) : !1;
  }, r.prototype.has = function(e) {
    return !!this._guard(e)[this._id];
  }, r.prototype._guard = function(e) {
    if (e !== Object(e))
      throw TypeError("Value of WeakMap is not a non-null object.");
    return e;
  }, r;
}(), F1 = fe.extend({
  type: "triangle",
  shape: {
    cx: 0,
    cy: 0,
    width: 0,
    height: 0
  },
  buildPath: function(r, e) {
    var t = e.cx, i = e.cy, n = e.width / 2, s = e.height / 2;
    r.moveTo(t, i - s), r.lineTo(t + n, i + s), r.lineTo(t - n, i + s), r.closePath();
  }
}), H1 = fe.extend({
  type: "diamond",
  shape: {
    cx: 0,
    cy: 0,
    width: 0,
    height: 0
  },
  buildPath: function(r, e) {
    var t = e.cx, i = e.cy, n = e.width / 2, s = e.height / 2;
    r.moveTo(t, i - s), r.lineTo(t + n, i), r.lineTo(t, i + s), r.lineTo(t - n, i), r.closePath();
  }
}), N1 = fe.extend({
  type: "pin",
  shape: {
    // x, y on the cusp
    x: 0,
    y: 0,
    width: 0,
    height: 0
  },
  buildPath: function(r, e) {
    var t = e.x, i = e.y, n = e.width / 5 * 3, s = Math.max(n, e.height), a = n / 2, o = a * a / (s - a), l = i - s + a + o, h = Math.asin(o / a), u = Math.cos(h) * a, d = Math.sin(h), c = Math.cos(h), f = a * 0.6, p = a * 0.7;
    r.moveTo(t - u, l + o), r.arc(t, l, a, Math.PI - h, Math.PI * 2 + h), r.bezierCurveTo(t + u - d * f, l + o + c * f, t, i - p, t, i), r.bezierCurveTo(t, i - p, t - u + d * f, l + o + c * f, t - u, l + o), r.closePath();
  }
}), B1 = fe.extend({
  type: "arrow",
  shape: {
    x: 0,
    y: 0,
    width: 0,
    height: 0
  },
  buildPath: function(r, e) {
    var t = e.height, i = e.width, n = e.x, s = e.y, a = i / 3 * 2;
    r.moveTo(n, s), r.lineTo(n + a, s + t), r.lineTo(n, s + t / 4 * 3), r.lineTo(n - a, s + t), r.lineTo(n, s), r.closePath();
  }
}), V1 = {
  line: sn,
  rect: ot,
  roundRect: ot,
  square: ot,
  circle: ao,
  diamond: H1,
  pin: N1,
  arrow: B1,
  triangle: F1
}, W1 = {
  line: function(r, e, t, i, n) {
    n.x1 = r, n.y1 = e + i / 2, n.x2 = r + t, n.y2 = e + i / 2;
  },
  rect: function(r, e, t, i, n) {
    n.x = r, n.y = e, n.width = t, n.height = i;
  },
  roundRect: function(r, e, t, i, n) {
    n.x = r, n.y = e, n.width = t, n.height = i, n.r = Math.min(t, i) / 4;
  },
  square: function(r, e, t, i, n) {
    var s = Math.min(t, i);
    n.x = r, n.y = e, n.width = s, n.height = s;
  },
  circle: function(r, e, t, i, n) {
    n.cx = r + t / 2, n.cy = e + i / 2, n.r = Math.min(t, i) / 2;
  },
  diamond: function(r, e, t, i, n) {
    n.cx = r + t / 2, n.cy = e + i / 2, n.width = t, n.height = i;
  },
  pin: function(r, e, t, i, n) {
    n.x = r + t / 2, n.y = e + i / 2, n.width = t, n.height = i;
  },
  arrow: function(r, e, t, i, n) {
    n.x = r + t / 2, n.y = e + i / 2, n.width = t, n.height = i;
  },
  triangle: function(r, e, t, i, n) {
    n.cx = r + t / 2, n.cy = e + i / 2, n.width = t, n.height = i;
  }
}, $h = {};
M(V1, function(r, e) {
  $h[e] = new r();
});
var G1 = fe.extend({
  type: "symbol",
  shape: {
    symbolType: "",
    x: 0,
    y: 0,
    width: 0,
    height: 0
  },
  calculateTextPosition: function(r, e, t) {
    var i = Sg(r, e, t), n = this.shape;
    return n && n.symbolType === "pin" && e.position === "inside" && (i.y = t.y + t.height * 0.4), i;
  },
  buildPath: function(r, e, t) {
    var i = e.symbolType;
    if (i !== "none") {
      var n = $h[i];
      n || (i = "rect", n = $h[i]), W1[i](e.x, e.y, e.width, e.height, n.shape), n.buildPath(r, n.shape, t);
    }
  }
});
function U1(r, e) {
  if (this.type !== "image") {
    var t = this.style;
    this.__isEmptyBrush ? (t.stroke = r, t.fill = e || "#fff", t.lineWidth = 2) : this.shape.symbolType === "line" ? t.stroke = r : t.fill = r, this.markRedraw();
  }
}
function sm(r, e, t, i, n, s, a) {
  var o = r.indexOf("empty") === 0;
  o && (r = r.substr(5, 1).toLowerCase() + r.substr(6));
  var l;
  return r.indexOf("image://") === 0 ? l = dv(r.slice(8), new re(e, t, i, n), a ? "center" : "cover") : r.indexOf("path://") === 0 ? l = Pu(r.slice(7), {}, new re(e, t, i, n), a ? "center" : "cover") : l = new G1({
    shape: {
      symbolType: r,
      x: e,
      y: t,
      width: i,
      height: n
    }
  }), l.__isEmptyBrush = o, l.setColor = U1, s && l.setColor(s), l;
}
function j1(r, e) {
  if (r != null)
    return F(r) || (r = [r, r]), [Fe(r[0], e[0]) || 0, Fe(j(r[1], r[0]), e[1]) || 0];
}
function tr(r) {
  return isFinite(r);
}
function Y1(r, e, t) {
  var i = e.x == null ? 0 : e.x, n = e.x2 == null ? 1 : e.x2, s = e.y == null ? 0 : e.y, a = e.y2 == null ? 0 : e.y2;
  e.global || (i = i * t.width + t.x, n = n * t.width + t.x, s = s * t.height + t.y, a = a * t.height + t.y), i = tr(i) ? i : 0, n = tr(n) ? n : 1, s = tr(s) ? s : 0, a = tr(a) ? a : 0;
  var o = r.createLinearGradient(i, s, n, a);
  return o;
}
function X1(r, e, t) {
  var i = t.width, n = t.height, s = Math.min(i, n), a = e.x == null ? 0.5 : e.x, o = e.y == null ? 0.5 : e.y, l = e.r == null ? 0.5 : e.r;
  e.global || (a = a * i + t.x, o = o * n + t.y, l = l * s), a = tr(a) ? a : 0.5, o = tr(o) ? o : 0.5, l = l >= 0 && tr(l) ? l : 0.5;
  var h = r.createRadialGradient(a, o, 0, a, o, l);
  return h;
}
function qh(r, e, t) {
  for (var i = e.type === "radial" ? X1(r, e, t) : Y1(r, e, t), n = e.colorStops, s = 0; s < n.length; s++)
    i.addColorStop(n[s].offset, n[s].color);
  return i;
}
function $1(r, e) {
  if (r === e || !r && !e)
    return !1;
  if (!r || !e || r.length !== e.length)
    return !0;
  for (var t = 0; t < r.length; t++)
    if (r[t] !== e[t])
      return !0;
  return !1;
}
function js(r) {
  return parseInt(r, 10);
}
function Ys(r, e, t) {
  var i = ["width", "height"][e], n = ["clientWidth", "clientHeight"][e], s = ["paddingLeft", "paddingTop"][e], a = ["paddingRight", "paddingBottom"][e];
  if (t[i] != null && t[i] !== "auto")
    return parseFloat(t[i]);
  var o = document.defaultView.getComputedStyle(r);
  return (r[n] || js(o[i]) || js(r.style[i])) - (js(o[s]) || 0) - (js(o[a]) || 0) | 0;
}
function q1(r, e) {
  return !r || r === "solid" || !(e > 0) ? null : r === "dashed" ? [4 * e, 2 * e] : r === "dotted" ? [e] : Re(r) ? [r] : F(r) ? r : null;
}
function am(r) {
  var e = r.style, t = e.lineDash && e.lineWidth > 0 && q1(e.lineDash, e.lineWidth), i = e.lineDashOffset;
  if (t) {
    var n = e.strokeNoScale && r.getLineScale ? r.getLineScale() : 1;
    n && n !== 1 && (t = J(t, function(s) {
      return s / n;
    }), i /= n);
  }
  return [t, i];
}
var K1 = new Zr(!0);
function Ha(r) {
  var e = r.stroke;
  return !(e == null || e === "none" || !(r.lineWidth > 0));
}
function vf(r) {
  return typeof r == "string" && r !== "none";
}
function Na(r) {
  var e = r.fill;
  return e != null && e !== "none";
}
function mf(r, e) {
  if (e.fillOpacity != null && e.fillOpacity !== 1) {
    var t = r.globalAlpha;
    r.globalAlpha = e.fillOpacity * e.opacity, r.fill(), r.globalAlpha = t;
  } else
    r.fill();
}
function bf(r, e) {
  if (e.strokeOpacity != null && e.strokeOpacity !== 1) {
    var t = r.globalAlpha;
    r.globalAlpha = e.strokeOpacity * e.opacity, r.stroke(), r.globalAlpha = t;
  } else
    r.stroke();
}
function Kh(r, e, t) {
  var i = Bg(e.image, e.__image, t);
  if (ro(i)) {
    var n = r.createPattern(i, e.repeat || "repeat");
    if (typeof DOMMatrix == "function" && n && n.setTransform) {
      var s = new DOMMatrix();
      s.translateSelf(e.x || 0, e.y || 0), s.rotateSelf(0, 0, (e.rotation || 0) * d0), s.scaleSelf(e.scaleX || 1, e.scaleY || 1), n.setTransform(s);
    }
    return n;
  }
}
function Z1(r, e, t, i) {
  var n, s = Ha(t), a = Na(t), o = t.strokePercent, l = o < 1, h = !e.path;
  (!e.silent || l) && h && e.createPathProxy();
  var u = e.path || K1, d = e.__dirty;
  if (!i) {
    var c = t.fill, f = t.stroke, p = a && !!c.colorStops, m = s && !!f.colorStops, g = a && !!c.image, v = s && !!f.image, b = void 0, y = void 0, w = void 0, _ = void 0, E = void 0;
    (p || m) && (E = e.getBoundingRect()), p && (b = d ? qh(r, c, E) : e.__canvasFillGradient, e.__canvasFillGradient = b), m && (y = d ? qh(r, f, E) : e.__canvasStrokeGradient, e.__canvasStrokeGradient = y), g && (w = d || !e.__canvasFillPattern ? Kh(r, c, e) : e.__canvasFillPattern, e.__canvasFillPattern = w), v && (_ = d || !e.__canvasStrokePattern ? Kh(r, f, e) : e.__canvasStrokePattern, e.__canvasStrokePattern = w), p ? r.fillStyle = b : g && (w ? r.fillStyle = w : a = !1), m ? r.strokeStyle = y : v && (_ ? r.strokeStyle = _ : s = !1);
  }
  var x = e.getGlobalScale();
  u.setScale(x[0], x[1], e.segmentIgnoreThreshold);
  var T, C;
  r.setLineDash && t.lineDash && (n = am(e), T = n[0], C = n[1]);
  var S = !0;
  (h || d & Lr) && (u.setDPR(r.dpr), l ? u.setContext(null) : (u.setContext(r), S = !1), u.reset(), e.buildPath(u, e.shape, i), u.toStatic(), e.pathUpdated()), S && u.rebuildPath(r, l ? o : 1), T && (r.setLineDash(T), r.lineDashOffset = C), i || (t.strokeFirst ? (s && bf(r, t), a && mf(r, t)) : (a && mf(r, t), s && bf(r, t))), T && r.setLineDash([]);
}
function J1(r, e, t) {
  var i = e.__image = Bg(t.image, e.__image, e, e.onload);
  if (!(!i || !ro(i))) {
    var n = t.x || 0, s = t.y || 0, a = e.getWidth(), o = e.getHeight(), l = i.width / i.height;
    if (a == null && o != null ? a = o * l : o == null && a != null ? o = a / l : a == null && o == null && (a = i.width, o = i.height), t.sWidth && t.sHeight) {
      var h = t.sx || 0, u = t.sy || 0;
      r.drawImage(i, h, u, t.sWidth, t.sHeight, n, s, a, o);
    } else if (t.sx && t.sy) {
      var h = t.sx, u = t.sy, d = a - h, c = o - u;
      r.drawImage(i, h, u, d, c, n, s, a, o);
    } else
      r.drawImage(i, n, s, a, o);
  }
}
function Q1(r, e, t) {
  var i, n = t.text;
  if (n != null && (n += ""), n) {
    r.font = t.font || dr, r.textAlign = t.textAlign, r.textBaseline = t.textBaseline;
    var s = void 0, a = void 0;
    r.setLineDash && t.lineDash && (i = am(e), s = i[0], a = i[1]), s && (r.setLineDash(s), r.lineDashOffset = a), t.strokeFirst ? (Ha(t) && r.strokeText(n, t.x, t.y), Na(t) && r.fillText(n, t.x, t.y)) : (Na(t) && r.fillText(n, t.x, t.y), Ha(t) && r.strokeText(n, t.x, t.y)), s && r.setLineDash([]);
  }
}
var yf = ["shadowBlur", "shadowOffsetX", "shadowOffsetY"], wf = [
  ["lineCap", "butt"],
  ["lineJoin", "miter"],
  ["miterLimit", 10]
];
function om(r, e, t, i, n) {
  var s = !1;
  if (!i && (t = t || {}, e === t))
    return !1;
  if (i || e.opacity !== t.opacity) {
    Ze(r, n), s = !0;
    var a = Math.max(Math.min(e.opacity, 1), 0);
    r.globalAlpha = isNaN(a) ? lr.opacity : a;
  }
  (i || e.blend !== t.blend) && (s || (Ze(r, n), s = !0), r.globalCompositeOperation = e.blend || lr.blend);
  for (var o = 0; o < yf.length; o++) {
    var l = yf[o];
    (i || e[l] !== t[l]) && (s || (Ze(r, n), s = !0), r[l] = r.dpr * (e[l] || 0));
  }
  return (i || e.shadowColor !== t.shadowColor) && (s || (Ze(r, n), s = !0), r.shadowColor = e.shadowColor || lr.shadowColor), s;
}
function Cf(r, e, t, i, n) {
  var s = ds(e, n.inHover), a = i ? null : t && ds(t, n.inHover) || {};
  if (s === a)
    return !1;
  var o = om(r, s, a, i, n);
  if ((i || s.fill !== a.fill) && (o || (Ze(r, n), o = !0), vf(s.fill) && (r.fillStyle = s.fill)), (i || s.stroke !== a.stroke) && (o || (Ze(r, n), o = !0), vf(s.stroke) && (r.strokeStyle = s.stroke)), (i || s.opacity !== a.opacity) && (o || (Ze(r, n), o = !0), r.globalAlpha = s.opacity == null ? 1 : s.opacity), e.hasStroke()) {
    var l = s.lineWidth, h = l / (s.strokeNoScale && e.getLineScale ? e.getLineScale() : 1);
    r.lineWidth !== h && (o || (Ze(r, n), o = !0), r.lineWidth = h);
  }
  for (var u = 0; u < wf.length; u++) {
    var d = wf[u], c = d[0];
    (i || s[c] !== a[c]) && (o || (Ze(r, n), o = !0), r[c] = s[c] || d[1]);
  }
  return o;
}
function eS(r, e, t, i, n) {
  return om(r, ds(e, n.inHover), t && ds(t, n.inHover), i, n);
}
function lm(r, e) {
  var t = e.transform, i = r.dpr || 1;
  t ? r.setTransform(i * t[0], i * t[1], i * t[2], i * t[3], i * t[4], i * t[5]) : r.setTransform(i, 0, 0, i, 0, 0);
}
function tS(r, e, t) {
  for (var i = !1, n = 0; n < r.length; n++) {
    var s = r[n];
    i = i || s.isZeroArea(), lm(e, s), e.beginPath(), s.buildPath(e, s.shape), e.clip();
  }
  t.allClipped = i;
}
function iS(r, e) {
  return r && e ? r[0] !== e[0] || r[1] !== e[1] || r[2] !== e[2] || r[3] !== e[3] || r[4] !== e[4] || r[5] !== e[5] : !(!r && !e);
}
var _f = 1, Ef = 2, Tf = 3, xf = 4;
function rS(r) {
  var e = Na(r), t = Ha(r);
  return !(r.lineDash || !(+e ^ +t) || e && typeof r.fill != "string" || t && typeof r.stroke != "string" || r.strokePercent < 1 || r.strokeOpacity < 1 || r.fillOpacity < 1);
}
function Ze(r, e) {
  e.batchFill && r.fill(), e.batchStroke && r.stroke(), e.batchFill = "", e.batchStroke = "";
}
function ds(r, e) {
  return e && r.__hoverStyle || r.style;
}
function hm(r, e) {
  ir(r, e, { inHover: !1, viewWidth: 0, viewHeight: 0 }, !0);
}
function ir(r, e, t, i) {
  var n = e.transform;
  if (!e.shouldBePainted(t.viewWidth, t.viewHeight, !1, !1)) {
    e.__dirty &= ~nt, e.__isRendered = !1;
    return;
  }
  var s = e.__clipPaths, a = t.prevElClipPaths, o = !1, l = !1;
  if ((!a || $1(s, a)) && (a && a.length && (Ze(r, t), r.restore(), l = o = !0, t.prevElClipPaths = null, t.allClipped = !1, t.prevEl = null), s && s.length && (Ze(r, t), r.save(), tS(s, r, t), o = !0), t.prevElClipPaths = s), t.allClipped) {
    e.__isRendered = !1;
    return;
  }
  e.beforeBrush && e.beforeBrush(), e.innerBeforeBrush();
  var h = t.prevEl;
  h || (l = o = !0);
  var u = e instanceof fe && e.autoBatch && rS(e.style);
  o || iS(n, h.transform) ? (Ze(r, t), lm(r, e)) : u || Ze(r, t);
  var d = ds(e, t.inHover);
  e instanceof fe ? (t.lastDrawType !== _f && (l = !0, t.lastDrawType = _f), Cf(r, e, h, l, t), (!u || !t.batchFill && !t.batchStroke) && r.beginPath(), Z1(r, e, d, u), u && (t.batchFill = d.fill || "", t.batchStroke = d.stroke || "")) : e instanceof Ra ? (t.lastDrawType !== Tf && (l = !0, t.lastDrawType = Tf), Cf(r, e, h, l, t), Q1(r, e, d)) : e instanceof cr ? (t.lastDrawType !== Ef && (l = !0, t.lastDrawType = Ef), eS(r, e, h, l, t), J1(r, e, d)) : e.getTemporalDisplayables && (t.lastDrawType !== xf && (l = !0, t.lastDrawType = xf), nS(r, e, t)), u && i && Ze(r, t), e.innerAfterBrush(), e.afterBrush && e.afterBrush(), t.prevEl = e, e.__dirty = 0, e.__isRendered = !0;
}
function nS(r, e, t) {
  var i = e.getDisplayables(), n = e.getTemporalDisplayables();
  r.save();
  var s = {
    prevElClipPaths: null,
    prevEl: null,
    allClipped: !1,
    viewWidth: t.viewWidth,
    viewHeight: t.viewHeight,
    inHover: t.inHover
  }, a, o;
  for (a = e.getCursor(), o = i.length; a < o; a++) {
    var l = i[a];
    l.beforeBrush && l.beforeBrush(), l.innerBeforeBrush(), ir(r, l, s, a === o - 1), l.innerAfterBrush(), l.afterBrush && l.afterBrush(), s.prevEl = l;
  }
  for (var h = 0, u = n.length; h < u; h++) {
    var l = n[h];
    l.beforeBrush && l.beforeBrush(), l.innerBeforeBrush(), ir(r, l, s, h === u - 1), l.innerAfterBrush(), l.afterBrush && l.afterBrush(), s.prevEl = l;
  }
  e.clearTemporalDisplayables(), e.notClear = !0, r.restore();
}
var gl = new z1(), Sf = new vs(100), Rf = ["symbol", "symbolSize", "symbolKeepAspect", "color", "backgroundColor", "dashArrayX", "dashArrayY", "maxTileWidth", "maxTileHeight"];
function Mf(r, e) {
  if (r === "none")
    return null;
  var t = e.getDevicePixelRatio(), i = e.getZr(), n = i.painter.type === "svg";
  r.dirty && gl.delete(r);
  var s = gl.get(r);
  if (s)
    return s;
  var a = ge(r, {
    symbol: "rect",
    symbolSize: 1,
    symbolKeepAspect: !0,
    color: "rgba(0, 0, 0, 0.2)",
    backgroundColor: null,
    dashArrayX: 5,
    dashArrayY: 5,
    rotation: 0,
    maxTileWidth: 512,
    maxTileHeight: 512
  });
  a.backgroundColor === "none" && (a.backgroundColor = null);
  var o = {
    repeat: "repeat"
  };
  return l(o), o.rotation = a.rotation, o.scaleX = o.scaleY = n ? 1 : 1 / t, gl.set(r, o), r.dirty = !1, o;
  function l(h) {
    for (var u = [t], d = !0, c = 0; c < Rf.length; ++c) {
      var f = a[Rf[c]];
      if (f != null && !F(f) && !V(f) && !Re(f) && typeof f != "boolean") {
        d = !1;
        break;
      }
      u.push(f);
    }
    var p;
    if (d) {
      p = u.join(",") + (n ? "-svg" : "");
      var m = Sf.get(p);
      m && (n ? h.svgElement = m : h.image = m);
    }
    var g = dm(a.dashArrayX), v = sS(a.dashArrayY), b = um(a.symbol), y = aS(g), w = cm(v), _ = !n && Qr.createCanvas(), E = n && {
      tag: "g",
      attrs: {},
      key: "dcl",
      children: []
    }, x = C(), T;
    _ && (_.width = x.width * t, _.height = x.height * t, T = _.getContext("2d")), S(), d && Sf.put(p, _ || E), h.image = _, h.svgElement = E, h.svgWidth = x.width, h.svgHeight = x.height;
    function C() {
      for (var R = 1, D = 0, k = y.length; D < k; ++D)
        R = Wd(R, y[D]);
      for (var L = 1, D = 0, k = b.length; D < k; ++D)
        L = Wd(L, b[D].length);
      R *= L;
      var O = w * y.length * b.length;
      if (process.env.NODE_ENV !== "production") {
        var I = function(G) {
          console.warn("Calculated decal size is greater than " + G + " due to decal option settings so " + G + " is used for the decal size. Please consider changing the decal option to make a smaller decal or set " + G + " to be larger to avoid incontinuity.");
        };
        R > a.maxTileWidth && I("maxTileWidth"), O > a.maxTileHeight && I("maxTileHeight");
      }
      return {
        width: Math.max(1, Math.min(R, a.maxTileWidth)),
        height: Math.max(1, Math.min(O, a.maxTileHeight))
      };
    }
    function S() {
      T && (T.clearRect(0, 0, _.width, _.height), a.backgroundColor && (T.fillStyle = a.backgroundColor, T.fillRect(0, 0, _.width, _.height)));
      for (var R = 0, D = 0; D < v.length; ++D)
        R += v[D];
      if (R <= 0)
        return;
      for (var k = -w, L = 0, O = 0, I = 0; k < x.height; ) {
        if (L % 2 === 0) {
          for (var G = O / 2 % b.length, ee = 0, te = 0, ve = 0; ee < x.width * 2; ) {
            for (var be = 0, D = 0; D < g[I].length; ++D)
              be += g[I][D];
            if (be <= 0)
              break;
            if (te % 2 === 0) {
              var ie = (1 - a.symbolSize) * 0.5, xe = ee + g[I][te] * ie, Be = k + v[L] * ie, ut = g[I][te] * a.symbolSize, Wt = v[L] * a.symbolSize, Gt = ve / 2 % b[G].length;
              Q(xe, Be, ut, Wt, b[G][Gt]);
            }
            ee += g[I][te], ++ve, ++te, te === g[I].length && (te = 0);
          }
          ++I, I === g.length && (I = 0);
        }
        k += v[L], ++O, ++L, L === v.length && (L = 0);
      }
      function Q(N, X, z, H, ye) {
        var le = n ? 1 : t, we = sm(ye, N * le, X * le, z * le, H * le, a.color, a.symbolKeepAspect);
        if (n) {
          var Ue = i.painter.renderOneToVNode(we);
          Ue && E.children.push(Ue);
        } else
          hm(T, we);
      }
    }
  }
}
function um(r) {
  if (!r || r.length === 0)
    return [["rect"]];
  if (V(r))
    return [[r]];
  for (var e = !0, t = 0; t < r.length; ++t)
    if (!V(r[t])) {
      e = !1;
      break;
    }
  if (e)
    return um([r]);
  for (var i = [], t = 0; t < r.length; ++t)
    V(r[t]) ? i.push([r[t]]) : i.push(r[t]);
  return i;
}
function dm(r) {
  if (!r || r.length === 0)
    return [[0, 0]];
  if (Re(r)) {
    var e = Math.ceil(r);
    return [[e, e]];
  }
  for (var t = !0, i = 0; i < r.length; ++i)
    if (!Re(r[i])) {
      t = !1;
      break;
    }
  if (t)
    return dm([r]);
  for (var n = [], i = 0; i < r.length; ++i)
    if (Re(r[i])) {
      var e = Math.ceil(r[i]);
      n.push([e, e]);
    } else {
      var e = J(r[i], function(o) {
        return Math.ceil(o);
      });
      e.length % 2 === 1 ? n.push(e.concat(e)) : n.push(e);
    }
  return n;
}
function sS(r) {
  if (!r || typeof r == "object" && r.length === 0)
    return [0, 0];
  if (Re(r)) {
    var e = Math.ceil(r);
    return [e, e];
  }
  var t = J(r, function(i) {
    return Math.ceil(i);
  });
  return r.length % 2 ? t.concat(t) : t;
}
function aS(r) {
  return J(r, function(e) {
    return cm(e);
  });
}
function cm(r) {
  for (var e = 0, t = 0; t < r.length; ++t)
    e += r[t];
  return r.length % 2 === 1 ? e * 2 : e;
}
function oS(r, e) {
  r.eachRawSeries(function(t) {
    if (!r.isSeriesFiltered(t)) {
      var i = t.getData();
      i.hasItemVisual() && i.each(function(a) {
        var o = i.getItemVisual(a, "decal");
        if (o) {
          var l = i.ensureUniqueItemVisual(a, "style");
          l.decal = Mf(o, e);
        }
      });
      var n = i.getVisual("decal");
      if (n) {
        var s = i.getVisual("style");
        s.decal = Mf(n, e);
      }
    }
  });
}
var St = new Mt(), Ba = {};
function lS(r, e) {
  process.env.NODE_ENV !== "production" && Ba[r] && Ne("Already has an implementation of " + r + "."), Ba[r] = e;
}
function hS(r) {
  return process.env.NODE_ENV !== "production" && (Ba[r] || Ne("Implementation of " + r + " doesn't exists.")), Ba[r];
}
var uS = 1, dS = 800, cS = 900, fS = 1e3, pS = 2e3, gS = 5e3, fm = 1e3, vS = 1100, ju = 2e3, pm = 3e3, mS = 4e3, vo = 4500, bS = 4600, yS = 5e3, wS = 6e3, gm = 7e3, CS = {
  PROCESSOR: {
    FILTER: fS,
    SERIES_FILTER: dS,
    STATISTIC: gS
  },
  VISUAL: {
    LAYOUT: fm,
    PROGRESSIVE_LAYOUT: vS,
    GLOBAL: ju,
    CHART: pm,
    POST_CHART_LAYOUT: bS,
    COMPONENT: mS,
    BRUSH: yS,
    CHART_ITEM: vo,
    ARIA: wS,
    DECAL: gm
  }
}, Pe = "__flagInMainProcess", Ye = "__pendingUpdate", vl = "__needsUpdateStatus", Df = /^[a-zA-Z0-9_]+$/, ml = "__connectUpdateStatus", Lf = 0, _S = 1, ES = 2;
function vm(r) {
  return function() {
    for (var e = [], t = 0; t < arguments.length; t++)
      e[t] = arguments[t];
    if (this.isDisposed()) {
      et(this.id);
      return;
    }
    return bm(this, r, e);
  };
}
function mm(r) {
  return function() {
    for (var e = [], t = 0; t < arguments.length; t++)
      e[t] = arguments[t];
    return bm(this, r, e);
  };
}
function bm(r, e, t) {
  return t[0] = t[0] && t[0].toLowerCase(), Mt.prototype[e].apply(r, t);
}
var ym = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      return r !== null && r.apply(this, arguments) || this;
    }
    return e;
  }(Mt)
), wm = ym.prototype;
wm.on = mm("on");
wm.off = mm("off");
var Mr, bl, Xs, hi, yl, wl, Cl, En, Tn, kf, Af, _l, Pf, $s, Of, Cm, ct, If, _m = (
  /** @class */
  function(r) {
    De(e, r);
    function e(t, i, n) {
      var s = r.call(this, new M1()) || this;
      s._chartsViews = [], s._chartsMap = {}, s._componentsViews = [], s._componentsMap = {}, s._pendingActions = [], n = n || {}, V(i) && (i = Em[i]), s._dom = t;
      var a = "canvas", o = "auto", l = !1;
      if (process.env.NODE_ENV !== "production") {
        var h = (
          /* eslint-disable-next-line */
          W.hasGlobalWindow ? window : global
        );
        h && (a = j(h.__ECHARTS__DEFAULT__RENDERER__, a), o = j(h.__ECHARTS__DEFAULT__COARSE_POINTER, o), l = j(h.__ECHARTS__DEFAULT__USE_DIRTY_RECT__, l));
      }
      n.ssr;
      var u = s._zr = Hd(t, {
        renderer: n.renderer || a,
        devicePixelRatio: n.devicePixelRatio,
        width: n.width,
        height: n.height,
        ssr: n.ssr,
        useDirtyRect: j(n.useDirtyRect, l),
        useCoarsePointer: j(n.useCoarsePointer, o),
        pointerSize: n.pointerSize
      });
      s._ssr = n.ssr, s._throttledZrFlush = Uu(K(u.flush, u), 17), i = $(i), i && Pv(i, !0), s._theme = i, s._locale = ET(n.locale || yv), s._coordSysMgr = new kv();
      var d = s._api = Of(s);
      function c(f, p) {
        return f.__prio - p.__prio;
      }
      return ia(Wa, c), ia(Zh, c), s._scheduler = new em(s, d, Zh, Wa), s._messageCenter = new ym(), s._initEvents(), s.resize = K(s.resize, s), u.animation.on("frame", s._onframe, s), kf(u, s), Af(u, s), uh(s), s;
    }
    return e.prototype._onframe = function() {
      if (!this._disposed) {
        If(this);
        var t = this._scheduler;
        if (this[Ye]) {
          var i = this[Ye].silent;
          this[Pe] = !0;
          try {
            Mr(this), hi.update.call(this, null, this[Ye].updateParams);
          } catch (l) {
            throw this[Pe] = !1, this[Ye] = null, l;
          }
          this._zr.flush(), this[Pe] = !1, this[Ye] = null, En.call(this, i), Tn.call(this, i);
        } else if (t.unfinished) {
          var n = uS, s = this._model, a = this._api;
          t.unfinished = !1;
          do {
            var o = +/* @__PURE__ */ new Date();
            t.performSeriesTasks(s), t.performDataProcessorTasks(s), wl(this, s), t.performVisualTasks(s), $s(this, this._model, a, "remain", {}), n -= +/* @__PURE__ */ new Date() - o;
          } while (n > 0 && t.unfinished);
          t.unfinished || this._zr.flush();
        }
      }
    }, e.prototype.getDom = function() {
      return this._dom;
    }, e.prototype.getId = function() {
      return this.id;
    }, e.prototype.getZr = function() {
      return this._zr;
    }, e.prototype.isSSR = function() {
      return this._ssr;
    }, e.prototype.setOption = function(t, i, n) {
      if (this[Pe]) {
        process.env.NODE_ENV !== "production" && Ne("`setOption` should not be called during main process.");
        return;
      }
      if (this._disposed) {
        et(this.id);
        return;
      }
      var s, a, o;
      if (B(i) && (n = i.lazyUpdate, s = i.silent, a = i.replaceMerge, o = i.transition, i = i.notMerge), this[Pe] = !0, !this._model || i) {
        var l = new ax(this._api), h = this._theme, u = this._model = new Bu();
        u.scheduler = this._scheduler, u.ssr = this._ssr, u.init(null, null, null, h, this._locale, l);
      }
      this._model.setOption(t, {
        replaceMerge: a
      }, Jh);
      var d = {
        seriesTransition: o,
        optionChanged: !0
      };
      if (n)
        this[Ye] = {
          silent: s,
          updateParams: d
        }, this[Pe] = !1, this.getZr().wakeUp();
      else {
        try {
          Mr(this), hi.update.call(this, null, d);
        } catch (c) {
          throw this[Ye] = null, this[Pe] = !1, c;
        }
        this._ssr || this._zr.flush(), this[Ye] = null, this[Pe] = !1, En.call(this, s), Tn.call(this, s);
      }
    }, e.prototype.setTheme = function() {
      Nt("ECharts#setTheme() is DEPRECATED in ECharts 3.0");
    }, e.prototype.getModel = function() {
      return this._model;
    }, e.prototype.getOption = function() {
      return this._model && this._model.getOption();
    }, e.prototype.getWidth = function() {
      return this._zr.getWidth();
    }, e.prototype.getHeight = function() {
      return this._zr.getHeight();
    }, e.prototype.getDevicePixelRatio = function() {
      return this._zr.painter.dpr || W.hasGlobalWindow && window.devicePixelRatio || 1;
    }, e.prototype.getRenderedCanvas = function(t) {
      return process.env.NODE_ENV !== "production" && Se("getRenderedCanvas", "renderToCanvas"), this.renderToCanvas(t);
    }, e.prototype.renderToCanvas = function(t) {
      t = t || {};
      var i = this._zr.painter;
      if (process.env.NODE_ENV !== "production" && i.type !== "canvas")
        throw new Error("renderToCanvas can only be used in the canvas renderer.");
      return i.getRenderedCanvas({
        backgroundColor: t.backgroundColor || this._model.get("backgroundColor"),
        pixelRatio: t.pixelRatio || this.getDevicePixelRatio()
      });
    }, e.prototype.renderToSVGString = function(t) {
      t = t || {};
      var i = this._zr.painter;
      if (process.env.NODE_ENV !== "production" && i.type !== "svg")
        throw new Error("renderToSVGString can only be used in the svg renderer.");
      return i.renderToString({
        useViewBox: t.useViewBox
      });
    }, e.prototype.getSvgDataURL = function() {
      if (W.svgSupported) {
        var t = this._zr, i = t.storage.getDisplayList();
        return M(i, function(n) {
          n.stopAnimation(null, !0);
        }), t.painter.toDataURL();
      }
    }, e.prototype.getDataURL = function(t) {
      if (this._disposed) {
        et(this.id);
        return;
      }
      t = t || {};
      var i = t.excludeComponents, n = this._model, s = [], a = this;
      M(i, function(l) {
        n.eachComponent({
          mainType: l
        }, function(h) {
          var u = a._componentsMap[h.__viewId];
          u.group.ignore || (s.push(u), u.group.ignore = !0);
        });
      });
      var o = this._zr.painter.getType() === "svg" ? this.getSvgDataURL() : this.renderToCanvas(t).toDataURL("image/" + (t && t.type || "png"));
      return M(s, function(l) {
        l.group.ignore = !1;
      }), o;
    }, e.prototype.getConnectedDataURL = function(t) {
      if (this._disposed) {
        et(this.id);
        return;
      }
      var i = t.type === "svg", n = this.group, s = Math.min, a = Math.max, o = 1 / 0;
      if (zf[n]) {
        var l = o, h = o, u = -o, d = -o, c = [], f = t && t.pixelRatio || this.getDevicePixelRatio();
        M(Jn, function(y, w) {
          if (y.group === n) {
            var _ = i ? y.getZr().painter.getSvgDom().innerHTML : y.renderToCanvas($(t)), E = y.getDom().getBoundingClientRect();
            l = s(E.left, l), h = s(E.top, h), u = a(E.right, u), d = a(E.bottom, d), c.push({
              dom: _,
              left: E.left,
              top: E.top
            });
          }
        }), l *= f, h *= f, u *= f, d *= f;
        var p = u - l, m = d - h, g = Qr.createCanvas(), v = Hd(g, {
          renderer: i ? "svg" : "canvas"
        });
        if (v.resize({
          width: p,
          height: m
        }), i) {
          var b = "";
          return M(c, function(y) {
            var w = y.left - l, _ = y.top - h;
            b += '<g transform="translate(' + w + "," + _ + ')">' + y.dom + "</g>";
          }), v.painter.getSvgRoot().innerHTML = b, t.connectedBackgroundColor && v.painter.setBackgroundColor(t.connectedBackgroundColor), v.refreshImmediately(), v.painter.toDataURL();
        } else
          return t.connectedBackgroundColor && v.add(new ot({
            shape: {
              x: 0,
              y: 0,
              width: p,
              height: m
            },
            style: {
              fill: t.connectedBackgroundColor
            }
          })), M(c, function(y) {
            var w = new cr({
              style: {
                x: y.left * f - l,
                y: y.top * f - h,
                image: y.dom
              }
            });
            v.add(w);
          }), v.refreshImmediately(), g.toDataURL("image/" + (t && t.type || "png"));
      } else
        return this.getDataURL(t);
    }, e.prototype.convertToPixel = function(t, i) {
      return yl(this, "convertToPixel", t, i);
    }, e.prototype.convertFromPixel = function(t, i) {
      return yl(this, "convertFromPixel", t, i);
    }, e.prototype.containPixel = function(t, i) {
      if (this._disposed) {
        et(this.id);
        return;
      }
      var n = this._model, s, a = Wo(n, t);
      return M(a, function(o, l) {
        l.indexOf("Models") >= 0 && M(o, function(h) {
          var u = h.coordinateSystem;
          if (u && u.containPoint)
            s = s || !!u.containPoint(i);
          else if (l === "seriesModels") {
            var d = this._chartsMap[h.__viewId];
            d && d.containPoint ? s = s || d.containPoint(i, h) : process.env.NODE_ENV !== "production" && wt(l + ": " + (d ? "The found component do not support containPoint." : "No view mapping to the found component."));
          } else
            process.env.NODE_ENV !== "production" && wt(l + ": containPoint is not supported");
        }, this);
      }, this), !!s;
    }, e.prototype.getVisual = function(t, i) {
      var n = this._model, s = Wo(n, t, {
        defaultMainType: "series"
      }), a = s.seriesModel;
      process.env.NODE_ENV !== "production" && (a || wt("There is no specified series model"));
      var o = a.getData(), l = s.hasOwnProperty("dataIndexInside") ? s.dataIndexInside : s.hasOwnProperty("dataIndex") ? o.indexOfRawIndex(s.dataIndex) : null;
      return l != null ? k1(o, l, i) : A1(o, i);
    }, e.prototype.getViewOfComponentModel = function(t) {
      return this._componentsMap[t.__viewId];
    }, e.prototype.getViewOfSeriesModel = function(t) {
      return this._chartsMap[t.__viewId];
    }, e.prototype._initEvents = function() {
      var t = this;
      M(TS, function(i) {
        var n = function(s) {
          var a = t.getModel(), o = s.target, l, h = i === "globalout";
          if (h ? l = {} : o && Nn(o, function(p) {
            var m = ce(p);
            if (m && m.dataIndex != null) {
              var g = m.dataModel || a.getSeriesByIndex(m.seriesIndex);
              return l = g && g.getDataParams(m.dataIndex, m.dataType, o) || {}, !0;
            } else if (m.eventData)
              return l = P({}, m.eventData), !0;
          }, !0), l) {
            var u = l.componentType, d = l.componentIndex;
            (u === "markLine" || u === "markPoint" || u === "markArea") && (u = "series", d = l.seriesIndex);
            var c = u && d != null && a.getComponent(u, d), f = c && t[c.mainType === "series" ? "_chartsMap" : "_componentsMap"][c.__viewId];
            process.env.NODE_ENV !== "production" && !h && !(c && f) && wt("model or view can not be found by params"), l.event = s, l.type = i, t._$eventProcessor.eventInfo = {
              targetEl: o,
              packedEvent: l,
              model: c,
              view: f
            }, t.trigger(i, l);
          }
        };
        n.zrEventfulCallAtLast = !0, t._zr.on(i, n, t);
      }), M(Zn, function(i, n) {
        t._messageCenter.on(n, function(s) {
          this.trigger(n, s);
        }, t);
      }), M(["selectchanged"], function(i) {
        t._messageCenter.on(i, function(n) {
          this.trigger(i, n);
        }, t);
      }), P1(this._messageCenter, this, this._api);
    }, e.prototype.isDisposed = function() {
      return this._disposed;
    }, e.prototype.clear = function() {
      if (this._disposed) {
        et(this.id);
        return;
      }
      this.setOption({
        series: []
      }, !0);
    }, e.prototype.dispose = function() {
      if (this._disposed) {
        et(this.id);
        return;
      }
      this._disposed = !0;
      var t = this.getDom();
      t && Fg(this.getDom(), Xu, "");
      var i = this, n = i._api, s = i._model;
      M(i._componentsViews, function(a) {
        a.dispose(s, n);
      }), M(i._chartsViews, function(a) {
        a.dispose(s, n);
      }), i._zr.dispose(), i._dom = i._model = i._chartsMap = i._componentsMap = i._chartsViews = i._componentsViews = i._scheduler = i._api = i._zr = i._throttledZrFlush = i._theme = i._coordSysMgr = i._messageCenter = null, delete Jn[i.id];
    }, e.prototype.resize = function(t) {
      if (this[Pe]) {
        process.env.NODE_ENV !== "production" && Ne("`resize` should not be called during main process.");
        return;
      }
      if (this._disposed) {
        et(this.id);
        return;
      }
      this._zr.resize(t);
      var i = this._model;
      if (this._loadingFX && this._loadingFX.resize(), !!i) {
        var n = i.resetOption("media"), s = t && t.silent;
        this[Ye] && (s == null && (s = this[Ye].silent), n = !0, this[Ye] = null), this[Pe] = !0;
        try {
          n && Mr(this), hi.update.call(this, {
            type: "resize",
            animation: P({
              // Disable animation
              duration: 0
            }, t && t.animation)
          });
        } catch (a) {
          throw this[Pe] = !1, a;
        }
        this[Pe] = !1, En.call(this, s), Tn.call(this, s);
      }
    }, e.prototype.showLoading = function(t, i) {
      if (this._disposed) {
        et(this.id);
        return;
      }
      if (B(t) && (i = t, t = ""), t = t || "default", this.hideLoading(), !Qh[t]) {
        process.env.NODE_ENV !== "production" && wt("Loading effects " + t + " not exists.");
        return;
      }
      var n = Qh[t](this._api, i), s = this._zr;
      this._loadingFX = n, s.add(n);
    }, e.prototype.hideLoading = function() {
      if (this._disposed) {
        et(this.id);
        return;
      }
      this._loadingFX && this._zr.remove(this._loadingFX), this._loadingFX = null;
    }, e.prototype.makeActionFromEvent = function(t) {
      var i = P({}, t);
      return i.type = Zn[t.type], i;
    }, e.prototype.dispatchAction = function(t, i) {
      if (this._disposed) {
        et(this.id);
        return;
      }
      if (B(i) || (i = {
        silent: !!i
      }), !!Va[t.type] && this._model) {
        if (this[Pe]) {
          this._pendingActions.push(t);
          return;
        }
        var n = i.silent;
        Cl.call(this, t, n);
        var s = i.flush;
        s ? this._zr.flush() : s !== !1 && W.browser.weChat && this._throttledZrFlush(), En.call(this, n), Tn.call(this, n);
      }
    }, e.prototype.updateLabelLayout = function() {
      St.trigger("series:layoutlabels", this._model, this._api, {
        // Not adding series labels.
        // TODO
        updatedSeries: []
      });
    }, e.prototype.appendData = function(t) {
      if (this._disposed) {
        et(this.id);
        return;
      }
      var i = t.seriesIndex, n = this.getModel(), s = n.getSeriesByIndex(i);
      process.env.NODE_ENV !== "production" && Y(t.data && s), s.appendData(t), this._scheduler.unfinished = !0, this.getZr().wakeUp();
    }, e.internalField = function() {
      Mr = function(d) {
        var c = d._scheduler;
        c.restorePipelines(d._model), c.prepareStageTasks(), bl(d, !0), bl(d, !1), c.plan();
      }, bl = function(d, c) {
        for (var f = d._model, p = d._scheduler, m = c ? d._componentsViews : d._chartsViews, g = c ? d._componentsMap : d._chartsMap, v = d._zr, b = d._api, y = 0; y < m.length; y++)
          m[y].__alive = !1;
        c ? f.eachComponent(function(E, x) {
          E !== "series" && w(x);
        }) : f.eachSeries(w);
        function w(E) {
          var x = E.__requireNewView;
          E.__requireNewView = !1;
          var T = "_ec_" + E.id + "_" + E.type, C = !x && g[T];
          if (!C) {
            var S = Ft(E.type), R = c ? ti.getClass(S.main, S.sub) : (
              // FIXME:TS
              // (ChartView as ChartViewConstructor).getClass('series', classType.sub)
              // For backward compat, still support a chart type declared as only subType
              // like "liquidfill", but recommend "series.liquidfill"
              // But need a base class to make a type series.
              Ei.getClass(S.sub)
            );
            process.env.NODE_ENV !== "production" && Y(R, S.sub + " does not exist."), C = new R(), C.init(f, b), g[T] = C, m.push(C), v.add(C.group);
          }
          E.__viewId = C.__id = T, C.__alive = !0, C.__model = E, C.group.__ecComponentInfo = {
            mainType: E.mainType,
            index: E.componentIndex
          }, !c && p.prepareView(C, E, f, b);
        }
        for (var y = 0; y < m.length; ) {
          var _ = m[y];
          _.__alive ? y++ : (!c && _.renderTask.dispose(), v.remove(_.group), _.dispose(f, b), m.splice(y, 1), g[_.__id] === _ && delete g[_.__id], _.__id = _.group.__ecComponentInfo = null);
        }
      }, Xs = function(d, c, f, p, m) {
        var g = d._model;
        if (g.setUpdatePayload(f), !p) {
          M([].concat(d._componentsViews).concat(d._chartsViews), _);
          return;
        }
        var v = {};
        v[p + "Id"] = f[p + "Id"], v[p + "Index"] = f[p + "Index"], v[p + "Name"] = f[p + "Name"];
        var b = {
          mainType: p,
          query: v
        };
        m && (b.subType = m);
        var y = f.excludeSeriesId, w;
        y != null && (w = Z(), M(Me(y), function(E) {
          var x = at(E, null);
          x != null && w.set(x, !0);
        })), g && g.eachComponent(b, function(E) {
          var x = w && w.get(E.id) != null;
          if (!x)
            if (mc(f))
              if (E instanceof Si)
                f.type === hr && !f.notBlur && !E.get(["emphasis", "disabled"]) && tE(E, f, d._api);
              else {
                var T = xu(E.mainType, E.componentIndex, f.name, d._api), C = T.focusSelf, S = T.dispatchers;
                f.type === hr && C && !f.notBlur && Ph(E.mainType, E.componentIndex, d._api), S && M(S, function(R) {
                  f.type === hr ? Lh(R) : kh(R);
                });
              }
            else Ih(f) && E instanceof Si && (nE(E, f, d._api), vc(E), ct(d));
        }, d), g && g.eachComponent(b, function(E) {
          var x = w && w.get(E.id) != null;
          x || _(d[p === "series" ? "_chartsMap" : "_componentsMap"][E.__viewId]);
        }, d);
        function _(E) {
          E && E.__alive && E[c] && E[c](E.__model, g, d._api, f);
        }
      }, hi = {
        prepareAndUpdate: function(d) {
          Mr(this), hi.update.call(this, d, {
            // Needs to mark option changed if newOption is given.
            // It's from MagicType.
            // TODO If use a separate flag optionChanged in payload?
            optionChanged: d.newOption != null
          });
        },
        update: function(d, c) {
          var f = this._model, p = this._api, m = this._zr, g = this._coordSysMgr, v = this._scheduler;
          if (f) {
            f.setUpdatePayload(d), v.restoreData(f, d), v.performSeriesTasks(f), g.create(f, p), v.performDataProcessorTasks(f, d), wl(this, f), g.update(f, p), t(f), v.performVisualTasks(f, d), _l(this, f, p, d, c);
            var b = f.get("backgroundColor") || "transparent", y = f.get("darkMode");
            m.setBackgroundColor(b), y != null && y !== "auto" && m.setDarkMode(y), St.trigger("afterupdate", f, p);
          }
        },
        updateTransform: function(d) {
          var c = this, f = this._model, p = this._api;
          if (f) {
            f.setUpdatePayload(d);
            var m = [];
            f.eachComponent(function(v, b) {
              if (v !== "series") {
                var y = c.getViewOfComponentModel(b);
                if (y && y.__alive)
                  if (y.updateTransform) {
                    var w = y.updateTransform(b, f, p, d);
                    w && w.update && m.push(y);
                  } else
                    m.push(y);
              }
            });
            var g = Z();
            f.eachSeries(function(v) {
              var b = c._chartsMap[v.__viewId];
              if (b.updateTransform) {
                var y = b.updateTransform(v, f, p, d);
                y && y.update && g.set(v.uid, 1);
              } else
                g.set(v.uid, 1);
            }), t(f), this._scheduler.performVisualTasks(f, d, {
              setDirty: !0,
              dirtyMap: g
            }), $s(this, f, p, d, {}, g), St.trigger("afterupdate", f, p);
          }
        },
        updateView: function(d) {
          var c = this._model;
          c && (c.setUpdatePayload(d), Ei.markUpdateMethod(d, "updateView"), t(c), this._scheduler.performVisualTasks(c, d, {
            setDirty: !0
          }), _l(this, c, this._api, d, {}), St.trigger("afterupdate", c, this._api));
        },
        updateVisual: function(d) {
          var c = this, f = this._model;
          f && (f.setUpdatePayload(d), f.eachSeries(function(p) {
            p.getData().clearAllVisual();
          }), Ei.markUpdateMethod(d, "updateVisual"), t(f), this._scheduler.performVisualTasks(f, d, {
            visualType: "visual",
            setDirty: !0
          }), f.eachComponent(function(p, m) {
            if (p !== "series") {
              var g = c.getViewOfComponentModel(m);
              g && g.__alive && g.updateVisual(m, f, c._api, d);
            }
          }), f.eachSeries(function(p) {
            var m = c._chartsMap[p.__viewId];
            m.updateVisual(p, f, c._api, d);
          }), St.trigger("afterupdate", f, this._api));
        },
        updateLayout: function(d) {
          hi.update.call(this, d);
        }
      }, yl = function(d, c, f, p) {
        if (d._disposed) {
          et(d.id);
          return;
        }
        for (var m = d._model, g = d._coordSysMgr.getCoordinateSystems(), v, b = Wo(m, f), y = 0; y < g.length; y++) {
          var w = g[y];
          if (w[c] && (v = w[c](m, b, p)) != null)
            return v;
        }
        process.env.NODE_ENV !== "production" && wt("No coordinate system that supports " + c + " found by the given finder.");
      }, wl = function(d, c) {
        var f = d._chartsMap, p = d._scheduler;
        c.eachSeries(function(m) {
          p.updateStreamModes(m, f[m.__viewId]);
        });
      }, Cl = function(d, c) {
        var f = this, p = this.getModel(), m = d.type, g = d.escapeConnect, v = Va[m], b = v.actionInfo, y = (b.update || "update").split(":"), w = y.pop(), _ = y[0] != null && Ft(y[0]);
        this[Pe] = !0;
        var E = [d], x = !1;
        d.batch && (x = !0, E = J(d.batch, function(L) {
          return L = ge(P({}, L), d), L.batch = null, L;
        }));
        var T = [], C, S = Ih(d), R = mc(d);
        if (R && rv(this._api), M(E, function(L) {
          if (C = v.action(L, f._model, f._api), C = C || P({}, L), C.type = b.event || C.type, T.push(C), R) {
            var O = mu(d), I = O.queryOptionMap, G = O.mainTypeSpecified, ee = G ? I.keys()[0] : "series";
            Xs(f, w, L, ee), ct(f);
          } else S ? (Xs(f, w, L, "series"), ct(f)) : _ && Xs(f, w, L, _.main, _.sub);
        }), w !== "none" && !R && !S && !_)
          try {
            this[Ye] ? (Mr(this), hi.update.call(this, d), this[Ye] = null) : hi[w].call(this, d);
          } catch (L) {
            throw this[Pe] = !1, L;
          }
        if (x ? C = {
          type: b.event || m,
          escapeConnect: g,
          batch: T
        } : C = T[0], this[Pe] = !1, !c) {
          var D = this._messageCenter;
          if (D.trigger(C.type, C), S) {
            var k = {
              type: "selectchanged",
              escapeConnect: g,
              selected: sE(p),
              isFromClick: d.isFromClick || !1,
              fromAction: d.type,
              fromActionPayload: d
            };
            D.trigger(k.type, k);
          }
        }
      }, En = function(d) {
        for (var c = this._pendingActions; c.length; ) {
          var f = c.shift();
          Cl.call(this, f, d);
        }
      }, Tn = function(d) {
        !d && this.trigger("updated");
      }, kf = function(d, c) {
        d.on("rendered", function(f) {
          c.trigger("rendered", f), // Although zr is dirty if initial animation is not finished
          // and this checking is called on frame, we also check
          // animation finished for robustness.
          d.animation.isFinished() && !c[Ye] && !c._scheduler.unfinished && !c._pendingActions.length && c.trigger("finished");
        });
      }, Af = function(d, c) {
        d.on("mouseover", function(f) {
          var p = f.target, m = Nn(p, xi);
          m && (iE(m, f, c._api), ct(c));
        }).on("mouseout", function(f) {
          var p = f.target, m = Nn(p, xi);
          m && (rE(m, f, c._api), ct(c));
        }).on("click", function(f) {
          var p = f.target, m = Nn(p, function(b) {
            return ce(b).dataIndex != null;
          }, !0);
          if (m) {
            var g = m.selected ? "unselect" : "select", v = ce(m);
            c._api.dispatchAction({
              type: g,
              dataType: v.dataType,
              dataIndexInside: v.dataIndex,
              seriesIndex: v.seriesIndex,
              isFromClick: !0
            });
          }
        });
      };
      function t(d) {
        d.clearColorPalette(), d.eachSeries(function(c) {
          c.clearColorPalette();
        });
      }
      function i(d) {
        var c = [], f = [], p = !1;
        if (d.eachComponent(function(b, y) {
          var w = y.get("zlevel") || 0, _ = y.get("z") || 0, E = y.getZLevelKey();
          p = p || !!E, (b === "series" ? f : c).push({
            zlevel: w,
            z: _,
            idx: y.componentIndex,
            type: b,
            key: E
          });
        }), p) {
          var m = c.concat(f), g, v;
          ia(m, function(b, y) {
            return b.zlevel === y.zlevel ? b.z - y.z : b.zlevel - y.zlevel;
          }), M(m, function(b) {
            var y = d.getComponent(b.type, b.idx), w = b.zlevel, _ = b.key;
            g != null && (w = Math.max(g, w)), _ ? (w === g && _ !== v && w++, v = _) : v && (w === g && w++, v = ""), g = w, y.setZLevel(w);
          });
        }
      }
      _l = function(d, c, f, p, m) {
        i(c), Pf(d, c, f, p, m), M(d._chartsViews, function(g) {
          g.__alive = !1;
        }), $s(d, c, f, p, m), M(d._chartsViews, function(g) {
          g.__alive || g.remove(c, f);
        });
      }, Pf = function(d, c, f, p, m, g) {
        M(g || d._componentsViews, function(v) {
          var b = v.__model;
          h(b, v), v.render(b, c, f, p), o(b, v), u(b, v);
        });
      }, $s = function(d, c, f, p, m, g) {
        var v = d._scheduler;
        m = P(m || {}, {
          updatedSeries: c.getSeries()
        }), St.trigger("series:beforeupdate", c, f, m);
        var b = !1;
        c.eachSeries(function(y) {
          var w = d._chartsMap[y.__viewId];
          w.__alive = !0;
          var _ = w.renderTask;
          v.updatePayload(_, p), h(y, w), g && g.get(y.uid) && _.dirty(), _.perform(v.getPerformArgs(_)) && (b = !0), w.group.silent = !!y.get("silent"), a(y, w), vc(y);
        }), v.unfinished = b || v.unfinished, St.trigger("series:layoutlabels", c, f, m), St.trigger("series:transition", c, f, m), c.eachSeries(function(y) {
          var w = d._chartsMap[y.__viewId];
          o(y, w), u(y, w);
        }), s(d, c), St.trigger("series:afterupdate", c, f, m);
      }, ct = function(d) {
        d[vl] = !0, d.getZr().wakeUp();
      }, If = function(d) {
        d[vl] && (d.getZr().storage.traverse(function(c) {
          qn(c) || n(c);
        }), d[vl] = !1);
      };
      function n(d) {
        for (var c = [], f = d.currentStates, p = 0; p < f.length; p++) {
          var m = f[p];
          m === "emphasis" || m === "blur" || m === "select" || c.push(m);
        }
        d.selected && d.states.select && c.push("select"), d.hoverState === Eu && d.states.emphasis ? c.push("emphasis") : d.hoverState === _u && d.states.blur && c.push("blur"), d.useStates(c);
      }
      function s(d, c) {
        var f = d._zr, p = f.storage, m = 0;
        p.traverse(function(g) {
          g.isGroup || m++;
        }), m > c.get("hoverLayerThreshold") && !W.node && !W.worker && c.eachSeries(function(g) {
          if (!g.preventUsingHoverLayer) {
            var v = d._chartsMap[g.__viewId];
            v.__alive && v.eachRendered(function(b) {
              b.states.emphasis && (b.states.emphasis.hoverLayer = !0);
            });
          }
        });
      }
      function a(d, c) {
        var f = d.get("blendMode") || null;
        c.eachRendered(function(p) {
          p.isGroup || (p.style.blend = f);
        });
      }
      function o(d, c) {
        if (!d.preventAutoZ) {
          var f = d.get("z") || 0, p = d.get("zlevel") || 0;
          c.eachRendered(function(m) {
            return l(m, f, p, -1 / 0), !0;
          });
        }
      }
      function l(d, c, f, p) {
        var m = d.getTextContent(), g = d.getTextGuideLine(), v = d.isGroup;
        if (v)
          for (var b = d.childrenRef(), y = 0; y < b.length; y++)
            p = Math.max(l(b[y], c, f, p), p);
        else
          d.z = c, d.zlevel = f, p = Math.max(d.z2, p);
        if (m && (m.z = c, m.zlevel = f, isFinite(p) && (m.z2 = p + 2)), g) {
          var w = d.textGuideLineConfig;
          g.z = c, g.zlevel = f, isFinite(p) && (g.z2 = p + (w && w.showAbove ? 1 : -1));
        }
        return p;
      }
      function h(d, c) {
        c.eachRendered(function(f) {
          if (!qn(f)) {
            var p = f.getTextContent(), m = f.getTextGuideLine();
            f.stateTransition && (f.stateTransition = null), p && p.stateTransition && (p.stateTransition = null), m && m.stateTransition && (m.stateTransition = null), f.hasState() ? (f.prevStates = f.currentStates, f.clearStates()) : f.prevStates && (f.prevStates = null);
          }
        });
      }
      function u(d, c) {
        var f = d.getModel("stateAnimation"), p = d.isAnimationEnabled(), m = f.get("duration"), g = m > 0 ? {
          duration: m,
          delay: f.get("delay"),
          easing: f.get("easing")
          // additive: stateAnimationModel.get('additive')
        } : null;
        c.eachRendered(function(v) {
          if (v.states && v.states.emphasis) {
            if (qn(v))
              return;
            if (v instanceof fe && uE(v), v.__dirty) {
              var b = v.prevStates;
              b && v.useStates(b);
            }
            if (p) {
              v.stateTransition = g;
              var y = v.getTextContent(), w = v.getTextGuideLine();
              y && (y.stateTransition = g), w && (w.stateTransition = g);
            }
            v.__dirty && n(v);
          }
        });
      }
      Of = function(d) {
        return new /** @class */
        (function(c) {
          De(f, c);
          function f() {
            return c !== null && c.apply(this, arguments) || this;
          }
          return f.prototype.getCoordinateSystems = function() {
            return d._coordSysMgr.getCoordinateSystems();
          }, f.prototype.getComponentByElement = function(p) {
            for (; p; ) {
              var m = p.__ecComponentInfo;
              if (m != null)
                return d._model.getComponent(m.mainType, m.index);
              p = p.parent;
            }
          }, f.prototype.enterEmphasis = function(p, m) {
            Lh(p, m), ct(d);
          }, f.prototype.leaveEmphasis = function(p, m) {
            kh(p, m), ct(d);
          }, f.prototype.enterBlur = function(p) {
            eE(p), ct(d);
          }, f.prototype.leaveBlur = function(p) {
            Qg(p), ct(d);
          }, f.prototype.enterSelect = function(p) {
            ev(p), ct(d);
          }, f.prototype.leaveSelect = function(p) {
            tv(p), ct(d);
          }, f.prototype.getModel = function() {
            return d.getModel();
          }, f.prototype.getViewOfComponentModel = function(p) {
            return d.getViewOfComponentModel(p);
          }, f.prototype.getViewOfSeriesModel = function(p) {
            return d.getViewOfSeriesModel(p);
          }, f;
        }(Lv))(d);
      }, Cm = function(d) {
        function c(f, p) {
          for (var m = 0; m < f.length; m++) {
            var g = f[m];
            g[ml] = p;
          }
        }
        M(Zn, function(f, p) {
          d._messageCenter.on(p, function(m) {
            if (zf[d.group] && d[ml] !== Lf) {
              if (m && m.escapeConnect)
                return;
              var g = d.makeActionFromEvent(m), v = [];
              M(Jn, function(b) {
                b !== d && b.group === d.group && v.push(b);
              }), c(v, Lf), M(v, function(b) {
                b[ml] !== _S && b.dispatchAction(g);
              }), c(v, ES);
            }
          });
        });
      };
    }(), e;
  }(Mt)
), Yu = _m.prototype;
Yu.on = vm("on");
Yu.off = vm("off");
Yu.one = function(r, e, t) {
  var i = this;
  Nt("ECharts#one is deprecated.");
  function n() {
    for (var s = [], a = 0; a < arguments.length; a++)
      s[a] = arguments[a];
    e && e.apply && e.apply(this, s), i.off(r, n);
  }
  this.on.call(this, r, n, t);
};
var TS = ["click", "dblclick", "mouseover", "mouseout", "mousemove", "mousedown", "mouseup", "globalout", "contextmenu"];
function et(r) {
  process.env.NODE_ENV !== "production" && wt("Instance " + r + " has been disposed");
}
var Va = {}, Zn = {}, Zh = [], Jh = [], Wa = [], Em = {}, Qh = {}, Jn = {}, zf = {}, xS = +/* @__PURE__ */ new Date() - 0, Xu = "_echarts_instance_";
function SS(r, e, t) {
  var i = !(t && t.ssr);
  if (i) {
    if (process.env.NODE_ENV !== "production" && !r)
      throw new Error("Initialize failed: invalid dom.");
    var n = RS(r);
    if (n)
      return process.env.NODE_ENV !== "production" && wt("There is a chart instance already initialized on the dom."), n;
    process.env.NODE_ENV !== "production" && Yr(r) && r.nodeName.toUpperCase() !== "CANVAS" && (!r.clientWidth && (!t || t.width == null) || !r.clientHeight && (!t || t.height == null)) && wt("Can't get DOM width or height. Please check dom.clientWidth and dom.clientHeight. They should not be 0.For example, you may need to call this in the callback of window.onload.");
  }
  var s = new _m(r, e, t);
  return s.id = "ec_" + xS++, Jn[s.id] = s, i && Fg(r, Xu, s.id), Cm(s), St.trigger("afterinit", s), s;
}
function RS(r) {
  return Jn[YC(r, Xu)];
}
function Tm(r, e) {
  Em[r] = e;
}
function xm(r) {
  ue(Jh, r) < 0 && Jh.push(r);
}
function Sm(r, e) {
  qu(Zh, r, e, pS);
}
function MS(r) {
  $u("afterinit", r);
}
function DS(r) {
  $u("afterupdate", r);
}
function $u(r, e) {
  St.on(r, e);
}
function fr(r, e, t) {
  q(e) && (t = e, e = "");
  var i = B(r) ? r.type : [r, r = {
    event: e
  }][0];
  r.event = (r.event || i).toLowerCase(), e = r.event, !Zn[e] && (Y(Df.test(i) && Df.test(e)), Va[i] || (Va[i] = {
    action: t,
    actionInfo: r
  }), Zn[e] = i);
}
function LS(r, e) {
  kv.register(r, e);
}
function kS(r, e) {
  qu(Wa, r, e, fm, "layout");
}
function pr(r, e) {
  qu(Wa, r, e, pm, "visual");
}
var Ff = [];
function qu(r, e, t, i, n) {
  if ((q(e) || B(e)) && (t = e, e = i), process.env.NODE_ENV !== "production") {
    if (isNaN(e) || e == null)
      throw new Error("Illegal priority");
    M(r, function(a) {
      Y(a.__raw !== t);
    });
  }
  if (!(ue(Ff, t) >= 0)) {
    Ff.push(t);
    var s = em.wrapStageHandler(t, n);
    s.__prio = e, s.__raw = t, r.push(s);
  }
}
function Rm(r, e) {
  Qh[r] = e;
}
function AS(r, e, t) {
  var i = hS("registerMap");
  i && i(r, e, t);
}
var PS = Fx;
pr(ju, p1);
pr(vo, g1);
pr(vo, v1);
pr(ju, D1);
pr(vo, L1);
pr(gm, oS);
xm(Pv);
Sm(cS, bx);
Rm("default", m1);
fr({
  type: hr,
  event: hr,
  update: hr
}, Le);
fr({
  type: oa,
  event: oa,
  update: oa
}, Le);
fr({
  type: Yn,
  event: Yn,
  update: Yn
}, Le);
fr({
  type: la,
  event: la,
  update: la
}, Le);
fr({
  type: Xn,
  event: Xn,
  update: Xn
}, Le);
Tm("light", R1);
Tm("dark", nm);
function xn(r) {
  return r == null ? 0 : r.length || 1;
}
function Hf(r) {
  return r;
}
var Mm = (
  /** @class */
  function() {
    function r(e, t, i, n, s, a) {
      this._old = e, this._new = t, this._oldKeyGetter = i || Hf, this._newKeyGetter = n || Hf, this.context = s, this._diffModeMultiple = a === "multiple";
    }
    return r.prototype.add = function(e) {
      return this._add = e, this;
    }, r.prototype.update = function(e) {
      return this._update = e, this;
    }, r.prototype.updateManyToOne = function(e) {
      return this._updateManyToOne = e, this;
    }, r.prototype.updateOneToMany = function(e) {
      return this._updateOneToMany = e, this;
    }, r.prototype.updateManyToMany = function(e) {
      return this._updateManyToMany = e, this;
    }, r.prototype.remove = function(e) {
      return this._remove = e, this;
    }, r.prototype.execute = function() {
      this[this._diffModeMultiple ? "_executeMultiple" : "_executeOneToOne"]();
    }, r.prototype._executeOneToOne = function() {
      var e = this._old, t = this._new, i = {}, n = new Array(e.length), s = new Array(t.length);
      this._initIndexMap(e, null, n, "_oldKeyGetter"), this._initIndexMap(t, i, s, "_newKeyGetter");
      for (var a = 0; a < e.length; a++) {
        var o = n[a], l = i[o], h = xn(l);
        if (h > 1) {
          var u = l.shift();
          l.length === 1 && (i[o] = l[0]), this._update && this._update(u, a);
        } else h === 1 ? (i[o] = null, this._update && this._update(l, a)) : this._remove && this._remove(a);
      }
      this._performRestAdd(s, i);
    }, r.prototype._executeMultiple = function() {
      var e = this._old, t = this._new, i = {}, n = {}, s = [], a = [];
      this._initIndexMap(e, i, s, "_oldKeyGetter"), this._initIndexMap(t, n, a, "_newKeyGetter");
      for (var o = 0; o < s.length; o++) {
        var l = s[o], h = i[l], u = n[l], d = xn(h), c = xn(u);
        if (d > 1 && c === 1)
          this._updateManyToOne && this._updateManyToOne(u, h), n[l] = null;
        else if (d === 1 && c > 1)
          this._updateOneToMany && this._updateOneToMany(u, h), n[l] = null;
        else if (d === 1 && c === 1)
          this._update && this._update(u, h), n[l] = null;
        else if (d > 1 && c > 1)
          this._updateManyToMany && this._updateManyToMany(u, h), n[l] = null;
        else if (d > 1)
          for (var f = 0; f < d; f++)
            this._remove && this._remove(h[f]);
        else
          this._remove && this._remove(h);
      }
      this._performRestAdd(a, n);
    }, r.prototype._performRestAdd = function(e, t) {
      for (var i = 0; i < e.length; i++) {
        var n = e[i], s = t[n], a = xn(s);
        if (a > 1)
          for (var o = 0; o < a; o++)
            this._add && this._add(s[o]);
        else a === 1 && this._add && this._add(s);
        t[n] = null;
      }
    }, r.prototype._initIndexMap = function(e, t, i, n) {
      for (var s = this._diffModeMultiple, a = 0; a < e.length; a++) {
        var o = "_ec_" + this[n](e[a], a);
        if (s || (i[a] = o), !!t) {
          var l = t[o], h = xn(l);
          h === 0 ? (t[o] = a, s && i.push(o)) : h === 1 ? t[o] = [l, a] : l.push(a);
        }
      }
    }, r;
  }()
), OS = (
  /** @class */
  function() {
    function r(e, t) {
      this._encode = e, this._schema = t;
    }
    return r.prototype.get = function() {
      return {
        // Do not generate full dimension name until fist used.
        fullDimensions: this._getFullDimensionNames(),
        encode: this._encode
      };
    }, r.prototype._getFullDimensionNames = function() {
      return this._cachedDimNames || (this._cachedDimNames = this._schema ? this._schema.makeOutputDimensionNames() : []), this._cachedDimNames;
    }, r;
  }()
);
function IS(r, e) {
  var t = {}, i = t.encode = {}, n = Z(), s = [], a = [], o = {};
  M(r.dimensions, function(c) {
    var f = r.getDimensionInfo(c), p = f.coordDim;
    if (p) {
      process.env.NODE_ENV !== "production" && Y(Bh.get(p) == null);
      var m = f.coordDimIndex;
      El(i, p)[m] = c, f.isExtraCoord || (n.set(p, 1), zS(f.type) && (s[0] = c), El(o, p)[m] = r.getDimensionIndex(f.name)), f.defaultTooltip && a.push(c);
    }
    Bh.each(function(g, v) {
      var b = El(i, v), y = f.otherDims[v];
      y != null && y !== !1 && (b[y] = f.name);
    });
  });
  var l = [], h = {};
  n.each(function(c, f) {
    var p = i[f];
    h[f] = p[0], l = l.concat(p);
  }), t.dataDimsOnCoord = l, t.dataDimIndicesOnCoord = J(l, function(c) {
    return r.getDimensionInfo(c).storeDimIndex;
  }), t.encodeFirstDimNotExtra = h;
  var u = i.label;
  u && u.length && (s = u.slice());
  var d = i.tooltip;
  return d && d.length ? a = d.slice() : a.length || (a = s.slice()), i.defaultedLabel = s, i.defaultedTooltip = a, t.userOutput = new OS(o, e), t;
}
function El(r, e) {
  return r.hasOwnProperty(e) || (r[e] = []), r[e];
}
function zS(r) {
  return !(r === "ordinal" || r === "time");
}
var ca = (
  /** @class */
  /* @__PURE__ */ function() {
    function r(e) {
      this.otherDims = {}, e != null && P(this, e);
    }
    return r;
  }()
), FS = Te(), HS = {
  float: "f",
  int: "i",
  ordinal: "o",
  number: "n",
  time: "t"
}, Dm = (
  /** @class */
  function() {
    function r(e) {
      this.dimensions = e.dimensions, this._dimOmitted = e.dimensionOmitted, this.source = e.source, this._fullDimCount = e.fullDimensionCount, this._updateDimOmitted(e.dimensionOmitted);
    }
    return r.prototype.isDimensionOmitted = function() {
      return this._dimOmitted;
    }, r.prototype._updateDimOmitted = function(e) {
      this._dimOmitted = e, e && (this._dimNameMap || (this._dimNameMap = km(this.source)));
    }, r.prototype.getSourceDimensionIndex = function(e) {
      return j(this._dimNameMap.get(e), -1);
    }, r.prototype.getSourceDimension = function(e) {
      var t = this.source.dimensionsDefine;
      if (t)
        return t[e];
    }, r.prototype.makeStoreSchema = function() {
      for (var e = this._fullDimCount, t = zv(this.source), i = !Am(e), n = "", s = [], a = 0, o = 0; a < e; a++) {
        var l = void 0, h = void 0, u = void 0, d = this.dimensions[o];
        if (d && d.storeDimIndex === a)
          l = t ? d.name : null, h = d.type, u = d.ordinalMeta, o++;
        else {
          var c = this.getSourceDimension(a);
          c && (l = t ? c.name : null, h = c.type);
        }
        s.push({
          property: l,
          type: h,
          ordinalMeta: u
        }), t && l != null && (!d || !d.isCalculationCoord) && (n += i ? l.replace(/\`/g, "`1").replace(/\$/g, "`2") : l), n += "$", n += HS[h] || "f", u && (n += u.uid), n += "$";
      }
      var f = this.source, p = [f.seriesLayoutBy, f.startIndex, n].join("$$");
      return {
        dimensions: s,
        hash: p
      };
    }, r.prototype.makeOutputDimensionNames = function() {
      for (var e = [], t = 0, i = 0; t < this._fullDimCount; t++) {
        var n = void 0, s = this.dimensions[i];
        if (s && s.storeDimIndex === t)
          s.isCalculationCoord || (n = s.name), i++;
        else {
          var a = this.getSourceDimension(t);
          a && (n = a.name);
        }
        e.push(n);
      }
      return e;
    }, r.prototype.appendCalculationDimension = function(e) {
      this.dimensions.push(e), e.isCalculationCoord = !0, this._fullDimCount++, this._updateDimOmitted(!0);
    }, r;
  }()
);
function NS(r) {
  return r instanceof Dm;
}
function Lm(r) {
  for (var e = Z(), t = 0; t < (r || []).length; t++) {
    var i = r[t], n = B(i) ? i.name : i;
    n != null && e.get(n) == null && e.set(n, t);
  }
  return e;
}
function km(r) {
  var e = FS(r);
  return e.dimNameMap || (e.dimNameMap = Lm(r.dimensionsDefine));
}
function Am(r) {
  return r > 30;
}
var Sn = B, ui = J, BS = typeof Int32Array > "u" ? Array : Int32Array, VS = "e\0\0", Nf = -1, WS = ["hasItemOption", "_nameList", "_idList", "_invertedIndicesMap", "_dimSummary", "userOutput", "_rawData", "_dimValueGetter", "_nameDimIdx", "_idDimIdx", "_nameRepeatCount"], GS = ["_approximateExtent"], Bf, qs, Rn, Dr, Tl, Mn, xl, US = (
  /** @class */
  function() {
    function r(e, t) {
      this.type = "list", this._dimOmitted = !1, this._nameList = [], this._idList = [], this._visual = {}, this._layout = {}, this._itemVisuals = [], this._itemLayouts = [], this._graphicEls = [], this._approximateExtent = {}, this._calculationInfo = {}, this.hasItemOption = !1, this.TRANSFERABLE_METHODS = ["cloneShallow", "downSample", "minmaxDownSample", "lttbDownSample", "map"], this.CHANGABLE_METHODS = ["filterSelf", "selectRange"], this.DOWNSAMPLE_METHODS = ["downSample", "minmaxDownSample", "lttbDownSample"];
      var i, n = !1;
      NS(e) ? (i = e.dimensions, this._dimOmitted = e.isDimensionOmitted(), this._schema = e) : (n = !0, i = e), i = i || ["x", "y"];
      for (var s = {}, a = [], o = {}, l = !1, h = {}, u = 0; u < i.length; u++) {
        var d = i[u], c = V(d) ? new ca({
          name: d
        }) : d instanceof ca ? d : new ca(d), f = c.name;
        c.type = c.type || "float", c.coordDim || (c.coordDim = f, c.coordDimIndex = 0);
        var p = c.otherDims = c.otherDims || {};
        a.push(f), s[f] = c, h[f] != null && (l = !0), c.createInvertedIndices && (o[f] = []), p.itemName === 0 && (this._nameDimIdx = u), p.itemId === 0 && (this._idDimIdx = u), process.env.NODE_ENV !== "production" && Y(n || c.storeDimIndex >= 0), n && (c.storeDimIndex = u);
      }
      if (this.dimensions = a, this._dimInfos = s, this._initGetDimensionInfo(l), this.hostModel = t, this._invertedIndicesMap = o, this._dimOmitted) {
        var m = this._dimIdxToName = Z();
        M(a, function(g) {
          m.set(s[g].storeDimIndex, g);
        });
      }
    }
    return r.prototype.getDimension = function(e) {
      var t = this._recognizeDimIndex(e);
      if (t == null)
        return e;
      if (t = e, !this._dimOmitted)
        return this.dimensions[t];
      var i = this._dimIdxToName.get(t);
      if (i != null)
        return i;
      var n = this._schema.getSourceDimension(t);
      if (n)
        return n.name;
    }, r.prototype.getDimensionIndex = function(e) {
      var t = this._recognizeDimIndex(e);
      if (t != null)
        return t;
      if (e == null)
        return -1;
      var i = this._getDimInfo(e);
      return i ? i.storeDimIndex : this._dimOmitted ? this._schema.getSourceDimensionIndex(e) : -1;
    }, r.prototype._recognizeDimIndex = function(e) {
      if (Re(e) || e != null && !isNaN(e) && !this._getDimInfo(e) && (!this._dimOmitted || this._schema.getSourceDimensionIndex(e) < 0))
        return +e;
    }, r.prototype._getStoreDimIndex = function(e) {
      var t = this.getDimensionIndex(e);
      if (process.env.NODE_ENV !== "production" && t == null)
        throw new Error("Unknown dimension " + e);
      return t;
    }, r.prototype.getDimensionInfo = function(e) {
      return this._getDimInfo(this.getDimension(e));
    }, r.prototype._initGetDimensionInfo = function(e) {
      var t = this._dimInfos;
      this._getDimInfo = e ? function(i) {
        return t.hasOwnProperty(i) ? t[i] : void 0;
      } : function(i) {
        return t[i];
      };
    }, r.prototype.getDimensionsOnCoord = function() {
      return this._dimSummary.dataDimsOnCoord.slice();
    }, r.prototype.mapDimension = function(e, t) {
      var i = this._dimSummary;
      if (t == null)
        return i.encodeFirstDimNotExtra[e];
      var n = i.encode[e];
      return n ? n[t] : null;
    }, r.prototype.mapDimensionsAll = function(e) {
      var t = this._dimSummary, i = t.encode[e];
      return (i || []).slice();
    }, r.prototype.getStore = function() {
      return this._store;
    }, r.prototype.initData = function(e, t, i) {
      var n = this, s;
      if (e instanceof Wh && (s = e), !s) {
        var a = this.dimensions, o = Vu(e) || Je(e) ? new Fv(e, a.length) : e;
        s = new Wh();
        var l = ui(a, function(h) {
          return {
            type: n._dimInfos[h].type,
            property: h
          };
        });
        s.initData(o, l, i);
      }
      this._store = s, this._nameList = (t || []).slice(), this._idList = [], this._nameRepeatCount = {}, this._doInit(0, s.count()), this._dimSummary = IS(this, this._schema), this.userOutput = this._dimSummary.userOutput;
    }, r.prototype.appendData = function(e) {
      var t = this._store.appendData(e);
      this._doInit(t[0], t[1]);
    }, r.prototype.appendValues = function(e, t) {
      var i = this._store.appendValues(e, t && t.length), n = i.start, s = i.end, a = this._shouldMakeIdFromName();
      if (this._updateOrdinalMeta(), t)
        for (var o = n; o < s; o++) {
          var l = o - n;
          this._nameList[o] = t[l], a && xl(this, o);
        }
    }, r.prototype._updateOrdinalMeta = function() {
      for (var e = this._store, t = this.dimensions, i = 0; i < t.length; i++) {
        var n = this._dimInfos[t[i]];
        n.ordinalMeta && e.collectOrdinalMeta(n.storeDimIndex, n.ordinalMeta);
      }
    }, r.prototype._shouldMakeIdFromName = function() {
      var e = this._store.getProvider();
      return this._idDimIdx == null && e.getSource().sourceFormat !== Jt && !e.fillStorage;
    }, r.prototype._doInit = function(e, t) {
      if (!(e >= t)) {
        var i = this._store, n = i.getProvider();
        this._updateOrdinalMeta();
        var s = this._nameList, a = this._idList, o = n.getSource().sourceFormat, l = o === Bt;
        if (l && !n.pure)
          for (var h = [], u = e; u < t; u++) {
            var d = n.getItem(u, h);
            if (!this.hasItemOption && IC(d) && (this.hasItemOption = !0), d) {
              var c = d.name;
              s[u] == null && c != null && (s[u] = at(c, null));
              var f = d.id;
              a[u] == null && f != null && (a[u] = at(f, null));
            }
          }
        if (this._shouldMakeIdFromName())
          for (var u = e; u < t; u++)
            xl(this, u);
        Bf(this);
      }
    }, r.prototype.getApproximateExtent = function(e) {
      return this._approximateExtent[e] || this._store.getDataExtent(this._getStoreDimIndex(e));
    }, r.prototype.setApproximateExtent = function(e, t) {
      t = this.getDimension(t), this._approximateExtent[t] = e.slice();
    }, r.prototype.getCalculationInfo = function(e) {
      return this._calculationInfo[e];
    }, r.prototype.setCalculationInfo = function(e, t) {
      Sn(e) ? P(this._calculationInfo, e) : this._calculationInfo[e] = t;
    }, r.prototype.getName = function(e) {
      var t = this.getRawIndex(e), i = this._nameList[t];
      return i == null && this._nameDimIdx != null && (i = Rn(this, this._nameDimIdx, t)), i == null && (i = ""), i;
    }, r.prototype._getCategory = function(e, t) {
      var i = this._store.get(e, t), n = this._store.getOrdinalMeta(e);
      return n ? n.categories[i] : i;
    }, r.prototype.getId = function(e) {
      return qs(this, this.getRawIndex(e));
    }, r.prototype.count = function() {
      return this._store.count();
    }, r.prototype.get = function(e, t) {
      var i = this._store, n = this._dimInfos[e];
      if (n)
        return i.get(n.storeDimIndex, t);
    }, r.prototype.getByRawIndex = function(e, t) {
      var i = this._store, n = this._dimInfos[e];
      if (n)
        return i.getByRawIndex(n.storeDimIndex, t);
    }, r.prototype.getIndices = function() {
      return this._store.getIndices();
    }, r.prototype.getDataExtent = function(e) {
      return this._store.getDataExtent(this._getStoreDimIndex(e));
    }, r.prototype.getSum = function(e) {
      return this._store.getSum(this._getStoreDimIndex(e));
    }, r.prototype.getMedian = function(e) {
      return this._store.getMedian(this._getStoreDimIndex(e));
    }, r.prototype.getValues = function(e, t) {
      var i = this, n = this._store;
      return F(e) ? n.getValues(ui(e, function(s) {
        return i._getStoreDimIndex(s);
      }), t) : n.getValues(e);
    }, r.prototype.hasValue = function(e) {
      for (var t = this._dimSummary.dataDimIndicesOnCoord, i = 0, n = t.length; i < n; i++)
        if (isNaN(this._store.get(t[i], e)))
          return !1;
      return !0;
    }, r.prototype.indexOfName = function(e) {
      for (var t = 0, i = this._store.count(); t < i; t++)
        if (this.getName(t) === e)
          return t;
      return -1;
    }, r.prototype.getRawIndex = function(e) {
      return this._store.getRawIndex(e);
    }, r.prototype.indexOfRawIndex = function(e) {
      return this._store.indexOfRawIndex(e);
    }, r.prototype.rawIndexOf = function(e, t) {
      var i = e && this._invertedIndicesMap[e];
      if (process.env.NODE_ENV !== "production" && !i)
        throw new Error("Do not supported yet");
      var n = i && i[t];
      return n == null || isNaN(n) ? Nf : n;
    }, r.prototype.indicesOfNearest = function(e, t, i) {
      return this._store.indicesOfNearest(this._getStoreDimIndex(e), t, i);
    }, r.prototype.each = function(e, t, i) {
      q(e) && (i = t, t = e, e = []);
      var n = i || this, s = ui(Dr(e), this._getStoreDimIndex, this);
      this._store.each(s, n ? K(t, n) : t);
    }, r.prototype.filterSelf = function(e, t, i) {
      q(e) && (i = t, t = e, e = []);
      var n = i || this, s = ui(Dr(e), this._getStoreDimIndex, this);
      return this._store = this._store.filter(s, n ? K(t, n) : t), this;
    }, r.prototype.selectRange = function(e) {
      var t = this, i = {}, n = me(e);
      return M(n, function(s) {
        var a = t._getStoreDimIndex(s);
        i[a] = e[s];
      }), this._store = this._store.selectRange(i), this;
    }, r.prototype.mapArray = function(e, t, i) {
      q(e) && (i = t, t = e, e = []), i = i || this;
      var n = [];
      return this.each(e, function() {
        n.push(t && t.apply(this, arguments));
      }, i), n;
    }, r.prototype.map = function(e, t, i, n) {
      var s = i || n || this, a = ui(Dr(e), this._getStoreDimIndex, this), o = Mn(this);
      return o._store = this._store.map(a, s ? K(t, s) : t), o;
    }, r.prototype.modify = function(e, t, i, n) {
      var s = this, a = i || n || this;
      process.env.NODE_ENV !== "production" && M(Dr(e), function(l) {
        var h = s.getDimensionInfo(l);
        h.isCalculationCoord || console.error("Danger: only stack dimension can be modified");
      });
      var o = ui(Dr(e), this._getStoreDimIndex, this);
      this._store.modify(o, a ? K(t, a) : t);
    }, r.prototype.downSample = function(e, t, i, n) {
      var s = Mn(this);
      return s._store = this._store.downSample(this._getStoreDimIndex(e), t, i, n), s;
    }, r.prototype.minmaxDownSample = function(e, t) {
      var i = Mn(this);
      return i._store = this._store.minmaxDownSample(this._getStoreDimIndex(e), t), i;
    }, r.prototype.lttbDownSample = function(e, t) {
      var i = Mn(this);
      return i._store = this._store.lttbDownSample(this._getStoreDimIndex(e), t), i;
    }, r.prototype.getRawDataItem = function(e) {
      return this._store.getRawDataItem(e);
    }, r.prototype.getItemModel = function(e) {
      var t = this.hostModel, i = this.getRawDataItem(e);
      return new pe(i, t, t && t.ecModel);
    }, r.prototype.diff = function(e) {
      var t = this;
      return new Mm(e ? e.getStore().getIndices() : [], this.getStore().getIndices(), function(i) {
        return qs(e, i);
      }, function(i) {
        return qs(t, i);
      });
    }, r.prototype.getVisual = function(e) {
      var t = this._visual;
      return t && t[e];
    }, r.prototype.setVisual = function(e, t) {
      this._visual = this._visual || {}, Sn(e) ? P(this._visual, e) : this._visual[e] = t;
    }, r.prototype.getItemVisual = function(e, t) {
      var i = this._itemVisuals[e], n = i && i[t];
      return n ?? this.getVisual(t);
    }, r.prototype.hasItemVisual = function() {
      return this._itemVisuals.length > 0;
    }, r.prototype.ensureUniqueItemVisual = function(e, t) {
      var i = this._itemVisuals, n = i[e];
      n || (n = i[e] = {});
      var s = n[t];
      return s == null && (s = this.getVisual(t), F(s) ? s = s.slice() : Sn(s) && (s = P({}, s)), n[t] = s), s;
    }, r.prototype.setItemVisual = function(e, t, i) {
      var n = this._itemVisuals[e] || {};
      this._itemVisuals[e] = n, Sn(t) ? P(n, t) : n[t] = i;
    }, r.prototype.clearAllVisual = function() {
      this._visual = {}, this._itemVisuals = [];
    }, r.prototype.setLayout = function(e, t) {
      Sn(e) ? P(this._layout, e) : this._layout[e] = t;
    }, r.prototype.getLayout = function(e) {
      return this._layout[e];
    }, r.prototype.getItemLayout = function(e) {
      return this._itemLayouts[e];
    }, r.prototype.setItemLayout = function(e, t, i) {
      this._itemLayouts[e] = i ? P(this._itemLayouts[e] || {}, t) : t;
    }, r.prototype.clearItemLayouts = function() {
      this._itemLayouts.length = 0;
    }, r.prototype.setItemGraphicEl = function(e, t) {
      var i = this.hostModel && this.hostModel.seriesIndex;
      Y_(i, this.dataType, e, t), this._graphicEls[e] = t;
    }, r.prototype.getItemGraphicEl = function(e) {
      return this._graphicEls[e];
    }, r.prototype.eachItemGraphicEl = function(e, t) {
      M(this._graphicEls, function(i, n) {
        i && e && e.call(t, i, n);
      });
    }, r.prototype.cloneShallow = function(e) {
      return e || (e = new r(this._schema ? this._schema : ui(this.dimensions, this._getDimInfo, this), this.hostModel)), Tl(e, this), e._store = this._store, e;
    }, r.prototype.wrapMethod = function(e, t) {
      var i = this[e];
      q(i) && (this.__wrappedMethods = this.__wrappedMethods || [], this.__wrappedMethods.push(e), this[e] = function() {
        var n = i.apply(this, arguments);
        return t.apply(this, [n].concat(hu(arguments)));
      });
    }, r.internalField = function() {
      Bf = function(e) {
        var t = e._invertedIndicesMap;
        M(t, function(i, n) {
          var s = e._dimInfos[n], a = s.ordinalMeta, o = e._store;
          if (a) {
            i = t[n] = new BS(a.categories.length);
            for (var l = 0; l < i.length; l++)
              i[l] = Nf;
            for (var l = 0; l < o.count(); l++)
              i[o.get(s.storeDimIndex, l)] = l;
          }
        });
      }, Rn = function(e, t, i) {
        return at(e._getCategory(t, i), null);
      }, qs = function(e, t) {
        var i = e._idList[t];
        return i == null && e._idDimIdx != null && (i = Rn(e, e._idDimIdx, t)), i == null && (i = VS + t), i;
      }, Dr = function(e) {
        return F(e) || (e = e != null ? [e] : []), e;
      }, Mn = function(e) {
        var t = new r(e._schema ? e._schema : ui(e.dimensions, e._getDimInfo, e), e.hostModel);
        return Tl(t, e), t;
      }, Tl = function(e, t) {
        M(WS.concat(t.__wrappedMethods || []), function(i) {
          t.hasOwnProperty(i) && (e[i] = t[i]);
        }), e.__wrappedMethods = t.__wrappedMethods, M(GS, function(i) {
          e[i] = $(t[i]);
        }), e._calculationInfo = P({}, t._calculationInfo);
      }, xl = function(e, t) {
        var i = e._nameList, n = e._idList, s = e._nameDimIdx, a = e._idDimIdx, o = i[t], l = n[t];
        if (o == null && s != null && (i[t] = o = Rn(e, s, t)), l == null && a != null && (n[t] = l = Rn(e, a, t)), l == null && o != null) {
          var h = e._nameRepeatCount, u = h[o] = (h[o] || 0) + 1;
          l = o, u > 1 && (l += "__ec__" + u), n[t] = l;
        }
      };
    }(), r;
  }()
);
function jS(r, e) {
  Vu(r) || (r = Ov(r)), e = e || {};
  var t = e.coordDimensions || [], i = e.dimensionsDefine || r.dimensionsDefine || [], n = Z(), s = [], a = XS(r, t, i, e.dimensionsCount), o = e.canOmitUnusedDimensions && Am(a), l = i === r.dimensionsDefine, h = l ? km(r) : Lm(i), u = e.encodeDefine;
  !u && e.encodeDefaulter && (u = e.encodeDefaulter(r, a));
  for (var d = Z(u), c = new Wv(a), f = 0; f < c.length; f++)
    c[f] = -1;
  function p(C) {
    var S = c[C];
    if (S < 0) {
      var R = i[C], D = B(R) ? R : {
        name: R
      }, k = new ca(), L = D.name;
      L != null && h.get(L) != null && (k.name = k.displayName = L), D.type != null && (k.type = D.type), D.displayName != null && (k.displayName = D.displayName);
      var O = s.length;
      return c[C] = O, k.storeDimIndex = C, s.push(k), k;
    }
    return s[S];
  }
  if (!o)
    for (var f = 0; f < a; f++)
      p(f);
  d.each(function(C, S) {
    var R = Me(C).slice();
    if (R.length === 1 && !V(R[0]) && R[0] < 0) {
      d.set(S, !1);
      return;
    }
    var D = d.set(S, []);
    M(R, function(k, L) {
      var O = V(k) ? h.get(k) : k;
      O != null && O < a && (D[L] = O, g(p(O), S, L));
    });
  });
  var m = 0;
  M(t, function(C) {
    var S, R, D, k;
    if (V(C))
      S = C, k = {};
    else {
      k = C, S = k.name;
      var L = k.ordinalMeta;
      k.ordinalMeta = null, k = P({}, k), k.ordinalMeta = L, R = k.dimsDef, D = k.otherDims, k.name = k.coordDim = k.coordDimIndex = k.dimsDef = k.otherDims = null;
    }
    var O = d.get(S);
    if (O !== !1) {
      if (O = Me(O), !O.length)
        for (var I = 0; I < (R && R.length || 1); I++) {
          for (; m < a && p(m).coordDim != null; )
            m++;
          m < a && O.push(m++);
        }
      M(O, function(G, ee) {
        var te = p(G);
        if (l && k.type != null && (te.type = k.type), g(ge(te, k), S, ee), te.name == null && R) {
          var ve = R[ee];
          !B(ve) && (ve = {
            name: ve
          }), te.name = te.displayName = ve.name, te.defaultTooltip = ve.defaultTooltip;
        }
        D && ge(te.otherDims, D);
      });
    }
  });
  function g(C, S, R) {
    Bh.get(S) != null ? C.otherDims[S] = R : (C.coordDim = S, C.coordDimIndex = R, n.set(S, !0));
  }
  var v = e.generateCoord, b = e.generateCoordCount, y = b != null;
  b = v ? b || 1 : 0;
  var w = v || "value";
  function _(C) {
    C.name == null && (C.name = C.coordDim);
  }
  if (o)
    M(s, function(C) {
      _(C);
    }), s.sort(function(C, S) {
      return C.storeDimIndex - S.storeDimIndex;
    });
  else
    for (var E = 0; E < a; E++) {
      var x = p(E), T = x.coordDim;
      T == null && (x.coordDim = $S(w, n, y), x.coordDimIndex = 0, (!v || b <= 0) && (x.isExtraCoord = !0), b--), _(x), x.type == null && (Mv(r, E) === tt.Must || x.isExtraCoord && (x.otherDims.itemName != null || x.otherDims.seriesName != null)) && (x.type = "ordinal");
    }
  return YS(s), new Dm({
    source: r,
    dimensions: s,
    fullDimensionCount: a,
    dimensionOmitted: o
  });
}
function YS(r) {
  for (var e = Z(), t = 0; t < r.length; t++) {
    var i = r[t], n = i.name, s = e.get(n) || 0;
    s > 0 && (i.name = n + (s - 1)), s++, e.set(n, s);
  }
}
function XS(r, e, t, i) {
  var n = Math.max(r.dimensionsDetectedCount || 1, e.length, t.length, i || 0);
  return M(e, function(s) {
    var a;
    B(s) && (a = s.dimsDef) && (n = Math.max(n, a.length));
  }), n;
}
function $S(r, e, t) {
  if (t || e.hasKey(r)) {
    for (var i = 0; e.hasKey(r + i); )
      i++;
    r += i;
  }
  return e.set(r, !0), r;
}
function Pm(r, e) {
  return r.type === "category" ? r.scale.getLabel(e) : e.value;
}
function qS(r) {
  var e = r.get("interval");
  return e ?? "auto";
}
function KS(r) {
  return r.type === "category" && qS(r.getLabelModel()) === 0;
}
var Vf = [], ZS = {
  registerPreprocessor: xm,
  registerProcessor: Sm,
  registerPostInit: MS,
  registerPostUpdate: DS,
  registerUpdateLifecycle: $u,
  registerAction: fr,
  registerCoordinateSystem: LS,
  registerLayout: kS,
  registerVisual: pr,
  registerTransform: PS,
  registerLoading: Rm,
  registerMap: AS,
  registerImpl: lS,
  PRIORITY: CS,
  ComponentModel: ae,
  ComponentView: ti,
  SeriesModel: Si,
  ChartView: Ei,
  // TODO Use ComponentModel and SeriesModel instead of Constructor
  registerComponentModel: function(r) {
    ae.registerClass(r);
  },
  registerComponentView: function(r) {
    ti.registerClass(r);
  },
  registerSeriesModel: function(r) {
    Si.registerClass(r);
  },
  registerChartView: function(r) {
    Ei.registerClass(r);
  },
  registerSubTypeDefaulter: function(r, e) {
    ae.registerSubTypeDefaulter(r, e);
  },
  registerPainter: function(r, e) {
    xC(r, e);
  }
};
function Ku(r) {
  if (F(r)) {
    M(r, function(e) {
      Ku(e);
    });
    return;
  }
  ue(Vf, r) >= 0 || (Vf.push(r), q(r) && (r = {
    install: r
  }), r.install(ZS));
}
function JS(r) {
  for (var e = [], t = 0; t < r.length; t++) {
    var i = r[t];
    if (!i.defaultAttr.ignore) {
      var n = i.label, s = n.getComputedTransform(), a = n.getBoundingRect(), o = !s || s[1] < 1e-5 && s[2] < 1e-5, l = n.style.margin || 0, h = a.clone();
      h.applyTransform(s), h.x -= l / 2, h.y -= l / 2, h.width += l, h.height += l;
      var u = o ? new Ma(a, s) : null;
      e.push({
        label: n,
        labelLine: i.labelLine,
        rect: h,
        localRect: a,
        obb: u,
        priority: i.priority,
        defaultAttr: i.defaultAttr,
        layoutOption: i.computedLayoutOption,
        axisAligned: o,
        transform: s
      });
    }
  }
  return e;
}
function QS(r) {
  var e = [];
  r.sort(function(m, g) {
    return g.priority - m.priority;
  });
  var t = new re(0, 0, 0, 0);
  function i(m) {
    if (!m.ignore) {
      var g = m.ensureState("emphasis");
      g.ignore == null && (g.ignore = !1);
    }
    m.ignore = !0;
  }
  for (var n = 0; n < r.length; n++) {
    var s = r[n], a = s.axisAligned, o = s.localRect, l = s.transform, h = s.label, u = s.labelLine;
    t.copy(s.rect), t.width -= 0.1, t.height -= 0.1, t.x += 0.05, t.y += 0.05;
    for (var d = s.obb, c = !1, f = 0; f < e.length; f++) {
      var p = e[f];
      if (t.intersect(p.rect)) {
        if (a && p.axisAligned) {
          c = !0;
          break;
        }
        if (p.obb || (p.obb = new Ma(p.localRect, p.transform)), d || (d = new Ma(o, l)), d.intersect(p.obb)) {
          c = !0;
          break;
        }
      }
    }
    c ? (i(h), u && i(u)) : (h.attr("ignore", s.defaultAttr.ignore), u && u.attr("ignore", s.defaultAttr.labelGuideIgnore), e.push(s));
  }
}
function Wf(r, e, t) {
  t = t || {};
  var i = r.coordinateSystem, n = e.axis, s = {}, a = n.getAxesOnZeroOf()[0], o = n.position, l = a ? "onZero" : o, h = n.dim, u = i.getRect(), d = [u.x, u.x + u.width, u.y, u.y + u.height], c = {
    left: 0,
    right: 1,
    top: 0,
    bottom: 1,
    onZero: 2
  }, f = e.get("offset") || 0, p = h === "x" ? [d[2] - f, d[3] + f] : [d[0] - f, d[1] + f];
  if (a) {
    var m = a.toGlobalCoord(a.dataToCoord(0));
    p[c.onZero] = Math.max(Math.min(m, p[1]), p[0]);
  }
  s.position = [h === "y" ? p[c[l]] : d[0], h === "x" ? p[c[l]] : d[3]], s.rotation = Math.PI / 2 * (h === "x" ? 0 : 1);
  var g = {
    top: -1,
    bottom: 1,
    left: -1,
    right: 1
  };
  s.labelDirection = s.tickDirection = s.nameDirection = g[o], s.labelOffset = a ? p[c[o]] - p[c.onZero] : 0, e.get(["axisTick", "inside"]) && (s.tickDirection = -s.tickDirection), Xr(t.labelInside, e.get(["axisLabel", "inside"])) && (s.labelDirection = -s.labelDirection);
  var v = e.get(["axisLabel", "rotate"]);
  return s.labelRotate = l === "top" ? -v : v, s.z2 = 1, s;
}
var wi = Math.PI, ur = (
  /** @class */
  function() {
    function r(e, t) {
      this.group = new lt(), this.opt = t, this.axisModel = e, ge(t, {
        labelOffset: 0,
        nameDirection: 1,
        tickDirection: 1,
        labelDirection: 1,
        silent: !0,
        handleAutoShown: function() {
          return !0;
        }
      });
      var i = new lt({
        x: t.position[0],
        y: t.position[1],
        rotation: t.rotation
      });
      i.updateTransform(), this._transformGroup = i;
    }
    return r.prototype.hasBuilder = function(e) {
      return !!Gf[e];
    }, r.prototype.add = function(e) {
      Gf[e](this.opt, this.axisModel, this.group, this._transformGroup);
    }, r.prototype.getGroup = function() {
      return this.group;
    }, r.innerTextLayout = function(e, t, i) {
      var n = Lg(t - e), s, a;
      return Ta(n) ? (a = i > 0 ? "top" : "bottom", s = "center") : Ta(n - wi) ? (a = i > 0 ? "bottom" : "top", s = "center") : (a = "middle", n > 0 && n < wi ? s = i > 0 ? "right" : "left" : s = i > 0 ? "left" : "right"), {
        rotation: n,
        textAlign: s,
        textVerticalAlign: a
      };
    }, r.makeAxisEventDataBase = function(e) {
      var t = {
        componentType: e.mainType,
        componentIndex: e.componentIndex
      };
      return t[e.mainType + "Index"] = e.componentIndex, t;
    }, r.isLabelSilent = function(e) {
      var t = e.get("tooltip");
      return e.get("silent") || !(e.get("triggerEvent") || t && t.show);
    }, r;
  }()
), Gf = {
  axisLine: function(r, e, t, i) {
    var n = e.get(["axisLine", "show"]);
    if (n === "auto" && r.handleAutoShown && (n = r.handleAutoShown("axisLine")), !!n) {
      var s = e.axis.getExtent(), a = i.transform, o = [s[0], 0], l = [s[1], 0], h = o[0] > l[0];
      a && (Ht(o, o, a), Ht(l, l, a));
      var u = P({
        lineCap: "round"
      }, e.getModel(["axisLine", "lineStyle"]).getLineStyle()), d = new sn({
        shape: {
          x1: o[0],
          y1: o[1],
          x2: l[0],
          y2: l[1]
        },
        style: u,
        strokeContainThreshold: r.strokeContainThreshold || 5,
        silent: !0,
        z2: 1
      });
      Ou(d.shape, d.style.lineWidth), d.anid = "line", t.add(d);
      var c = e.get(["axisLine", "symbol"]);
      if (c != null) {
        var f = e.get(["axisLine", "symbolSize"]);
        V(c) && (c = [c, c]), (V(f) || Re(f)) && (f = [f, f]);
        var p = j1(e.get(["axisLine", "symbolOffset"]) || 0, f), m = f[0], g = f[1];
        M([{
          rotate: r.rotation + Math.PI / 2,
          offset: p[0],
          r: 0
        }, {
          rotate: r.rotation - Math.PI / 2,
          offset: p[1],
          r: Math.sqrt((o[0] - l[0]) * (o[0] - l[0]) + (o[1] - l[1]) * (o[1] - l[1]))
        }], function(v, b) {
          if (c[b] !== "none" && c[b] != null) {
            var y = sm(c[b], -m / 2, -g / 2, m, g, u.stroke, !0), w = v.r + v.offset, _ = h ? l : o;
            y.attr({
              rotation: v.rotate,
              x: _[0] + w * Math.cos(r.rotation),
              y: _[1] - w * Math.sin(r.rotation),
              silent: !0,
              z2: 11
            }), t.add(y);
          }
        });
      }
    }
  },
  axisTickLabel: function(r, e, t, i) {
    var n = iR(t, i, e, r), s = nR(t, i, e, r);
    if (tR(e, s, n), rR(t, i, e, r.tickDirection), e.get(["axisLabel", "hideOverlap"])) {
      var a = JS(J(s, function(o) {
        return {
          label: o,
          priority: o.z2,
          defaultAttr: {
            ignore: o.ignore
          }
        };
      }));
      QS(a);
    }
  },
  axisName: function(r, e, t, i) {
    var n = Xr(r.axisName, e.get("name"));
    if (n) {
      var s = e.get("nameLocation"), a = r.nameDirection, o = e.getModel("nameTextStyle"), l = e.get("nameGap") || 0, h = e.axis.getExtent(), u = h[0] > h[1] ? -1 : 1, d = [
        s === "start" ? h[0] - u * l : s === "end" ? h[1] + u * l : (h[0] + h[1]) / 2,
        // Reuse labelOffset.
        jf(s) ? r.labelOffset + a * l : 0
      ], c, f = e.get("nameRotate");
      f != null && (f = f * wi / 180);
      var p;
      jf(s) ? c = ur.innerTextLayout(
        r.rotation,
        f ?? r.rotation,
        // Adapt to axis.
        a
      ) : (c = eR(r.rotation, s, f || 0, h), p = r.axisNameAvailableWidth, p != null && (p = Math.abs(p / Math.sin(c.rotation)), !isFinite(p) && (p = null)));
      var m = o.getFont(), g = e.get("nameTruncate", !0) || {}, v = g.ellipsis, b = Xr(r.nameTruncateMaxWidth, g.maxWidth, p), y = new ht({
        x: d[0],
        y: d[1],
        rotation: c.rotation,
        silent: ur.isLabelSilent(e),
        style: ei(o, {
          text: n,
          font: m,
          overflow: "truncate",
          width: b,
          ellipsis: v,
          fill: o.getTextColor() || e.get(["axisLine", "lineStyle", "color"]),
          align: o.get("align") || c.textAlign,
          verticalAlign: o.get("verticalAlign") || c.textVerticalAlign
        }),
        z2: 1
      });
      if (zu({
        el: y,
        componentModel: e,
        itemName: n
      }), y.__fullText = n, y.anid = "name", e.get("triggerEvent")) {
        var w = ur.makeAxisEventDataBase(e);
        w.targetType = "axisName", w.name = n, ce(y).eventData = w;
      }
      i.add(y), y.updateTransform(), t.add(y), y.decomposeTransform();
    }
  }
};
function eR(r, e, t, i) {
  var n = Lg(t - r), s, a, o = i[0] > i[1], l = e === "start" && !o || e !== "start" && o;
  return Ta(n - wi / 2) ? (a = l ? "bottom" : "top", s = "center") : Ta(n - wi * 1.5) ? (a = l ? "top" : "bottom", s = "center") : (a = "middle", n < wi * 1.5 && n > wi / 2 ? s = l ? "left" : "right" : s = l ? "right" : "left"), {
    rotation: n,
    textAlign: s,
    textVerticalAlign: a
  };
}
function tR(r, e, t) {
  if (!KS(r.axis)) {
    var i = r.get(["axisLabel", "showMinLabel"]), n = r.get(["axisLabel", "showMaxLabel"]);
    e = e || [], t = t || [];
    var s = e[0], a = e[1], o = e[e.length - 1], l = e[e.length - 2], h = t[0], u = t[1], d = t[t.length - 1], c = t[t.length - 2];
    i === !1 ? (ft(s), ft(h)) : Uf(s, a) && (i ? (ft(a), ft(u)) : (ft(s), ft(h))), n === !1 ? (ft(o), ft(d)) : Uf(l, o) && (n ? (ft(l), ft(c)) : (ft(o), ft(d)));
  }
}
function ft(r) {
  r && (r.ignore = !0);
}
function Uf(r, e) {
  var t = r && r.getBoundingRect().clone(), i = e && e.getBoundingRect().clone();
  if (!(!t || !i)) {
    var n = cu([]);
    return fu(n, n, -r.rotation), t.applyTransform(Gr([], n, r.getLocalTransform())), i.applyTransform(Gr([], n, e.getLocalTransform())), t.intersect(i);
  }
}
function jf(r) {
  return r === "middle" || r === "center";
}
function Om(r, e, t, i, n) {
  for (var s = [], a = [], o = [], l = 0; l < r.length; l++) {
    var h = r[l].coord;
    a[0] = h, a[1] = 0, o[0] = h, o[1] = t, e && (Ht(a, a, e), Ht(o, o, e));
    var u = new sn({
      shape: {
        x1: a[0],
        y1: a[1],
        x2: o[0],
        y2: o[1]
      },
      style: i,
      z2: 2,
      autoBatch: !0,
      silent: !0
    });
    Ou(u.shape, u.style.lineWidth), u.anid = n + "_" + r[l].tickValue, s.push(u);
  }
  return s;
}
function iR(r, e, t, i) {
  var n = t.axis, s = t.getModel("axisTick"), a = s.get("show");
  if (a === "auto" && i.handleAutoShown && (a = i.handleAutoShown("axisTick")), !(!a || n.scale.isBlank())) {
    for (var o = s.getModel("lineStyle"), l = i.tickDirection * s.get("length"), h = n.getTicksCoords(), u = Om(h, e.transform, l, ge(o.getLineStyle(), {
      stroke: t.get(["axisLine", "lineStyle", "color"])
    }), "ticks"), d = 0; d < u.length; d++)
      r.add(u[d]);
    return u;
  }
}
function rR(r, e, t, i) {
  var n = t.axis, s = t.getModel("minorTick");
  if (!(!s.get("show") || n.scale.isBlank())) {
    var a = n.getMinorTicksCoords();
    if (a.length)
      for (var o = s.getModel("lineStyle"), l = i * s.get("length"), h = ge(o.getLineStyle(), ge(t.getModel("axisTick").getLineStyle(), {
        stroke: t.get(["axisLine", "lineStyle", "color"])
      })), u = 0; u < a.length; u++)
        for (var d = Om(a[u], e.transform, l, h, "minorticks_" + u), c = 0; c < d.length; c++)
          r.add(d[c]);
  }
}
function nR(r, e, t, i) {
  var n = t.axis, s = Xr(i.axisLabelShow, t.get(["axisLabel", "show"]));
  if (!(!s || n.scale.isBlank())) {
    var a = t.getModel("axisLabel"), o = a.get("margin"), l = n.getViewLabels(), h = (Xr(i.labelRotate, a.get("rotate")) || 0) * wi / 180, u = ur.innerTextLayout(i.rotation, h, i.labelDirection), d = t.getCategories && t.getCategories(!0), c = [], f = ur.isLabelSilent(t), p = t.get("triggerEvent");
    return M(l, function(m, g) {
      var v = n.scale.type === "ordinal" ? n.scale.getRawOrdinalNumber(m.tickValue) : m.tickValue, b = m.formattedLabel, y = m.rawLabel, w = a;
      if (d && d[v]) {
        var _ = d[v];
        B(_) && _.textStyle && (w = new pe(_.textStyle, a, t.ecModel));
      }
      var E = w.getTextColor() || t.get(["axisLine", "lineStyle", "color"]), x = n.dataToCoord(v), T = w.getShallow("align", !0) || u.textAlign, C = j(w.getShallow("alignMinLabel", !0), T), S = j(w.getShallow("alignMaxLabel", !0), T), R = w.getShallow("verticalAlign", !0) || w.getShallow("baseline", !0) || u.textVerticalAlign, D = j(w.getShallow("verticalAlignMinLabel", !0), R), k = j(w.getShallow("verticalAlignMaxLabel", !0), R), L = new ht({
        x,
        y: i.labelOffset + i.labelDirection * o,
        rotation: u.rotation,
        silent: f,
        z2: 10 + (m.level || 0),
        style: ei(w, {
          text: b,
          align: g === 0 ? C : g === l.length - 1 ? S : T,
          verticalAlign: g === 0 ? D : g === l.length - 1 ? k : R,
          fill: q(E) ? E(
            // (1) In category axis with data zoom, tick is not the original
            // index of axis.data. So tick should not be exposed to user
            // in category axis.
            // (2) Compatible with previous version, which always use formatted label as
            // input. But in interval scale the formatted label is like '223,445', which
            // maked user replace ','. So we modify it to return original val but remain
            // it as 'string' to avoid error in replacing.
            n.type === "category" ? y : n.type === "value" ? v + "" : v,
            g
          ) : E
        })
      });
      if (L.anid = "label_" + v, zu({
        el: L,
        componentModel: t,
        itemName: b,
        formatterParamsExtra: {
          isTruncated: function() {
            return L.isTruncated;
          },
          value: y,
          tickIndex: g
        }
      }), p) {
        var O = ur.makeAxisEventDataBase(t);
        O.targetType = "axisLabel", O.value = y, O.tickIndex = g, n.type === "category" && (O.dataIndex = v), ce(L).eventData = O;
      }
      e.add(L), L.updateTransform(), c.push(L), r.add(L), L.decomposeTransform();
    }), c;
  }
}
function sR(r, e) {
  var t = {
    /**
     * key: makeKey(axis.model)
     * value: {
     *      axis,
     *      coordSys,
     *      axisPointerModel,
     *      triggerTooltip,
     *      triggerEmphasis,
     *      involveSeries,
     *      snap,
     *      seriesModels,
     *      seriesDataCount
     * }
     */
    axesInfo: {},
    seriesInvolved: !1,
    /**
     * key: makeKey(coordSys.model)
     * value: Object: key makeKey(axis.model), value: axisInfo
     */
    coordSysAxesInfo: {},
    coordSysMap: {}
  };
  return aR(t, r, e), t.seriesInvolved && lR(t, r), t;
}
function aR(r, e, t) {
  var i = e.getComponent("tooltip"), n = e.getComponent("axisPointer"), s = n.get("link", !0) || [], a = [];
  M(t.getCoordinateSystems(), function(o) {
    if (!o.axisPointerEnabled)
      return;
    var l = cs(o.model), h = r.coordSysAxesInfo[l] = {};
    r.coordSysMap[l] = o;
    var u = o.model, d = u.getModel("tooltip", i);
    if (M(o.getAxes(), He(m, !1, null)), o.getTooltipAxes && i && d.get("show")) {
      var c = d.get("trigger") === "axis", f = d.get(["axisPointer", "type"]) === "cross", p = o.getTooltipAxes(d.get(["axisPointer", "axis"]));
      (c || f) && M(p.baseAxes, He(m, f ? "cross" : !0, c)), f && M(p.otherAxes, He(m, "cross", !1));
    }
    function m(g, v, b) {
      var y = b.model.getModel("axisPointer", n), w = y.get("show");
      if (!(!w || w === "auto" && !g && !eu(y))) {
        v == null && (v = y.get("triggerTooltip")), y = g ? oR(b, d, n, e, g, v) : y;
        var _ = y.get("snap"), E = y.get("triggerEmphasis"), x = cs(b.model), T = v || _ || b.type === "category", C = r.axesInfo[x] = {
          key: x,
          axis: b,
          coordSys: o,
          axisPointerModel: y,
          triggerTooltip: v,
          triggerEmphasis: E,
          involveSeries: T,
          snap: _,
          useHandle: eu(y),
          seriesModels: [],
          linkGroup: null
        };
        h[x] = C, r.seriesInvolved = r.seriesInvolved || T;
        var S = hR(s, b);
        if (S != null) {
          var R = a[S] || (a[S] = {
            axesInfo: {}
          });
          R.axesInfo[x] = C, R.mapper = s[S].mapper, C.linkGroup = R;
        }
      }
    }
  });
}
function oR(r, e, t, i, n, s) {
  var a = e.getModel("axisPointer"), o = ["type", "snap", "lineStyle", "shadowStyle", "label", "animation", "animationDurationUpdate", "animationEasingUpdate", "z"], l = {};
  M(o, function(c) {
    l[c] = $(a.get(c));
  }), l.snap = r.type !== "category" && !!s, a.get("type") === "cross" && (l.type = "line");
  var h = l.label || (l.label = {});
  if (h.show == null && (h.show = !1), n === "cross") {
    var u = a.get(["label", "show"]);
    if (h.show = u ?? !0, !s) {
      var d = l.lineStyle = a.get("crossStyle");
      d && ge(h, d.textStyle);
    }
  }
  return r.model.getModel("axisPointer", new pe(l, t, i));
}
function lR(r, e) {
  e.eachSeries(function(t) {
    var i = t.coordinateSystem, n = t.get(["tooltip", "trigger"], !0), s = t.get(["tooltip", "show"], !0);
    !i || n === "none" || n === !1 || n === "item" || s === !1 || t.get(["axisPointer", "show"], !0) === !1 || M(r.coordSysAxesInfo[cs(i.model)], function(a) {
      var o = a.axis;
      i.getAxis(o.dim) === o && (a.seriesModels.push(t), a.seriesDataCount == null && (a.seriesDataCount = 0), a.seriesDataCount += t.getData().count());
    });
  });
}
function hR(r, e) {
  for (var t = e.model, i = e.dim, n = 0; n < r.length; n++) {
    var s = r[n] || {};
    if (Sl(s[i + "AxisId"], t.id) || Sl(s[i + "AxisIndex"], t.componentIndex) || Sl(s[i + "AxisName"], t.name))
      return n;
  }
}
function Sl(r, e) {
  return r === "all" || F(r) && ue(r, e) >= 0 || r === e;
}
function uR(r) {
  var e = Zu(r);
  if (e) {
    var t = e.axisPointerModel, i = e.axis.scale, n = t.option, s = t.get("status"), a = t.get("value");
    a != null && (a = i.parse(a));
    var o = eu(t);
    s == null && (n.status = o ? "show" : "hide");
    var l = i.getExtent().slice();
    l[0] > l[1] && l.reverse(), // Pick a value on axis when initializing.
    (a == null || a > l[1]) && (a = l[1]), a < l[0] && (a = l[0]), n.value = a, o && (n.status = e.axis.scale.isBlank() ? "hide" : "show");
  }
}
function Zu(r) {
  var e = (r.ecModel.getComponent("axisPointer") || {}).coordSysAxesInfo;
  return e && e.axesInfo[cs(r)];
}
function dR(r) {
  var e = Zu(r);
  return e && e.axisPointerModel;
}
function eu(r) {
  return !!r.get(["handle", "show"]);
}
function cs(r) {
  return r.type + "||" + r.id;
}
var Rl = {}, cR = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      var t = r !== null && r.apply(this, arguments) || this;
      return t.type = e.type, t;
    }
    return e.prototype.render = function(t, i, n, s) {
      this.axisPointerClass && uR(t), r.prototype.render.apply(this, arguments), this._doUpdateAxisPointerClass(t, n, !0);
    }, e.prototype.updateAxisPointer = function(t, i, n, s) {
      this._doUpdateAxisPointerClass(t, n, !1);
    }, e.prototype.remove = function(t, i) {
      var n = this._axisPointer;
      n && n.remove(i);
    }, e.prototype.dispose = function(t, i) {
      this._disposeAxisPointer(i), r.prototype.dispose.apply(this, arguments);
    }, e.prototype._doUpdateAxisPointerClass = function(t, i, n) {
      var s = e.getAxisPointerClass(this.axisPointerClass);
      if (s) {
        var a = dR(t);
        a ? (this._axisPointer || (this._axisPointer = new s())).render(t, a, i, n) : this._disposeAxisPointer(i);
      }
    }, e.prototype._disposeAxisPointer = function(t) {
      this._axisPointer && this._axisPointer.dispose(t), this._axisPointer = null;
    }, e.registerAxisPointerClass = function(t, i) {
      if (process.env.NODE_ENV !== "production" && Rl[t])
        throw new Error("axisPointer " + t + " exists");
      Rl[t] = i;
    }, e.getAxisPointerClass = function(t) {
      return t && Rl[t];
    }, e.type = "axis", e;
  }(ti)
), Yf = "\0_ec_interaction_mutex";
function Xf(r, e) {
  return !!fR(r)[e];
}
function fR(r) {
  return r[Yf] || (r[Yf] = {});
}
fr({
  type: "takeGlobalCursor",
  event: "globalCursorTaken",
  update: "update"
}, Le);
var pR = (
  /** @class */
  function(r) {
    De(e, r);
    function e(t) {
      var i = r.call(this) || this;
      i._zr = t;
      var n = K(i._mousedownHandler, i), s = K(i._mousemoveHandler, i), a = K(i._mouseupHandler, i), o = K(i._mousewheelHandler, i), l = K(i._pinchHandler, i);
      return i.enable = function(h, u) {
        this.disable(), this._opt = ge($(u) || {}, {
          zoomOnMouseWheel: !0,
          moveOnMouseMove: !0,
          // By default, wheel do not trigger move.
          moveOnMouseWheel: !1,
          preventDefaultMouseMove: !0
        }), h == null && (h = !0), (h === !0 || h === "move" || h === "pan") && (t.on("mousedown", n), t.on("mousemove", s), t.on("mouseup", a)), (h === !0 || h === "scale" || h === "zoom") && (t.on("mousewheel", o), t.on("pinch", l));
      }, i.disable = function() {
        t.off("mousedown", n), t.off("mousemove", s), t.off("mouseup", a), t.off("mousewheel", o), t.off("pinch", l);
      }, i;
    }
    return e.prototype.isDragging = function() {
      return this._dragging;
    }, e.prototype.isPinching = function() {
      return this._pinching;
    }, e.prototype.setPointerChecker = function(t) {
      this.pointerChecker = t;
    }, e.prototype.dispose = function() {
      this.disable();
    }, e.prototype._mousedownHandler = function(t) {
      if (!pd(t)) {
        for (var i = t.target; i; ) {
          if (i.draggable)
            return;
          i = i.__hostTarget || i.parent;
        }
        var n = t.offsetX, s = t.offsetY;
        this.pointerChecker && this.pointerChecker(t, n, s) && (this._x = n, this._y = s, this._dragging = !0);
      }
    }, e.prototype._mousemoveHandler = function(t) {
      if (!(!this._dragging || !fa("moveOnMouseMove", t, this._opt) || t.gestureEvent === "pinch" || Xf(this._zr, "globalPan"))) {
        var i = t.offsetX, n = t.offsetY, s = this._x, a = this._y, o = i - s, l = n - a;
        this._x = i, this._y = n, this._opt.preventDefaultMouseMove && Ja(t.event), Im(this, "pan", "moveOnMouseMove", t, {
          dx: o,
          dy: l,
          oldX: s,
          oldY: a,
          newX: i,
          newY: n,
          isAvailableBehavior: null
        });
      }
    }, e.prototype._mouseupHandler = function(t) {
      pd(t) || (this._dragging = !1);
    }, e.prototype._mousewheelHandler = function(t) {
      var i = fa("zoomOnMouseWheel", t, this._opt), n = fa("moveOnMouseWheel", t, this._opt), s = t.wheelDelta, a = Math.abs(s), o = t.offsetX, l = t.offsetY;
      if (!(s === 0 || !i && !n)) {
        if (i) {
          var h = a > 3 ? 1.4 : a > 1 ? 1.2 : 1.1, u = s > 0 ? h : 1 / h;
          Ml(this, "zoom", "zoomOnMouseWheel", t, {
            scale: u,
            originX: o,
            originY: l,
            isAvailableBehavior: null
          });
        }
        if (n) {
          var d = Math.abs(s), c = (s > 0 ? 1 : -1) * (d > 3 ? 0.4 : d > 1 ? 0.15 : 0.05);
          Ml(this, "scrollMove", "moveOnMouseWheel", t, {
            scrollDelta: c,
            originX: o,
            originY: l,
            isAvailableBehavior: null
          });
        }
      }
    }, e.prototype._pinchHandler = function(t) {
      if (!Xf(this._zr, "globalPan")) {
        var i = t.pinchScale > 1 ? 1.1 : 1 / 1.1;
        Ml(this, "zoom", null, t, {
          scale: i,
          originX: t.pinchX,
          originY: t.pinchY,
          isAvailableBehavior: null
        });
      }
    }, e;
  }(Mt)
);
function Ml(r, e, t, i, n) {
  r.pointerChecker && r.pointerChecker(i, n.originX, n.originY) && (Ja(i.event), Im(r, e, t, i, n));
}
function Im(r, e, t, i, n) {
  n.isAvailableBehavior = K(fa, null, t, i), r.trigger(e, n);
}
function fa(r, e, t) {
  var i = t[r];
  return !r || i && (!V(i) || e.event[i + "Key"]);
}
var Et = Te();
function gR(r) {
  var e = r.mainData, t = r.datas;
  t || (t = {
    main: e
  }, r.datasAttr = {
    main: "data"
  }), r.datas = r.mainData = null, zm(e, t, r), M(t, function(i) {
    M(e.TRANSFERABLE_METHODS, function(n) {
      i.wrapMethod(n, He(vR, r));
    });
  }), e.wrapMethod("cloneShallow", He(bR, r)), M(e.CHANGABLE_METHODS, function(i) {
    e.wrapMethod(i, He(mR, r));
  }), Y(t[e.dataType] === e);
}
function vR(r, e) {
  if (CR(this)) {
    var t = P({}, Et(this).datas);
    t[this.dataType] = e, zm(e, t, r);
  } else
    Ju(e, this.dataType, Et(this).mainData, r);
  return e;
}
function mR(r, e) {
  return r.struct && r.struct.update(), e;
}
function bR(r, e) {
  return M(Et(e).datas, function(t, i) {
    t !== e && Ju(t.cloneShallow(), i, e, r);
  }), e;
}
function yR(r) {
  var e = Et(this).mainData;
  return r == null || e == null ? e : Et(e).datas[r];
}
function wR() {
  var r = Et(this).mainData;
  return r == null ? [{
    data: r
  }] : J(me(Et(r).datas), function(e) {
    return {
      type: e,
      data: Et(r).datas[e]
    };
  });
}
function CR(r) {
  return Et(r).mainData === r;
}
function zm(r, e, t) {
  Et(r).datas = {}, M(e, function(i, n) {
    Ju(i, n, r, t);
  });
}
function Ju(r, e, t, i) {
  Et(t).datas[e] = r, Et(r).mainData = t, r.dataType = e, i.struct && (r[i.structAttr] = i.struct, i.struct[i.datasAttr[e]] = r), r.getLinkedData = yR, r.getLinkedDataAll = wR;
}
var _R = (
  /** @class */
  function() {
    function r(e, t) {
      this.depth = 0, this.height = 0, this.dataIndex = -1, this.children = [], this.viewChildren = [], this.isExpand = !1, this.name = e || "", this.hostTree = t;
    }
    return r.prototype.isRemoved = function() {
      return this.dataIndex < 0;
    }, r.prototype.eachNode = function(e, t, i) {
      q(e) && (i = t, t = e, e = null), e = e || {}, V(e) && (e = {
        order: e
      });
      var n = e.order || "preorder", s = this[e.attr || "children"], a;
      n === "preorder" && (a = t.call(i, this));
      for (var o = 0; !a && o < s.length; o++)
        s[o].eachNode(e, t, i);
      n === "postorder" && t.call(i, this);
    }, r.prototype.updateDepthAndHeight = function(e) {
      var t = 0;
      this.depth = e;
      for (var i = 0; i < this.children.length; i++) {
        var n = this.children[i];
        n.updateDepthAndHeight(e + 1), n.height > t && (t = n.height);
      }
      this.height = t + 1;
    }, r.prototype.getNodeById = function(e) {
      if (this.getId() === e)
        return this;
      for (var t = 0, i = this.children, n = i.length; t < n; t++) {
        var s = i[t].getNodeById(e);
        if (s)
          return s;
      }
    }, r.prototype.contains = function(e) {
      if (e === this)
        return !0;
      for (var t = 0, i = this.children, n = i.length; t < n; t++) {
        var s = i[t].contains(e);
        if (s)
          return s;
      }
    }, r.prototype.getAncestors = function(e) {
      for (var t = [], i = e ? this : this.parentNode; i; )
        t.push(i), i = i.parentNode;
      return t.reverse(), t;
    }, r.prototype.getAncestorsIndices = function() {
      for (var e = [], t = this; t; )
        e.push(t.dataIndex), t = t.parentNode;
      return e.reverse(), e;
    }, r.prototype.getDescendantIndices = function() {
      var e = [];
      return this.eachNode(function(t) {
        e.push(t.dataIndex);
      }), e;
    }, r.prototype.getValue = function(e) {
      var t = this.hostTree.data;
      return t.getStore().get(t.getDimensionIndex(e || "value"), this.dataIndex);
    }, r.prototype.setLayout = function(e, t) {
      this.dataIndex >= 0 && this.hostTree.data.setItemLayout(this.dataIndex, e, t);
    }, r.prototype.getLayout = function() {
      return this.hostTree.data.getItemLayout(this.dataIndex);
    }, r.prototype.getModel = function(e) {
      if (!(this.dataIndex < 0)) {
        var t = this.hostTree, i = t.data.getItemModel(this.dataIndex);
        return i.getModel(e);
      }
    }, r.prototype.getLevelModel = function() {
      return (this.hostTree.levelModels || [])[this.depth];
    }, r.prototype.setVisual = function(e, t) {
      this.dataIndex >= 0 && this.hostTree.data.setItemVisual(this.dataIndex, e, t);
    }, r.prototype.getVisual = function(e) {
      return this.hostTree.data.getItemVisual(this.dataIndex, e);
    }, r.prototype.getRawIndex = function() {
      return this.hostTree.data.getRawIndex(this.dataIndex);
    }, r.prototype.getId = function() {
      return this.hostTree.data.getId(this.dataIndex);
    }, r.prototype.getChildIndex = function() {
      if (this.parentNode) {
        for (var e = this.parentNode.children, t = 0; t < e.length; ++t)
          if (e[t] === this)
            return t;
        return -1;
      }
      return -1;
    }, r.prototype.isAncestorOf = function(e) {
      for (var t = e.parentNode; t; ) {
        if (t === this)
          return !0;
        t = t.parentNode;
      }
      return !1;
    }, r.prototype.isDescendantOf = function(e) {
      return e !== this && e.isAncestorOf(this);
    }, r;
  }()
), ER = (
  /** @class */
  function() {
    function r(e) {
      this.type = "tree", this._nodes = [], this.hostModel = e;
    }
    return r.prototype.eachNode = function(e, t, i) {
      this.root.eachNode(e, t, i);
    }, r.prototype.getNodeByDataIndex = function(e) {
      var t = this.data.getRawIndex(e);
      return this._nodes[t];
    }, r.prototype.getNodeById = function(e) {
      return this.root.getNodeById(e);
    }, r.prototype.update = function() {
      for (var e = this.data, t = this._nodes, i = 0, n = t.length; i < n; i++)
        t[i].dataIndex = -1;
      for (var i = 0, n = e.count(); i < n; i++)
        t[e.getRawIndex(i)].dataIndex = i;
    }, r.prototype.clearLayouts = function() {
      this.data.clearItemLayouts();
    }, r.createTree = function(e, t, i) {
      var n = new r(t), s = [], a = 1;
      o(e);
      function o(u, d) {
        var c = u.value;
        a = Math.max(a, F(c) ? c.length : 1), s.push(u);
        var f = new _R(at(u.name, ""), n);
        d ? TR(f, d) : n.root = f, n._nodes.push(f);
        var p = u.children;
        if (p)
          for (var m = 0; m < p.length; m++)
            o(p[m], f);
      }
      n.root.updateDepthAndHeight(0);
      var l = jS(s, {
        coordDimensions: ["value"],
        dimensionsCount: a
      }).dimensions, h = new US(l, t);
      return h.initData(s), i && i(h), gR({
        mainData: h,
        struct: n,
        structAttr: "tree"
      }), n.update(), n;
    }, r;
  }()
);
function TR(r, e) {
  var t = e.children;
  r.parentNode !== e && (t.push(r), r.parentNode = e);
}
function Qu(r, e, t) {
  if (r && ue(e, r.type) >= 0) {
    var i = t.getData().tree.root, n = r.targetNode;
    if (V(n) && (n = i.getNodeById(n)), n && i.contains(n))
      return {
        node: n
      };
    var s = r.targetNodeId;
    if (s != null && (n = i.getNodeById(s)))
      return {
        node: n
      };
  }
}
function Fm(r) {
  for (var e = []; r; )
    r = r.parentNode, r && e.push(r);
  return e.reverse();
}
function Hm(r, e) {
  var t = Fm(r);
  return ue(t, e) >= 0;
}
function Nm(r, e) {
  for (var t = []; r; ) {
    var i = r.dataIndex;
    t.push({
      name: r.name,
      dataIndex: i,
      value: e.getRawValue(i)
    }), r = r.parentNode;
  }
  return t.reverse(), t;
}
var $f = ["treemapZoomToNode", "treemapRender", "treemapMove"];
function xR(r) {
  for (var e = 0; e < $f.length; e++)
    r.registerAction({
      type: $f[e],
      update: "updateView"
    }, Le);
  r.registerAction({
    type: "treemapRootToNode",
    update: "updateView"
  }, function(t, i) {
    i.eachComponent({
      mainType: "series",
      subType: "treemap",
      query: t
    }, n);
    function n(s, a) {
      var o = ["treemapZoomToNode", "treemapRootToNode"], l = Qu(t, o, s);
      if (l) {
        var h = s.getViewRoot();
        h && (t.direction = Hm(h, l.node) ? "rollUp" : "drillDown"), s.resetViewRoot(l.node);
      }
    }
  });
}
function SR(r) {
  var e = r.getData(), t = e.tree, i = {};
  t.eachNode(function(n) {
    for (var s = n; s && s.depth > 1; )
      s = s.parentNode;
    var a = KT(r.ecModel, s.name || s.dataIndex + "", i);
    n.setVisual("decal", a);
  });
}
var RR = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      var t = r !== null && r.apply(this, arguments) || this;
      return t.type = e.type, t.preventUsingHoverLayer = !0, t;
    }
    return e.prototype.getInitialData = function(t, i) {
      var n = {
        name: t.name,
        children: t.data
      };
      Bm(n);
      var s = t.levels || [], a = this.designatedVisualItemStyle = {}, o = new pe({
        itemStyle: a
      }, this, i);
      s = t.levels = MR(s, i);
      var l = J(s || [], function(d) {
        return new pe(d, o, i);
      }, this), h = ER.createTree(n, this, u);
      function u(d) {
        d.wrapMethod("getItemModel", function(c, f) {
          var p = h.getNodeByDataIndex(f), m = p ? l[p.depth] : null;
          return c.parentModel = m || o, c;
        });
      }
      return h.data;
    }, e.prototype.optionUpdated = function() {
      this.resetViewRoot();
    }, e.prototype.formatTooltip = function(t, i, n) {
      var s = this.getData(), a = this.getRawValue(t), o = s.getName(t);
      return Jr("nameValue", {
        name: o,
        value: a
      });
    }, e.prototype.getDataParams = function(t) {
      var i = r.prototype.getDataParams.apply(this, arguments), n = this.getData().tree.getNodeByDataIndex(t);
      return i.treeAncestors = Nm(n, this), i.treePathInfo = i.treeAncestors, i;
    }, e.prototype.setLayoutInfo = function(t) {
      this.layoutInfo = this.layoutInfo || {}, P(this.layoutInfo, t);
    }, e.prototype.mapIdToIndex = function(t) {
      var i = this._idIndexMap;
      i || (i = this._idIndexMap = Z(), this._idIndexMapCount = 0);
      var n = i.get(t);
      return n == null && i.set(t, n = this._idIndexMapCount++), n;
    }, e.prototype.getViewRoot = function() {
      return this._viewRoot;
    }, e.prototype.resetViewRoot = function(t) {
      t ? this._viewRoot = t : t = this._viewRoot;
      var i = this.getRawData().tree.root;
      (!t || t !== i && !i.contains(t)) && (this._viewRoot = i);
    }, e.prototype.enableAriaDecal = function() {
      SR(this);
    }, e.type = "series.treemap", e.layoutMode = "box", e.defaultOption = {
      // Disable progressive rendering
      progressive: 0,
      // size: ['80%', '80%'],            // deprecated, compatible with ec2.
      left: "center",
      top: "middle",
      width: "80%",
      height: "80%",
      sort: !0,
      clipWindow: "origin",
      squareRatio: 0.5 * (1 + Math.sqrt(5)),
      leafDepth: null,
      drillDownIcon: "â–¶",
      // to align specialized icon. â–·â–¶â’ââ–¼âœš
      zoomToNodeRatio: 0.32 * 0.32,
      scaleLimit: null,
      roam: !0,
      nodeClick: "zoomToNode",
      animation: !0,
      animationDurationUpdate: 900,
      animationEasing: "quinticInOut",
      breadcrumb: {
        show: !0,
        height: 22,
        left: "center",
        top: "bottom",
        // right
        // bottom
        emptyItemWidth: 25,
        itemStyle: {
          color: "rgba(0,0,0,0.7)",
          textStyle: {
            color: "#fff"
          }
        },
        emphasis: {
          itemStyle: {
            color: "rgba(0,0,0,0.9)"
            // '#5793f3',
          }
        }
      },
      label: {
        show: !0,
        // Do not use textDistance, for ellipsis rect just the same as treemap node rect.
        distance: 0,
        padding: 5,
        position: "inside",
        // formatter: null,
        color: "#fff",
        overflow: "truncate"
        // align
        // verticalAlign
      },
      upperLabel: {
        show: !1,
        position: [0, "50%"],
        height: 20,
        // formatter: null,
        // color: '#fff',
        overflow: "truncate",
        // align: null,
        verticalAlign: "middle"
      },
      itemStyle: {
        color: null,
        colorAlpha: null,
        colorSaturation: null,
        borderWidth: 0,
        gapWidth: 0,
        borderColor: "#fff",
        borderColorSaturation: null
        // If specified, borderColor will be ineffective, and the
        // border color is evaluated by color of current node and
        // borderColorSaturation.
      },
      emphasis: {
        upperLabel: {
          show: !0,
          position: [0, "50%"],
          overflow: "truncate",
          verticalAlign: "middle"
        }
      },
      visualDimension: 0,
      visualMin: null,
      visualMax: null,
      color: [],
      // level[n].color (if necessary).
      // + Specify color list of each level. level[0].color would be global
      // color list if not specified. (see method `setDefault`).
      // + But set as a empty array to forbid fetch color from global palette
      // when using nodeModel.get('color'), otherwise nodes on deep level
      // will always has color palette set and are not able to inherit color
      // from parent node.
      // + TreemapSeries.color can not be set as 'none', otherwise effect
      // legend color fetching (see seriesColor.js).
      colorAlpha: null,
      colorSaturation: null,
      colorMappingBy: "index",
      visibleMin: 10,
      // be rendered. Only works when sort is 'asc' or 'desc'.
      childrenVisibleMin: null,
      // grandchildren will not show.
      // Why grandchildren? If not grandchildren but children,
      // some siblings show children and some not,
      // the appearance may be mess and not consistent,
      levels: []
      // Each item: {
      //     visibleMin, itemStyle, visualDimension, label
      // }
    }, e;
  }(Si)
);
function Bm(r) {
  var e = 0;
  M(r.children, function(i) {
    Bm(i);
    var n = i.value;
    F(n) && (n = n[0]), e += n;
  });
  var t = r.value;
  F(t) && (t = t[0]), (t == null || isNaN(t)) && (t = e), t < 0 && (t = 0), F(r.value) ? r.value[0] = t : r.value = t;
}
function MR(r, e) {
  var t = Me(e.get("color")), i = Me(e.get(["aria", "decal", "decals"]));
  if (t) {
    r = r || [];
    var n, s;
    M(r, function(o) {
      var l = new pe(o), h = l.get("color"), u = l.get("decal");
      (l.get(["itemStyle", "color"]) || h && h !== "none") && (n = !0), (l.get(["itemStyle", "decal"]) || u && u !== "none") && (s = !0);
    });
    var a = r[0] || (r[0] = {});
    return n || (a.color = t.slice()), !s && i && (a.decal = i.slice()), r;
  }
}
var DR = 8, qf = 8, Dl = 5, LR = (
  /** @class */
  function() {
    function r(e) {
      this.group = new lt(), e.add(this.group);
    }
    return r.prototype.render = function(e, t, i, n) {
      var s = e.getModel("breadcrumb"), a = this.group;
      if (a.removeAll(), !(!s.get("show") || !i)) {
        var o = s.getModel("itemStyle"), l = s.getModel("emphasis"), h = o.getModel("textStyle"), u = l.getModel(["itemStyle", "textStyle"]), d = {
          pos: {
            left: s.get("left"),
            right: s.get("right"),
            top: s.get("top"),
            bottom: s.get("bottom")
          },
          box: {
            width: t.getWidth(),
            height: t.getHeight()
          },
          emptyItemWidth: s.get("emptyItemWidth"),
          totalWidth: 0,
          renderList: []
        };
        this._prepare(i, d, h), this._renderContent(e, d, o, l, h, u, n), FT(a, d.pos, d.box);
      }
    }, r.prototype._prepare = function(e, t, i) {
      for (var n = e; n; n = n.parentNode) {
        var s = at(n.getModel().get("name"), ""), a = i.getTextRect(s), o = Math.max(a.width + DR * 2, t.emptyItemWidth);
        t.totalWidth += o + qf, t.renderList.push({
          node: n,
          text: s,
          width: o
        });
      }
    }, r.prototype._renderContent = function(e, t, i, n, s, a, o) {
      for (var l = 0, h = t.emptyItemWidth, u = e.get(["breadcrumb", "height"]), d = zT(t.pos, t.box), c = t.totalWidth, f = t.renderList, p = n.getModel("itemStyle").getItemStyle(), m = f.length - 1; m >= 0; m--) {
        var g = f[m], v = g.node, b = g.width, y = g.text;
        c > d.width && (c -= b - h, b = h, y = null);
        var w = new oo({
          shape: {
            points: kR(l, 0, b, u, m === f.length - 1, m === 0)
          },
          style: ge(i.getItemStyle(), {
            lineJoin: "bevel"
          }),
          textContent: new ht({
            style: ei(s, {
              text: y
            })
          }),
          textConfig: {
            position: "inside"
          },
          z2: ys * 1e4,
          onclick: He(o, v)
        });
        w.disableLabelAnimation = !0, w.getTextContent().ensureState("emphasis").style = ei(a, {
          text: y
        }), w.ensureState("emphasis").style = p, lE(w, n.get("focus"), n.get("blurScope"), n.get("disabled")), this.group.add(w), AR(w, e, v), l += b + qf;
      }
    }, r.prototype.remove = function() {
      this.group.removeAll();
    }, r;
  }()
);
function kR(r, e, t, i, n, s) {
  var a = [[n ? r : r - Dl, e], [r + t, e], [r + t, e + i], [n ? r : r - Dl, e + i]];
  return !s && a.splice(2, 0, [r + t + Dl, e + i / 2]), !n && a.push([r, e + i / 2]), a;
}
function AR(r, e, t) {
  ce(r).eventData = {
    componentType: "series",
    componentSubType: "treemap",
    componentIndex: e.componentIndex,
    seriesIndex: e.seriesIndex,
    seriesName: e.name,
    seriesType: "treemap",
    selfType: "breadcrumb",
    nodeData: {
      dataIndex: t && t.dataIndex,
      name: t && t.name
    },
    treePathInfo: t && Nm(t, e)
  };
}
var PR = (
  /** @class */
  function() {
    function r() {
      this._storage = [], this._elExistsMap = {};
    }
    return r.prototype.add = function(e, t, i, n, s) {
      return this._elExistsMap[e.id] ? !1 : (this._elExistsMap[e.id] = !0, this._storage.push({
        el: e,
        target: t,
        duration: i,
        delay: n,
        easing: s
      }), !0);
    }, r.prototype.finished = function(e) {
      return this._finishedCallback = e, this;
    }, r.prototype.start = function() {
      for (var e = this, t = this._storage.length, i = function() {
        t--, t <= 0 && (e._storage.length = 0, e._elExistsMap = {}, e._finishedCallback && e._finishedCallback());
      }, n = 0, s = this._storage.length; n < s; n++) {
        var a = this._storage[n];
        a.el.animateTo(a.target, {
          duration: a.duration,
          delay: a.delay,
          easing: a.easing,
          setToFinal: !0,
          done: i,
          aborted: i
        });
      }
      return this;
    }, r;
  }()
);
function OR() {
  return new PR();
}
var tu = lt, Kf = ot, Zf = 3, Jf = "label", Qf = "upperLabel", IR = ys * 10, zR = ys * 2, FR = ys * 3, $i = Kr([
  ["fill", "color"],
  // `borderColor` and `borderWidth` has been occupied,
  // so use `stroke` to indicate the stroke of the rect.
  ["stroke", "strokeColor"],
  ["lineWidth", "strokeWidth"],
  ["shadowBlur"],
  ["shadowOffsetX"],
  ["shadowOffsetY"],
  ["shadowColor"]
  // Option decal is in `DecalObject` but style.decal is in `PatternObject`.
  // So do not transfer decal directly.
]), ep = function(r) {
  var e = $i(r);
  return e.stroke = e.fill = e.lineWidth = null, e;
}, Ga = Te(), HR = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      var t = r !== null && r.apply(this, arguments) || this;
      return t.type = e.type, t._state = "ready", t._storage = Dn(), t;
    }
    return e.prototype.render = function(t, i, n, s) {
      var a = i.findComponents({
        mainType: "series",
        subType: "treemap",
        query: s
      });
      if (!(ue(a, t) < 0)) {
        this.seriesModel = t, this.api = n, this.ecModel = i;
        var o = ["treemapZoomToNode", "treemapRootToNode"], l = Qu(s, o, t), h = s && s.type, u = t.layoutInfo, d = !this._oldTree, c = this._storage, f = h === "treemapRootToNode" && l && c ? {
          rootNodeGroup: c.nodeGroup[l.node.getRawIndex()],
          direction: s.direction
        } : null, p = this._giveContainerGroup(u), m = t.get("animation"), g = this._doRender(p, t, f);
        m && !d && (!h || h === "treemapZoomToNode" || h === "treemapRootToNode") ? this._doAnimation(p, g, t, f) : g.renderFinally(), this._resetController(n), this._renderBreadcrumb(t, n, l);
      }
    }, e.prototype._giveContainerGroup = function(t) {
      var i = this._containerGroup;
      return i || (i = this._containerGroup = new tu(), this._initEvents(i), this.group.add(i)), i.x = t.x, i.y = t.y, i;
    }, e.prototype._doRender = function(t, i, n) {
      var s = i.getData().tree, a = this._oldTree, o = Dn(), l = Dn(), h = this._storage, u = [];
      function d(b, y, w, _) {
        return NR(i, l, h, n, o, u, b, y, w, _);
      }
      m(s.root ? [s.root] : [], a && a.root ? [a.root] : [], t, s === a || !a, 0);
      var c = g(h);
      if (this._oldTree = s, this._storage = l, this._controllerHost) {
        var f = this.seriesModel.layoutInfo, p = s.root.getLayout();
        p.width === f.width && p.height === f.height && (this._controllerHost.zoom = 1);
      }
      return {
        lastsForAnimation: o,
        willDeleteEls: c,
        renderFinally: v
      };
      function m(b, y, w, _, E) {
        _ ? (y = b, M(b, function(C, S) {
          !C.isRemoved() && T(S, S);
        })) : new Mm(y, b, x, x).add(T).update(T).remove(He(T, null)).execute();
        function x(C) {
          return C.getId();
        }
        function T(C, S) {
          var R = C != null ? b[C] : null, D = S != null ? y[S] : null, k = d(R, D, w, E);
          k && m(R && R.viewChildren || [], D && D.viewChildren || [], k, _, E + 1);
        }
      }
      function g(b) {
        var y = Dn();
        return b && M(b, function(w, _) {
          var E = y[_];
          M(w, function(x) {
            x && (E.push(x), Ga(x).willDelete = !0);
          });
        }), y;
      }
      function v() {
        M(c, function(b) {
          M(b, function(y) {
            y.parent && y.parent.remove(y);
          });
        }), M(u, function(b) {
          b.invisible = !0, b.dirty();
        });
      }
    }, e.prototype._doAnimation = function(t, i, n, s) {
      var a = n.get("animationDurationUpdate"), o = n.get("animationEasing"), l = (q(a) ? 0 : a) || 0, h = (q(o) ? null : o) || "cubicOut", u = OR();
      M(i.willDeleteEls, function(d, c) {
        M(d, function(f, p) {
          if (!f.invisible) {
            var m = f.parent, g, v = Ga(m);
            if (s && s.direction === "drillDown")
              g = m === s.rootNodeGroup ? {
                shape: {
                  x: 0,
                  y: 0,
                  width: v.nodeWidth,
                  height: v.nodeHeight
                },
                style: {
                  opacity: 0
                }
              } : {
                style: {
                  opacity: 0
                }
              };
            else {
              var b = 0, y = 0;
              v.willDelete || (b = v.nodeWidth / 2, y = v.nodeHeight / 2), g = c === "nodeGroup" ? {
                x: b,
                y,
                style: {
                  opacity: 0
                }
              } : {
                shape: {
                  x: b,
                  y,
                  width: 0,
                  height: 0
                },
                style: {
                  opacity: 0
                }
              };
            }
            g && u.add(f, g, l, 0, h);
          }
        });
      }), M(this._storage, function(d, c) {
        M(d, function(f, p) {
          var m = i.lastsForAnimation[c][p], g = {};
          m && (f instanceof lt ? m.oldX != null && (g.x = f.x, g.y = f.y, f.x = m.oldX, f.y = m.oldY) : (m.oldShape && (g.shape = P({}, f.shape), f.setShape(m.oldShape)), m.fadein ? (f.setStyle("opacity", 0), g.style = {
            opacity: 1
          }) : f.style.opacity !== 1 && (g.style = {
            opacity: 1
          })), u.add(f, g, l, 0, h));
        });
      }, this), this._state = "animating", u.finished(K(function() {
        this._state = "ready", i.renderFinally();
      }, this)).start();
    }, e.prototype._resetController = function(t) {
      var i = this._controller, n = this._controllerHost;
      n || (this._controllerHost = {
        target: this.group
      }, n = this._controllerHost), i || (i = this._controller = new pR(t.getZr()), i.enable(this.seriesModel.get("roam")), n.zoomLimit = this.seriesModel.get("scaleLimit"), n.zoom = this.seriesModel.get("zoom"), i.on("pan", K(this._onPan, this)), i.on("zoom", K(this._onZoom, this)));
      var s = new re(0, 0, t.getWidth(), t.getHeight());
      i.setPointerChecker(function(a, o, l) {
        return s.contain(o, l);
      });
    }, e.prototype._clearController = function() {
      var t = this._controller;
      this._controllerHost = null, t && (t.dispose(), t = null);
    }, e.prototype._onPan = function(t) {
      if (this._state !== "animating" && (Math.abs(t.dx) > Zf || Math.abs(t.dy) > Zf)) {
        var i = this.seriesModel.getData().tree.root;
        if (!i)
          return;
        var n = i.getLayout();
        if (!n)
          return;
        this.api.dispatchAction({
          type: "treemapMove",
          from: this.uid,
          seriesId: this.seriesModel.id,
          rootRect: {
            x: n.x + t.dx,
            y: n.y + t.dy,
            width: n.width,
            height: n.height
          }
        });
      }
    }, e.prototype._onZoom = function(t) {
      var i = t.originX, n = t.originY, s = t.scale;
      if (this._state !== "animating") {
        var a = this.seriesModel.getData().tree.root;
        if (!a)
          return;
        var o = a.getLayout();
        if (!o)
          return;
        var l = new re(o.x, o.y, o.width, o.height), h = null, u = this._controllerHost;
        h = u.zoomLimit;
        var d = u.zoom = u.zoom || 1;
        if (d *= s, h) {
          var c = h.min || 0, f = h.max || 1 / 0;
          d = Math.max(Math.min(f, d), c);
        }
        var p = d / u.zoom;
        u.zoom = d;
        var m = this.seriesModel.layoutInfo;
        i -= m.x, n -= m.y;
        var g = sr();
        ns(g, g, [-i, -n]), og(g, g, [p, p]), ns(g, g, [i, n]), l.applyTransform(g), this.api.dispatchAction({
          type: "treemapRender",
          from: this.uid,
          seriesId: this.seriesModel.id,
          rootRect: {
            x: l.x,
            y: l.y,
            width: l.width,
            height: l.height
          }
        });
      }
    }, e.prototype._initEvents = function(t) {
      var i = this;
      t.on("click", function(n) {
        if (i._state === "ready") {
          var s = i.seriesModel.get("nodeClick", !0);
          if (s) {
            var a = i.findTarget(n.offsetX, n.offsetY);
            if (a) {
              var o = a.node;
              if (o.getLayout().isLeafRoot)
                i._rootToNode(a);
              else if (s === "zoomToNode")
                i._zoomToNode(a);
              else if (s === "link") {
                var l = o.hostTree.data.getItemModel(o.dataIndex), h = l.get("link", !0), u = l.get("target", !0) || "blank";
                h && Nh(h, u);
              }
            }
          }
        }
      }, this);
    }, e.prototype._renderBreadcrumb = function(t, i, n) {
      var s = this;
      n || (n = t.get("leafDepth", !0) != null ? {
        node: t.getViewRoot()
      } : this.findTarget(i.getWidth() / 2, i.getHeight() / 2), n || (n = {
        node: t.getData().tree.root
      })), (this._breadcrumb || (this._breadcrumb = new LR(this.group))).render(t, i, n.node, function(a) {
        s._state !== "animating" && (Hm(t.getViewRoot(), a) ? s._rootToNode({
          node: a
        }) : s._zoomToNode({
          node: a
        }));
      });
    }, e.prototype.remove = function() {
      this._clearController(), this._containerGroup && this._containerGroup.removeAll(), this._storage = Dn(), this._state = "ready", this._breadcrumb && this._breadcrumb.remove();
    }, e.prototype.dispose = function() {
      this._clearController();
    }, e.prototype._zoomToNode = function(t) {
      this.api.dispatchAction({
        type: "treemapZoomToNode",
        from: this.uid,
        seriesId: this.seriesModel.id,
        targetNode: t.node
      });
    }, e.prototype._rootToNode = function(t) {
      this.api.dispatchAction({
        type: "treemapRootToNode",
        from: this.uid,
        seriesId: this.seriesModel.id,
        targetNode: t.node
      });
    }, e.prototype.findTarget = function(t, i) {
      var n, s = this.seriesModel.getViewRoot();
      return s.eachNode({
        attr: "viewChildren",
        order: "preorder"
      }, function(a) {
        var o = this._storage.background[a.getRawIndex()];
        if (o) {
          var l = o.transformCoordToLocal(t, i), h = o.shape;
          if (h.x <= l[0] && l[0] <= h.x + h.width && h.y <= l[1] && l[1] <= h.y + h.height)
            n = {
              node: a,
              offsetX: l[0],
              offsetY: l[1]
            };
          else
            return !1;
        }
      }, this), n;
    }, e.type = "treemap", e;
  }(Ei)
);
function Dn() {
  return {
    nodeGroup: [],
    background: [],
    content: []
  };
}
function NR(r, e, t, i, n, s, a, o, l, h) {
  if (!a)
    return;
  var u = a.getLayout(), d = r.getData(), c = a.getModel();
  if (d.setItemGraphicEl(a.dataIndex, null), !u || !u.isInView)
    return;
  var f = u.width, p = u.height, m = u.borderWidth, g = u.invisible, v = a.getRawIndex(), b = o && o.getRawIndex(), y = a.viewChildren, w = u.upperHeight, _ = y && y.length, E = c.getModel("itemStyle"), x = c.getModel(["emphasis", "itemStyle"]), T = c.getModel(["blur", "itemStyle"]), C = c.getModel(["select", "itemStyle"]), S = E.get("borderRadius") || 0, R = ut("nodeGroup", tu);
  if (!R)
    return;
  if (l.add(R), R.x = u.x || 0, R.y = u.y || 0, R.markRedraw(), Ga(R).nodeWidth = f, Ga(R).nodeHeight = p, u.isAboveViewRoot)
    return R;
  var D = ut("background", Kf, h, zR);
  D && ve(R, D, _ && u.upperLabelHeight);
  var k = c.getModel("emphasis"), L = k.get("focus"), O = k.get("blurScope"), I = k.get("disabled"), G = L === "ancestor" ? a.getAncestorsIndices() : L === "descendant" ? a.getDescendantIndices() : L;
  if (_)
    xi(R) && zr(R, !1), D && (zr(D, !I), d.setItemGraphicEl(a.dataIndex, D), Oh(D, G, O));
  else {
    var ee = ut("content", Kf, h, FR);
    ee && be(R, ee), D.disableMorphing = !0, D && xi(D) && zr(D, !1), zr(R, !I), d.setItemGraphicEl(a.dataIndex, R);
    var te = c.getShallow("cursor");
    te && ee.attr("cursor", te), Oh(R, G, O);
  }
  return R;
  function ve(Q, N, X) {
    var z = ce(N);
    if (z.dataIndex = a.dataIndex, z.seriesIndex = r.seriesIndex, N.setShape({
      x: 0,
      y: 0,
      width: f,
      height: p,
      r: S
    }), g)
      ie(N);
    else {
      N.invisible = !1;
      var H = a.getVisual("style"), ye = H.stroke, le = ep(E);
      le.fill = ye;
      var we = $i(x);
      we.fill = x.get("borderColor");
      var Ue = $i(T);
      Ue.fill = T.get("borderColor");
      var Ut = $i(C);
      if (Ut.fill = C.get("borderColor"), X) {
        var gr = f - 2 * m;
        xe(
          // PENDING: convert ZRColor to ColorString for text.
          N,
          ye,
          H.opacity,
          {
            x: m,
            y: 0,
            width: gr,
            height: w
          }
        );
      } else
        N.removeTextContent();
      N.setStyle(le), N.ensureState("emphasis").style = we, N.ensureState("blur").style = Ue, N.ensureState("select").style = Ut, Dh(N);
    }
    Q.add(N);
  }
  function be(Q, N) {
    var X = ce(N);
    X.dataIndex = a.dataIndex, X.seriesIndex = r.seriesIndex;
    var z = Math.max(f - 2 * m, 0), H = Math.max(p - 2 * m, 0);
    if (N.culling = !0, N.setShape({
      x: m,
      y: m,
      width: z,
      height: H,
      r: S
    }), g)
      ie(N);
    else {
      N.invisible = !1;
      var ye = a.getVisual("style"), le = ye.fill, we = ep(E);
      we.fill = le, we.decal = ye.decal;
      var Ue = $i(x), Ut = $i(T), gr = $i(C);
      xe(N, le, ye.opacity, null), N.setStyle(we), N.ensureState("emphasis").style = Ue, N.ensureState("blur").style = Ut, N.ensureState("select").style = gr, Dh(N);
    }
    Q.add(N);
  }
  function ie(Q) {
    !Q.invisible && s.push(Q);
  }
  function xe(Q, N, X, z) {
    var H = c.getModel(z ? Qf : Jf), ye = at(c.get("name"), null), le = H.getShallow("show");
    aT(Q, oT(c, z ? Qf : Jf), {
      defaultText: le ? ye : null,
      inheritColor: N,
      defaultOpacity: X,
      labelFetcher: r,
      labelDataIndex: a.dataIndex
    });
    var we = Q.getTextContent();
    if (we) {
      var Ue = we.style, Ut = uu(Ue.padding || 0);
      z && (Q.setTextConfig({
        layoutRect: z
      }), we.disableLabelLayout = !0), we.beforeUpdate = function() {
        var rd = Math.max((z ? z.width : Q.shape.width) - Ut[1] - Ut[3], 0), nd = Math.max((z ? z.height : Q.shape.height) - Ut[0] - Ut[2], 0);
        (Ue.width !== rd || Ue.height !== nd) && we.setStyle({
          width: rd,
          height: nd
        });
      }, Ue.truncateMinChar = 2, Ue.lineOverflow = "truncate", Be(Ue, z, u);
      var gr = we.getState("emphasis");
      Be(gr ? gr.style : null, z, u);
    }
  }
  function Be(Q, N, X) {
    var z = Q ? Q.text : null;
    if (!N && X.isLeafRoot && z != null) {
      var H = r.get("drillDownIcon", !0);
      Q.text = H ? H + " " + z : z;
    }
  }
  function ut(Q, N, X, z) {
    var H = b != null && t[Q][b], ye = n[Q];
    return H ? (t[Q][b] = null, Wt(ye, H)) : g || (H = new N(), H instanceof nn && (H.z2 = BR(X, z)), Gt(ye, H)), e[Q][v] = H;
  }
  function Wt(Q, N) {
    var X = Q[v] = {};
    N instanceof tu ? (X.oldX = N.x, X.oldY = N.y) : X.oldShape = P({}, N.shape);
  }
  function Gt(Q, N) {
    var X = Q[v] = {}, z = a.parentNode, H = N instanceof lt;
    if (z && (!i || i.direction === "drillDown")) {
      var ye = 0, le = 0, we = n.background[z.getRawIndex()];
      !i && we && we.oldShape && (ye = we.oldShape.width, le = we.oldShape.height), H ? (X.oldX = 0, X.oldY = le) : X.oldShape = {
        x: ye,
        y: le,
        width: 0,
        height: 0
      };
    }
    X.fadein = !H;
  }
}
function BR(r, e) {
  return r * IR + e;
}
var fs = M, VR = B, Ua = -1, ed = (
  /** @class */
  function() {
    function r(e) {
      var t = e.mappingMethod, i = e.type, n = this.option = $(e);
      this.type = i, this.mappingMethod = t, this._normalizeData = UR[t];
      var s = r.visualHandlers[i];
      this.applyVisual = s.applyVisual, this.getColorMapper = s.getColorMapper, this._normalizedToVisual = s._normalizedToVisual[t], t === "piecewise" ? (Ll(n), WR(n)) : t === "category" ? n.categories ? GR(n) : Ll(n, !0) : (Y(t !== "linear" || n.dataExtent), Ll(n));
    }
    return r.prototype.mapValueToVisual = function(e) {
      var t = this._normalizeData(e);
      return this._normalizedToVisual(t, e);
    }, r.prototype.getNormalizer = function() {
      return K(this._normalizeData, this);
    }, r.listVisualTypes = function() {
      return me(r.visualHandlers);
    }, r.isValidType = function(e) {
      return r.visualHandlers.hasOwnProperty(e);
    }, r.eachVisual = function(e, t, i) {
      B(e) ? M(e, t, i) : t.call(i, e);
    }, r.mapVisual = function(e, t, i) {
      var n, s = F(e) ? [] : B(e) ? {} : (n = !0, null);
      return r.eachVisual(e, function(a, o) {
        var l = t.call(i, a, o);
        n ? s = l : s[o] = l;
      }), s;
    }, r.retrieveVisuals = function(e) {
      var t = {}, i;
      return e && fs(r.visualHandlers, function(n, s) {
        e.hasOwnProperty(s) && (t[s] = e[s], i = !0);
      }), i ? t : null;
    }, r.prepareVisualTypes = function(e) {
      if (F(e))
        e = e.slice();
      else if (VR(e)) {
        var t = [];
        fs(e, function(i, n) {
          t.push(n);
        }), e = t;
      } else
        return [];
      return e.sort(function(i, n) {
        return n === "color" && i !== "color" && i.indexOf("color") === 0 ? 1 : -1;
      }), e;
    }, r.dependsOn = function(e, t) {
      return t === "color" ? !!(e && e.indexOf(t) === 0) : e === t;
    }, r.findPieceIndex = function(e, t, i) {
      for (var n, s = 1 / 0, a = 0, o = t.length; a < o; a++) {
        var l = t[a].value;
        if (l != null) {
          if (l === e || V(l) && l === e + "")
            return a;
          i && c(l, a);
        }
      }
      for (var a = 0, o = t.length; a < o; a++) {
        var h = t[a], u = h.interval, d = h.close;
        if (u) {
          if (u[0] === -1 / 0) {
            if (Zs(d[1], e, u[1]))
              return a;
          } else if (u[1] === 1 / 0) {
            if (Zs(d[0], u[0], e))
              return a;
          } else if (Zs(d[0], u[0], e) && Zs(d[1], e, u[1]))
            return a;
          i && c(u[0], a), i && c(u[1], a);
        }
      }
      if (i)
        return e === 1 / 0 ? t.length - 1 : e === -1 / 0 ? 0 : n;
      function c(f, p) {
        var m = Math.abs(f - e);
        m < s && (s = m, n = p);
      }
    }, r.visualHandlers = {
      color: {
        applyVisual: Ln("color"),
        getColorMapper: function() {
          var e = this.option;
          return K(e.mappingMethod === "category" ? function(t, i) {
            return !i && (t = this._normalizeData(t)), Bn.call(this, t);
          } : function(t, i, n) {
            var s = !!n;
            return !i && (t = this._normalizeData(t)), n = Lo(t, e.parsedVisual, n), s ? n : or(n, "rgba");
          }, this);
        },
        _normalizedToVisual: {
          linear: function(e) {
            return or(Lo(e, this.option.parsedVisual), "rgba");
          },
          category: Bn,
          piecewise: function(e, t) {
            var i = ru.call(this, t);
            return i == null && (i = or(Lo(e, this.option.parsedVisual), "rgba")), i;
          },
          fixed: qi
        }
      },
      colorHue: Ks(function(e, t) {
        return Un(e, t);
      }),
      colorSaturation: Ks(function(e, t) {
        return Un(e, null, t);
      }),
      colorLightness: Ks(function(e, t) {
        return Un(e, null, null, t);
      }),
      colorAlpha: Ks(function(e, t) {
        return Cg(e, t);
      }),
      decal: {
        applyVisual: Ln("decal"),
        _normalizedToVisual: {
          linear: null,
          category: Bn,
          piecewise: null,
          fixed: null
        }
      },
      opacity: {
        applyVisual: Ln("opacity"),
        _normalizedToVisual: iu([0, 1])
      },
      liftZ: {
        applyVisual: Ln("liftZ"),
        _normalizedToVisual: {
          linear: qi,
          category: qi,
          piecewise: qi,
          fixed: qi
        }
      },
      symbol: {
        applyVisual: function(e, t, i) {
          var n = this.mapValueToVisual(e);
          i("symbol", n);
        },
        _normalizedToVisual: {
          linear: tp,
          category: Bn,
          piecewise: function(e, t) {
            var i = ru.call(this, t);
            return i == null && (i = tp.call(this, e)), i;
          },
          fixed: qi
        }
      },
      symbolSize: {
        applyVisual: Ln("symbolSize"),
        _normalizedToVisual: iu([0, 1])
      }
    }, r;
  }()
);
function WR(r) {
  var e = r.pieceList;
  r.hasSpecialVisual = !1, M(e, function(t, i) {
    t.originIndex = i, t.visual != null && (r.hasSpecialVisual = !0);
  });
}
function GR(r) {
  var e = r.categories, t = r.categoryMap = {}, i = r.visual;
  if (fs(e, function(a, o) {
    t[a] = o;
  }), !F(i)) {
    var n = [];
    B(i) ? fs(i, function(a, o) {
      var l = t[o];
      n[l ?? Ua] = a;
    }) : n[Ua] = i, i = Vm(r, n);
  }
  for (var s = e.length - 1; s >= 0; s--)
    i[s] == null && (delete t[e[s]], e.pop());
}
function Ll(r, e) {
  var t = r.visual, i = [];
  B(t) ? fs(t, function(s) {
    i.push(s);
  }) : t != null && i.push(t);
  var n = {
    color: 1,
    symbol: 1
  };
  !e && i.length === 1 && !n.hasOwnProperty(r.type) && (i[1] = i[0]), Vm(r, i);
}
function Ks(r) {
  return {
    applyVisual: function(e, t, i) {
      var n = this.mapValueToVisual(e);
      i("color", r(t("color"), n));
    },
    _normalizedToVisual: iu([0, 1])
  };
}
function tp(r) {
  var e = this.option.visual;
  return e[Math.round(os(r, [0, 1], [0, e.length - 1]))] || {};
}
function Ln(r) {
  return function(e, t, i) {
    i(r, this.mapValueToVisual(e));
  };
}
function Bn(r) {
  var e = this.option.visual;
  return e[this.option.loop && r !== Ua ? r % e.length : r];
}
function qi() {
  return this.option.visual[0];
}
function iu(r) {
  return {
    linear: function(e) {
      return os(e, r, this.option.visual);
    },
    category: Bn,
    piecewise: function(e, t) {
      var i = ru.call(this, t);
      return i == null && (i = os(e, r, this.option.visual)), i;
    },
    fixed: qi
  };
}
function ru(r) {
  var e = this.option, t = e.pieceList;
  if (e.hasSpecialVisual) {
    var i = ed.findPieceIndex(r, t), n = t[i];
    if (n && n.visual)
      return n.visual[this.type];
  }
}
function Vm(r, e) {
  return r.visual = e, r.type === "color" && (r.parsedVisual = J(e, function(t) {
    var i = Zt(t);
    return !i && process.env.NODE_ENV !== "production" && wt("'" + t + "' is an illegal color, fallback to '#000000'", !0), i || [0, 0, 0, 1];
  })), e;
}
var UR = {
  linear: function(r) {
    return os(r, this.option.dataExtent, [0, 1]);
  },
  piecewise: function(r) {
    var e = this.option.pieceList, t = ed.findPieceIndex(r, e, !0);
    if (t != null)
      return os(t, [0, e.length - 1], [0, 1]);
  },
  category: function(r) {
    var e = this.option.categories ? this.option.categoryMap[r] : r;
    return e ?? Ua;
  },
  fixed: Le
};
function Zs(r, e, t) {
  return r ? e <= t : e < t;
}
var jR = "itemStyle", Wm = Te();
const YR = {
  seriesType: "treemap",
  reset: function(r) {
    var e = r.getData().tree, t = e.root;
    t.isRemoved() || Gm(
      t,
      // Visual should calculate from tree root but not view root.
      {},
      r.getViewRoot().getAncestors(),
      r
    );
  }
};
function Gm(r, e, t, i) {
  var n = r.getModel(), s = r.getLayout(), a = r.hostTree.data;
  if (!(!s || s.invisible || !s.isInView)) {
    var o = n.getModel(jR), l = XR(o, e, i), h = a.ensureUniqueItemVisual(r.dataIndex, "style"), u = o.get("borderColor"), d = o.get("borderColorSaturation"), c;
    d != null && (c = ip(l), u = $R(d, c)), h.stroke = u;
    var f = r.viewChildren;
    if (!f || !f.length)
      c = ip(l), h.fill = c;
    else {
      var p = qR(r, n, s, o, l, f);
      M(f, function(m, g) {
        if (m.depth >= t.length || m === t[m.depth]) {
          var v = KR(n, l, m, g, p, i);
          Gm(m, v, t, i);
        }
      });
    }
  }
}
function XR(r, e, t) {
  var i = P({}, e), n = t.designatedVisualItemStyle;
  return M(["color", "colorAlpha", "colorSaturation"], function(s) {
    n[s] = e[s];
    var a = r.get(s);
    n[s] = null, a != null && (i[s] = a);
  }), i;
}
function ip(r) {
  var e = kl(r, "color");
  if (e) {
    var t = kl(r, "colorAlpha"), i = kl(r, "colorSaturation");
    return i && (e = Un(e, null, null, i)), t && (e = Cg(e, t)), e;
  }
}
function $R(r, e) {
  return e != null ? Un(e, null, null, r) : null;
}
function kl(r, e) {
  var t = r[e];
  if (t != null && t !== "none")
    return t;
}
function qR(r, e, t, i, n, s) {
  if (!(!s || !s.length)) {
    var a = Al(e, "color") || n.color != null && n.color !== "none" && (Al(e, "colorAlpha") || Al(e, "colorSaturation"));
    if (a) {
      var o = e.get("visualMin"), l = e.get("visualMax"), h = t.dataExtent.slice();
      o != null && o < h[0] && (h[0] = o), l != null && l > h[1] && (h[1] = l);
      var u = e.get("colorMappingBy"), d = {
        type: a.name,
        dataExtent: h,
        visual: a.range
      };
      d.type === "color" && (u === "index" || u === "id") ? (d.mappingMethod = "category", d.loop = !0) : d.mappingMethod = "linear";
      var c = new ed(d);
      return Wm(c).drColorMappingBy = u, c;
    }
  }
}
function Al(r, e) {
  var t = r.get(e);
  return F(t) && t.length ? {
    name: e,
    range: t
  } : null;
}
function KR(r, e, t, i, n, s) {
  var a = P({}, e);
  if (n) {
    var o = n.type, l = o === "color" && Wm(n).drColorMappingBy, h = l === "index" ? i : l === "id" ? s.mapIdToIndex(t.getId()) : t.getValue(r.get("visualDimension"));
    a[o] = n.mapValueToVisual(h);
  }
  return a;
}
var ps = Math.max, ja = Math.min, rp = Xr, td = M, Um = ["itemStyle", "borderWidth"], ZR = ["itemStyle", "gapWidth"], JR = ["upperLabel", "show"], QR = ["upperLabel", "height"];
const eM = {
  seriesType: "treemap",
  reset: function(r, e, t, i) {
    var n = t.getWidth(), s = t.getHeight(), a = r.option, o = fo(r.getBoxLayoutParams(), {
      width: t.getWidth(),
      height: t.getHeight()
    }), l = a.size || [], h = Fe(rp(o.width, l[0]), n), u = Fe(rp(o.height, l[1]), s), d = i && i.type, c = ["treemapZoomToNode", "treemapRootToNode"], f = Qu(i, c, r), p = d === "treemapRender" || d === "treemapMove" ? i.rootRect : null, m = r.getViewRoot(), g = Fm(m);
    if (d !== "treemapMove") {
      var v = d === "treemapZoomToNode" ? aM(r, f, m, h, u) : p ? [p.width, p.height] : [h, u], b = a.sort;
      b && b !== "asc" && b !== "desc" && (b = "desc");
      var y = {
        squareRatio: a.squareRatio,
        sort: b,
        leafDepth: a.leafDepth
      };
      m.hostTree.clearLayouts();
      var w = {
        x: 0,
        y: 0,
        width: v[0],
        height: v[1],
        area: v[0] * v[1]
      };
      m.setLayout(w), jm(m, y, !1, 0), w = m.getLayout(), td(g, function(E, x) {
        var T = (g[x + 1] || m).getValue();
        E.setLayout(P({
          dataExtent: [T, T],
          borderWidth: 0,
          upperHeight: 0
        }, w));
      });
    }
    var _ = r.getData().tree.root;
    _.setLayout(oM(o, p, f), !0), r.setLayoutInfo(o), Ym(
      _,
      // Transform to base element coordinate system.
      new re(-o.x, -o.y, n, s),
      g,
      m,
      0
    );
  }
};
function jm(r, e, t, i) {
  var n, s;
  if (!r.isRemoved()) {
    var a = r.getLayout();
    n = a.width, s = a.height;
    var o = r.getModel(), l = o.get(Um), h = o.get(ZR) / 2, u = Xm(o), d = Math.max(l, u), c = l - h, f = d - h;
    r.setLayout({
      borderWidth: l,
      upperHeight: d,
      upperLabelHeight: u
    }, !0), n = ps(n - 2 * c, 0), s = ps(s - c - f, 0);
    var p = n * s, m = tM(r, o, p, e, t, i);
    if (m.length) {
      var g = {
        x: c,
        y: f,
        width: n,
        height: s
      }, v = ja(n, s), b = 1 / 0, y = [];
      y.area = 0;
      for (var w = 0, _ = m.length; w < _; ) {
        var E = m[w];
        y.push(E), y.area += E.getLayout().area;
        var x = sM(y, v, e.squareRatio);
        x <= b ? (w++, b = x) : (y.area -= y.pop().getLayout().area, np(y, v, g, h, !1), v = ja(g.width, g.height), y.length = y.area = 0, b = 1 / 0);
      }
      if (y.length && np(y, v, g, h, !0), !t) {
        var T = o.get("childrenVisibleMin");
        T != null && p < T && (t = !0);
      }
      for (var w = 0, _ = m.length; w < _; w++)
        jm(m[w], e, t, i + 1);
    }
  }
}
function tM(r, e, t, i, n, s) {
  var a = r.children || [], o = i.sort;
  o !== "asc" && o !== "desc" && (o = null);
  var l = i.leafDepth != null && i.leafDepth <= s;
  if (n && !l)
    return r.viewChildren = [];
  a = bt(a, function(f) {
    return !f.isRemoved();
  }), rM(a, o);
  var h = nM(e, a, o);
  if (h.sum === 0)
    return r.viewChildren = [];
  if (h.sum = iM(e, t, h.sum, o, a), h.sum === 0)
    return r.viewChildren = [];
  for (var u = 0, d = a.length; u < d; u++) {
    var c = a[u].getValue() / h.sum * t;
    a[u].setLayout({
      area: c
    });
  }
  return l && (a.length && r.setLayout({
    isLeafRoot: !0
  }, !0), a.length = 0), r.viewChildren = a, r.setLayout({
    dataExtent: h.dataExtent
  }, !0), a;
}
function iM(r, e, t, i, n) {
  if (!i)
    return t;
  for (var s = r.get("visibleMin"), a = n.length, o = a, l = a - 1; l >= 0; l--) {
    var h = n[i === "asc" ? a - l - 1 : l].getValue();
    h / t * e < s && (o = l, t -= h);
  }
  return i === "asc" ? n.splice(0, a - o) : n.splice(o, a - o), t;
}
function rM(r, e) {
  return e && r.sort(function(t, i) {
    var n = e === "asc" ? t.getValue() - i.getValue() : i.getValue() - t.getValue();
    return n === 0 ? e === "asc" ? t.dataIndex - i.dataIndex : i.dataIndex - t.dataIndex : n;
  }), r;
}
function nM(r, e, t) {
  for (var i = 0, n = 0, s = e.length; n < s; n++)
    i += e[n].getValue();
  var a = r.get("visualDimension"), o;
  return !e || !e.length ? o = [NaN, NaN] : a === "value" && t ? (o = [e[e.length - 1].getValue(), e[0].getValue()], t === "asc" && o.reverse()) : (o = [1 / 0, -1 / 0], td(e, function(l) {
    var h = l.getValue(a);
    h < o[0] && (o[0] = h), h > o[1] && (o[1] = h);
  })), {
    sum: i,
    dataExtent: o
  };
}
function sM(r, e, t) {
  for (var i = 0, n = 1 / 0, s = 0, a = void 0, o = r.length; s < o; s++)
    a = r[s].getLayout().area, a && (a < n && (n = a), a > i && (i = a));
  var l = r.area * r.area, h = e * e * t;
  return l ? ps(h * i / l, l / (h * n)) : 1 / 0;
}
function np(r, e, t, i, n) {
  var s = e === t.width ? 0 : 1, a = 1 - s, o = ["x", "y"], l = ["width", "height"], h = t[o[s]], u = e ? r.area / e : 0;
  (n || u > t[l[a]]) && (u = t[l[a]]);
  for (var d = 0, c = r.length; d < c; d++) {
    var f = r[d], p = {}, m = u ? f.getLayout().area / u : 0, g = p[l[a]] = ps(u - 2 * i, 0), v = t[o[s]] + t[l[s]] - h, b = d === c - 1 || v < m ? v : m, y = p[l[s]] = ps(b - 2 * i, 0);
    p[o[a]] = t[o[a]] + ja(i, g / 2), p[o[s]] = h + ja(i, y / 2), h += b, f.setLayout(p, !0);
  }
  t[o[a]] += u, t[l[a]] -= u;
}
function aM(r, e, t, i, n) {
  var s = (e || {}).node, a = [i, n];
  if (!s || s === t)
    return a;
  for (var o, l = i * n, h = l * r.option.zoomToNodeRatio; o = s.parentNode; ) {
    for (var u = 0, d = o.children, c = 0, f = d.length; c < f; c++)
      u += d[c].getValue();
    var p = s.getValue();
    if (p === 0)
      return a;
    h *= u / p;
    var m = o.getModel(), g = m.get(Um), v = Math.max(g, Xm(m));
    h += 4 * g * g + (3 * g + v) * Math.pow(h, 0.5), h > Vd && (h = Vd), s = o;
  }
  h < l && (h = l);
  var b = Math.pow(h / l, 0.5);
  return [i * b, n * b];
}
function oM(r, e, t) {
  if (e)
    return {
      x: e.x,
      y: e.y
    };
  var i = {
    x: 0,
    y: 0
  };
  if (!t)
    return i;
  var n = t.node, s = n.getLayout();
  if (!s)
    return i;
  for (var a = [s.width / 2, s.height / 2], o = n; o; ) {
    var l = o.getLayout();
    a[0] += l.x, a[1] += l.y, o = o.parentNode;
  }
  return {
    x: r.width / 2 - a[0],
    y: r.height / 2 - a[1]
  };
}
function Ym(r, e, t, i, n) {
  var s = r.getLayout(), a = t[n], o = a && a === r;
  if (!(a && !o || n === t.length && r !== i)) {
    r.setLayout({
      // isInView means: viewRoot sub tree + viewAbovePath
      isInView: !0,
      // invisible only means: outside view clip so that the node can not
      // see but still layout for animation preparation but not render.
      invisible: !o && !e.intersect(s),
      isAboveViewRoot: o
    }, !0);
    var l = new re(e.x - s.x, e.y - s.y, e.width, e.height);
    td(r.viewChildren || [], function(h) {
      Ym(h, l, t, i, n + 1);
    });
  }
}
function Xm(r) {
  return r.get(JR) ? r.get(QR) : 0;
}
function lM(r) {
  r.registerSeriesModel(RR), r.registerChartView(HR), r.registerVisual(YR), r.registerLayout(eM), xR(r);
}
function sp(r, e, t) {
  var i = Qr.createCanvas(), n = e.getWidth(), s = e.getHeight(), a = i.style;
  return a && (a.position = "absolute", a.left = "0", a.top = "0", a.width = n + "px", a.height = s + "px", i.setAttribute("data-zr-dom-id", r)), i.width = n * t, i.height = s * t, i;
}
var Pl = function(r) {
  oe(e, r);
  function e(t, i, n) {
    var s = r.call(this) || this;
    s.motionBlur = !1, s.lastFrameAlpha = 0.7, s.dpr = 1, s.virtual = !1, s.config = {}, s.incremental = !1, s.zlevel = 0, s.maxRepaintRectCount = 5, s.__dirty = !0, s.__firstTimePaint = !0, s.__used = !1, s.__drawIndex = 0, s.__startIndex = 0, s.__endIndex = 0, s.__prevStartIndex = null, s.__prevEndIndex = null;
    var a;
    n = n || Ea, typeof t == "string" ? a = sp(t, i, n) : B(t) && (a = t, t = a.id), s.id = t, s.dom = a;
    var o = a.style;
    return o && (sg(a), a.onselectstart = function() {
      return !1;
    }, o.padding = "0", o.margin = "0", o.borderWidth = "0"), s.painter = i, s.dpr = n, s;
  }
  return e.prototype.getElementCount = function() {
    return this.__endIndex - this.__startIndex;
  }, e.prototype.afterBrush = function() {
    this.__prevStartIndex = this.__startIndex, this.__prevEndIndex = this.__endIndex;
  }, e.prototype.initContext = function() {
    this.ctx = this.dom.getContext("2d"), this.ctx.dpr = this.dpr;
  }, e.prototype.setUnpainted = function() {
    this.__firstTimePaint = !0;
  }, e.prototype.createBackBuffer = function() {
    var t = this.dpr;
    this.domBack = sp("back-" + this.id, this.painter, t), this.ctxBack = this.domBack.getContext("2d"), t !== 1 && this.ctxBack.scale(t, t);
  }, e.prototype.createRepaintRects = function(t, i, n, s) {
    if (this.__firstTimePaint)
      return this.__firstTimePaint = !1, null;
    var a = [], o = this.maxRepaintRectCount, l = !1, h = new re(0, 0, 0, 0);
    function u(b) {
      if (!(!b.isFinite() || b.isZero()))
        if (a.length === 0) {
          var y = new re(0, 0, 0, 0);
          y.copy(b), a.push(y);
        } else {
          for (var w = !1, _ = 1 / 0, E = 0, x = 0; x < a.length; ++x) {
            var T = a[x];
            if (T.intersect(b)) {
              var C = new re(0, 0, 0, 0);
              C.copy(T), C.union(b), a[x] = C, w = !0;
              break;
            } else if (l) {
              h.copy(b), h.union(T);
              var S = b.width * b.height, R = T.width * T.height, D = h.width * h.height, k = D - S - R;
              k < _ && (_ = k, E = x);
            }
          }
          if (l && (a[E].union(b), w = !0), !w) {
            var y = new re(0, 0, 0, 0);
            y.copy(b), a.push(y);
          }
          l || (l = a.length >= o);
        }
    }
    for (var d = this.__startIndex; d < this.__endIndex; ++d) {
      var c = t[d];
      if (c) {
        var f = c.shouldBePainted(n, s, !0, !0), p = c.__isRendered && (c.__dirty & nt || !f) ? c.getPrevPaintRect() : null;
        p && u(p);
        var m = f && (c.__dirty & nt || !c.__isRendered) ? c.getPaintRect() : null;
        m && u(m);
      }
    }
    for (var d = this.__prevStartIndex; d < this.__prevEndIndex; ++d) {
      var c = i[d], f = c && c.shouldBePainted(n, s, !0, !0);
      if (c && (!f || !c.__zr) && c.__isRendered) {
        var p = c.getPrevPaintRect();
        p && u(p);
      }
    }
    var g;
    do {
      g = !1;
      for (var d = 0; d < a.length; ) {
        if (a[d].isZero()) {
          a.splice(d, 1);
          continue;
        }
        for (var v = d + 1; v < a.length; )
          a[d].intersect(a[v]) ? (g = !0, a[d].union(a[v]), a.splice(v, 1)) : v++;
        d++;
      }
    } while (g);
    return this._paintRects = a, a;
  }, e.prototype.debugGetPaintRects = function() {
    return (this._paintRects || []).slice();
  }, e.prototype.resize = function(t, i) {
    var n = this.dpr, s = this.dom, a = s.style, o = this.domBack;
    a && (a.width = t + "px", a.height = i + "px"), s.width = t * n, s.height = i * n, o && (o.width = t * n, o.height = i * n, n !== 1 && this.ctxBack.scale(n, n));
  }, e.prototype.clear = function(t, i, n) {
    var s = this.dom, a = this.ctx, o = s.width, l = s.height;
    i = i || this.clearColor;
    var h = this.motionBlur && !t, u = this.lastFrameAlpha, d = this.dpr, c = this;
    h && (this.domBack || this.createBackBuffer(), this.ctxBack.globalCompositeOperation = "copy", this.ctxBack.drawImage(s, 0, 0, o / d, l / d));
    var f = this.domBack;
    function p(m, g, v, b) {
      if (a.clearRect(m, g, v, b), i && i !== "transparent") {
        var y = void 0;
        if (Ka(i)) {
          var w = i.global || i.__width === v && i.__height === b;
          y = w && i.__canvasGradient || qh(a, i, {
            x: 0,
            y: 0,
            width: v,
            height: b
          }), i.__canvasGradient = y, i.__width = v, i.__height = b;
        } else s0(i) && (i.scaleX = i.scaleX || d, i.scaleY = i.scaleY || d, y = Kh(a, i, {
          dirty: function() {
            c.setUnpainted(), c.painter.refresh();
          }
        }));
        a.save(), a.fillStyle = y || i, a.fillRect(m, g, v, b), a.restore();
      }
      h && (a.save(), a.globalAlpha = u, a.drawImage(f, m, g, v, b), a.restore());
    }
    !n || h ? p(0, 0, o, l) : n.length && M(n, function(m) {
      p(m.x * d, m.y * d, m.width * d, m.height * d);
    });
  }, e;
}(Mt), ap = 1e5, Xi = 314159, Js = 0.01, hM = 1e-3;
function uM(r) {
  return r ? r.__builtin__ ? !0 : !(typeof r.resize != "function" || typeof r.refresh != "function") : !1;
}
function dM(r, e) {
  var t = document.createElement("div");
  return t.style.cssText = [
    "position:relative",
    "width:" + r + "px",
    "height:" + e + "px",
    "padding:0",
    "margin:0",
    "border-width:0"
  ].join(";") + ";", t;
}
var cM = function() {
  function r(e, t, i, n) {
    this.type = "canvas", this._zlevelList = [], this._prevDisplayList = [], this._layers = {}, this._layerConfig = {}, this._needsManuallyCompositing = !1, this.type = "canvas";
    var s = !e.nodeName || e.nodeName.toUpperCase() === "CANVAS";
    this._opts = i = P({}, i || {}), this.dpr = i.devicePixelRatio || Ea, this._singleCanvas = s, this.root = e;
    var a = e.style;
    a && (sg(e), e.innerHTML = ""), this.storage = t;
    var o = this._zlevelList;
    this._prevDisplayList = [];
    var l = this._layers;
    if (s) {
      var u = e, d = u.width, c = u.height;
      i.width != null && (d = i.width), i.height != null && (c = i.height), this.dpr = i.devicePixelRatio || 1, u.width = d * this.dpr, u.height = c * this.dpr, this._width = d, this._height = c;
      var f = new Pl(u, this, this.dpr);
      f.__builtin__ = !0, f.initContext(), l[Xi] = f, f.zlevel = Xi, o.push(Xi), this._domRoot = e;
    } else {
      this._width = Ys(e, 0, i), this._height = Ys(e, 1, i);
      var h = this._domRoot = dM(this._width, this._height);
      e.appendChild(h);
    }
  }
  return r.prototype.getType = function() {
    return "canvas";
  }, r.prototype.isSingleCanvas = function() {
    return this._singleCanvas;
  }, r.prototype.getViewportRoot = function() {
    return this._domRoot;
  }, r.prototype.getViewportRootOffset = function() {
    var e = this.getViewportRoot();
    if (e)
      return {
        offsetLeft: e.offsetLeft || 0,
        offsetTop: e.offsetTop || 0
      };
  }, r.prototype.refresh = function(e) {
    var t = this.storage.getDisplayList(!0), i = this._prevDisplayList, n = this._zlevelList;
    this._redrawId = Math.random(), this._paintList(t, i, e, this._redrawId);
    for (var s = 0; s < n.length; s++) {
      var a = n[s], o = this._layers[a];
      if (!o.__builtin__ && o.refresh) {
        var l = s === 0 ? this._backgroundColor : null;
        o.refresh(l);
      }
    }
    return this._opts.useDirtyRect && (this._prevDisplayList = t.slice()), this;
  }, r.prototype.refreshHover = function() {
    this._paintHoverList(this.storage.getDisplayList(!1));
  }, r.prototype._paintHoverList = function(e) {
    var t = e.length, i = this._hoverlayer;
    if (i && i.clear(), !!t) {
      for (var n = {
        inHover: !0,
        viewWidth: this._width,
        viewHeight: this._height
      }, s, a = 0; a < t; a++) {
        var o = e[a];
        o.__inHover && (i || (i = this._hoverlayer = this.getLayer(ap)), s || (s = i.ctx, s.save()), ir(s, o, n, a === t - 1));
      }
      s && s.restore();
    }
  }, r.prototype.getHoverLayer = function() {
    return this.getLayer(ap);
  }, r.prototype.paintOne = function(e, t) {
    hm(e, t);
  }, r.prototype._paintList = function(e, t, i, n) {
    if (this._redrawId === n) {
      i = i || !1, this._updateLayerStatus(e);
      var s = this._doPaintList(e, t, i), a = s.finished, o = s.needsRefreshHover;
      if (this._needsManuallyCompositing && this._compositeManually(), o && this._paintHoverList(e), a)
        this.eachLayer(function(h) {
          h.afterBrush && h.afterBrush();
        });
      else {
        var l = this;
        ma(function() {
          l._paintList(e, t, i, n);
        });
      }
    }
  }, r.prototype._compositeManually = function() {
    var e = this.getLayer(Xi).ctx, t = this._domRoot.width, i = this._domRoot.height;
    e.clearRect(0, 0, t, i), this.eachBuiltinLayer(function(n) {
      n.virtual && e.drawImage(n.dom, 0, 0, t, i);
    });
  }, r.prototype._doPaintList = function(e, t, i) {
    for (var n = this, s = [], a = this._opts.useDirtyRect, o = 0; o < this._zlevelList.length; o++) {
      var l = this._zlevelList[o], h = this._layers[l];
      h.__builtin__ && h !== this._hoverlayer && (h.__dirty || i) && s.push(h);
    }
    for (var u = !0, d = !1, c = function(m) {
      var g = s[m], v = g.ctx, b = a && g.createRepaintRects(e, t, f._width, f._height), y = i ? g.__startIndex : g.__drawIndex, w = !i && g.incremental && Date.now, _ = w && Date.now(), E = g.zlevel === f._zlevelList[0] ? f._backgroundColor : null;
      if (g.__startIndex === g.__endIndex)
        g.clear(!1, E, b);
      else if (y === g.__startIndex) {
        var x = e[y];
        (!x.incremental || !x.notClear || i) && g.clear(!1, E, b);
      }
      y === -1 && (console.error("For some unknown reason. drawIndex is -1"), y = g.__startIndex);
      var T, C = function(k) {
        var L = {
          inHover: !1,
          allClipped: !1,
          prevEl: null,
          viewWidth: n._width,
          viewHeight: n._height
        };
        for (T = y; T < g.__endIndex; T++) {
          var O = e[T];
          if (O.__inHover && (d = !0), n._doPaintEl(O, g, a, k, L, T === g.__endIndex - 1), w) {
            var I = Date.now() - _;
            if (I > 15)
              break;
          }
        }
        L.prevElClipPaths && v.restore();
      };
      if (b)
        if (b.length === 0)
          T = g.__endIndex;
        else
          for (var S = f.dpr, R = 0; R < b.length; ++R) {
            var D = b[R];
            v.save(), v.beginPath(), v.rect(D.x * S, D.y * S, D.width * S, D.height * S), v.clip(), C(D), v.restore();
          }
      else
        v.save(), C(), v.restore();
      g.__drawIndex = T, g.__drawIndex < g.__endIndex && (u = !1);
    }, f = this, p = 0; p < s.length; p++)
      c(p);
    return W.wxa && M(this._layers, function(m) {
      m && m.ctx && m.ctx.draw && m.ctx.draw();
    }), {
      finished: u,
      needsRefreshHover: d
    };
  }, r.prototype._doPaintEl = function(e, t, i, n, s, a) {
    var o = t.ctx;
    if (i) {
      var l = e.getPaintRect();
      (!n || l && l.intersect(n)) && (ir(o, e, s, a), e.setPrevPaintRect(l));
    } else
      ir(o, e, s, a);
  }, r.prototype.getLayer = function(e, t) {
    this._singleCanvas && !this._needsManuallyCompositing && (e = Xi);
    var i = this._layers[e];
    return i || (i = new Pl("zr_" + e, this, this.dpr), i.zlevel = e, i.__builtin__ = !0, this._layerConfig[e] ? Ee(i, this._layerConfig[e], !0) : this._layerConfig[e - Js] && Ee(i, this._layerConfig[e - Js], !0), t && (i.virtual = t), this.insertLayer(e, i), i.initContext()), i;
  }, r.prototype.insertLayer = function(e, t) {
    var i = this._layers, n = this._zlevelList, s = n.length, a = this._domRoot, o = null, l = -1;
    if (i[e]) {
      process.env.NODE_ENV !== "production" && nr("ZLevel " + e + " has been used already");
      return;
    }
    if (!uM(t)) {
      process.env.NODE_ENV !== "production" && nr("Layer of zlevel " + e + " is not valid");
      return;
    }
    if (s > 0 && e > n[0]) {
      for (l = 0; l < s - 1 && !(n[l] < e && n[l + 1] > e); l++)
        ;
      o = i[n[l]];
    }
    if (n.splice(l + 1, 0, e), i[e] = t, !t.virtual)
      if (o) {
        var h = o.dom;
        h.nextSibling ? a.insertBefore(t.dom, h.nextSibling) : a.appendChild(t.dom);
      } else
        a.firstChild ? a.insertBefore(t.dom, a.firstChild) : a.appendChild(t.dom);
    t.painter || (t.painter = this);
  }, r.prototype.eachLayer = function(e, t) {
    for (var i = this._zlevelList, n = 0; n < i.length; n++) {
      var s = i[n];
      e.call(t, this._layers[s], s);
    }
  }, r.prototype.eachBuiltinLayer = function(e, t) {
    for (var i = this._zlevelList, n = 0; n < i.length; n++) {
      var s = i[n], a = this._layers[s];
      a.__builtin__ && e.call(t, a, s);
    }
  }, r.prototype.eachOtherLayer = function(e, t) {
    for (var i = this._zlevelList, n = 0; n < i.length; n++) {
      var s = i[n], a = this._layers[s];
      a.__builtin__ || e.call(t, a, s);
    }
  }, r.prototype.getLayers = function() {
    return this._layers;
  }, r.prototype._updateLayerStatus = function(e) {
    this.eachBuiltinLayer(function(d, c) {
      d.__dirty = d.__used = !1;
    });
    function t(d) {
      s && (s.__endIndex !== d && (s.__dirty = !0), s.__endIndex = d);
    }
    if (this._singleCanvas)
      for (var i = 1; i < e.length; i++) {
        var n = e[i];
        if (n.zlevel !== e[i - 1].zlevel || n.incremental) {
          this._needsManuallyCompositing = !0;
          break;
        }
      }
    var s = null, a = 0, o, l;
    for (l = 0; l < e.length; l++) {
      var n = e[l], h = n.zlevel, u = void 0;
      o !== h && (o = h, a = 0), n.incremental ? (u = this.getLayer(h + hM, this._needsManuallyCompositing), u.incremental = !0, a = 1) : u = this.getLayer(h + (a > 0 ? Js : 0), this._needsManuallyCompositing), u.__builtin__ || nr("ZLevel " + h + " has been used by unkown layer " + u.id), u !== s && (u.__used = !0, u.__startIndex !== l && (u.__dirty = !0), u.__startIndex = l, u.incremental ? u.__drawIndex = -1 : u.__drawIndex = l, t(l), s = u), n.__dirty & nt && !n.__inHover && (u.__dirty = !0, u.incremental && u.__drawIndex < 0 && (u.__drawIndex = l));
    }
    t(l), this.eachBuiltinLayer(function(d, c) {
      !d.__used && d.getElementCount() > 0 && (d.__dirty = !0, d.__startIndex = d.__endIndex = d.__drawIndex = 0), d.__dirty && d.__drawIndex < 0 && (d.__drawIndex = d.__startIndex);
    });
  }, r.prototype.clear = function() {
    return this.eachBuiltinLayer(this._clearLayer), this;
  }, r.prototype._clearLayer = function(e) {
    e.clear();
  }, r.prototype.setBackgroundColor = function(e) {
    this._backgroundColor = e, M(this._layers, function(t) {
      t.setUnpainted();
    });
  }, r.prototype.configLayer = function(e, t) {
    if (t) {
      var i = this._layerConfig;
      i[e] ? Ee(i[e], t, !0) : i[e] = t;
      for (var n = 0; n < this._zlevelList.length; n++) {
        var s = this._zlevelList[n];
        if (s === e || s === e + Js) {
          var a = this._layers[s];
          Ee(a, i[e], !0);
        }
      }
    }
  }, r.prototype.delLayer = function(e) {
    var t = this._layers, i = this._zlevelList, n = t[e];
    n && (n.dom.parentNode.removeChild(n.dom), delete t[e], i.splice(ue(i, e), 1));
  }, r.prototype.resize = function(e, t) {
    if (this._domRoot.style) {
      var i = this._domRoot;
      i.style.display = "none";
      var n = this._opts, s = this.root;
      if (e != null && (n.width = e), t != null && (n.height = t), e = Ys(s, 0, n), t = Ys(s, 1, n), i.style.display = "", this._width !== e || t !== this._height) {
        i.style.width = e + "px", i.style.height = t + "px";
        for (var a in this._layers)
          this._layers.hasOwnProperty(a) && this._layers[a].resize(e, t);
        this.refresh(!0);
      }
      this._width = e, this._height = t;
    } else {
      if (e == null || t == null)
        return;
      this._width = e, this._height = t, this.getLayer(Xi).resize(e, t);
    }
    return this;
  }, r.prototype.clearLayer = function(e) {
    var t = this._layers[e];
    t && t.clear();
  }, r.prototype.dispose = function() {
    this.root.innerHTML = "", this.root = this.storage = this._domRoot = this._layers = null;
  }, r.prototype.getRenderedCanvas = function(e) {
    if (e = e || {}, this._singleCanvas && !this._compositeManually)
      return this._layers[Xi].dom;
    var t = new Pl("image", this, e.pixelRatio || this.dpr);
    t.initContext(), t.clear(!1, e.backgroundColor || this._backgroundColor);
    var i = t.ctx;
    if (e.pixelRatio <= this.dpr) {
      this.refresh();
      var n = t.dom.width, s = t.dom.height;
      this.eachLayer(function(d) {
        d.__builtin__ ? i.drawImage(d.dom, 0, 0, n, s) : d.renderToCanvas && (i.save(), d.renderToCanvas(i), i.restore());
      });
    } else
      for (var a = {
        inHover: !1,
        viewWidth: this._width,
        viewHeight: this._height
      }, o = this.storage.getDisplayList(!0), l = 0, h = o.length; l < h; l++) {
        var u = o[l];
        ir(i, u, a, l === h - 1);
      }
    return t.dom;
  }, r.prototype.getWidth = function() {
    return this._width;
  }, r.prototype.getHeight = function() {
    return this._height;
  }, r;
}();
function fM(r) {
  r.registerPainter("canvas", cM);
}
var Ki = Te(), op = $, Ol = K, pM = (
  /** @class */
  function() {
    function r() {
      this._dragging = !1, this.animationThreshold = 15;
    }
    return r.prototype.render = function(e, t, i, n) {
      var s = t.get("value"), a = t.get("status");
      if (this._axisModel = e, this._axisPointerModel = t, this._api = i, !(!n && this._lastValue === s && this._lastStatus === a)) {
        this._lastValue = s, this._lastStatus = a;
        var o = this._group, l = this._handle;
        if (!a || a === "hide") {
          o && o.hide(), l && l.hide();
          return;
        }
        o && o.show(), l && l.show();
        var h = {};
        this.makeElOption(h, s, e, t, i);
        var u = h.graphicKey;
        u !== this._lastGraphicKey && this.clear(i), this._lastGraphicKey = u;
        var d = this._moveAnimation = this.determineAnimation(e, t);
        if (!o)
          o = this._group = new lt(), this.createPointerEl(o, h, e, t), this.createLabelEl(o, h, e, t), i.getZr().add(o);
        else {
          var c = He(lp, t, d);
          this.updatePointerEl(o, h, c), this.updateLabelEl(o, h, c, t);
        }
        up(o, t, !0), this._renderHandle(s);
      }
    }, r.prototype.remove = function(e) {
      this.clear(e);
    }, r.prototype.dispose = function(e) {
      this.clear(e);
    }, r.prototype.determineAnimation = function(e, t) {
      var i = t.get("animation"), n = e.axis, s = n.type === "category", a = t.get("snap");
      if (!a && !s)
        return !1;
      if (i === "auto" || i == null) {
        var o = this.animationThreshold;
        if (s && n.getBandWidth() > o)
          return !0;
        if (a) {
          var l = Zu(e).seriesDataCount, h = n.getExtent();
          return Math.abs(h[0] - h[1]) / l > o;
        }
        return !1;
      }
      return i === !0;
    }, r.prototype.makeElOption = function(e, t, i, n, s) {
    }, r.prototype.createPointerEl = function(e, t, i, n) {
      var s = t.pointer;
      if (s) {
        var a = Ki(e).pointerEl = new nT[s.type](op(t.pointer));
        e.add(a);
      }
    }, r.prototype.createLabelEl = function(e, t, i, n) {
      if (t.label) {
        var s = Ki(e).labelEl = new ht(op(t.label));
        e.add(s), hp(s, n);
      }
    }, r.prototype.updatePointerEl = function(e, t, i) {
      var n = Ki(e).pointerEl;
      n && t.pointer && (n.setStyle(t.pointer.style), i(n, {
        shape: t.pointer.shape
      }));
    }, r.prototype.updateLabelEl = function(e, t, i, n) {
      var s = Ki(e).labelEl;
      s && (s.setStyle(t.label.style), i(s, {
        // Consider text length change in vertical axis, animation should
        // be used on shape, otherwise the effect will be weird.
        // TODOTODO
        // shape: elOption.label.shape,
        x: t.label.x,
        y: t.label.y
      }), hp(s, n));
    }, r.prototype._renderHandle = function(e) {
      if (!(this._dragging || !this.updateHandleTransform)) {
        var t = this._axisPointerModel, i = this._api.getZr(), n = this._handle, s = t.getModel("handle"), a = t.get("status");
        if (!s.get("show") || !a || a === "hide") {
          n && i.remove(n), this._handle = null;
          return;
        }
        var o;
        this._handle || (o = !0, n = this._handle = pv(s.get("icon"), {
          cursor: "move",
          draggable: !0,
          onmousemove: function(h) {
            Ja(h.event);
          },
          onmousedown: Ol(this._onHandleDragMove, this, 0, 0),
          drift: Ol(this._onHandleDragMove, this),
          ondragend: Ol(this._onHandleDragEnd, this)
        }), i.add(n)), up(n, t, !1), n.setStyle(s.getItemStyle(null, ["color", "borderColor", "borderWidth", "opacity", "shadowColor", "shadowBlur", "shadowOffsetX", "shadowOffsetY"]));
        var l = s.get("size");
        F(l) || (l = [l, l]), n.scaleX = l[0] / 2, n.scaleY = l[1] / 2, Zv(this, "_doDispatchAxisPointer", s.get("throttle") || 0, "fixRate"), this._moveHandleToValue(e, o);
      }
    }, r.prototype._moveHandleToValue = function(e, t) {
      lp(this._axisPointerModel, !t && this._moveAnimation, this._handle, Il(this.getHandleTransform(e, this._axisModel, this._axisPointerModel)));
    }, r.prototype._onHandleDragMove = function(e, t) {
      var i = this._handle;
      if (i) {
        this._dragging = !0;
        var n = this.updateHandleTransform(Il(i), [e, t], this._axisModel, this._axisPointerModel);
        this._payloadInfo = n, i.stopAnimation(), i.attr(Il(n)), Ki(i).lastProp = null, this._doDispatchAxisPointer();
      }
    }, r.prototype._doDispatchAxisPointer = function() {
      var e = this._handle;
      if (e) {
        var t = this._payloadInfo, i = this._axisModel;
        this._api.dispatchAction({
          type: "updateAxisPointer",
          x: t.cursorPoint[0],
          y: t.cursorPoint[1],
          tooltipOption: t.tooltipOption,
          axesInfo: [{
            axisDim: i.axis.dim,
            axisIndex: i.componentIndex
          }]
        });
      }
    }, r.prototype._onHandleDragEnd = function() {
      this._dragging = !1;
      var e = this._handle;
      if (e) {
        var t = this._axisPointerModel.get("value");
        this._moveHandleToValue(t), this._api.dispatchAction({
          type: "hideTip"
        });
      }
    }, r.prototype.clear = function(e) {
      this._lastValue = null, this._lastStatus = null;
      var t = e.getZr(), i = this._group, n = this._handle;
      t && i && (this._lastGraphicKey = null, i && t.remove(i), n && t.remove(n), this._group = null, this._handle = null, this._payloadInfo = null), Yh(this, "_doDispatchAxisPointer");
    }, r.prototype.doClear = function() {
    }, r.prototype.buildLabel = function(e, t, i) {
      return i = i || 0, {
        x: e[i],
        y: e[1 - i],
        width: t[i],
        height: t[1 - i]
      };
    }, r;
  }()
);
function lp(r, e, t, i) {
  $m(Ki(t).lastProp, i) || (Ki(t).lastProp = i, e ? Au(t, i, r) : (t.stopAnimation(), t.attr(i)));
}
function $m(r, e) {
  if (B(r) && B(e)) {
    var t = !0;
    return M(e, function(i, n) {
      t = t && $m(r[n], i);
    }), !!t;
  } else
    return r === e;
}
function hp(r, e) {
  r[e.get(["label", "show"]) ? "show" : "hide"]();
}
function Il(r) {
  return {
    x: r.x || 0,
    y: r.y || 0,
    rotation: r.rotation || 0
  };
}
function up(r, e, t) {
  var i = e.get("z"), n = e.get("zlevel");
  r && r.traverse(function(s) {
    s.type !== "group" && (i != null && (s.z = i), n != null && (s.zlevel = n), s.silent = t);
  });
}
function gM(r) {
  var e = r.get("type"), t = r.getModel(e + "Style"), i;
  return e === "line" ? (i = t.getLineStyle(), i.fill = null) : e === "shadow" && (i = t.getAreaStyle(), i.stroke = null), i;
}
function vM(r, e, t, i, n) {
  var s = t.get("value"), a = qm(s, e.axis, e.ecModel, t.get("seriesDataIndices"), {
    precision: t.get(["label", "precision"]),
    formatter: t.get(["label", "formatter"])
  }), o = t.getModel("label"), l = co(o.get("padding") || 0), h = o.getFont(), u = xg(a, h), d = n.position, c = u.width + l[1] + l[3], f = u.height + l[0] + l[2], p = n.align;
  p === "right" && (d[0] -= c), p === "center" && (d[0] -= c / 2);
  var m = n.verticalAlign;
  m === "bottom" && (d[1] -= f), m === "middle" && (d[1] -= f / 2), mM(d, c, f, i);
  var g = o.get("backgroundColor");
  (!g || g === "auto") && (g = e.get(["axisLine", "lineStyle", "color"])), r.label = {
    // shape: {x: 0, y: 0, width: width, height: height, r: labelModel.get('borderRadius')},
    x: d[0],
    y: d[1],
    style: ei(o, {
      text: a,
      font: h,
      fill: o.getTextColor(),
      padding: l,
      backgroundColor: g
    }),
    // Label should be over axisPointer.
    z2: 10
  };
}
function mM(r, e, t, i) {
  var n = i.getWidth(), s = i.getHeight();
  r[0] = Math.min(r[0] + e, n) - e, r[1] = Math.min(r[1] + t, s) - t, r[0] = Math.max(r[0], 0), r[1] = Math.max(r[1], 0);
}
function qm(r, e, t, i, n) {
  r = e.scale.parse(r);
  var s = e.scale.getLabel({
    value: r
  }, {
    // If `precision` is set, width can be fixed (like '12.00500'), which
    // helps to debounce when when moving label.
    precision: n.precision
  }), a = n.formatter;
  if (a) {
    var o = {
      value: Pm(e, {
        value: r
      }),
      axisDimension: e.dim,
      axisIndex: e.index,
      seriesData: []
    };
    M(i, function(l) {
      var h = t.getSeriesByIndex(l.seriesIndex), u = l.dataIndexInside, d = h && h.getDataParams(u);
      d && o.seriesData.push(d);
    }), V(a) ? s = a.replace("{value}", s) : q(a) && (s = a(o));
  }
  return s;
}
function Km(r, e, t) {
  var i = sr();
  return fu(i, i, t.rotation), ns(i, i, t.position), Iu([r.dataToCoord(e), (t.labelOffset || 0) + (t.labelDirection || 1) * (t.labelMargin || 0)], i);
}
function bM(r, e, t, i, n, s) {
  var a = ur.innerTextLayout(t.rotation, 0, t.labelDirection);
  t.labelMargin = n.get(["label", "margin"]), vM(e, i, n, s, {
    position: Km(i.axis, r, t),
    align: a.textAlign,
    verticalAlign: a.textVerticalAlign
  });
}
function yM(r, e, t) {
  return t = t || 0, {
    x1: r[t],
    y1: r[1 - t],
    x2: e[t],
    y2: e[1 - t]
  };
}
function wM(r, e, t) {
  return t = t || 0, {
    x: r[t],
    y: r[1 - t],
    width: e[t],
    height: e[1 - t]
  };
}
var CM = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      return r !== null && r.apply(this, arguments) || this;
    }
    return e.prototype.makeElOption = function(t, i, n, s, a) {
      var o = n.axis, l = o.grid, h = s.get("type"), u = dp(l, o).getOtherAxis(o).getGlobalExtent(), d = o.toGlobalCoord(o.dataToCoord(i, !0));
      if (h && h !== "none") {
        var c = gM(s), f = _M[h](o, d, u);
        f.style = c, t.graphicKey = f.type, t.pointer = f;
      }
      var p = Wf(l.model, n);
      bM(
        // @ts-ignore
        i,
        t,
        p,
        n,
        s,
        a
      );
    }, e.prototype.getHandleTransform = function(t, i, n) {
      var s = Wf(i.axis.grid.model, i, {
        labelInside: !1
      });
      s.labelMargin = n.get(["handle", "margin"]);
      var a = Km(i.axis, t, s);
      return {
        x: a[0],
        y: a[1],
        rotation: s.rotation + (s.labelDirection < 0 ? Math.PI : 0)
      };
    }, e.prototype.updateHandleTransform = function(t, i, n, s) {
      var a = n.axis, o = a.grid, l = a.getGlobalExtent(!0), h = dp(o, a).getOtherAxis(a).getGlobalExtent(), u = a.dim === "x" ? 0 : 1, d = [t.x, t.y];
      d[u] += i[u], d[u] = Math.min(l[1], d[u]), d[u] = Math.max(l[0], d[u]);
      var c = (h[1] + h[0]) / 2, f = [c, c];
      f[u] = d[u];
      var p = [{
        verticalAlign: "middle"
      }, {
        align: "center"
      }];
      return {
        x: d[0],
        y: d[1],
        rotation: t.rotation,
        cursorPoint: f,
        tooltipOption: p[u]
      };
    }, e;
  }(pM)
);
function dp(r, e) {
  var t = {};
  return t[e.dim + "AxisIndex"] = e.index, r.getCartesian(t);
}
var _M = {
  line: function(r, e, t) {
    var i = yM([e, t[0]], [e, t[1]], cp(r));
    return {
      type: "Line",
      subPixelOptimize: !0,
      shape: i
    };
  },
  shadow: function(r, e, t) {
    var i = Math.max(1, r.getBandWidth()), n = t[1] - t[0];
    return {
      type: "Rect",
      shape: wM([e - i / 2, t[0]], [i, n], cp(r))
    };
  }
};
function cp(r) {
  return r.dim === "x" ? 0 : 1;
}
var EM = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      var t = r !== null && r.apply(this, arguments) || this;
      return t.type = e.type, t;
    }
    return e.type = "axisPointer", e.defaultOption = {
      // 'auto' means that show when triggered by tooltip or handle.
      show: "auto",
      // zlevel: 0,
      z: 50,
      type: "line",
      // axispointer triggered by tootip determine snap automatically,
      // see `modelHelper`.
      snap: !1,
      triggerTooltip: !0,
      triggerEmphasis: !0,
      value: null,
      status: null,
      link: [],
      // Do not set 'auto' here, otherwise global animation: false
      // will not effect at this axispointer.
      animation: null,
      animationDurationUpdate: 200,
      lineStyle: {
        color: "#B9BEC9",
        width: 1,
        type: "dashed"
      },
      shadowStyle: {
        color: "rgba(210,219,238,0.2)"
      },
      label: {
        show: !0,
        formatter: null,
        precision: "auto",
        margin: 3,
        color: "#fff",
        padding: [5, 7, 5, 7],
        backgroundColor: "auto",
        borderColor: null,
        borderWidth: 0,
        borderRadius: 3
      },
      handle: {
        show: !1,
        // eslint-disable-next-line
        icon: "M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",
        size: 45,
        // handle margin is from symbol center to axis, which is stable when circular move.
        margin: 50,
        // color: '#1b8bbd'
        // color: '#2f4554'
        color: "#333",
        shadowBlur: 3,
        shadowColor: "#aaa",
        shadowOffsetX: 0,
        shadowOffsetY: 2,
        // For mobile performance
        throttle: 40
      }
    }, e;
  }(ae)
), Kt = Te(), TM = M;
function Zm(r, e, t) {
  if (!W.node) {
    var i = e.getZr();
    Kt(i).records || (Kt(i).records = {}), xM(i, e);
    var n = Kt(i).records[r] || (Kt(i).records[r] = {});
    n.handler = t;
  }
}
function xM(r, e) {
  if (Kt(r).initialized)
    return;
  Kt(r).initialized = !0, t("click", He(fp, "click")), t("mousemove", He(fp, "mousemove")), t("globalout", RM);
  function t(i, n) {
    r.on(i, function(s) {
      var a = MM(e);
      TM(Kt(r).records, function(o) {
        o && n(o, s, a.dispatchAction);
      }), SM(a.pendings, e);
    });
  }
}
function SM(r, e) {
  var t = r.showTip.length, i = r.hideTip.length, n;
  t ? n = r.showTip[t - 1] : i && (n = r.hideTip[i - 1]), n && (n.dispatchAction = null, e.dispatchAction(n));
}
function RM(r, e, t) {
  r.handler("leave", null, t);
}
function fp(r, e, t, i) {
  e.handler(r, t, i);
}
function MM(r) {
  var e = {
    showTip: [],
    hideTip: []
  }, t = function(i) {
    var n = e[i.type];
    n ? n.push(i) : (i.dispatchAction = t, r.dispatchAction(i));
  };
  return {
    dispatchAction: t,
    pendings: e
  };
}
function nu(r, e) {
  if (!W.node) {
    var t = e.getZr(), i = (Kt(t).records || {})[r];
    i && (Kt(t).records[r] = null);
  }
}
var DM = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      var t = r !== null && r.apply(this, arguments) || this;
      return t.type = e.type, t;
    }
    return e.prototype.render = function(t, i, n) {
      var s = i.getComponent("tooltip"), a = t.get("triggerOn") || s && s.get("triggerOn") || "mousemove|click";
      Zm("axisPointer", n, function(o, l, h) {
        a !== "none" && (o === "leave" || a.indexOf(o) >= 0) && h({
          type: "updateAxisPointer",
          currTrigger: o,
          x: l && l.offsetX,
          y: l && l.offsetY
        });
      });
    }, e.prototype.remove = function(t, i) {
      nu("axisPointer", i);
    }, e.prototype.dispose = function(t, i) {
      nu("axisPointer", i);
    }, e.type = "axisPointer", e;
  }(ti)
);
function Jm(r, e) {
  var t = [], i = r.seriesIndex, n;
  if (i == null || !(n = e.getSeriesByIndex(i)))
    return {
      point: []
    };
  var s = n.getData(), a = ms(s, r);
  if (a == null || a < 0 || F(a))
    return {
      point: []
    };
  var o = s.getItemGraphicEl(a), l = n.coordinateSystem;
  if (n.getTooltipPosition)
    t = n.getTooltipPosition(a) || [];
  else if (l && l.dataToPoint)
    if (r.isStacked) {
      var h = l.getBaseAxis(), u = l.getOtherAxis(h), d = u.dim, c = h.dim, f = d === "x" || d === "radius" ? 1 : 0, p = s.mapDimension(c), m = [];
      m[f] = s.get(p, a), m[1 - f] = s.get(s.getCalculationInfo("stackResultDimension"), a), t = l.dataToPoint(m) || [];
    } else
      t = l.dataToPoint(s.getValues(J(l.dimensions, function(v) {
        return s.mapDimension(v);
      }), a)) || [];
  else if (o) {
    var g = o.getBoundingRect().clone();
    g.applyTransform(o.transform), t = [g.x + g.width / 2, g.y + g.height / 2];
  }
  return {
    point: t,
    el: o
  };
}
var pp = Te();
function LM(r, e, t) {
  var i = r.currTrigger, n = [r.x, r.y], s = r, a = r.dispatchAction || K(t.dispatchAction, t), o = e.getComponent("axisPointer").coordSysAxesInfo;
  if (o) {
    pa(n) && (n = Jm({
      seriesIndex: s.seriesIndex,
      // Do not use dataIndexInside from other ec instance.
      // FIXME: auto detect it?
      dataIndex: s.dataIndex
    }, e).point);
    var l = pa(n), h = s.axesInfo, u = o.axesInfo, d = i === "leave" || pa(n), c = {}, f = {}, p = {
      list: [],
      map: {}
    }, m = {
      showPointer: He(AM, f),
      showTooltip: He(PM, p)
    };
    M(o.coordSysMap, function(v, b) {
      var y = l || v.containPoint(n);
      M(o.coordSysAxesInfo[b], function(w, _) {
        var E = w.axis, x = FM(h, w);
        if (!d && y && (!h || x)) {
          var T = x && x.value;
          T == null && !l && (T = E.pointToData(n)), T != null && gp(w, T, m, !1, c);
        }
      });
    });
    var g = {};
    return M(u, function(v, b) {
      var y = v.linkGroup;
      y && !f[b] && M(y.axesInfo, function(w, _) {
        var E = f[_];
        if (w !== v && E) {
          var x = E.value;
          y.mapper && (x = v.axis.scale.parse(y.mapper(x, vp(w), vp(v)))), g[v.key] = x;
        }
      });
    }), M(g, function(v, b) {
      gp(u[b], v, m, !0, c);
    }), OM(f, u, c), IM(p, n, r, a), zM(u, a, t), c;
  }
}
function gp(r, e, t, i, n) {
  var s = r.axis;
  if (!(s.scale.isBlank() || !s.containData(e))) {
    if (!r.involveSeries) {
      t.showPointer(r, e);
      return;
    }
    var a = kM(e, r), o = a.payloadBatch, l = a.snapToValue;
    o[0] && n.seriesIndex == null && P(n, o[0]), !i && r.snap && s.containData(l) && l != null && (e = l), t.showPointer(r, e, o), t.showTooltip(r, a, l);
  }
}
function kM(r, e) {
  var t = e.axis, i = t.dim, n = r, s = [], a = Number.MAX_VALUE, o = -1;
  return M(e.seriesModels, function(l, h) {
    var u = l.getData().mapDimensionsAll(i), d, c;
    if (l.getAxisTooltipData) {
      var f = l.getAxisTooltipData(u, r, t);
      c = f.dataIndices, d = f.nestestValue;
    } else {
      if (c = l.getData().indicesOfNearest(
        u[0],
        r,
        // Add a threshold to avoid find the wrong dataIndex
        // when data length is not same.
        // false,
        t.type === "category" ? 0.5 : null
      ), !c.length)
        return;
      d = l.getData().get(u[0], c[0]);
    }
    if (!(d == null || !isFinite(d))) {
      var p = r - d, m = Math.abs(p);
      m <= a && ((m < a || p >= 0 && o < 0) && (a = m, o = p, n = d, s.length = 0), M(c, function(g) {
        s.push({
          seriesIndex: l.seriesIndex,
          dataIndexInside: g,
          dataIndex: l.getData().getRawIndex(g)
        });
      }));
    }
  }), {
    payloadBatch: s,
    snapToValue: n
  };
}
function AM(r, e, t, i) {
  r[e.key] = {
    value: t,
    payloadBatch: i
  };
}
function PM(r, e, t, i) {
  var n = t.payloadBatch, s = e.axis, a = s.model, o = e.axisPointerModel;
  if (!(!e.triggerTooltip || !n.length)) {
    var l = e.coordSys.model, h = cs(l), u = r.map[h];
    u || (u = r.map[h] = {
      coordSysId: l.id,
      coordSysIndex: l.componentIndex,
      coordSysType: l.type,
      coordSysMainType: l.mainType,
      dataByAxis: []
    }, r.list.push(u)), u.dataByAxis.push({
      axisDim: s.dim,
      axisIndex: a.componentIndex,
      axisType: a.type,
      axisId: a.id,
      value: i,
      // Caustion: viewHelper.getValueLabel is actually on "view stage", which
      // depends that all models have been updated. So it should not be performed
      // here. Considering axisPointerModel used here is volatile, which is hard
      // to be retrieve in TooltipView, we prepare parameters here.
      valueLabelOpt: {
        precision: o.get(["label", "precision"]),
        formatter: o.get(["label", "formatter"])
      },
      seriesDataIndices: n.slice()
    });
  }
}
function OM(r, e, t) {
  var i = t.axesInfo = [];
  M(e, function(n, s) {
    var a = n.axisPointerModel.option, o = r[s];
    o ? (!n.useHandle && (a.status = "show"), a.value = o.value, a.seriesDataIndices = (o.payloadBatch || []).slice()) : !n.useHandle && (a.status = "hide"), a.status === "show" && i.push({
      axisDim: n.axis.dim,
      axisIndex: n.axis.model.componentIndex,
      value: a.value
    });
  });
}
function IM(r, e, t, i) {
  if (pa(e) || !r.list.length) {
    i({
      type: "hideTip"
    });
    return;
  }
  var n = ((r.list[0].dataByAxis[0] || {}).seriesDataIndices || [])[0] || {};
  i({
    type: "showTip",
    escapeConnect: !0,
    x: e[0],
    y: e[1],
    tooltipOption: t.tooltipOption,
    position: t.position,
    dataIndexInside: n.dataIndexInside,
    dataIndex: n.dataIndex,
    seriesIndex: n.seriesIndex,
    dataByCoordSys: r.list
  });
}
function zM(r, e, t) {
  var i = t.getZr(), n = "axisPointerLastHighlights", s = pp(i)[n] || {}, a = pp(i)[n] = {};
  M(r, function(h, u) {
    var d = h.axisPointerModel.option;
    d.status === "show" && h.triggerEmphasis && M(d.seriesDataIndices, function(c) {
      var f = c.seriesIndex + " | " + c.dataIndex;
      a[f] = c;
    });
  });
  var o = [], l = [];
  M(s, function(h, u) {
    !a[u] && l.push(h);
  }), M(a, function(h, u) {
    !s[u] && o.push(h);
  }), l.length && t.dispatchAction({
    type: "downplay",
    escapeConnect: !0,
    // Not blur others when highlight in axisPointer.
    notBlur: !0,
    batch: l
  }), o.length && t.dispatchAction({
    type: "highlight",
    escapeConnect: !0,
    // Not blur others when highlight in axisPointer.
    notBlur: !0,
    batch: o
  });
}
function FM(r, e) {
  for (var t = 0; t < (r || []).length; t++) {
    var i = r[t];
    if (e.axis.dim === i.axisDim && e.axis.model.componentIndex === i.axisIndex)
      return i;
  }
}
function vp(r) {
  var e = r.axis.model, t = {}, i = t.axisDim = r.axis.dim;
  return t.axisIndex = t[i + "AxisIndex"] = e.componentIndex, t.axisName = t[i + "AxisName"] = e.name, t.axisId = t[i + "AxisId"] = e.id, t;
}
function pa(r) {
  return !r || r[0] == null || isNaN(r[0]) || r[1] == null || isNaN(r[1]);
}
function HM(r) {
  cR.registerAxisPointerClass("CartesianAxisPointer", CM), r.registerComponentModel(EM), r.registerComponentView(DM), r.registerPreprocessor(function(e) {
    if (e) {
      (!e.axisPointer || e.axisPointer.length === 0) && (e.axisPointer = {});
      var t = e.axisPointer.link;
      t && !F(t) && (e.axisPointer.link = [t]);
    }
  }), r.registerProcessor(r.PRIORITY.PROCESSOR.STATISTIC, function(e, t) {
    e.getComponent("axisPointer").coordSysAxesInfo = sR(e, t);
  }), r.registerAction({
    type: "updateAxisPointer",
    event: "updateAxisPointer",
    update: ":updateAxisPointer"
  }, LM);
}
var NM = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      var t = r !== null && r.apply(this, arguments) || this;
      return t.type = e.type, t;
    }
    return e.type = "tooltip", e.dependencies = ["axisPointer"], e.defaultOption = {
      // zlevel: 0,
      z: 60,
      show: !0,
      // tooltip main content
      showContent: !0,
      // 'trigger' only works on coordinate system.
      // 'item' | 'axis' | 'none'
      trigger: "item",
      // 'click' | 'mousemove' | 'none'
      triggerOn: "mousemove|click",
      alwaysShowContent: !1,
      displayMode: "single",
      renderMode: "auto",
      // whether restraint content inside viewRect.
      // If renderMode: 'richText', default true.
      // If renderMode: 'html', defaut false (for backward compat).
      confine: null,
      showDelay: 0,
      hideDelay: 100,
      // Animation transition time, unit is second
      transitionDuration: 0.4,
      enterable: !1,
      backgroundColor: "#fff",
      // box shadow
      shadowBlur: 10,
      shadowColor: "rgba(0, 0, 0, .2)",
      shadowOffsetX: 1,
      shadowOffsetY: 2,
      // tooltip border radius, unit is px, default is 4
      borderRadius: 4,
      // tooltip border width, unit is px, default is 0 (no border)
      borderWidth: 1,
      // Tooltip inside padding, default is 5 for all direction
      // Array is allowed to set up, right, bottom, left, same with css
      // The default value: See `tooltip/tooltipMarkup.ts#getPaddingFromTooltipModel`.
      padding: null,
      // Extra css text
      extraCssText: "",
      // axis indicator, trigger by axis
      axisPointer: {
        // default is line
        // legal values: 'line' | 'shadow' | 'cross'
        type: "line",
        // Valid when type is line, appoint tooltip line locate on which line. Optional
        // legal values: 'x' | 'y' | 'angle' | 'radius' | 'auto'
        // default is 'auto', chose the axis which type is category.
        // for multiply y axis, cartesian coord chose x axis, polar chose angle axis
        axis: "auto",
        animation: "auto",
        animationDurationUpdate: 200,
        animationEasingUpdate: "exponentialOut",
        crossStyle: {
          color: "#999",
          width: 1,
          type: "dashed",
          // TODO formatter
          textStyle: {}
        }
        // lineStyle and shadowStyle should not be specified here,
        // otherwise it will always override those styles on option.axisPointer.
      },
      textStyle: {
        color: "#666",
        fontSize: 14
      }
    }, e;
  }(ae)
);
function Qm(r) {
  var e = r.get("confine");
  return e != null ? !!e : r.get("renderMode") === "richText";
}
function eb(r) {
  if (W.domSupported) {
    for (var e = document.documentElement.style, t = 0, i = r.length; t < i; t++)
      if (r[t] in e)
        return r[t];
  }
}
var tb = eb(["transform", "webkitTransform", "OTransform", "MozTransform", "msTransform"]), BM = eb(["webkitTransition", "transition", "OTransition", "MozTransition", "msTransition"]);
function ib(r, e) {
  if (!r)
    return e;
  e = _v(e, !0);
  var t = r.indexOf(e);
  return r = t === -1 ? e : "-" + r.slice(0, t) + "-" + e, r.toLowerCase();
}
function VM(r, e) {
  var t = r.currentStyle || document.defaultView && document.defaultView.getComputedStyle(r);
  return t ? t[e] : null;
}
var WM = ib(BM, "transition"), id = ib(tb, "transform"), GM = "position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;" + (W.transform3dSupported ? "will-change:transform;" : "");
function UM(r) {
  return r = r === "left" ? "right" : r === "right" ? "left" : r === "top" ? "bottom" : "top", r;
}
function jM(r, e, t) {
  if (!V(t) || t === "inside")
    return "";
  var i = r.get("backgroundColor"), n = r.get("borderWidth");
  e = ls(e);
  var s = UM(t), a = Math.max(Math.round(n) * 1.5, 6), o = "", l = id + ":", h;
  ue(["left", "right"], s) > -1 ? (o += "top:50%", l += "translateY(-50%) rotate(" + (h = s === "left" ? -225 : -45) + "deg)") : (o += "left:50%", l += "translateX(-50%) rotate(" + (h = s === "top" ? 225 : 45) + "deg)");
  var u = h * Math.PI / 180, d = a + n, c = d * Math.abs(Math.cos(u)) + d * Math.abs(Math.sin(u)), f = Math.round(((c - Math.SQRT2 * n) / 2 + Math.SQRT2 * n - (c - d) / 2) * 100) / 100;
  o += ";" + s + ":-" + f + "px";
  var p = e + " solid " + n + "px;", m = ["position:absolute;width:" + a + "px;height:" + a + "px;z-index:-1;", o + ";" + l + ";", "border-bottom:" + p, "border-right:" + p, "background-color:" + i + ";"];
  return '<div style="' + m.join("") + '"></div>';
}
function YM(r, e) {
  var t = "cubic-bezier(0.23,1,0.32,1)", i = " " + r / 2 + "s " + t, n = "opacity" + i + ",visibility" + i;
  return e || (i = " " + r + "s " + t, n += W.transformSupported ? "," + id + i : ",left" + i + ",top" + i), WM + ":" + n;
}
function mp(r, e, t) {
  var i = r.toFixed(0) + "px", n = e.toFixed(0) + "px";
  if (!W.transformSupported)
    return t ? "top:" + n + ";left:" + i + ";" : [["top", n], ["left", i]];
  var s = W.transform3dSupported, a = "translate" + (s ? "3d" : "") + "(" + i + "," + n + (s ? ",0" : "") + ")";
  return t ? "top:0;left:0;" + id + ":" + a + ";" : [["top", 0], ["left", 0], [tb, a]];
}
function XM(r) {
  var e = [], t = r.get("fontSize"), i = r.getTextColor();
  i && e.push("color:" + i), e.push("font:" + r.getFont());
  var n = j(r.get("lineHeight"), Math.round(t * 3 / 2));
  t && e.push("line-height:" + n + "px");
  var s = r.get("textShadowColor"), a = r.get("textShadowBlur") || 0, o = r.get("textShadowOffsetX") || 0, l = r.get("textShadowOffsetY") || 0;
  return s && a && e.push("text-shadow:" + o + "px " + l + "px " + a + "px " + s), M(["decoration", "align"], function(h) {
    var u = r.get(h);
    u && e.push("text-" + h + ":" + u);
  }), e.join(";");
}
function $M(r, e, t) {
  var i = [], n = r.get("transitionDuration"), s = r.get("backgroundColor"), a = r.get("shadowBlur"), o = r.get("shadowColor"), l = r.get("shadowOffsetX"), h = r.get("shadowOffsetY"), u = r.getModel("textStyle"), d = qv(r, "html"), c = l + "px " + h + "px " + a + "px " + o;
  return i.push("box-shadow:" + c), e && n && i.push(YM(n, t)), s && i.push("background-color:" + s), M(["width", "color", "radius"], function(f) {
    var p = "border-" + f, m = _v(p), g = r.get(m);
    g != null && i.push(p + ":" + g + (f === "color" ? "" : "px"));
  }), i.push(XM(u)), d != null && i.push("padding:" + co(d).join("px ") + "px"), i.join(";") + ";";
}
function bp(r, e, t, i, n) {
  var s = e && e.painter;
  if (t) {
    var a = s && s.getViewportRoot();
    a && C0(r, a, t, i, n);
  } else {
    r[0] = i, r[1] = n;
    var o = s && s.getViewportRootOffset();
    o && (r[0] += o.offsetLeft, r[1] += o.offsetTop);
  }
  r[2] = r[0] / e.getWidth(), r[3] = r[1] / e.getHeight();
}
var qM = (
  /** @class */
  function() {
    function r(e, t) {
      if (this._show = !1, this._styleCoord = [0, 0, 0, 0], this._enterable = !0, this._alwaysShowContent = !1, this._firstShow = !0, this._longHide = !0, W.wxa)
        return null;
      var i = document.createElement("div");
      i.domBelongToZr = !0, this.el = i;
      var n = this._zr = e.getZr(), s = t.appendTo, a = s && (V(s) ? document.querySelector(s) : Yr(s) ? s : q(s) && s(e.getDom()));
      bp(this._styleCoord, n, a, e.getWidth() / 2, e.getHeight() / 2), (a || e.getDom()).appendChild(i), this._api = e, this._container = a;
      var o = this;
      i.onmouseenter = function() {
        o._enterable && (clearTimeout(o._hideTimeout), o._show = !0), o._inContent = !0;
      }, i.onmousemove = function(l) {
        if (l = l || window.event, !o._enterable) {
          var h = n.handler, u = n.painter.getViewportRoot();
          gt(u, l, !0), h.dispatch("mousemove", l);
        }
      }, i.onmouseleave = function() {
        o._inContent = !1, o._enterable && o._show && o.hideLater(o._hideDelay);
      };
    }
    return r.prototype.update = function(e) {
      if (!this._container) {
        var t = this._api.getDom(), i = VM(t, "position"), n = t.style;
        n.position !== "absolute" && i !== "absolute" && (n.position = "relative");
      }
      var s = e.get("alwaysShowContent");
      s && this._moveIfResized(), this._alwaysShowContent = s, this.el.className = e.get("className") || "";
    }, r.prototype.show = function(e, t) {
      clearTimeout(this._hideTimeout), clearTimeout(this._longHideTimeout);
      var i = this.el, n = i.style, s = this._styleCoord;
      i.innerHTML ? n.cssText = GM + $M(e, !this._firstShow, this._longHide) + mp(s[0], s[1], !0) + ("border-color:" + ls(t) + ";") + (e.get("extraCssText") || "") + (";pointer-events:" + (this._enterable ? "auto" : "none")) : n.display = "none", this._show = !0, this._firstShow = !1, this._longHide = !1;
    }, r.prototype.setContent = function(e, t, i, n, s) {
      var a = this.el;
      if (e == null) {
        a.innerHTML = "";
        return;
      }
      var o = "";
      if (V(s) && i.get("trigger") === "item" && !Qm(i) && (o = jM(i, n, s)), V(e))
        a.innerHTML = e + o;
      else if (e) {
        a.innerHTML = "", F(e) || (e = [e]);
        for (var l = 0; l < e.length; l++)
          Yr(e[l]) && e[l].parentNode !== a && a.appendChild(e[l]);
        if (o && a.childNodes.length) {
          var h = document.createElement("div");
          h.innerHTML = o, a.appendChild(h);
        }
      }
    }, r.prototype.setEnterable = function(e) {
      this._enterable = e;
    }, r.prototype.getSize = function() {
      var e = this.el;
      return e ? [e.offsetWidth, e.offsetHeight] : [0, 0];
    }, r.prototype.moveTo = function(e, t) {
      if (this.el) {
        var i = this._styleCoord;
        if (bp(i, this._zr, this._container, e, t), i[0] != null && i[1] != null) {
          var n = this.el.style, s = mp(i[0], i[1]);
          M(s, function(a) {
            n[a[0]] = a[1];
          });
        }
      }
    }, r.prototype._moveIfResized = function() {
      var e = this._styleCoord[2], t = this._styleCoord[3];
      this.moveTo(e * this._zr.getWidth(), t * this._zr.getHeight());
    }, r.prototype.hide = function() {
      var e = this, t = this.el.style;
      t.visibility = "hidden", t.opacity = "0", W.transform3dSupported && (t.willChange = ""), this._show = !1, this._longHideTimeout = setTimeout(function() {
        return e._longHide = !0;
      }, 500);
    }, r.prototype.hideLater = function(e) {
      this._show && !(this._inContent && this._enterable) && !this._alwaysShowContent && (e ? (this._hideDelay = e, this._show = !1, this._hideTimeout = setTimeout(K(this.hide, this), e)) : this.hide());
    }, r.prototype.isShow = function() {
      return this._show;
    }, r.prototype.dispose = function() {
      clearTimeout(this._hideTimeout), clearTimeout(this._longHideTimeout);
      var e = this.el.parentNode;
      e && e.removeChild(this.el), this.el = this._container = null;
    }, r;
  }()
), KM = (
  /** @class */
  function() {
    function r(e) {
      this._show = !1, this._styleCoord = [0, 0, 0, 0], this._alwaysShowContent = !1, this._enterable = !0, this._zr = e.getZr(), wp(this._styleCoord, this._zr, e.getWidth() / 2, e.getHeight() / 2);
    }
    return r.prototype.update = function(e) {
      var t = e.get("alwaysShowContent");
      t && this._moveIfResized(), this._alwaysShowContent = t;
    }, r.prototype.show = function() {
      this._hideTimeout && clearTimeout(this._hideTimeout), this.el.show(), this._show = !0;
    }, r.prototype.setContent = function(e, t, i, n, s) {
      var a = this;
      B(e) && Ke(process.env.NODE_ENV !== "production" ? "Passing DOM nodes as content is not supported in richText tooltip!" : ""), this.el && this._zr.remove(this.el);
      var o = i.getModel("textStyle");
      this.el = new ht({
        style: {
          rich: t.richTextStyles,
          text: e,
          lineHeight: 22,
          borderWidth: 1,
          borderColor: n,
          textShadowColor: o.get("textShadowColor"),
          fill: i.get(["textStyle", "color"]),
          padding: qv(i, "richText"),
          verticalAlign: "top",
          align: "left"
        },
        z: i.get("z")
      }), M(["backgroundColor", "borderRadius", "shadowColor", "shadowBlur", "shadowOffsetX", "shadowOffsetY"], function(h) {
        a.el.style[h] = i.get(h);
      }), M(["textShadowBlur", "textShadowOffsetX", "textShadowOffsetY"], function(h) {
        a.el.style[h] = o.get(h) || 0;
      }), this._zr.add(this.el);
      var l = this;
      this.el.on("mouseover", function() {
        l._enterable && (clearTimeout(l._hideTimeout), l._show = !0), l._inContent = !0;
      }), this.el.on("mouseout", function() {
        l._enterable && l._show && l.hideLater(l._hideDelay), l._inContent = !1;
      });
    }, r.prototype.setEnterable = function(e) {
      this._enterable = e;
    }, r.prototype.getSize = function() {
      var e = this.el, t = this.el.getBoundingRect(), i = yp(e.style);
      return [t.width + i.left + i.right, t.height + i.top + i.bottom];
    }, r.prototype.moveTo = function(e, t) {
      var i = this.el;
      if (i) {
        var n = this._styleCoord;
        wp(n, this._zr, e, t), e = n[0], t = n[1];
        var s = i.style, a = ci(s.borderWidth || 0), o = yp(s);
        i.x = e + a + o.left, i.y = t + a + o.top, i.markRedraw();
      }
    }, r.prototype._moveIfResized = function() {
      var e = this._styleCoord[2], t = this._styleCoord[3];
      this.moveTo(e * this._zr.getWidth(), t * this._zr.getHeight());
    }, r.prototype.hide = function() {
      this.el && this.el.hide(), this._show = !1;
    }, r.prototype.hideLater = function(e) {
      this._show && !(this._inContent && this._enterable) && !this._alwaysShowContent && (e ? (this._hideDelay = e, this._show = !1, this._hideTimeout = setTimeout(K(this.hide, this), e)) : this.hide());
    }, r.prototype.isShow = function() {
      return this._show;
    }, r.prototype.dispose = function() {
      this._zr.remove(this.el);
    }, r;
  }()
);
function ci(r) {
  return Math.max(0, r);
}
function yp(r) {
  var e = ci(r.shadowBlur || 0), t = ci(r.shadowOffsetX || 0), i = ci(r.shadowOffsetY || 0);
  return {
    left: ci(e - t),
    right: ci(e + t),
    top: ci(e - i),
    bottom: ci(e + i)
  };
}
function wp(r, e, t, i) {
  r[0] = t, r[1] = i, r[2] = r[0] / e.getWidth(), r[3] = r[1] / e.getHeight();
}
var ZM = new ot({
  shape: {
    x: -1,
    y: -1,
    width: 2,
    height: 2
  }
}), JM = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      var t = r !== null && r.apply(this, arguments) || this;
      return t.type = e.type, t;
    }
    return e.prototype.init = function(t, i) {
      if (!(W.node || !i.getDom())) {
        var n = t.getComponent("tooltip"), s = this._renderMode = XC(n.get("renderMode"));
        this._tooltipContent = s === "richText" ? new KM(i) : new qM(i, {
          appendTo: n.get("appendToBody", !0) ? "body" : n.get("appendTo", !0)
        });
      }
    }, e.prototype.render = function(t, i, n) {
      if (!(W.node || !n.getDom())) {
        this.group.removeAll(), this._tooltipModel = t, this._ecModel = i, this._api = n;
        var s = this._tooltipContent;
        s.update(t), s.setEnterable(t.get("enterable")), this._initGlobalListener(), this._keepShow(), this._renderMode !== "richText" && t.get("transitionDuration") ? Zv(this, "_updatePosition", 50, "fixRate") : Yh(this, "_updatePosition");
      }
    }, e.prototype._initGlobalListener = function() {
      var t = this._tooltipModel, i = t.get("triggerOn");
      Zm("itemTooltip", this._api, K(function(n, s, a) {
        i !== "none" && (i.indexOf(n) >= 0 ? this._tryShow(s, a) : n === "leave" && this._hide(a));
      }, this));
    }, e.prototype._keepShow = function() {
      var t = this._tooltipModel, i = this._ecModel, n = this._api, s = t.get("triggerOn");
      if (this._lastX != null && this._lastY != null && s !== "none" && s !== "click") {
        var a = this;
        clearTimeout(this._refreshUpdateTimeout), this._refreshUpdateTimeout = setTimeout(function() {
          !n.isDisposed() && a.manuallyShowTip(t, i, n, {
            x: a._lastX,
            y: a._lastY,
            dataByCoordSys: a._lastDataByCoordSys
          });
        });
      }
    }, e.prototype.manuallyShowTip = function(t, i, n, s) {
      if (!(s.from === this.uid || W.node || !n.getDom())) {
        var a = Cp(s, n);
        this._ticket = "";
        var o = s.dataByCoordSys, l = iD(s, i, n);
        if (l) {
          var h = l.el.getBoundingRect().clone();
          h.applyTransform(l.el.transform), this._tryShow({
            offsetX: h.x + h.width / 2,
            offsetY: h.y + h.height / 2,
            target: l.el,
            position: s.position,
            // When manully trigger, the mouse is not on the el, so we'd better to
            // position tooltip on the bottom of the el and display arrow is possible.
            positionDefault: "bottom"
          }, a);
        } else if (s.tooltip && s.x != null && s.y != null) {
          var u = ZM;
          u.x = s.x, u.y = s.y, u.update(), ce(u).tooltipConfig = {
            name: null,
            option: s.tooltip
          }, this._tryShow({
            offsetX: s.x,
            offsetY: s.y,
            target: u
          }, a);
        } else if (o)
          this._tryShow({
            offsetX: s.x,
            offsetY: s.y,
            position: s.position,
            dataByCoordSys: o,
            tooltipOption: s.tooltipOption
          }, a);
        else if (s.seriesIndex != null) {
          if (this._manuallyAxisShowTip(t, i, n, s))
            return;
          var d = Jm(s, i), c = d.point[0], f = d.point[1];
          c != null && f != null && this._tryShow({
            offsetX: c,
            offsetY: f,
            target: d.el,
            position: s.position,
            // When manully trigger, the mouse is not on the el, so we'd better to
            // position tooltip on the bottom of the el and display arrow is possible.
            positionDefault: "bottom"
          }, a);
        } else s.x != null && s.y != null && (n.dispatchAction({
          type: "updateAxisPointer",
          x: s.x,
          y: s.y
        }), this._tryShow({
          offsetX: s.x,
          offsetY: s.y,
          position: s.position,
          target: n.getZr().findHover(s.x, s.y).target
        }, a));
      }
    }, e.prototype.manuallyHideTip = function(t, i, n, s) {
      var a = this._tooltipContent;
      this._tooltipModel && a.hideLater(this._tooltipModel.get("hideDelay")), this._lastX = this._lastY = this._lastDataByCoordSys = null, s.from !== this.uid && this._hide(Cp(s, n));
    }, e.prototype._manuallyAxisShowTip = function(t, i, n, s) {
      var a = s.seriesIndex, o = s.dataIndex, l = i.getComponent("axisPointer").coordSysAxesInfo;
      if (!(a == null || o == null || l == null)) {
        var h = i.getSeriesByIndex(a);
        if (h) {
          var u = h.getData(), d = kn([u.getItemModel(o), h, (h.coordinateSystem || {}).model], this._tooltipModel);
          if (d.get("trigger") === "axis")
            return n.dispatchAction({
              type: "updateAxisPointer",
              seriesIndex: a,
              dataIndex: o,
              position: s.position
            }), !0;
        }
      }
    }, e.prototype._tryShow = function(t, i) {
      var n = t.target, s = this._tooltipModel;
      if (s) {
        this._lastX = t.offsetX, this._lastY = t.offsetY;
        var a = t.dataByCoordSys;
        if (a && a.length)
          this._showAxisTooltip(a, t);
        else if (n) {
          var o = ce(n);
          if (o.ssrType === "legend")
            return;
          this._lastDataByCoordSys = null;
          var l, h;
          Nn(n, function(u) {
            if (ce(u).dataIndex != null)
              return l = u, !0;
            if (ce(u).tooltipConfig != null)
              return h = u, !0;
          }, !0), l ? this._showSeriesItemTooltip(t, l, i) : h ? this._showComponentItemTooltip(t, h, i) : this._hide(i);
        } else
          this._lastDataByCoordSys = null, this._hide(i);
      }
    }, e.prototype._showOrMove = function(t, i) {
      var n = t.get("showDelay");
      i = K(i, this), clearTimeout(this._showTimout), n > 0 ? this._showTimout = setTimeout(i, n) : i();
    }, e.prototype._showAxisTooltip = function(t, i) {
      var n = this._ecModel, s = this._tooltipModel, a = [i.offsetX, i.offsetY], o = kn([i.tooltipOption], s), l = this._renderMode, h = [], u = Jr("section", {
        blocks: [],
        noHeader: !0
      }), d = [], c = new pl();
      M(t, function(b) {
        M(b.dataByAxis, function(y) {
          var w = n.getComponent(y.axisDim + "Axis", y.axisIndex), _ = y.value;
          if (!(!w || _ == null)) {
            var E = qm(_, w.axis, n, y.seriesDataIndices, y.valueLabelOpt), x = Jr("section", {
              header: E,
              noHeader: !zt(E),
              sortBlocks: !0,
              blocks: []
            });
            u.blocks.push(x), M(y.seriesDataIndices, function(T) {
              var C = n.getSeriesByIndex(T.seriesIndex), S = T.dataIndexInside, R = C.getDataParams(S);
              if (!(R.dataIndex < 0)) {
                R.axisDim = y.axisDim, R.axisIndex = y.axisIndex, R.axisType = y.axisType, R.axisId = y.axisId, R.axisValue = Pm(w.axis, {
                  value: _
                }), R.axisValueLabel = E, R.marker = c.makeTooltipMarker("item", ls(R.color), l);
                var D = Zc(C.formatTooltip(S, !0, null)), k = D.frag;
                if (k) {
                  var L = kn([C], s).get("valueFormatter");
                  x.blocks.push(L ? P({
                    valueFormatter: L
                  }, k) : k);
                }
                D.text && d.push(D.text), h.push(R);
              }
            });
          }
        });
      }), u.blocks.reverse(), d.reverse();
      var f = i.position, p = o.get("order"), m = rf(u, c, l, p, n.get("useUTC"), o.get("textStyle"));
      m && d.unshift(m);
      var g = l === "richText" ? `

` : "<br/>", v = d.join(g);
      this._showOrMove(o, function() {
        this._updateContentNotChangedOnAxis(t, h) ? this._updatePosition(o, f, a[0], a[1], this._tooltipContent, h) : this._showTooltipContent(o, v, h, Math.random() + "", a[0], a[1], f, null, c);
      });
    }, e.prototype._showSeriesItemTooltip = function(t, i, n) {
      var s = this._ecModel, a = ce(i), o = a.seriesIndex, l = s.getSeriesByIndex(o), h = a.dataModel || l, u = a.dataIndex, d = a.dataType, c = h.getData(d), f = this._renderMode, p = t.positionDefault, m = kn([c.getItemModel(u), h, l && (l.coordinateSystem || {}).model], this._tooltipModel, p ? {
        position: p
      } : null), g = m.get("trigger");
      if (!(g != null && g !== "item")) {
        var v = h.getDataParams(u, d), b = new pl();
        v.marker = b.makeTooltipMarker("item", ls(v.color), f);
        var y = Zc(h.formatTooltip(u, !1, d)), w = m.get("order"), _ = m.get("valueFormatter"), E = y.frag, x = E ? rf(_ ? P({
          valueFormatter: _
        }, E) : E, b, f, w, s.get("useUTC"), m.get("textStyle")) : y.text, T = "item_" + h.name + "_" + u;
        this._showOrMove(m, function() {
          this._showTooltipContent(m, x, v, T, t.offsetX, t.offsetY, t.position, t.target, b);
        }), n({
          type: "showTip",
          dataIndexInside: u,
          dataIndex: c.getRawIndex(u),
          seriesIndex: o,
          from: this.uid
        });
      }
    }, e.prototype._showComponentItemTooltip = function(t, i, n) {
      var s = this._renderMode === "html", a = ce(i), o = a.tooltipConfig, l = o.option || {}, h = l.encodeHTMLContent;
      if (V(l)) {
        var u = l;
        l = {
          content: u,
          // Fixed formatter
          formatter: u
        }, h = !0;
      }
      h && s && l.content && (l = $(l), l.content = $e(l.content));
      var d = [l], c = this._ecModel.getComponent(a.componentMainType, a.componentIndex);
      c && d.push(c), d.push({
        formatter: l.content
      });
      var f = t.positionDefault, p = kn(d, this._tooltipModel, f ? {
        position: f
      } : null), m = p.get("content"), g = Math.random() + "", v = new pl();
      this._showOrMove(p, function() {
        var b = $(p.get("formatterParams") || {});
        this._showTooltipContent(p, m, b, g, t.offsetX, t.offsetY, t.position, i, v);
      }), n({
        type: "showTip",
        from: this.uid
      });
    }, e.prototype._showTooltipContent = function(t, i, n, s, a, o, l, h, u) {
      if (this._ticket = "", !(!t.get("showContent") || !t.get("show"))) {
        var d = this._tooltipContent;
        d.setEnterable(t.get("enterable"));
        var c = t.get("formatter");
        l = l || t.get("position");
        var f = i, p = this._getNearestPoint([a, o], n, t.get("trigger"), t.get("borderColor")), m = p.color;
        if (c)
          if (V(c)) {
            var g = t.ecModel.get("useUTC"), v = F(n) ? n[0] : n, b = v && v.axisType && v.axisType.indexOf("time") >= 0;
            f = c, b && (f = Cv(v.axisValue, f, g)), f = Ev(f, n, !0);
          } else if (q(c)) {
            var y = K(function(w, _) {
              w === this._ticket && (d.setContent(_, u, t, m, l), this._updatePosition(t, l, a, o, d, n, h));
            }, this);
            this._ticket = s, f = c(n, s, y);
          } else
            f = c;
        d.setContent(f, u, t, m, l), d.show(t, m), this._updatePosition(t, l, a, o, d, n, h);
      }
    }, e.prototype._getNearestPoint = function(t, i, n, s) {
      if (n === "axis" || F(i))
        return {
          color: s || (this._renderMode === "html" ? "#fff" : "none")
        };
      if (!F(i))
        return {
          color: s || i.color || i.borderColor
        };
    }, e.prototype._updatePosition = function(t, i, n, s, a, o, l) {
      var h = this._api.getWidth(), u = this._api.getHeight();
      i = i || t.get("position");
      var d = a.getSize(), c = t.get("align"), f = t.get("verticalAlign"), p = l && l.getBoundingRect().clone();
      if (l && p.applyTransform(l.transform), q(i) && (i = i([n, s], o, a.el, p, {
        viewSize: [h, u],
        contentSize: d.slice()
      })), F(i))
        n = Fe(i[0], h), s = Fe(i[1], u);
      else if (B(i)) {
        var m = i;
        m.width = d[0], m.height = d[1];
        var g = fo(m, {
          width: h,
          height: u
        });
        n = g.x, s = g.y, c = null, f = null;
      } else if (V(i) && l) {
        var v = tD(i, p, d, t.get("borderWidth"));
        n = v[0], s = v[1];
      } else {
        var v = QM(n, s, a, h, u, c ? null : 20, f ? null : 20);
        n = v[0], s = v[1];
      }
      if (c && (n -= _p(c) ? d[0] / 2 : c === "right" ? d[0] : 0), f && (s -= _p(f) ? d[1] / 2 : f === "bottom" ? d[1] : 0), Qm(t)) {
        var v = eD(n, s, a, h, u);
        n = v[0], s = v[1];
      }
      a.moveTo(n, s);
    }, e.prototype._updateContentNotChangedOnAxis = function(t, i) {
      var n = this._lastDataByCoordSys, s = this._cbParamsList, a = !!n && n.length === t.length;
      return a && M(n, function(o, l) {
        var h = o.dataByAxis || [], u = t[l] || {}, d = u.dataByAxis || [];
        a = a && h.length === d.length, a && M(h, function(c, f) {
          var p = d[f] || {}, m = c.seriesDataIndices || [], g = p.seriesDataIndices || [];
          a = a && c.value === p.value && c.axisType === p.axisType && c.axisId === p.axisId && m.length === g.length, a && M(m, function(v, b) {
            var y = g[b];
            a = a && v.seriesIndex === y.seriesIndex && v.dataIndex === y.dataIndex;
          }), s && M(c.seriesDataIndices, function(v) {
            var b = v.seriesIndex, y = i[b], w = s[b];
            y && w && w.data !== y.data && (a = !1);
          });
        });
      }), this._lastDataByCoordSys = t, this._cbParamsList = i, !!a;
    }, e.prototype._hide = function(t) {
      this._lastDataByCoordSys = null, t({
        type: "hideTip",
        from: this.uid
      });
    }, e.prototype.dispose = function(t, i) {
      W.node || !i.getDom() || (Yh(this, "_updatePosition"), this._tooltipContent.dispose(), nu("itemTooltip", i));
    }, e.type = "tooltip", e;
  }(ti)
);
function kn(r, e, t) {
  var i = e.ecModel, n;
  t ? (n = new pe(t, i, i), n = new pe(e.option, n, i)) : n = e;
  for (var s = r.length - 1; s >= 0; s--) {
    var a = r[s];
    a && (a instanceof pe && (a = a.get("tooltip", !0)), V(a) && (a = {
      formatter: a
    }), a && (n = new pe(a, n, i)));
  }
  return n;
}
function Cp(r, e) {
  return r.dispatchAction || K(e.dispatchAction, e);
}
function QM(r, e, t, i, n, s, a) {
  var o = t.getSize(), l = o[0], h = o[1];
  return s != null && (r + l + s + 2 > i ? r -= l + s : r += s), a != null && (e + h + a > n ? e -= h + a : e += a), [r, e];
}
function eD(r, e, t, i, n) {
  var s = t.getSize(), a = s[0], o = s[1];
  return r = Math.min(r + a, i) - a, e = Math.min(e + o, n) - o, r = Math.max(r, 0), e = Math.max(e, 0), [r, e];
}
function tD(r, e, t, i) {
  var n = t[0], s = t[1], a = Math.ceil(Math.SQRT2 * i) + 8, o = 0, l = 0, h = e.width, u = e.height;
  switch (r) {
    case "inside":
      o = e.x + h / 2 - n / 2, l = e.y + u / 2 - s / 2;
      break;
    case "top":
      o = e.x + h / 2 - n / 2, l = e.y - s - a;
      break;
    case "bottom":
      o = e.x + h / 2 - n / 2, l = e.y + u + a;
      break;
    case "left":
      o = e.x - n - a, l = e.y + u / 2 - s / 2;
      break;
    case "right":
      o = e.x + h + a, l = e.y + u / 2 - s / 2;
  }
  return [o, l];
}
function _p(r) {
  return r === "center" || r === "middle";
}
function iD(r, e, t) {
  var i = mu(r).queryOptionMap, n = i.keys()[0];
  if (!(!n || n === "series")) {
    var s = bs(e, n, i.get(n), {
      useDefault: !1,
      enableAll: !1,
      enableNone: !1
    }), a = s.models[0];
    if (a) {
      var o = t.getViewOfComponentModel(a), l;
      if (o.group.traverse(function(h) {
        var u = ce(h).tooltipConfig;
        if (u && u.name === r.name)
          return l = h, !0;
      }), l)
        return {
          componentMainType: n,
          componentIndex: a.componentIndex,
          el: l
        };
    }
  }
}
function rD(r) {
  Ku(HM), r.registerComponentModel(NM), r.registerComponentView(JM), r.registerAction({
    type: "showTip",
    event: "showTip",
    update: "tooltip:manuallyShowTip"
  }, Le), r.registerAction({
    type: "hideTip",
    event: "hideTip",
    update: "tooltip:manuallyHideTip"
  }, Le);
}
var nD = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      var t = r !== null && r.apply(this, arguments) || this;
      return t.type = e.type, t.layoutMode = {
        type: "box",
        ignoreSize: !0
      }, t;
    }
    return e.type = "title", e.defaultOption = {
      // zlevel: 0,
      z: 6,
      show: !0,
      text: "",
      target: "blank",
      subtext: "",
      subtarget: "blank",
      left: 0,
      top: 0,
      backgroundColor: "rgba(0,0,0,0)",
      borderColor: "#ccc",
      borderWidth: 0,
      padding: 5,
      itemGap: 10,
      textStyle: {
        fontSize: 18,
        fontWeight: "bold",
        color: "#464646"
      },
      subtextStyle: {
        fontSize: 12,
        color: "#6E7079"
      }
    }, e;
  }(ae)
), sD = (
  /** @class */
  function(r) {
    De(e, r);
    function e() {
      var t = r !== null && r.apply(this, arguments) || this;
      return t.type = e.type, t;
    }
    return e.prototype.render = function(t, i, n) {
      if (this.group.removeAll(), !!t.get("show")) {
        var s = this.group, a = t.getModel("textStyle"), o = t.getModel("subtextStyle"), l = t.get("textAlign"), h = j(t.get("textBaseline"), t.get("textVerticalAlign")), u = new ht({
          style: ei(a, {
            text: t.get("text"),
            fill: a.getTextColor()
          }, {
            disableBox: !0
          }),
          z2: 10
        }), d = u.getBoundingRect(), c = t.get("subtext"), f = new ht({
          style: ei(o, {
            text: c,
            fill: o.getTextColor(),
            y: d.height + t.get("itemGap"),
            verticalAlign: "top"
          }, {
            disableBox: !0
          }),
          z2: 10
        }), p = t.get("link"), m = t.get("sublink"), g = t.get("triggerEvent", !0);
        u.silent = !p && !g, f.silent = !m && !g, p && u.on("click", function() {
          Nh(p, "_" + t.get("target"));
        }), m && f.on("click", function() {
          Nh(m, "_" + t.get("subtarget"));
        }), ce(u).eventData = ce(f).eventData = g ? {
          componentType: "title",
          componentIndex: t.componentIndex
        } : null, s.add(u), c && s.add(f);
        var v = s.getBoundingRect(), b = t.getBoxLayoutParams();
        b.width = v.width, b.height = v.height;
        var y = fo(b, {
          width: n.getWidth(),
          height: n.getHeight()
        }, t.get("padding"));
        l || (l = t.get("left") || t.get("right"), l === "middle" && (l = "center"), l === "right" ? y.x += y.width : l === "center" && (y.x += y.width / 2)), h || (h = t.get("top") || t.get("bottom"), h === "center" && (h = "middle"), h === "bottom" ? y.y += y.height : h === "middle" && (y.y += y.height / 2), h = h || "top"), s.x = y.x, s.y = y.y, s.markRedraw();
        var w = {
          align: l,
          verticalAlign: h
        };
        u.setStyle(w), f.setStyle(w), v = s.getBoundingRect();
        var _ = y.margin, E = t.getItemStyle(["color", "opacity"]);
        E.fill = t.get("backgroundColor");
        var x = new ot({
          shape: {
            x: v.x - _[3],
            y: v.y - _[0],
            width: v.width + _[1] + _[3],
            height: v.height + _[0] + _[2],
            r: t.get("borderRadius")
          },
          style: E,
          subPixelOptimize: !0,
          silent: !0
        });
        s.add(x);
      }
    }, e.type = "title", e;
  }(ti)
);
function aD(r) {
  r.registerComponentModel(nD), r.registerComponentView(sD);
}
const oD = [
  "getWidth",
  "getHeight",
  "getDom",
  "getOption",
  "resize",
  "dispatchAction",
  "convertToPixel",
  "convertFromPixel",
  "containPixel",
  "getDataURL",
  "getConnectedDataURL",
  "appendData",
  "clear",
  "isDisposed",
  "dispose"
];
function lD(r) {
  function e(i) {
    return (...n) => {
      if (!r.value)
        throw new Error("ECharts is not initialized yet.");
      return r.value[i].apply(r.value, n);
    };
  }
  function t() {
    const i = /* @__PURE__ */ Object.create(null);
    return oD.forEach((n) => {
      i[n] = e(n);
    }), i;
  }
  return t();
}
function hD(r, e, t) {
  Vr(
    [t, r, e],
    ([i, n, s], a, o) => {
      let l = null;
      if (i && n && s) {
        const { offsetWidth: h, offsetHeight: u } = i, d = s === !0 ? {} : s, { throttle: c = 100, onResize: f } = d;
        let p = !1;
        const m = () => {
          n.resize(), f == null || f();
        }, g = c ? Uu(m, c) : m;
        l = new ResizeObserver(() => {
          !p && (p = !0, i.offsetWidth === h && i.offsetHeight === u) || g();
        }), l.observe(i);
      }
      o(() => {
        l && (l.disconnect(), l = null);
      });
    }
  );
}
const uD = {
  autoresize: [Boolean, Object]
}, dD = /^on[^a-z]/, rb = (r) => dD.test(r);
function cD(r) {
  const e = {};
  for (const t in r)
    rb(t) || (e[t] = r[t]);
  return e;
}
function ga(r, e) {
  const t = db(r) ? Ot(r) : r;
  return t && typeof t == "object" && "value" in t ? t.value || e : t || e;
}
const fD = "ecLoadingOptions";
function pD(r, e, t) {
  const i = Vn(fD, {}), n = rt(() => ({
    ...ga(i, {}),
    ...t == null ? void 0 : t.value
  }));
  Sp(() => {
    const s = r.value;
    s && (e.value ? s.showLoading(n.value) : s.hideLoading());
  });
}
const gD = {
  loading: Boolean,
  loadingOptions: Object
};
let An = null;
const nb = "x-vue-echarts";
function vD() {
  if (An != null)
    return An;
  if (typeof HTMLElement > "u" || typeof customElements > "u")
    return An = !1;
  try {
    new Function(
      "tag",
      // Use esbuild repl to keep build process simple
      // https://esbuild.github.io/try/#dAAwLjIzLjAALS1taW5pZnkAY2xhc3MgRUNoYXJ0c0VsZW1lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7CiAgX19kaXNwb3NlID0gbnVsbDsKCiAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7CiAgICBpZiAodGhpcy5fX2Rpc3Bvc2UpIHsKICAgICAgdGhpcy5fX2Rpc3Bvc2UoKTsKICAgICAgdGhpcy5fX2Rpc3Bvc2UgPSBudWxsOwogICAgfQogIH0KfQoKaWYgKGN1c3RvbUVsZW1lbnRzLmdldCh0YWcpID09IG51bGwpIHsKICBjdXN0b21FbGVtZW50cy5kZWZpbmUodGFnLCBFQ2hhcnRzRWxlbWVudCk7Cn0K
      "class EChartsElement extends HTMLElement{__dispose=null;disconnectedCallback(){this.__dispose&&(this.__dispose(),this.__dispose=null)}}customElements.get(tag)==null&&customElements.define(tag,EChartsElement);"
    )(nb);
  } catch {
    return An = !1;
  }
  return An = !0;
}
document.head.appendChild(document.createElement("style")).textContent = `x-vue-echarts{display:block;width:100%;height:100%;min-width:0}
`;
const mD = vD(), bD = "ecTheme", yD = "ecInitOptions", wD = "ecUpdateOptions", Ep = /(^&?~?!?)native:/;
var CD = xp({
  name: "echarts",
  props: {
    option: Object,
    theme: {
      type: [Object, String]
    },
    initOptions: Object,
    updateOptions: Object,
    group: String,
    manualUpdate: Boolean,
    ...uD,
    ...gD
  },
  emits: {},
  inheritAttrs: !1,
  setup(r, { attrs: e }) {
    const t = mo(), i = mo(), n = mo(), s = Vn(bD, null), a = Vn(yD, null), o = Vn(wD, null), { autoresize: l, manualUpdate: h, loading: u, loadingOptions: d } = lb(r), c = rt(
      () => n.value || r.option || null
    ), f = rt(
      () => r.theme || ga(s, {})
    ), p = rt(
      () => r.initOptions || ga(a, {})
    ), m = rt(
      () => r.updateOptions || ga(o, {})
    ), g = rt(() => cD(e)), v = {}, b = hb().proxy.$listeners, y = {};
    b ? Object.keys(b).forEach((C) => {
      Ep.test(C) ? v[C.replace(Ep, "$1")] = b[C] : y[C] = b[C];
    }) : Object.keys(e).filter((C) => rb(C)).forEach((C) => {
      let S = C.charAt(2).toLowerCase() + C.slice(3);
      if (S.indexOf("native:") === 0) {
        const R = `on${S.charAt(7).toUpperCase()}${S.slice(
          8
        )}`;
        v[R] = e[C];
        return;
      }
      S.substring(S.length - 4) === "Once" && (S = `~${S.substring(0, S.length - 4)}`), y[S] = e[C];
    });
    function w(C) {
      if (!t.value)
        return;
      const S = i.value = SS(
        t.value,
        f.value,
        p.value
      );
      r.group && (S.group = r.group), Object.keys(y).forEach((k) => {
        let L = y[k];
        if (!L)
          return;
        let O = k.toLowerCase();
        O.charAt(0) === "~" && (O = O.substring(1), L.__once__ = !0);
        let I = S;
        if (O.indexOf("zr:") === 0 && (I = S.getZr(), O = O.substring(3)), L.__once__) {
          delete L.__once__;
          const G = L;
          L = (...ee) => {
            G(...ee), I.off(O, L);
          };
        }
        I.on(O, L);
      });
      function R() {
        S && !S.isDisposed() && S.resize();
      }
      function D() {
        const k = C || c.value;
        k && S.setOption(k, m.value);
      }
      l.value ? Tp(() => {
        R(), D();
      }) : D();
    }
    function _(C, S) {
      r.manualUpdate && (n.value = C), i.value ? i.value.setOption(C, S || {}) : w(C);
    }
    function E() {
      i.value && (i.value.dispose(), i.value = void 0);
    }
    let x = null;
    Vr(
      h,
      (C) => {
        typeof x == "function" && (x(), x = null), C || (x = Vr(
          () => r.option,
          (S, R) => {
            S && (i.value ? i.value.setOption(S, {
              // mutating `option` will lead to `notMerge: false` and
              // replacing it with new reference will lead to `notMerge: true`
              notMerge: S !== R,
              ...m.value
            }) : w());
          },
          { deep: !0 }
        ));
      },
      {
        immediate: !0
      }
    ), Vr(
      [f, p],
      () => {
        E(), w();
      },
      {
        deep: !0
      }
    ), Sp(() => {
      r.group && i.value && (i.value.group = r.group);
    });
    const T = lD(i);
    return pD(i, u, d), hD(i, l, t), ub(() => {
      w();
    }), Rp(() => {
      mD && t.value ? t.value.__dispose = E : E();
    }), {
      chart: i,
      root: t,
      setOption: _,
      nonEventAttrs: g,
      nativeListeners: v,
      ...T
    };
  },
  render() {
    const r = { ...this.nonEventAttrs, ...this.nativeListeners };
    return r.ref = "root", r.class = r.class ? ["echarts"].concat(r.class) : "echarts", ob(nb, r);
  }
});
const _D = { class: "relative-capital-deployed-risk-management-view" }, ED = {
  key: 0,
  class: "loading-state"
}, TD = {
  key: 1,
  class: "error-state"
}, xD = { class: "error-message" }, SD = {
  key: 2,
  class: "content"
}, RD = { class: "summary-stats" }, MD = { class: "stat-card" }, DD = { class: "stat-value" }, LD = { class: "stat-card" }, kD = { class: "stat-value" }, AD = { class: "stat-card" }, PD = { class: "stat-value" }, OD = { class: "stat-detail" }, ID = { class: "chart-container" }, zD = { class: "positions-container" }, FD = {
  key: 3,
  class: "empty-state"
}, HD = /* @__PURE__ */ xp({
  __name: "RelativeCapitalDeployed",
  props: {
    userId: { default: "4fbec15d-2316-4805-b2a4-5cd2115a5ac8" }
  },
  setup(r) {
    Ku([lM, fM, rD, aD]);
    const e = r, { data: t, isLoading: i, isError: n, error: s, _cleanup: a } = Cb(e.userId), o = rt(() => t.value ? t.value.reduce((T, C) => T + C.capitalInvested, 0) : 0), l = rt(() => t.value ? t.value.reduce((T, C) => T + u(C), 0) : 0), h = rt(() => t.value ? t.value.reduce((T, C) => T + d(C), 0) : 0), u = (T) => T.positions.filter((C) => C.asset_class === "STK" || C.asset_class === "FUND").reduce((C, S) => {
      const R = Math.abs(S.accounting_quantity ?? S.qty ?? 0);
      return C + R * (T.currentMarketPrice ?? 0);
    }, 0), d = (T) => T.positions.filter((C) => C.asset_class === "OPT").reduce((C, S) => {
      const R = Math.abs(S.accounting_quantity ?? S.qty ?? 0);
      return C + R * (T.currentMarketPrice ?? 0);
    }, 0), c = (T) => new Intl.NumberFormat("en-US", {
      style: "currency",
      currency: "USD",
      minimumFractionDigits: 0,
      maximumFractionDigits: 0
    }).format(T), f = (T) => new Intl.NumberFormat("en-US", {
      minimumFractionDigits: 0,
      maximumFractionDigits: 0
    }).format(T), p = (T) => o.value === 0 ? "0.00" : (T / o.value * 100).toFixed(2), m = (T) => {
      const C = T.getValue();
      return C == null ? "" : f(C);
    };
    rt(() => t.value ? t.value.reduce((T, C) => T + C.positionCount, 0) : 0);
    const g = (T) => {
      var I;
      const C = T.getData();
      console.log("ðŸ” [DetailRow] Formatting detail for:", C.symbolRoot, "with", (I = C.positions) == null ? void 0 : I.length, "positions"), console.log("ðŸ” [DetailRow] Positions data:", C.positions);
      const S = document.createElement("div");
      S.style.cssText = "padding: 1rem; background: #f8f9fa; border-top: 2px solid #dee2e6;";
      const R = document.createElement("div");
      R.style.cssText = "margin-bottom: 1rem;", R.innerHTML = `
    <h4 style="margin: 0 0 0.5rem 0; color: #495057; font-size: 1rem;">
      ${C.symbolRoot} - Position Details (${C.positionCount} positions)
    </h4>
    <p style="margin: 0; color: #6c757d; font-size: 0.875rem;">
      Showing individual stocks, funds, and PUT options that make up the total
    </p>
  `, S.appendChild(R);
      const D = document.createElement("table");
      D.style.cssText = "width: 100%; border-collapse: collapse; background: white; border-radius: 4px; overflow: hidden;";
      const k = document.createElement("thead");
      k.innerHTML = `
    <tr style="background: #e9ecef;">
      <th style="padding: 0.75rem; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Account</th>
      <th style="padding: 0.75rem; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Asset Category</th>
      <th style="padding: 0.75rem; text-align: left; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Symbol</th>
      <th style="padding: 0.75rem; text-align: right; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Accounting Quantity</th>
      <th style="padding: 0.75rem; text-align: right; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6;">Capital Used</th>
    </tr>
  `, D.appendChild(k);
      const L = document.createElement("tbody");
      C.positions.forEach((G, ee) => {
        const te = Math.abs(G.accounting_quantity ?? G.qty ?? 0), ve = C.currentMarketPrice ? te * C.currentMarketPrice : 0;
        let be = "Unknown", ie = "#6c757d";
        G.asset_class === "STK" ? (be = "Stock", ie = "#28a745") : G.asset_class === "FUND" ? (be = "Fund", ie = "#ffc107") : G.asset_class === "OPT" && (be = "PUT Option", ie = "#007bff");
        const xe = document.createElement("tr");
        xe.style.cssText = ee % 2 === 0 ? "background: #ffffff;" : "background: #f8f9fa;", xe.innerHTML = `
      <td style="padding: 0.75rem; text-align: left; border-bottom: 1px solid #e9ecef; color: #495057; font-size: 0.875rem; font-weight: 500;">
        ${G.account_display_name || G.internal_account_id || "N/A"}
      </td>
      <td style="padding: 0.75rem; border-bottom: 1px solid #e9ecef;">
        <span style="display: inline-block; padding: 0.25rem 0.5rem; background: ${ie}15; color: ${ie}; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">
          ${be}
        </span>
      </td>
      <td style="padding: 0.75rem; border-bottom: 1px solid #e9ecef; font-family: monospace; font-size: 0.875rem; color: #495057;">
        ${G.symbol}
      </td>
      <td style="padding: 0.75rem; text-align: right; border-bottom: 1px solid #e9ecef; font-weight: 600; color: #495057;">
        ${f(te)}
      </td>
      <td style="padding: 0.75rem; text-align: right; border-bottom: 1px solid #e9ecef; font-weight: 600; color: #28a745;">
        ${c(ve)}
      </td>
    `, L.appendChild(xe);
      });
      const O = document.createElement("tr");
      return O.style.cssText = "background: #e9ecef; font-weight: 700;", O.innerHTML = `
    <td colspan="2" style="padding: 0.75rem; border-top: 2px solid #dee2e6; color: #495057;">
      TOTAL
    </td>    
    <td style="padding: 0.75rem; text-align: right; border-top: 2px solid #dee2e6;"></td>
    <td style="padding: 0.75rem; text-align: right; border-top: 2px solid #dee2e6; color: #495057;">
      ${f(C.totalQuantity)}
    </td>
    <td style="padding: 0.75rem; text-align: right; border-top: 2px solid #dee2e6; color: #28a745;">
      ${c(C.capitalInvested)}
    </td>
  `, L.appendChild(O), D.appendChild(L), S.appendChild(D), S;
    }, v = [
      {
        title: "",
        field: "expand",
        width: 50,
        hozAlign: "center",
        headerHozAlign: "center",
        headerSort: !1,
        cellClick: (T, C) => {
          console.log("ðŸ–±ï¸ [Expand] Cell clicked");
          const S = C.getRow(), R = S.getData(), D = R.symbolRoot;
          console.log("ðŸ“Š [Expand] Row data:", R), console.log("ðŸ“Š [Expand] Symbol:", D), console.log("ðŸ“Š [Expand] Positions:", R.positions), w.value.has(D) ? (console.log("â¬†ï¸ [Expand] Collapsing row"), w.value.delete(D), C.getElement().innerHTML = '<span style="cursor: pointer; font-size: 1.2rem; color: #007bff;">â–¶</span>') : (console.log("â¬‡ï¸ [Expand] Expanding row"), w.value.add(D), C.getElement().innerHTML = '<span style="cursor: pointer; font-size: 1.2rem; color: #007bff;">â–¼</span>'), w.value = new Set(w.value), S.reformat(), console.log("âœ… [Expand] Toggle complete, expanded rows:", Array.from(w.value));
        },
        formatter: (T) => {
          const S = T.getRow().getData().symbolRoot;
          return `<span style="cursor: pointer; font-size: 1.2rem; color: #007bff;">${w.value.has(S) ? "â–¼" : "â–¶"}</span>`;
        }
      },
      {
        title: "#",
        field: "rank",
        width: 60,
        hozAlign: "center",
        headerHozAlign: "center",
        formatter: (T) => {
          const C = T.getRow();
          return String(C.getPosition());
        }
      },
      {
        title: "Symbol",
        field: "symbolRoot",
        widthGrow: 1.2,
        headerHozAlign: "left",
        formatter: (T) => `<strong style="color:#007bff;font-size:1.05rem">${T.getValue()}</strong>`
      },
      {
        title: "Total Accounting Quantity",
        field: "totalQuantity",
        widthGrow: 1.5,
        hozAlign: "right",
        headerHozAlign: "right",
        formatter: m,
        bottomCalc: "sum",
        bottomCalcFormatter: (T) => {
          const C = T.getValue();
          return f(C);
        }
      },
      {
        title: "Market Price",
        field: "currentMarketPrice",
        widthGrow: 1.3,
        hozAlign: "right",
        headerHozAlign: "right",
        formatter: (T) => {
          const C = T.getValue();
          return C == null ? '<span style="color:#6c757d;font-style:italic;">N/A</span>' : new Intl.NumberFormat("en-US", {
            style: "currency",
            currency: "USD",
            minimumFractionDigits: 2,
            maximumFractionDigits: 2
          }).format(C);
        }
      },
      {
        title: "Capital Used (STK)",
        field: "capitalStkOnly",
        widthGrow: 1.8,
        hozAlign: "right",
        headerHozAlign: "right",
        formatter: (T) => {
          const C = T.getRow().getData(), S = u(C);
          return `<strong style="color:#28a745;font-size:1.05rem">${c(S)}</strong>`;
        },
        bottomCalc: () => l.value,
        bottomCalcFormatter: (T) => {
          const C = T.getValue();
          return `<strong style="color:#28a745;font-size:1.05rem">${c(C)}</strong>`;
        }
      },
      {
        title: "Capital Used (PUT)",
        field: "capitalPutOnly",
        widthGrow: 1.8,
        hozAlign: "right",
        headerHozAlign: "right",
        formatter: (T) => {
          const C = T.getRow().getData(), S = d(C);
          return `<strong style="color:#007bff;font-size:1.05rem">${c(S)}</strong>`;
        },
        bottomCalc: () => h.value,
        bottomCalcFormatter: (T) => {
          const C = T.getValue();
          return `<strong style="color:#007bff;font-size:1.05rem">${c(C)}</strong>`;
        }
      },
      {
        title: "% of Total",
        field: "percentage",
        widthGrow: 1.3,
        hozAlign: "center",
        headerHozAlign: "center",
        formatter: (T) => {
          const C = T.getRow().getData();
          return `<span style="display:inline-block;padding:0.375rem 0.75rem;background:#e7f3ff;color:#007bff;border-radius:12px;font-weight:600;font-size:0.875rem">${p(C.capitalInvested)}%</span>`;
        },
        bottomCalc: () => 100,
        bottomCalcFormatter: () => '<span style="display:inline-block;padding:0.375rem 0.75rem;background:#e7f3ff;color:#007bff;border-radius:12px;font-weight:600;font-size:0.875rem">100.00%</span>'
      }
      /* {
        title: 'Positions',
        field: 'positionCount',
        width: 100,
        hozAlign: 'center',
        headerHozAlign: 'center',
        formatter: (cell: any) => {
          const value = cell.getValue()
          return `<span style="color:#6c757d">${value}</span>`
        },
        bottomCalc: 'sum',
        bottomCalcFormatter: (cell: any) => {
          const value = cell.getValue()
          return `<span style="color:#6c757d">${value}</span>`
        }
      } */
    ], b = rt(() => t.value ? t.value : []), y = rt(() => !i.value && !n.value && !!t.value && t.value.length > 0), w = Qs(/* @__PURE__ */ new Set()), { tableDiv: _ } = Gw({
      data: b,
      columns: v,
      isSuccess: y,
      placeholder: "No position data available",
      rowFormatter: (T) => {
        const C = T.getData(), S = T.getElement(), R = C.symbolRoot, D = S.querySelector(".detail-row-container");
        if (D && D.remove(), w.value.has(R)) {
          const k = document.createElement("div");
          k.className = "detail-row-container", k.appendChild(g(T)), S.appendChild(k);
        }
      }
    }), E = (T) => T >= 15 ? "#1B5E20" : T >= 10 ? "#2E7D32" : T >= 7 ? "#388E3C" : T >= 5 ? "#4CAF50" : T >= 3 ? "#66BB6A" : "#81C784", x = rt(() => {
      if (!t.value || t.value.length === 0)
        return {
          series: [{
            type: "treemap",
            data: []
          }]
        };
      const T = o.value;
      return {
        tooltip: {
          formatter: (C) => {
            const { name: S, value: R, data: D } = C, k = D.percentage;
            return `
          <div style="padding: 8px;">
            <strong style="font-size: 16px;">${S}</strong><br/>
            Capital: <strong>${c(R)}</strong><br/>
            Percentage: <strong>${k.toFixed(2)}%</strong>
          </div>
        `;
          }
        },
        series: [{
          type: "treemap",
          width: "100%",
          height: "100%",
          roam: !1,
          nodeClick: !1,
          breadcrumb: {
            show: !1
          },
          label: {
            show: !0,
            formatter: (C) => {
              const { name: S, data: R } = C, D = R.percentage;
              return `{name|${S}}
{percent|${D.toFixed(2)}%}`;
            },
            rich: {
              name: {
                fontSize: 16,
                fontWeight: "bold",
                color: "#fff",
                lineHeight: 20
              },
              percent: {
                fontSize: 14,
                color: "#fff",
                lineHeight: 18
              }
            }
          },
          upperLabel: {
            show: !1
          },
          itemStyle: {
            borderColor: "#fff",
            borderWidth: 2,
            gapWidth: 2
          },
          levels: [
            {
              itemStyle: {
                borderColor: "#fff",
                borderWidth: 2,
                gapWidth: 2
              }
            }
          ],
          data: t.value.map((C) => {
            const S = C.capitalInvested / T * 100;
            return {
              name: C.symbolRoot,
              value: C.capitalInvested,
              percentage: S,
              itemStyle: {
                color: E(S)
              }
            };
          })
        }]
      };
    });
    return Rp(() => {
      a && a();
    }), (T, C) => {
      var S;
      return ln(), on("div", _D, [
        C[5] || (C[5] = Ce("div", { class: "header" }, [
          Ce("h2", null, "Top 20 Positions by Capital Used"),
          Ce("p", { class: "subtitle" }, "Risk management view showing capital deployment across largest positions")
        ], -1)),
        Ot(i) ? (ln(), on("div", ED, [...C[0] || (C[0] = [
          Ce("div", { class: "spinner" }, null, -1),
          Ce("p", null, "Loading position data...", -1)
        ])])) : Ot(n) ? (ln(), on("div", TD, [
          Ce("p", xD, "âŒ Error loading data: " + hn((S = Ot(s)) == null ? void 0 : S.message), 1)
        ])) : Ot(t) && Ot(t).length > 0 ? (ln(), on("div", SD, [
          Ce("div", RD, [
            Ce("div", MD, [
              C[1] || (C[1] = Ce("div", { class: "stat-label" }, "Total Capital Used", -1)),
              Ce("div", DD, hn(c(o.value)), 1)
            ]),
            Ce("div", LD, [
              C[2] || (C[2] = Ce("div", { class: "stat-label" }, "Number of Positions", -1)),
              Ce("div", kD, hn(Ot(t).length), 1)
            ]),
            Ce("div", AD, [
              C[3] || (C[3] = Ce("div", { class: "stat-label" }, "Largest Position", -1)),
              Ce("div", PD, hn(Ot(t)[0].symbolRoot), 1),
              Ce("div", OD, hn(c(Ot(t)[0].capitalInvested)), 1)
            ])
          ]),
          Ce("div", ID, [
            cb(Ot(CD), {
              option: x.value,
              autoresize: ""
            }, null, 8, ["option"])
          ]),
          Ce("div", zD, [
            Ce("div", {
              ref_key: "tableDiv",
              ref: _,
              class: "tabulator-table"
            }, null, 512)
          ])
        ])) : (ln(), on("div", FD, [...C[4] || (C[4] = [
          Ce("p", null, "No position data available", -1)
        ])]))
      ]);
    };
  }
}), ND = (r, e) => {
  const t = r.__vccOpts || r;
  for (const [i, n] of e)
    t[i] = n;
  return t;
}, UD = /* @__PURE__ */ ND(HD, [["__scopeId", "data-v-614acbe0"]]);
export {
  UD as default,
  UD as relativeCapitalDeployed
};
